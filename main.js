/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var U2=Object.create;var Es=Object.defineProperty;var B2=Object.getOwnPropertyDescriptor;var z2=Object.getOwnPropertyNames;var V2=Object.getPrototypeOf,G2=Object.prototype.hasOwnProperty;var H2=(e,t,n)=>t in e?Es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _e=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),j2=(e,t)=>{for(var n in t)Es(e,n,{get:t[n],enumerable:!0})},Yg=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of z2(t))!G2.call(e,i)&&i!==n&&Es(e,i,{get:()=>t[i],enumerable:!(r=B2(t,i))||r.enumerable});return e};var H=(e,t,n)=>(n=e!=null?U2(V2(e)):{},Yg(t||!e||!e.__esModule?Es(n,"default",{value:e,enumerable:!0}):n,e)),W2=e=>Yg(Es({},"__esModule",{value:!0}),e);var cu=(e,t,n)=>H2(e,typeof t!="symbol"?t+"":t,n);var av=_e(De=>{"use strict";var Ts=Symbol.for("react.element"),$2=Symbol.for("react.portal"),X2=Symbol.for("react.fragment"),Y2=Symbol.for("react.strict_mode"),K2=Symbol.for("react.profiler"),Z2=Symbol.for("react.provider"),q2=Symbol.for("react.context"),J2=Symbol.for("react.forward_ref"),Q2=Symbol.for("react.suspense"),eE=Symbol.for("react.memo"),tE=Symbol.for("react.lazy"),Kg=Symbol.iterator;function nE(e){return e===null||typeof e!="object"?null:(e=Kg&&e[Kg]||e["@@iterator"],typeof e=="function"?e:null)}var Jg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qg=Object.assign,ev={};function ra(e,t,n){this.props=e,this.context=t,this.refs=ev,this.updater=n||Jg}ra.prototype.isReactComponent={};ra.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ra.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function tv(){}tv.prototype=ra.prototype;function _f(e,t,n){this.props=e,this.context=t,this.refs=ev,this.updater=n||Jg}var xf=_f.prototype=new tv;xf.constructor=_f;Qg(xf,ra.prototype);xf.isPureReactComponent=!0;var Zg=Array.isArray,nv=Object.prototype.hasOwnProperty,Ef={current:null},rv={key:!0,ref:!0,__self:!0,__source:!0};function iv(e,t,n){var r,i={},o=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)nv.call(t,r)&&!rv.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:Ts,type:e,key:o,ref:a,props:i,_owner:Ef.current}}function rE(e,t){return{$$typeof:Ts,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Tf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ts}function iE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var qg=/\/+/g;function bf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?iE(""+e.key):t.toString(36)}function fu(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ts:case $2:a=!0}}if(a)return a=e,i=i(a),e=r===""?"."+bf(a,0):r,Zg(i)?(n="",e!=null&&(n=e.replace(qg,"$&/")+"/"),fu(i,t,n,"",function(u){return u})):i!=null&&(Tf(i)&&(i=rE(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(qg,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=r===""?".":r+":",Zg(e))for(var s=0;s<e.length;s++){o=e[s];var l=r+bf(o,s);a+=fu(o,t,n,l,i)}else if(l=nE(e),typeof l=="function")for(e=l.call(e),s=0;!(o=e.next()).done;)o=o.value,l=r+bf(o,s++),a+=fu(o,t,n,l,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function du(e,t,n){if(e==null)return e;var r=[],i=0;return fu(e,r,"","",function(o){return t.call(n,o,i++)}),r}function oE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sn={current:null},pu={transition:null},aE={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:pu,ReactCurrentOwner:Ef};function ov(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:du,forEach:function(e,t,n){du(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return du(e,function(){t++}),t},toArray:function(e){return du(e,function(t){return t})||[]},only:function(e){if(!Tf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};De.Component=ra;De.Fragment=X2;De.Profiler=K2;De.PureComponent=_f;De.StrictMode=Y2;De.Suspense=Q2;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aE;De.act=ov;De.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Qg({},e.props),i=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=Ef.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)nv.call(t,l)&&!rv.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:Ts,type:e.type,key:i,ref:o,props:r,_owner:a}};De.createContext=function(e){return e={$$typeof:q2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Z2,_context:e},e.Consumer=e};De.createElement=iv;De.createFactory=function(e){var t=iv.bind(null,e);return t.type=e,t};De.createRef=function(){return{current:null}};De.forwardRef=function(e){return{$$typeof:J2,render:e}};De.isValidElement=Tf;De.lazy=function(e){return{$$typeof:tE,_payload:{_status:-1,_result:e},_init:oE}};De.memo=function(e,t){return{$$typeof:eE,type:e,compare:t===void 0?null:t}};De.startTransition=function(e){var t=pu.transition;pu.transition={};try{e()}finally{pu.transition=t}};De.unstable_act=ov;De.useCallback=function(e,t){return sn.current.useCallback(e,t)};De.useContext=function(e){return sn.current.useContext(e)};De.useDebugValue=function(){};De.useDeferredValue=function(e){return sn.current.useDeferredValue(e)};De.useEffect=function(e,t){return sn.current.useEffect(e,t)};De.useId=function(){return sn.current.useId()};De.useImperativeHandle=function(e,t,n){return sn.current.useImperativeHandle(e,t,n)};De.useInsertionEffect=function(e,t){return sn.current.useInsertionEffect(e,t)};De.useLayoutEffect=function(e,t){return sn.current.useLayoutEffect(e,t)};De.useMemo=function(e,t){return sn.current.useMemo(e,t)};De.useReducer=function(e,t,n){return sn.current.useReducer(e,t,n)};De.useRef=function(e){return sn.current.useRef(e)};De.useState=function(e){return sn.current.useState(e)};De.useSyncExternalStore=function(e,t,n){return sn.current.useSyncExternalStore(e,t,n)};De.useTransition=function(){return sn.current.useTransition()};De.version="18.3.1"});var Fe=_e((uk,sv)=>{"use strict";sv.exports=av()});var vv=_e(qe=>{"use strict";function Af(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(0<hu(i,t))e[r]=t,e[n]=i,n=r;else break e}}function nr(e){return e.length===0?null:e[0]}function gu(e){if(e.length===0)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,s=e[a],l=a+1,u=e[l];if(0>hu(s,n))l<i&&0>hu(u,s)?(e[r]=u,e[l]=n,r=l):(e[r]=s,e[a]=n,r=a);else if(l<i&&0>hu(u,n))e[r]=u,e[l]=n,r=l;else break e}}return t}function hu(e,t){var n=e.sortIndex-t.sortIndex;return n!==0?n:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(lv=performance,qe.unstable_now=function(){return lv.now()}):(Cf=Date,uv=Cf.now(),qe.unstable_now=function(){return Cf.now()-uv});var lv,Cf,uv,Sr=[],xi=[],sE=1,Gn=null,Zt=3,vu=!1,mo=!1,Is=!1,fv=typeof setTimeout=="function"?setTimeout:null,pv=typeof clearTimeout=="function"?clearTimeout:null,cv=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Df(e){for(var t=nr(xi);t!==null;){if(t.callback===null)gu(xi);else if(t.startTime<=e)gu(xi),t.sortIndex=t.expirationTime,Af(Sr,t);else break;t=nr(xi)}}function Lf(e){if(Is=!1,Df(e),!mo)if(nr(Sr)!==null)mo=!0,Rf(kf);else{var t=nr(xi);t!==null&&Mf(Lf,t.startTime-e)}}function kf(e,t){mo=!1,Is&&(Is=!1,pv(Ps),Ps=-1),vu=!0;var n=Zt;try{for(Df(t),Gn=nr(Sr);Gn!==null&&(!(Gn.expirationTime>t)||e&&!gv());){var r=Gn.callback;if(typeof r=="function"){Gn.callback=null,Zt=Gn.priorityLevel;var i=r(Gn.expirationTime<=t);t=qe.unstable_now(),typeof i=="function"?Gn.callback=i:Gn===nr(Sr)&&gu(Sr),Df(t)}else gu(Sr);Gn=nr(Sr)}if(Gn!==null)var o=!0;else{var a=nr(xi);a!==null&&Mf(Lf,a.startTime-t),o=!1}return o}finally{Gn=null,Zt=n,vu=!1}}var yu=!1,mu=null,Ps=-1,hv=5,mv=-1;function gv(){return!(qe.unstable_now()-mv<hv)}function If(){if(mu!==null){var e=qe.unstable_now();mv=e;var t=!0;try{t=mu(!0,e)}finally{t?Cs():(yu=!1,mu=null)}}else yu=!1}var Cs;typeof cv=="function"?Cs=function(){cv(If)}:typeof MessageChannel!="undefined"?(Pf=new MessageChannel,dv=Pf.port2,Pf.port1.onmessage=If,Cs=function(){dv.postMessage(null)}):Cs=function(){fv(If,0)};var Pf,dv;function Rf(e){mu=e,yu||(yu=!0,Cs())}function Mf(e,t){Ps=fv(function(){e(qe.unstable_now())},t)}qe.unstable_IdlePriority=5;qe.unstable_ImmediatePriority=1;qe.unstable_LowPriority=4;qe.unstable_NormalPriority=3;qe.unstable_Profiling=null;qe.unstable_UserBlockingPriority=2;qe.unstable_cancelCallback=function(e){e.callback=null};qe.unstable_continueExecution=function(){mo||vu||(mo=!0,Rf(kf))};qe.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):hv=0<e?Math.floor(1e3/e):5};qe.unstable_getCurrentPriorityLevel=function(){return Zt};qe.unstable_getFirstCallbackNode=function(){return nr(Sr)};qe.unstable_next=function(e){switch(Zt){case 1:case 2:case 3:var t=3;break;default:t=Zt}var n=Zt;Zt=t;try{return e()}finally{Zt=n}};qe.unstable_pauseExecution=function(){};qe.unstable_requestPaint=function(){};qe.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=Zt;Zt=e;try{return t()}finally{Zt=n}};qe.unstable_scheduleCallback=function(e,t,n){var r=qe.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?r+n:r):n=r,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=n+i,e={id:sE++,callback:t,priorityLevel:e,startTime:n,expirationTime:i,sortIndex:-1},n>r?(e.sortIndex=n,Af(xi,e),nr(Sr)===null&&e===nr(xi)&&(Is?(pv(Ps),Ps=-1):Is=!0,Mf(Lf,n-r))):(e.sortIndex=i,Af(Sr,e),mo||vu||(mo=!0,Rf(kf))),e};qe.unstable_shouldYield=gv;qe.unstable_wrapCallback=function(e){var t=Zt;return function(){var n=Zt;Zt=t;try{return e.apply(this,arguments)}finally{Zt=n}}}});var Sv=_e((dk,yv)=>{"use strict";yv.exports=vv()});var xS=_e(Mn=>{"use strict";var lE=Fe(),kn=Sv();function $(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cy=new Set,Zs={};function Po(e,t){Ea(e,t),Ea(e+"Capture",t)}function Ea(e,t){for(Zs[e]=t,e=0;e<t.length;e++)Cy.add(t[e])}var Jr=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),rp=Object.prototype.hasOwnProperty,uE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wv={},bv={};function cE(e){return rp.call(bv,e)?!0:rp.call(wv,e)?!1:uE.test(e)?bv[e]=!0:(wv[e]=!0,!1)}function dE(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function fE(e,t,n,r){if(t===null||typeof t=="undefined"||dE(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function cn(e,t,n,r,i,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wt[e]=new cn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wt[t]=new cn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wt[e]=new cn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wt[e]=new cn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wt[e]=new cn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wt[e]=new cn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wt[e]=new cn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wt[e]=new cn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wt[e]=new cn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Kp=/[\-:]([a-z])/g;function Zp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Kp,Zp);Wt[t]=new cn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Kp,Zp);Wt[t]=new cn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Kp,Zp);Wt[t]=new cn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wt[e]=new cn(e,1,!1,e.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wt[e]=new cn(e,1,!1,e.toLowerCase(),null,!0,!0)});function qp(e,t,n,r){var i=Wt.hasOwnProperty(t)?Wt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(fE(t,n,i,r)&&(n=null),r||i===null?cE(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ni=lE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Su=Symbol.for("react.element"),aa=Symbol.for("react.portal"),sa=Symbol.for("react.fragment"),Jp=Symbol.for("react.strict_mode"),ip=Symbol.for("react.profiler"),Iy=Symbol.for("react.provider"),Py=Symbol.for("react.context"),Qp=Symbol.for("react.forward_ref"),op=Symbol.for("react.suspense"),ap=Symbol.for("react.suspense_list"),eh=Symbol.for("react.memo"),Ti=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var Ay=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var _v=Symbol.iterator;function As(e){return e===null||typeof e!="object"?null:(e=_v&&e[_v]||e["@@iterator"],typeof e=="function"?e:null)}var vt=Object.assign,Of;function Ns(e){if(Of===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Of=t&&t[1]||""}return`
`+Of+e}var Ff=!1;function Nf(e,t){if(!e||Ff)return"";Ff=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=s);break}}}finally{Ff=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ns(e):""}function pE(e){switch(e.tag){case 5:return Ns(e.type);case 16:return Ns("Lazy");case 13:return Ns("Suspense");case 19:return Ns("SuspenseList");case 0:case 2:case 15:return e=Nf(e.type,!1),e;case 11:return e=Nf(e.type.render,!1),e;case 1:return e=Nf(e.type,!0),e;default:return""}}function sp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case sa:return"Fragment";case aa:return"Portal";case ip:return"Profiler";case Jp:return"StrictMode";case op:return"Suspense";case ap:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Py:return(e.displayName||"Context")+".Consumer";case Iy:return(e._context.displayName||"Context")+".Provider";case Qp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case eh:return t=e.displayName||null,t!==null?t:sp(e.type)||"Memo";case Ti:t=e._payload,e=e._init;try{return sp(e(t))}catch(n){}}return null}function hE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sp(t);case 8:return t===Jp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mE(e){var t=Dy(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n!="undefined"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wu(e){e._valueTracker||(e._valueTracker=mE(e))}function Ly(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Dy(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Yu(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function lp(e,t){var n=t.checked;return vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:e._wrapperState.initialChecked})}function xv(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Bi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ky(e,t){t=t.checked,t!=null&&qp(e,"checked",t,!1)}function up(e,t){ky(e,t);var n=Bi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cp(e,t.type,n):t.hasOwnProperty("defaultValue")&&cp(e,t.type,Bi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ev(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function cp(e,t,n){(t!=="number"||Yu(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Us=Array.isArray;function ya(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Bi(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function dp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error($(91));return vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Tv(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error($(92));if(Us(n)){if(1<n.length)throw Error($(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Bi(n)}}function Ry(e,t){var n=Bi(t.value),r=Bi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Cv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function My(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?My(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var bu,Oy=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(bu=bu||document.createElement("div"),bu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=bu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gE=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(e){gE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vs[t]=Vs[e]})});function Fy(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Vs.hasOwnProperty(e)&&Vs[e]?(""+t).trim():t+"px"}function Ny(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Fy(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var vE=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pp(e,t){if(t){if(vE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error($(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error($(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error($(61))}if(t.style!=null&&typeof t.style!="object")throw Error($(62))}}function hp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mp=null;function th(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gp=null,Sa=null,wa=null;function Iv(e){if(e=ml(e)){if(typeof gp!="function")throw Error($(280));var t=e.stateNode;t&&(t=_c(t),gp(e.stateNode,e.type,t))}}function Uy(e){Sa?wa?wa.push(e):wa=[e]:Sa=e}function By(){if(Sa){var e=Sa,t=wa;if(wa=Sa=null,Iv(e),t)for(e=0;e<t.length;e++)Iv(t[e])}}function zy(e,t){return e(t)}function Vy(){}var Uf=!1;function Gy(e,t,n){if(Uf)return e(t,n);Uf=!0;try{return zy(e,t,n)}finally{Uf=!1,(Sa!==null||wa!==null)&&(Vy(),By())}}function Js(e,t){var n=e.stateNode;if(n===null)return null;var r=_c(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error($(231,t,typeof n));return n}var vp=!1;if(Jr)try{ia={},Object.defineProperty(ia,"passive",{get:function(){vp=!0}}),window.addEventListener("test",ia,ia),window.removeEventListener("test",ia,ia)}catch(e){vp=!1}var ia;function yE(e,t,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Gs=!1,Ku=null,Zu=!1,yp=null,SE={onError:function(e){Gs=!0,Ku=e}};function wE(e,t,n,r,i,o,a,s,l){Gs=!1,Ku=null,yE.apply(SE,arguments)}function bE(e,t,n,r,i,o,a,s,l){if(wE.apply(this,arguments),Gs){if(Gs){var u=Ku;Gs=!1,Ku=null}else throw Error($(198));Zu||(Zu=!0,yp=u)}}function Ao(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Hy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pv(e){if(Ao(e)!==e)throw Error($(188))}function _E(e){var t=e.alternate;if(!t){if(t=Ao(e),t===null)throw Error($(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Pv(i),e;if(o===r)return Pv(i),t;o=o.sibling}throw Error($(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?e:t}function jy(e){return e=_E(e),e!==null?Wy(e):null}function Wy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Wy(e);if(t!==null)return t;e=e.sibling}return null}var $y=kn.unstable_scheduleCallback,Av=kn.unstable_cancelCallback,xE=kn.unstable_shouldYield,EE=kn.unstable_requestPaint,wt=kn.unstable_now,TE=kn.unstable_getCurrentPriorityLevel,nh=kn.unstable_ImmediatePriority,Xy=kn.unstable_UserBlockingPriority,qu=kn.unstable_NormalPriority,CE=kn.unstable_LowPriority,Yy=kn.unstable_IdlePriority,yc=null,xr=null;function IE(e){if(xr&&typeof xr.onCommitFiberRoot=="function")try{xr.onCommitFiberRoot(yc,e,void 0,(e.current.flags&128)===128)}catch(t){}}var sr=Math.clz32?Math.clz32:DE,PE=Math.log,AE=Math.LN2;function DE(e){return e>>>=0,e===0?32:31-(PE(e)/AE|0)|0}var _u=64,xu=4194304;function Bs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ju(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~i;s!==0?r=Bs(s):(o&=a,o!==0&&(r=Bs(o)))}else a=n&~i,a!==0?r=Bs(a):o!==0&&(r=Bs(o));if(r===0)return 0;if(t!==0&&t!==r&&(t&i)===0&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-sr(t),i=1<<n,r|=e[n],t&=~i;return r}function LE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kE(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-sr(o),s=1<<a,l=i[a];l===-1?((s&n)===0||(s&r)!==0)&&(i[a]=LE(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}function Sp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ky(){var e=_u;return _u<<=1,(_u&4194240)===0&&(_u=64),e}function Bf(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-sr(t),e[t]=n}function RE(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-sr(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function rh(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-sr(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var We=0;function Zy(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var qy,ih,Jy,Qy,e1,wp=!1,Eu=[],Li=null,ki=null,Ri=null,Qs=new Map,el=new Map,Ii=[],ME="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dv(e,t){switch(e){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Ri=null;break;case"pointerover":case"pointerout":Qs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":el.delete(t.pointerId)}}function Ds(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=ml(t),t!==null&&ih(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function OE(e,t,n,r,i){switch(t){case"focusin":return Li=Ds(Li,e,t,n,r,i),!0;case"dragenter":return ki=Ds(ki,e,t,n,r,i),!0;case"mouseover":return Ri=Ds(Ri,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Qs.set(o,Ds(Qs.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,el.set(o,Ds(el.get(o)||null,e,t,n,r,i)),!0}return!1}function t1(e){var t=yo(e.target);if(t!==null){var n=Ao(t);if(n!==null){if(t=n.tag,t===13){if(t=Hy(n),t!==null){e.blockedOn=t,e1(e.priority,function(){Jy(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Uu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=bp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);mp=r,n.target.dispatchEvent(r),mp=null}else return t=ml(n),t!==null&&ih(t),e.blockedOn=n,!1;t.shift()}return!0}function Lv(e,t,n){Uu(e)&&n.delete(t)}function FE(){wp=!1,Li!==null&&Uu(Li)&&(Li=null),ki!==null&&Uu(ki)&&(ki=null),Ri!==null&&Uu(Ri)&&(Ri=null),Qs.forEach(Lv),el.forEach(Lv)}function Ls(e,t){e.blockedOn===t&&(e.blockedOn=null,wp||(wp=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,FE)))}function tl(e){function t(i){return Ls(i,e)}if(0<Eu.length){Ls(Eu[0],e);for(var n=1;n<Eu.length;n++){var r=Eu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Li!==null&&Ls(Li,e),ki!==null&&Ls(ki,e),Ri!==null&&Ls(Ri,e),Qs.forEach(t),el.forEach(t),n=0;n<Ii.length;n++)r=Ii[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ii.length&&(n=Ii[0],n.blockedOn===null);)t1(n),n.blockedOn===null&&Ii.shift()}var ba=ni.ReactCurrentBatchConfig,Qu=!0;function NE(e,t,n,r){var i=We,o=ba.transition;ba.transition=null;try{We=1,oh(e,t,n,r)}finally{We=i,ba.transition=o}}function UE(e,t,n,r){var i=We,o=ba.transition;ba.transition=null;try{We=4,oh(e,t,n,r)}finally{We=i,ba.transition=o}}function oh(e,t,n,r){if(Qu){var i=bp(e,t,n,r);if(i===null)$f(e,t,r,ec,n),Dv(e,r);else if(OE(i,e,t,n,r))r.stopPropagation();else if(Dv(e,r),t&4&&-1<ME.indexOf(e)){for(;i!==null;){var o=ml(i);if(o!==null&&qy(o),o=bp(e,t,n,r),o===null&&$f(e,t,r,ec,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else $f(e,t,r,null,n)}}var ec=null;function bp(e,t,n,r){if(ec=null,e=th(r),e=yo(e),e!==null)if(t=Ao(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Hy(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ec=e,null}function n1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(TE()){case nh:return 1;case Xy:return 4;case qu:case CE:return 16;case Yy:return 536870912;default:return 16}default:return 16}}var Ai=null,ah=null,Bu=null;function r1(){if(Bu)return Bu;var e,t=ah,n=t.length,r,i="value"in Ai?Ai.value:Ai.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===i[o-r];r++);return Bu=i.slice(e,1<r?1-r:void 0)}function zu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Tu(){return!0}function kv(){return!1}function Rn(e){function t(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Tu:kv,this.isPropagationStopped=kv,this}return vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tu)},persist:function(){},isPersistent:Tu}),t}var La={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sh=Rn(La),hl=vt({},La,{view:0,detail:0}),BE=Rn(hl),zf,Vf,ks,Sc=vt({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ks&&(ks&&e.type==="mousemove"?(zf=e.screenX-ks.screenX,Vf=e.screenY-ks.screenY):Vf=zf=0,ks=e),zf)},movementY:function(e){return"movementY"in e?e.movementY:Vf}}),Rv=Rn(Sc),zE=vt({},Sc,{dataTransfer:0}),VE=Rn(zE),GE=vt({},hl,{relatedTarget:0}),Gf=Rn(GE),HE=vt({},La,{animationName:0,elapsedTime:0,pseudoElement:0}),jE=Rn(HE),WE=vt({},La,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$E=Rn(WE),XE=vt({},La,{data:0}),Mv=Rn(XE),YE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ZE[e])?!!t[e]:!1}function lh(){return qE}var JE=vt({},hl,{key:function(e){if(e.key){var t=YE[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=zu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?KE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lh,charCode:function(e){return e.type==="keypress"?zu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),QE=Rn(JE),eT=vt({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ov=Rn(eT),tT=vt({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lh}),nT=Rn(tT),rT=vt({},La,{propertyName:0,elapsedTime:0,pseudoElement:0}),iT=Rn(rT),oT=vt({},Sc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aT=Rn(oT),sT=[9,13,27,32],uh=Jr&&"CompositionEvent"in window,Hs=null;Jr&&"documentMode"in document&&(Hs=document.documentMode);var lT=Jr&&"TextEvent"in window&&!Hs,i1=Jr&&(!uh||Hs&&8<Hs&&11>=Hs),Fv=" ",Nv=!1;function o1(e,t){switch(e){case"keyup":return sT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var la=!1;function uT(e,t){switch(e){case"compositionend":return a1(t);case"keypress":return t.which!==32?null:(Nv=!0,Fv);case"textInput":return e=t.data,e===Fv&&Nv?null:e;default:return null}}function cT(e,t){if(la)return e==="compositionend"||!uh&&o1(e,t)?(e=r1(),Bu=ah=Ai=null,la=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return i1&&t.locale!=="ko"?null:t.data;default:return null}}var dT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!dT[e.type]:t==="textarea"}function s1(e,t,n,r){Uy(r),t=tc(t,"onChange"),0<t.length&&(n=new sh("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var js=null,nl=null;function fT(e){y1(e,0)}function wc(e){var t=da(e);if(Ly(t))return e}function pT(e,t){if(e==="change")return t}var l1=!1;Jr&&(Jr?(Iu="oninput"in document,Iu||(Hf=document.createElement("div"),Hf.setAttribute("oninput","return;"),Iu=typeof Hf.oninput=="function"),Cu=Iu):Cu=!1,l1=Cu&&(!document.documentMode||9<document.documentMode));var Cu,Iu,Hf;function Bv(){js&&(js.detachEvent("onpropertychange",u1),nl=js=null)}function u1(e){if(e.propertyName==="value"&&wc(nl)){var t=[];s1(t,nl,e,th(e)),Gy(fT,t)}}function hT(e,t,n){e==="focusin"?(Bv(),js=t,nl=n,js.attachEvent("onpropertychange",u1)):e==="focusout"&&Bv()}function mT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wc(nl)}function gT(e,t){if(e==="click")return wc(t)}function vT(e,t){if(e==="input"||e==="change")return wc(t)}function yT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ur=typeof Object.is=="function"?Object.is:yT;function rl(e,t){if(ur(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!rp.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function zv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vv(e,t){var n=zv(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zv(n)}}function c1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?c1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function d1(){for(var e=window,t=Yu();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch(r){n=!1}if(n)e=t.contentWindow;else break;t=Yu(e.document)}return t}function ch(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ST(e){var t=d1(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&c1(n.ownerDocument.documentElement,n)){if(r!==null&&ch(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=Vv(n,o);var a=Vv(n,r);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var wT=Jr&&"documentMode"in document&&11>=document.documentMode,ua=null,_p=null,Ws=null,xp=!1;function Gv(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xp||ua==null||ua!==Yu(r)||(r=ua,"selectionStart"in r&&ch(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ws&&rl(Ws,r)||(Ws=r,r=tc(_p,"onSelect"),0<r.length&&(t=new sh("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ua)))}function Pu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ca={animationend:Pu("Animation","AnimationEnd"),animationiteration:Pu("Animation","AnimationIteration"),animationstart:Pu("Animation","AnimationStart"),transitionend:Pu("Transition","TransitionEnd")},jf={},f1={};Jr&&(f1=document.createElement("div").style,"AnimationEvent"in window||(delete ca.animationend.animation,delete ca.animationiteration.animation,delete ca.animationstart.animation),"TransitionEvent"in window||delete ca.transitionend.transition);function bc(e){if(jf[e])return jf[e];if(!ca[e])return e;var t=ca[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in f1)return jf[e]=t[n];return e}var p1=bc("animationend"),h1=bc("animationiteration"),m1=bc("animationstart"),g1=bc("transitionend"),v1=new Map,Hv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vi(e,t){v1.set(e,t),Po(t,[e])}for(Au=0;Au<Hv.length;Au++)Du=Hv[Au],jv=Du.toLowerCase(),Wv=Du[0].toUpperCase()+Du.slice(1),Vi(jv,"on"+Wv);var Du,jv,Wv,Au;Vi(p1,"onAnimationEnd");Vi(h1,"onAnimationIteration");Vi(m1,"onAnimationStart");Vi("dblclick","onDoubleClick");Vi("focusin","onFocus");Vi("focusout","onBlur");Vi(g1,"onTransitionEnd");Ea("onMouseEnter",["mouseout","mouseover"]);Ea("onMouseLeave",["mouseout","mouseover"]);Ea("onPointerEnter",["pointerout","pointerover"]);Ea("onPointerLeave",["pointerout","pointerover"]);Po("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Po("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Po("onBeforeInput",["compositionend","keypress","textInput","paste"]);Po("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Po("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Po("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bT=new Set("cancel close invalid load scroll toggle".split(" ").concat(zs));function $v(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,bE(r,t,void 0,e),e.currentTarget=null}function y1(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;$v(i,s,u),o=l}else for(a=0;a<r.length;a++){if(s=r[a],l=s.instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;$v(i,s,u),o=l}}}if(Zu)throw e=yp,Zu=!1,yp=null,e}function rt(e,t){var n=t[Pp];n===void 0&&(n=t[Pp]=new Set);var r=e+"__bubble";n.has(r)||(S1(t,e,2,!1),n.add(r))}function Wf(e,t,n){var r=0;t&&(r|=4),S1(n,e,r,t)}var Lu="_reactListening"+Math.random().toString(36).slice(2);function il(e){if(!e[Lu]){e[Lu]=!0,Cy.forEach(function(n){n!=="selectionchange"&&(bT.has(n)||Wf(n,!1,e),Wf(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Lu]||(t[Lu]=!0,Wf("selectionchange",!1,t))}}function S1(e,t,n,r){switch(n1(t)){case 1:var i=NE;break;case 4:i=UE;break;default:i=oh}n=i.bind(null,t,n,e),i=void 0,!vp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $f(e,t,n,r,i){var o=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;s!==null;){if(a=yo(s),a===null)return;if(l=a.tag,l===5||l===6){r=o=a;continue e}s=s.parentNode}}r=r.return}Gy(function(){var u=o,c=th(n),f=[];e:{var d=v1.get(e);if(d!==void 0){var h=sh,y=e;switch(e){case"keypress":if(zu(n)===0)break e;case"keydown":case"keyup":h=QE;break;case"focusin":y="focus",h=Gf;break;case"focusout":y="blur",h=Gf;break;case"beforeblur":case"afterblur":h=Gf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Rv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=VE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=nT;break;case p1:case h1:case m1:h=jE;break;case g1:h=iT;break;case"scroll":h=BE;break;case"wheel":h=aT;break;case"copy":case"cut":case"paste":h=$E;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ov}var S=(t&4)!==0,b=!S&&e==="scroll",g=S?d!==null?d+"Capture":null:d;S=[];for(var p=u,m;p!==null;){m=p;var v=m.stateNode;if(m.tag===5&&v!==null&&(m=v,g!==null&&(v=Js(p,g),v!=null&&S.push(ol(p,v,m)))),b)break;p=p.return}0<S.length&&(d=new h(d,y,null,n,c),f.push({event:d,listeners:S}))}}if((t&7)===0){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==mp&&(y=n.relatedTarget||n.fromElement)&&(yo(y)||y[Qr]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(y=n.relatedTarget||n.toElement,h=u,y=y?yo(y):null,y!==null&&(b=Ao(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=u),h!==y)){if(S=Rv,v="onMouseLeave",g="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(S=Ov,v="onPointerLeave",g="onPointerEnter",p="pointer"),b=h==null?d:da(h),m=y==null?d:da(y),d=new S(v,p+"leave",h,n,c),d.target=b,d.relatedTarget=m,v=null,yo(c)===u&&(S=new S(g,p+"enter",y,n,c),S.target=m,S.relatedTarget=b,v=S),b=v,h&&y)t:{for(S=h,g=y,p=0,m=S;m;m=oa(m))p++;for(m=0,v=g;v;v=oa(v))m++;for(;0<p-m;)S=oa(S),p--;for(;0<m-p;)g=oa(g),m--;for(;p--;){if(S===g||g!==null&&S===g.alternate)break t;S=oa(S),g=oa(g)}S=null}else S=null;h!==null&&Xv(f,d,h,S,!1),y!==null&&b!==null&&Xv(f,b,y,S,!0)}}e:{if(d=u?da(u):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var x=pT;else if(Uv(d))if(l1)x=vT;else{x=mT;var w=hT}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(x=gT);if(x&&(x=x(e,u))){s1(f,x,n,c);break e}w&&w(e,d,u),e==="focusout"&&(w=d._wrapperState)&&w.controlled&&d.type==="number"&&cp(d,"number",d.value)}switch(w=u?da(u):window,e){case"focusin":(Uv(w)||w.contentEditable==="true")&&(ua=w,_p=u,Ws=null);break;case"focusout":Ws=_p=ua=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,Gv(f,n,c);break;case"selectionchange":if(wT)break;case"keydown":case"keyup":Gv(f,n,c)}var _;if(uh)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else la?o1(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(i1&&n.locale!=="ko"&&(la||E!=="onCompositionStart"?E==="onCompositionEnd"&&la&&(_=r1()):(Ai=c,ah="value"in Ai?Ai.value:Ai.textContent,la=!0)),w=tc(u,E),0<w.length&&(E=new Mv(E,e,null,n,c),f.push({event:E,listeners:w}),_?E.data=_:(_=a1(n),_!==null&&(E.data=_)))),(_=lT?uT(e,n):cT(e,n))&&(u=tc(u,"onBeforeInput"),0<u.length&&(c=new Mv("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=_))}y1(f,t)})}function ol(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Js(e,n),o!=null&&r.unshift(ol(e,o,i)),o=Js(e,t),o!=null&&r.push(ol(e,o,i))),e=e.return}return r}function oa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xv(e,t,n,r,i){for(var o=t._reactName,a=[];n!==null&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,i?(l=Js(n,o),l!=null&&a.unshift(ol(n,l,s))):i||(l=Js(n,o),l!=null&&a.push(ol(n,l,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var _T=/\r\n?/g,xT=/\u0000|\uFFFD/g;function Yv(e){return(typeof e=="string"?e:""+e).replace(_T,`
`).replace(xT,"")}function ku(e,t,n){if(t=Yv(t),Yv(e)!==t&&n)throw Error($(425))}function nc(){}var Ep=null,Tp=null;function Cp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ip=typeof setTimeout=="function"?setTimeout:void 0,ET=typeof clearTimeout=="function"?clearTimeout:void 0,Kv=typeof Promise=="function"?Promise:void 0,TT=typeof queueMicrotask=="function"?queueMicrotask:typeof Kv!="undefined"?function(e){return Kv.resolve(null).then(e).catch(CT)}:Ip;function CT(e){setTimeout(function(){throw e})}function Xf(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),tl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);tl(t)}function Mi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Zv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ka=Math.random().toString(36).slice(2),_r="__reactFiber$"+ka,al="__reactProps$"+ka,Qr="__reactContainer$"+ka,Pp="__reactEvents$"+ka,IT="__reactListeners$"+ka,PT="__reactHandles$"+ka;function yo(e){var t=e[_r];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qr]||n[_r]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zv(e);e!==null;){if(n=e[_r])return n;e=Zv(e)}return t}e=n,n=e.parentNode}return null}function ml(e){return e=e[_r]||e[Qr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function da(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error($(33))}function _c(e){return e[al]||null}var Ap=[],fa=-1;function Gi(e){return{current:e}}function it(e){0>fa||(e.current=Ap[fa],Ap[fa]=null,fa--)}function Je(e,t){fa++,Ap[fa]=e.current,e.current=t}var zi={},en=Gi(zi),wn=Gi(!1),xo=zi;function Ta(e,t){var n=e.type.contextTypes;if(!n)return zi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function bn(e){return e=e.childContextTypes,e!=null}function rc(){it(wn),it(en)}function qv(e,t,n){if(en.current!==zi)throw Error($(168));Je(en,t),Je(wn,n)}function w1(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error($(108,hE(e)||"Unknown",i));return vt({},n,r)}function ic(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zi,xo=en.current,Je(en,e),Je(wn,wn.current),!0}function Jv(e,t,n){var r=e.stateNode;if(!r)throw Error($(169));n?(e=w1(e,t,xo),r.__reactInternalMemoizedMergedChildContext=e,it(wn),it(en),Je(en,e)):it(wn),Je(wn,n)}var Yr=null,xc=!1,Yf=!1;function b1(e){Yr===null?Yr=[e]:Yr.push(e)}function AT(e){xc=!0,b1(e)}function Hi(){if(!Yf&&Yr!==null){Yf=!0;var e=0,t=We;try{var n=Yr;for(We=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Yr=null,xc=!1}catch(i){throw Yr!==null&&(Yr=Yr.slice(e+1)),$y(nh,Hi),i}finally{We=t,Yf=!1}}return null}var pa=[],ha=0,oc=null,ac=0,Hn=[],jn=0,Eo=null,Kr=1,Zr="";function go(e,t){pa[ha++]=ac,pa[ha++]=oc,oc=e,ac=t}function _1(e,t,n){Hn[jn++]=Kr,Hn[jn++]=Zr,Hn[jn++]=Eo,Eo=e;var r=Kr;e=Zr;var i=32-sr(r)-1;r&=~(1<<i),n+=1;var o=32-sr(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Kr=1<<32-sr(t)+i|n<<i|r,Zr=o+e}else Kr=1<<o|n<<i|r,Zr=e}function dh(e){e.return!==null&&(go(e,1),_1(e,1,0))}function fh(e){for(;e===oc;)oc=pa[--ha],pa[ha]=null,ac=pa[--ha],pa[ha]=null;for(;e===Eo;)Eo=Hn[--jn],Hn[jn]=null,Zr=Hn[--jn],Hn[jn]=null,Kr=Hn[--jn],Hn[jn]=null}var Ln=null,Dn=null,ut=!1,ar=null;function x1(e,t){var n=Wn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Qv(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ln=e,Dn=Mi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ln=e,Dn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Eo!==null?{id:Kr,overflow:Zr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Wn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ln=e,Dn=null,!0):!1;default:return!1}}function Dp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Lp(e){if(ut){var t=Dn;if(t){var n=t;if(!Qv(e,t)){if(Dp(e))throw Error($(418));t=Mi(n.nextSibling);var r=Ln;t&&Qv(e,t)?x1(r,n):(e.flags=e.flags&-4097|2,ut=!1,Ln=e)}}else{if(Dp(e))throw Error($(418));e.flags=e.flags&-4097|2,ut=!1,Ln=e}}}function ey(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ln=e}function Ru(e){if(e!==Ln)return!1;if(!ut)return ey(e),ut=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cp(e.type,e.memoizedProps)),t&&(t=Dn)){if(Dp(e))throw E1(),Error($(418));for(;t;)x1(e,t),t=Mi(t.nextSibling)}if(ey(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error($(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Dn=Mi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Dn=null}}else Dn=Ln?Mi(e.stateNode.nextSibling):null;return!0}function E1(){for(var e=Dn;e;)e=Mi(e.nextSibling)}function Ca(){Dn=Ln=null,ut=!1}function ph(e){ar===null?ar=[e]:ar.push(e)}var DT=ni.ReactCurrentBatchConfig;function Rs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var s=i.refs;a===null?delete s[o]:s[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error($(284));if(!n._owner)throw Error($(290,e))}return e}function Mu(e,t){throw e=Object.prototype.toString.call(t),Error($(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ty(e){var t=e._init;return t(e._payload)}function T1(e){function t(g,p){if(e){var m=g.deletions;m===null?(g.deletions=[p],g.flags|=16):m.push(p)}}function n(g,p){if(!e)return null;for(;p!==null;)t(g,p),p=p.sibling;return null}function r(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function i(g,p){return g=Ui(g,p),g.index=0,g.sibling=null,g}function o(g,p,m){return g.index=m,e?(m=g.alternate,m!==null?(m=m.index,m<p?(g.flags|=2,p):m):(g.flags|=2,p)):(g.flags|=1048576,p)}function a(g){return e&&g.alternate===null&&(g.flags|=2),g}function s(g,p,m,v){return p===null||p.tag!==6?(p=tp(m,g.mode,v),p.return=g,p):(p=i(p,m),p.return=g,p)}function l(g,p,m,v){var x=m.type;return x===sa?c(g,p,m.props.children,v,m.key):p!==null&&(p.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ti&&ty(x)===p.type)?(v=i(p,m.props),v.ref=Rs(g,p,m),v.return=g,v):(v=Xu(m.type,m.key,m.props,null,g.mode,v),v.ref=Rs(g,p,m),v.return=g,v)}function u(g,p,m,v){return p===null||p.tag!==4||p.stateNode.containerInfo!==m.containerInfo||p.stateNode.implementation!==m.implementation?(p=np(m,g.mode,v),p.return=g,p):(p=i(p,m.children||[]),p.return=g,p)}function c(g,p,m,v,x){return p===null||p.tag!==7?(p=_o(m,g.mode,v,x),p.return=g,p):(p=i(p,m),p.return=g,p)}function f(g,p,m){if(typeof p=="string"&&p!==""||typeof p=="number")return p=tp(""+p,g.mode,m),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Su:return m=Xu(p.type,p.key,p.props,null,g.mode,m),m.ref=Rs(g,null,p),m.return=g,m;case aa:return p=np(p,g.mode,m),p.return=g,p;case Ti:var v=p._init;return f(g,v(p._payload),m)}if(Us(p)||As(p))return p=_o(p,g.mode,m,null),p.return=g,p;Mu(g,p)}return null}function d(g,p,m,v){var x=p!==null?p.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return x!==null?null:s(g,p,""+m,v);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Su:return m.key===x?l(g,p,m,v):null;case aa:return m.key===x?u(g,p,m,v):null;case Ti:return x=m._init,d(g,p,x(m._payload),v)}if(Us(m)||As(m))return x!==null?null:c(g,p,m,v,null);Mu(g,m)}return null}function h(g,p,m,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return g=g.get(m)||null,s(p,g,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Su:return g=g.get(v.key===null?m:v.key)||null,l(p,g,v,x);case aa:return g=g.get(v.key===null?m:v.key)||null,u(p,g,v,x);case Ti:var w=v._init;return h(g,p,m,w(v._payload),x)}if(Us(v)||As(v))return g=g.get(m)||null,c(p,g,v,x,null);Mu(p,v)}return null}function y(g,p,m,v){for(var x=null,w=null,_=p,E=p=0,P=null;_!==null&&E<m.length;E++){_.index>E?(P=_,_=null):P=_.sibling;var D=d(g,_,m[E],v);if(D===null){_===null&&(_=P);break}e&&_&&D.alternate===null&&t(g,_),p=o(D,p,E),w===null?x=D:w.sibling=D,w=D,_=P}if(E===m.length)return n(g,_),ut&&go(g,E),x;if(_===null){for(;E<m.length;E++)_=f(g,m[E],v),_!==null&&(p=o(_,p,E),w===null?x=_:w.sibling=_,w=_);return ut&&go(g,E),x}for(_=r(g,_);E<m.length;E++)P=h(_,g,E,m[E],v),P!==null&&(e&&P.alternate!==null&&_.delete(P.key===null?E:P.key),p=o(P,p,E),w===null?x=P:w.sibling=P,w=P);return e&&_.forEach(function(M){return t(g,M)}),ut&&go(g,E),x}function S(g,p,m,v){var x=As(m);if(typeof x!="function")throw Error($(150));if(m=x.call(m),m==null)throw Error($(151));for(var w=x=null,_=p,E=p=0,P=null,D=m.next();_!==null&&!D.done;E++,D=m.next()){_.index>E?(P=_,_=null):P=_.sibling;var M=d(g,_,D.value,v);if(M===null){_===null&&(_=P);break}e&&_&&M.alternate===null&&t(g,_),p=o(M,p,E),w===null?x=M:w.sibling=M,w=M,_=P}if(D.done)return n(g,_),ut&&go(g,E),x;if(_===null){for(;!D.done;E++,D=m.next())D=f(g,D.value,v),D!==null&&(p=o(D,p,E),w===null?x=D:w.sibling=D,w=D);return ut&&go(g,E),x}for(_=r(g,_);!D.done;E++,D=m.next())D=h(_,g,E,D.value,v),D!==null&&(e&&D.alternate!==null&&_.delete(D.key===null?E:D.key),p=o(D,p,E),w===null?x=D:w.sibling=D,w=D);return e&&_.forEach(function(j){return t(g,j)}),ut&&go(g,E),x}function b(g,p,m,v){if(typeof m=="object"&&m!==null&&m.type===sa&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Su:e:{for(var x=m.key,w=p;w!==null;){if(w.key===x){if(x=m.type,x===sa){if(w.tag===7){n(g,w.sibling),p=i(w,m.props.children),p.return=g,g=p;break e}}else if(w.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ti&&ty(x)===w.type){n(g,w.sibling),p=i(w,m.props),p.ref=Rs(g,w,m),p.return=g,g=p;break e}n(g,w);break}else t(g,w);w=w.sibling}m.type===sa?(p=_o(m.props.children,g.mode,v,m.key),p.return=g,g=p):(v=Xu(m.type,m.key,m.props,null,g.mode,v),v.ref=Rs(g,p,m),v.return=g,g=v)}return a(g);case aa:e:{for(w=m.key;p!==null;){if(p.key===w)if(p.tag===4&&p.stateNode.containerInfo===m.containerInfo&&p.stateNode.implementation===m.implementation){n(g,p.sibling),p=i(p,m.children||[]),p.return=g,g=p;break e}else{n(g,p);break}else t(g,p);p=p.sibling}p=np(m,g.mode,v),p.return=g,g=p}return a(g);case Ti:return w=m._init,b(g,p,w(m._payload),v)}if(Us(m))return y(g,p,m,v);if(As(m))return S(g,p,m,v);Mu(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,p!==null&&p.tag===6?(n(g,p.sibling),p=i(p,m),p.return=g,g=p):(n(g,p),p=tp(m,g.mode,v),p.return=g,g=p),a(g)):n(g,p)}return b}var Ia=T1(!0),C1=T1(!1),sc=Gi(null),lc=null,ma=null,hh=null;function mh(){hh=ma=lc=null}function gh(e){var t=sc.current;it(sc),e._currentValue=t}function kp(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function _a(e,t){lc=e,hh=ma=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Sn=!0),e.firstContext=null)}function Xn(e){var t=e._currentValue;if(hh!==e)if(e={context:e,memoizedValue:t,next:null},ma===null){if(lc===null)throw Error($(308));ma=e,lc.dependencies={lanes:0,firstContext:e}}else ma=ma.next=e;return t}var So=null;function vh(e){So===null?So=[e]:So.push(e)}function I1(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,vh(t)):(n.next=i.next,i.next=n),t.interleaved=n,ei(e,r)}function ei(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ci=!1;function yh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oi(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Ne&2)!==0){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ei(e,n)}return i=r.interleaved,i===null?(t.next=t,vh(r)):(t.next=i.next,i.next=t),r.interleaved=t,ei(e,n)}function Vu(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rh(e,n)}}function ny(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function uc(e,t,n,r){var i=e.updateQueue;Ci=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,u=l.next;l.next=null,a===null?o=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(o!==null){var f=i.baseState;a=0,c=u=l=null,s=o;do{var d=s.lane,h=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var y=e,S=s;switch(d=t,h=n,S.tag){case 1:if(y=S.payload,typeof y=="function"){f=y.call(h,f,d);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=S.payload,d=typeof y=="function"?y.call(h,f,d):y,d==null)break e;f=vt({},f,d);break e;case 2:Ci=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[s]:d.push(s))}else h={eventTime:h,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=h,l=f):c=c.next=h,a|=d;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;d=s,s=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Co|=a,e.lanes=a,e.memoizedState=f}}function ry(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error($(191,i));i.call(r)}}}var gl={},Er=Gi(gl),sl=Gi(gl),ll=Gi(gl);function wo(e){if(e===gl)throw Error($(174));return e}function Sh(e,t){switch(Je(ll,t),Je(sl,e),Je(Er,gl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fp(t,e)}it(Er),Je(Er,t)}function Pa(){it(Er),it(sl),it(ll)}function A1(e){wo(ll.current);var t=wo(Er.current),n=fp(t,e.type);t!==n&&(Je(sl,e),Je(Er,n))}function wh(e){sl.current===e&&(it(Er),it(sl))}var mt=Gi(0);function cc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kf=[];function bh(){for(var e=0;e<Kf.length;e++)Kf[e]._workInProgressVersionPrimary=null;Kf.length=0}var Gu=ni.ReactCurrentDispatcher,Zf=ni.ReactCurrentBatchConfig,To=0,gt=null,Dt=null,Nt=null,dc=!1,$s=!1,ul=0,LT=0;function qt(){throw Error($(321))}function _h(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function xh(e,t,n,r,i,o){if(To=o,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Gu.current=e===null||e.memoizedState===null?OT:FT,e=n(r,i),$s){o=0;do{if($s=!1,ul=0,25<=o)throw Error($(301));o+=1,Nt=Dt=null,t.updateQueue=null,Gu.current=NT,e=n(r,i)}while($s)}if(Gu.current=fc,t=Dt!==null&&Dt.next!==null,To=0,Nt=Dt=gt=null,dc=!1,t)throw Error($(300));return e}function Eh(){var e=ul!==0;return ul=0,e}function br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?gt.memoizedState=Nt=e:Nt=Nt.next=e,Nt}function Yn(){if(Dt===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Dt.next;var t=Nt===null?gt.memoizedState:Nt.next;if(t!==null)Nt=t,Dt=e;else{if(e===null)throw Error($(310));Dt=e,e={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Nt===null?gt.memoizedState=Nt=e:Nt=Nt.next=e}return Nt}function cl(e,t){return typeof t=="function"?t(e):t}function qf(e){var t=Yn(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=Dt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,l=null,u=o;do{var c=u.lane;if((To&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=f,a=r):l=l.next=f,gt.lanes|=c,Co|=c}u=u.next}while(u!==null&&u!==o);l===null?a=r:l.next=s,ur(r,t.memoizedState)||(Sn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,gt.lanes|=o,Co|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Jf(e){var t=Yn(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=e(o,a.action),a=a.next;while(a!==i);ur(o,t.memoizedState)||(Sn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function D1(){}function L1(e,t){var n=gt,r=Yn(),i=t(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,Sn=!0),r=r.queue,Th(M1.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,dl(9,R1.bind(null,n,r,i,t),void 0,null),Ut===null)throw Error($(349));(To&30)!==0||k1(n,t,i)}return i}function k1(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function R1(e,t,n,r){t.value=n,t.getSnapshot=r,O1(t)&&F1(e)}function M1(e,t,n){return n(function(){O1(t)&&F1(e)})}function O1(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function F1(e){var t=ei(e,1);t!==null&&lr(t,e,1,-1)}function iy(e){var t=br();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cl,lastRenderedState:e},t.queue=e,e=e.dispatch=MT.bind(null,gt,e),[t.memoizedState,e]}function dl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function N1(){return Yn().memoizedState}function Hu(e,t,n,r){var i=br();gt.flags|=e,i.memoizedState=dl(1|t,n,void 0,r===void 0?null:r)}function Ec(e,t,n,r){var i=Yn();r=r===void 0?null:r;var o=void 0;if(Dt!==null){var a=Dt.memoizedState;if(o=a.destroy,r!==null&&_h(r,a.deps)){i.memoizedState=dl(t,n,o,r);return}}gt.flags|=e,i.memoizedState=dl(1|t,n,o,r)}function oy(e,t){return Hu(8390656,8,e,t)}function Th(e,t){return Ec(2048,8,e,t)}function U1(e,t){return Ec(4,2,e,t)}function B1(e,t){return Ec(4,4,e,t)}function z1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function V1(e,t,n){return n=n!=null?n.concat([e]):null,Ec(4,4,z1.bind(null,t,e),n)}function Ch(){}function G1(e,t){var n=Yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&_h(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function H1(e,t){var n=Yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&_h(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function j1(e,t,n){return(To&21)===0?(e.baseState&&(e.baseState=!1,Sn=!0),e.memoizedState=n):(ur(n,t)||(n=Ky(),gt.lanes|=n,Co|=n,e.baseState=!0),t)}function kT(e,t){var n=We;We=n!==0&&4>n?n:4,e(!0);var r=Zf.transition;Zf.transition={};try{e(!1),t()}finally{We=n,Zf.transition=r}}function W1(){return Yn().memoizedState}function RT(e,t,n){var r=Ni(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$1(e))X1(t,n);else if(n=I1(e,t,n,r),n!==null){var i=un();lr(n,e,r,i),Y1(n,t,r)}}function MT(e,t,n){var r=Ni(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($1(e))X1(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,ur(s,a)){var l=t.interleaved;l===null?(i.next=i,vh(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch(u){}finally{}n=I1(e,t,i,r),n!==null&&(i=un(),lr(n,e,r,i),Y1(n,t,r))}}function $1(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function X1(e,t){$s=dc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Y1(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rh(e,n)}}var fc={readContext:Xn,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},OT={readContext:Xn,useCallback:function(e,t){return br().memoizedState=[e,t===void 0?null:t],e},useContext:Xn,useEffect:oy,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Hu(4194308,4,z1.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Hu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Hu(4,2,e,t)},useMemo:function(e,t){var n=br();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=br();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=RT.bind(null,gt,e),[r.memoizedState,e]},useRef:function(e){var t=br();return e={current:e},t.memoizedState=e},useState:iy,useDebugValue:Ch,useDeferredValue:function(e){return br().memoizedState=e},useTransition:function(){var e=iy(!1),t=e[0];return e=kT.bind(null,e[1]),br().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=gt,i=br();if(ut){if(n===void 0)throw Error($(407));n=n()}else{if(n=t(),Ut===null)throw Error($(349));(To&30)!==0||k1(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,oy(M1.bind(null,r,o,e),[e]),r.flags|=2048,dl(9,R1.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=br(),t=Ut.identifierPrefix;if(ut){var n=Zr,r=Kr;n=(r&~(1<<32-sr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ul++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=LT++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},FT={readContext:Xn,useCallback:G1,useContext:Xn,useEffect:Th,useImperativeHandle:V1,useInsertionEffect:U1,useLayoutEffect:B1,useMemo:H1,useReducer:qf,useRef:N1,useState:function(){return qf(cl)},useDebugValue:Ch,useDeferredValue:function(e){var t=Yn();return j1(t,Dt.memoizedState,e)},useTransition:function(){var e=qf(cl)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:D1,useSyncExternalStore:L1,useId:W1,unstable_isNewReconciler:!1},NT={readContext:Xn,useCallback:G1,useContext:Xn,useEffect:Th,useImperativeHandle:V1,useInsertionEffect:U1,useLayoutEffect:B1,useMemo:H1,useReducer:Jf,useRef:N1,useState:function(){return Jf(cl)},useDebugValue:Ch,useDeferredValue:function(e){var t=Yn();return Dt===null?t.memoizedState=e:j1(t,Dt.memoizedState,e)},useTransition:function(){var e=Jf(cl)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:D1,useSyncExternalStore:L1,useId:W1,unstable_isNewReconciler:!1};function ir(e,t){if(e&&e.defaultProps){t=vt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Rp(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:vt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Tc={isMounted:function(e){return(e=e._reactInternals)?Ao(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=un(),i=Ni(e),o=qr(r,i);o.payload=t,n!=null&&(o.callback=n),t=Oi(e,o,i),t!==null&&(lr(t,e,i,r),Vu(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=un(),i=Ni(e),o=qr(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Oi(e,o,i),t!==null&&(lr(t,e,i,r),Vu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=un(),r=Ni(e),i=qr(n,r);i.tag=2,t!=null&&(i.callback=t),t=Oi(e,i,r),t!==null&&(lr(t,e,r,n),Vu(t,e,r))}};function ay(e,t,n,r,i,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,a):t.prototype&&t.prototype.isPureReactComponent?!rl(n,r)||!rl(i,o):!0}function K1(e,t,n){var r=!1,i=zi,o=t.contextType;return typeof o=="object"&&o!==null?o=Xn(o):(i=bn(t)?xo:en.current,r=t.contextTypes,o=(r=r!=null)?Ta(e,i):zi),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function sy(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Tc.enqueueReplaceState(t,t.state,null)}function Mp(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},yh(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=Xn(o):(o=bn(t)?xo:en.current,i.context=Ta(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Rp(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Tc.enqueueReplaceState(i,i.state,null),uc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Aa(e,t){try{var n="",r=t;do n+=pE(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Qf(e,t,n){return{value:e,source:null,stack:n!=null?n:null,digest:t!=null?t:null}}function Op(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var UT=typeof WeakMap=="function"?WeakMap:Map;function Z1(e,t,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){hc||(hc=!0,Wp=r),Op(e,t)},n}function q1(e,t,n){n=qr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Op(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Op(e,t),typeof r!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function ly(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new UT;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=JT.bind(null,e,t,n),t.then(e,e))}function uy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cy(e,t,n,r,i){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=qr(-1,1),t.tag=2,Oi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var BT=ni.ReactCurrentOwner,Sn=!1;function ln(e,t,n,r){t.child=e===null?C1(t,null,n,r):Ia(t,e.child,n,r)}function dy(e,t,n,r,i){n=n.render;var o=t.ref;return _a(t,i),r=xh(e,t,n,r,o,i),n=Eh(),e!==null&&!Sn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ti(e,t,i)):(ut&&n&&dh(t),t.flags|=1,ln(e,t,r,i),t.child)}function fy(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!Mh(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,J1(e,t,o,r,i)):(e=Xu(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,(e.lanes&i)===0){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:rl,n(a,r)&&e.ref===t.ref)return ti(e,t,i)}return t.flags|=1,e=Ui(o,r),e.ref=t.ref,e.return=t,t.child=e}function J1(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(rl(o,r)&&e.ref===t.ref)if(Sn=!1,t.pendingProps=r=o,(e.lanes&i)!==0)(e.flags&131072)!==0&&(Sn=!0);else return t.lanes=e.lanes,ti(e,t,i)}return Fp(e,t,n,r,i)}function Q1(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(va,An),An|=n;else{if((n&1073741824)===0)return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(va,An),An|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Je(va,An),An|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Je(va,An),An|=r;return ln(e,t,i,n),t.child}function eS(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Fp(e,t,n,r,i){var o=bn(n)?xo:en.current;return o=Ta(t,o),_a(t,i),n=xh(e,t,n,r,o,i),r=Eh(),e!==null&&!Sn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ti(e,t,i)):(ut&&r&&dh(t),t.flags|=1,ln(e,t,n,i),t.child)}function py(e,t,n,r,i){if(bn(n)){var o=!0;ic(t)}else o=!1;if(_a(t,i),t.stateNode===null)ju(e,t),K1(t,n,r),Mp(t,n,r,i),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Xn(u):(u=bn(n)?xo:en.current,u=Ta(t,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||l!==u)&&sy(t,a,r,u),Ci=!1;var d=t.memoizedState;a.state=d,uc(t,r,a,i),l=t.memoizedState,s!==r||d!==l||wn.current||Ci?(typeof c=="function"&&(Rp(t,n,c,r),l=t.memoizedState),(s=Ci||ay(t,n,s,r,d,l,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,P1(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:ir(t.type,s),a.props=u,f=t.pendingProps,d=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=bn(n)?xo:en.current,l=Ta(t,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==f||d!==l)&&sy(t,a,r,l),Ci=!1,d=t.memoizedState,a.state=d,uc(t,r,a,i);var y=t.memoizedState;s!==f||d!==y||wn.current||Ci?(typeof h=="function"&&(Rp(t,n,h,r),y=t.memoizedState),(u=Ci||ay(t,n,u,r,d,y,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),a.props=r,a.state=y,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Np(e,t,n,r,o,i)}function Np(e,t,n,r,i,o){eS(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return i&&Jv(t,n,!1),ti(e,t,o);r=t.stateNode,BT.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ia(t,e.child,null,o),t.child=Ia(t,null,s,o)):ln(e,t,s,o),t.memoizedState=r.state,i&&Jv(t,n,!0),t.child}function tS(e){var t=e.stateNode;t.pendingContext?qv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qv(e,t.context,!1),Sh(e,t.containerInfo)}function hy(e,t,n,r,i){return Ca(),ph(i),t.flags|=256,ln(e,t,n,r),t.child}var Up={dehydrated:null,treeContext:null,retryLane:0};function Bp(e){return{baseLanes:e,cachePool:null,transitions:null}}function nS(e,t,n){var r=t.pendingProps,i=mt.current,o=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Je(mt,i&1),e===null)return Lp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(a=r.children,e=r.fallback,o?(r=t.mode,o=t.child,a={mode:"hidden",children:a},(r&1)===0&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Pc(a,r,0,null),e=_o(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Bp(n),t.memoizedState=Up,e):Ih(t,a));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return zT(e,t,a,r,s,i,n);if(o){o=r.fallback,a=t.mode,i=e.child,s=i.sibling;var l={mode:"hidden",children:r.children};return(a&1)===0&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Ui(i,l),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=Ui(s,o):(o=_o(o,a,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,a=e.child.memoizedState,a=a===null?Bp(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=Up,r}return o=e.child,e=o.sibling,r=Ui(o,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Ih(e,t){return t=Pc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ou(e,t,n,r){return r!==null&&ph(r),Ia(t,e.child,null,n),e=Ih(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function zT(e,t,n,r,i,o,a){if(n)return t.flags&256?(t.flags&=-257,r=Qf(Error($(422))),Ou(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Pc({mode:"visible",children:r.children},i,0,null),o=_o(o,i,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,(t.mode&1)!==0&&Ia(t,e.child,null,a),t.child.memoizedState=Bp(a),t.memoizedState=Up,o);if((t.mode&1)===0)return Ou(e,t,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error($(419)),r=Qf(o,r,void 0),Ou(e,t,a,r)}if(s=(a&e.childLanes)!==0,Sn||s){if(r=Ut,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(r.suspendedLanes|a))!==0?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ei(e,i),lr(r,e,i,-1))}return Rh(),r=Qf(Error($(421))),Ou(e,t,a,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=QT.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Dn=Mi(i.nextSibling),Ln=t,ut=!0,ar=null,e!==null&&(Hn[jn++]=Kr,Hn[jn++]=Zr,Hn[jn++]=Eo,Kr=e.id,Zr=e.overflow,Eo=t),t=Ih(t,r.children),t.flags|=4096,t)}function my(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),kp(e.return,t,n)}function ep(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function rS(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(ln(e,t,r.children,n),r=mt.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&my(e,n,t);else if(e.tag===19)my(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(mt,r),(t.mode&1)===0)t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&cc(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ep(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&cc(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ep(t,!0,n,null,o);break;case"together":ep(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ju(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ti(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Co|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error($(153));if(t.child!==null){for(e=t.child,n=Ui(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ui(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function VT(e,t,n){switch(t.tag){case 3:tS(t),Ca();break;case 5:A1(t);break;case 1:bn(t.type)&&ic(t);break;case 4:Sh(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Je(sc,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(mt,mt.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?nS(e,t,n):(Je(mt,mt.current&1),e=ti(e,t,n),e!==null?e.sibling:null);Je(mt,mt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return rS(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(mt,mt.current),r)break;return null;case 22:case 23:return t.lanes=0,Q1(e,t,n)}return ti(e,t,n)}var iS,zp,oS,aS;iS=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zp=function(){};oS=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,wo(Er.current);var o=null;switch(n){case"input":i=lp(e,i),r=lp(e,r),o=[];break;case"select":i=vt({},i,{value:void 0}),r=vt({},r,{value:void 0}),o=[];break;case"textarea":i=dp(e,i),r=dp(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=nc)}pp(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var s=i[u];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zs.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(s=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(a in s)!s.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&s[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zs.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&rt("scroll",e),o||s===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};aS=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ms(e,t){if(!ut)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function GT(e,t,n){var r=t.pendingProps;switch(fh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return bn(t.type)&&rc(),Jt(t),null;case 3:return r=t.stateNode,Pa(),it(wn),it(en),bh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ru(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ar!==null&&(Yp(ar),ar=null))),zp(e,t),Jt(t),null;case 5:wh(t);var i=wo(ll.current);if(n=t.type,e!==null&&t.stateNode!=null)oS(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error($(166));return Jt(t),null}if(e=wo(Er.current),Ru(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[_r]=t,r[al]=o,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(i=0;i<zs.length;i++)rt(zs[i],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":xv(r,o),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},rt("invalid",r);break;case"textarea":Tv(r,o),rt("invalid",r)}pp(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&ku(r.textContent,s,e),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&ku(r.textContent,s,e),i=["children",""+s]):Zs.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&rt("scroll",r)}switch(n){case"input":wu(r),Ev(r,o,!0);break;case"textarea":wu(r),Cv(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=nc)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=My(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[_r]=t,e[al]=r,iS(e,t,!1,!1),t.stateNode=e;e:{switch(a=hp(n,r),n){case"dialog":rt("cancel",e),rt("close",e),i=r;break;case"iframe":case"object":case"embed":rt("load",e),i=r;break;case"video":case"audio":for(i=0;i<zs.length;i++)rt(zs[i],e);i=r;break;case"source":rt("error",e),i=r;break;case"img":case"image":case"link":rt("error",e),rt("load",e),i=r;break;case"details":rt("toggle",e),i=r;break;case"input":xv(e,r),i=lp(e,r),rt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=vt({},r,{value:void 0}),rt("invalid",e);break;case"textarea":Tv(e,r),i=dp(e,r),rt("invalid",e);break;default:i=r}pp(n,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?Ny(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Oy(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&qs(e,l):typeof l=="number"&&qs(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Zs.hasOwnProperty(o)?l!=null&&o==="onScroll"&&rt("scroll",e):l!=null&&qp(e,o,l,a))}switch(n){case"input":wu(e),Ev(e,r,!1);break;case"textarea":wu(e),Cv(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Bi(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?ya(e,!!r.multiple,o,!1):r.defaultValue!=null&&ya(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=nc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)aS(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error($(166));if(n=wo(ll.current),wo(Er.current),Ru(t)){if(r=t.stateNode,n=t.memoizedProps,r[_r]=t,(o=r.nodeValue!==n)&&(e=Ln,e!==null))switch(e.tag){case 3:ku(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ku(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[_r]=t,t.stateNode=r}return Jt(t),null;case 13:if(it(mt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ut&&Dn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)E1(),Ca(),t.flags|=98560,o=!1;else if(o=Ru(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error($(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error($(317));o[_r]=t}else Ca(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Jt(t),o=!1}else ar!==null&&(Yp(ar),ar=null),o=!0;if(!o)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(mt.current&1)!==0?Lt===0&&(Lt=3):Rh())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return Pa(),zp(e,t),e===null&&il(t.stateNode.containerInfo),Jt(t),null;case 10:return gh(t.type._context),Jt(t),null;case 17:return bn(t.type)&&rc(),Jt(t),null;case 19:if(it(mt),o=t.memoizedState,o===null)return Jt(t),null;if(r=(t.flags&128)!==0,a=o.rendering,a===null)if(r)Ms(o,!1);else{if(Lt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(a=cc(e),a!==null){for(t.flags|=128,Ms(o,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(mt,mt.current&1|2),t.child}e=e.sibling}o.tail!==null&&wt()>Da&&(t.flags|=128,r=!0,Ms(o,!1),t.lanes=4194304)}else{if(!r)if(e=cc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ms(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!ut)return Jt(t),null}else 2*wt()-o.renderingStartTime>Da&&n!==1073741824&&(t.flags|=128,r=!0,Ms(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=wt(),t.sibling=null,n=mt.current,Je(mt,r?n&1|2:n&1),t):(Jt(t),null);case 22:case 23:return kh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(An&1073741824)!==0&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error($(156,t.tag))}function HT(e,t){switch(fh(t),t.tag){case 1:return bn(t.type)&&rc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Pa(),it(wn),it(en),bh(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return wh(t),null;case 13:if(it(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error($(340));Ca()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(mt),null;case 4:return Pa(),null;case 10:return gh(t.type._context),null;case 22:case 23:return kh(),null;case 24:return null;default:return null}}var Fu=!1,Qt=!1,jT=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ga(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(e,t,r)}else n.current=null}function Vp(e,t,n){try{n()}catch(r){yt(e,t,r)}}var gy=!1;function WT(e,t){if(Ep=Qu,e=d1(),ch(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(v){n=null;break e}var a=0,s=-1,l=-1,u=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(s=a+i),f!==o||r!==0&&f.nodeType!==3||(l=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++u===i&&(s=a),d===o&&++c===r&&(l=a),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Tp={focusedElem:e,selectionRange:n},Qu=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var y=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var S=y.memoizedProps,b=y.memoizedState,g=t.stateNode,p=g.getSnapshotBeforeUpdate(t.elementType===t.type?S:ir(t.type,S),b);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(v){yt(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return y=gy,gy=!1,y}function Xs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Vp(t,n,o)}i=i.next}while(i!==r)}}function Cc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Gp(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function sS(e){var t=e.alternate;t!==null&&(e.alternate=null,sS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_r],delete t[al],delete t[Pp],delete t[IT],delete t[PT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lS(e){return e.tag===5||e.tag===3||e.tag===4}function vy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nc));else if(r!==4&&(e=e.child,e!==null))for(Hp(e,t,n),e=e.sibling;e!==null;)Hp(e,t,n),e=e.sibling}function jp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(jp(e,t,n),e=e.sibling;e!==null;)jp(e,t,n),e=e.sibling}var Ht=null,or=!1;function Ei(e,t,n){for(n=n.child;n!==null;)uS(e,t,n),n=n.sibling}function uS(e,t,n){if(xr&&typeof xr.onCommitFiberUnmount=="function")try{xr.onCommitFiberUnmount(yc,n)}catch(s){}switch(n.tag){case 5:Qt||ga(n,t);case 6:var r=Ht,i=or;Ht=null,Ei(e,t,n),Ht=r,or=i,Ht!==null&&(or?(e=Ht,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(or?(e=Ht,n=n.stateNode,e.nodeType===8?Xf(e.parentNode,n):e.nodeType===1&&Xf(e,n),tl(e)):Xf(Ht,n.stateNode));break;case 4:r=Ht,i=or,Ht=n.stateNode.containerInfo,or=!0,Ei(e,t,n),Ht=r,or=i;break;case 0:case 11:case 14:case 15:if(!Qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&((o&2)!==0||(o&4)!==0)&&Vp(n,t,a),i=i.next}while(i!==r)}Ei(e,t,n);break;case 1:if(!Qt&&(ga(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){yt(n,t,s)}Ei(e,t,n);break;case 21:Ei(e,t,n);break;case 22:n.mode&1?(Qt=(r=Qt)||n.memoizedState!==null,Ei(e,t,n),Qt=r):Ei(e,t,n);break;default:Ei(e,t,n)}}function yy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new jT),t.forEach(function(r){var i=eC.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:Ht=s.stateNode,or=!1;break e;case 3:Ht=s.stateNode.containerInfo,or=!0;break e;case 4:Ht=s.stateNode.containerInfo,or=!0;break e}s=s.return}if(Ht===null)throw Error($(160));uS(o,a,i),Ht=null,or=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){yt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cS(t,e),t=t.sibling}function cS(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rr(t,e),wr(e),r&4){try{Xs(3,e,e.return),Cc(3,e)}catch(S){yt(e,e.return,S)}try{Xs(5,e,e.return)}catch(S){yt(e,e.return,S)}}break;case 1:rr(t,e),wr(e),r&512&&n!==null&&ga(n,n.return);break;case 5:if(rr(t,e),wr(e),r&512&&n!==null&&ga(n,n.return),e.flags&32){var i=e.stateNode;try{qs(i,"")}catch(S){yt(e,e.return,S)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&ky(i,o),hp(s,a);var u=hp(s,o);for(a=0;a<l.length;a+=2){var c=l[a],f=l[a+1];c==="style"?Ny(i,f):c==="dangerouslySetInnerHTML"?Oy(i,f):c==="children"?qs(i,f):qp(i,c,f,u)}switch(s){case"input":up(i,o);break;case"textarea":Ry(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?ya(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?ya(i,!!o.multiple,o.defaultValue,!0):ya(i,!!o.multiple,o.multiple?[]:"",!1))}i[al]=o}catch(S){yt(e,e.return,S)}}break;case 6:if(rr(t,e),wr(e),r&4){if(e.stateNode===null)throw Error($(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(S){yt(e,e.return,S)}}break;case 3:if(rr(t,e),wr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{tl(t.containerInfo)}catch(S){yt(e,e.return,S)}break;case 4:rr(t,e),wr(e);break;case 13:rr(t,e),wr(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Dh=wt())),r&4&&yy(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Qt=(u=Qt)||c,rr(t,e),Qt=u):rr(t,e),wr(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&(e.mode&1)!==0)for(ae=e,c=e.child;c!==null;){for(f=ae=c;ae!==null;){switch(d=ae,h=d.child,d.tag){case 0:case 11:case 14:case 15:Xs(4,d,d.return);break;case 1:ga(d,d.return);var y=d.stateNode;if(typeof y.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(S){yt(r,n,S)}}break;case 5:ga(d,d.return);break;case 22:if(d.memoizedState!==null){wy(f);continue}}h!==null?(h.return=d,ae=h):wy(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=Fy("display",a))}catch(S){yt(e,e.return,S)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(S){yt(e,e.return,S)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:rr(t,e),wr(e),r&4&&yy(e);break;case 21:break;default:rr(t,e),wr(e)}}function wr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(lS(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qs(i,""),r.flags&=-33);var o=vy(e);jp(e,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=vy(e);Hp(e,s,a);break;default:throw Error($(161))}}catch(l){yt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $T(e,t,n){ae=e,dS(e,t,n)}function dS(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var i=ae,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Fu;if(!a){var s=i.alternate,l=s!==null&&s.memoizedState!==null||Qt;s=Fu;var u=Qt;if(Fu=a,(Qt=l)&&!u)for(ae=i;ae!==null;)a=ae,l=a.child,a.tag===22&&a.memoizedState!==null?by(i):l!==null?(l.return=a,ae=l):by(i);for(;o!==null;)ae=o,dS(o,t,n),o=o.sibling;ae=i,Fu=s,Qt=u}Sy(e,t,n)}else(i.subtreeFlags&8772)!==0&&o!==null?(o.return=i,ae=o):Sy(e,t,n)}}function Sy(e){for(;ae!==null;){var t=ae;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Qt||Cc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Qt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ir(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&ry(t,o,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ry(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&tl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Qt||t.flags&512&&Gp(t)}catch(d){yt(t,t.return,d)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function wy(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function by(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Cc(4,t)}catch(l){yt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){yt(t,i,l)}}var o=t.return;try{Gp(t)}catch(l){yt(t,o,l)}break;case 5:var a=t.return;try{Gp(t)}catch(l){yt(t,a,l)}}}catch(l){yt(t,t.return,l)}if(t===e){ae=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ae=s;break}ae=t.return}}var XT=Math.ceil,pc=ni.ReactCurrentDispatcher,Ph=ni.ReactCurrentOwner,$n=ni.ReactCurrentBatchConfig,Ne=0,Ut=null,Et=null,jt=0,An=0,va=Gi(0),Lt=0,fl=null,Co=0,Ic=0,Ah=0,Ys=null,yn=null,Dh=0,Da=1/0,Xr=null,hc=!1,Wp=null,Fi=null,Nu=!1,Di=null,mc=0,Ks=0,$p=null,Wu=-1,$u=0;function un(){return(Ne&6)!==0?wt():Wu!==-1?Wu:Wu=wt()}function Ni(e){return(e.mode&1)===0?1:(Ne&2)!==0&&jt!==0?jt&-jt:DT.transition!==null?($u===0&&($u=Ky()),$u):(e=We,e!==0||(e=window.event,e=e===void 0?16:n1(e.type)),e)}function lr(e,t,n,r){if(50<Ks)throw Ks=0,$p=null,Error($(185));pl(e,n,r),((Ne&2)===0||e!==Ut)&&(e===Ut&&((Ne&2)===0&&(Ic|=n),Lt===4&&Pi(e,jt)),_n(e,r),n===1&&Ne===0&&(t.mode&1)===0&&(Da=wt()+500,xc&&Hi()))}function _n(e,t){var n=e.callbackNode;kE(e,t);var r=Ju(e,e===Ut?jt:0);if(r===0)n!==null&&Av(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Av(n),t===1)e.tag===0?AT(_y.bind(null,e)):b1(_y.bind(null,e)),TT(function(){(Ne&6)===0&&Hi()}),n=null;else{switch(Zy(r)){case 1:n=nh;break;case 4:n=Xy;break;case 16:n=qu;break;case 536870912:n=Yy;break;default:n=qu}n=SS(n,fS.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fS(e,t){if(Wu=-1,$u=0,(Ne&6)!==0)throw Error($(327));var n=e.callbackNode;if(xa()&&e.callbackNode!==n)return null;var r=Ju(e,e===Ut?jt:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=gc(e,r);else{t=r;var i=Ne;Ne|=2;var o=hS();(Ut!==e||jt!==t)&&(Xr=null,Da=wt()+500,bo(e,t));do try{ZT();break}catch(s){pS(e,s)}while(!0);mh(),pc.current=o,Ne=i,Et!==null?t=0:(Ut=null,jt=0,t=Lt)}if(t!==0){if(t===2&&(i=Sp(e),i!==0&&(r=i,t=Xp(e,i))),t===1)throw n=fl,bo(e,0),Pi(e,r),_n(e,wt()),n;if(t===6)Pi(e,r);else{if(i=e.current.alternate,(r&30)===0&&!YT(i)&&(t=gc(e,r),t===2&&(o=Sp(e),o!==0&&(r=o,t=Xp(e,o))),t===1))throw n=fl,bo(e,0),Pi(e,r),_n(e,wt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error($(345));case 2:vo(e,yn,Xr);break;case 3:if(Pi(e,r),(r&130023424)===r&&(t=Dh+500-wt(),10<t)){if(Ju(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){un(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ip(vo.bind(null,e,yn,Xr),t);break}vo(e,yn,Xr);break;case 4:if(Pi(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-sr(r);o=1<<a,a=t[a],a>i&&(i=a),r&=~o}if(r=i,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*XT(r/1960))-r,10<r){e.timeoutHandle=Ip(vo.bind(null,e,yn,Xr),r);break}vo(e,yn,Xr);break;case 5:vo(e,yn,Xr);break;default:throw Error($(329))}}}return _n(e,wt()),e.callbackNode===n?fS.bind(null,e):null}function Xp(e,t){var n=Ys;return e.current.memoizedState.isDehydrated&&(bo(e,t).flags|=256),e=gc(e,t),e!==2&&(t=yn,yn=n,t!==null&&Yp(t)),e}function Yp(e){yn===null?yn=e:yn.push.apply(yn,e)}function YT(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ur(o(),i))return!1}catch(a){return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pi(e,t){for(t&=~Ah,t&=~Ic,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-sr(t),r=1<<n;e[n]=-1,t&=~r}}function _y(e){if((Ne&6)!==0)throw Error($(327));xa();var t=Ju(e,0);if((t&1)===0)return _n(e,wt()),null;var n=gc(e,t);if(e.tag!==0&&n===2){var r=Sp(e);r!==0&&(t=r,n=Xp(e,r))}if(n===1)throw n=fl,bo(e,0),Pi(e,t),_n(e,wt()),n;if(n===6)throw Error($(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vo(e,yn,Xr),_n(e,wt()),null}function Lh(e,t){var n=Ne;Ne|=1;try{return e(t)}finally{Ne=n,Ne===0&&(Da=wt()+500,xc&&Hi())}}function Io(e){Di!==null&&Di.tag===0&&(Ne&6)===0&&xa();var t=Ne;Ne|=1;var n=$n.transition,r=We;try{if($n.transition=null,We=1,e)return e()}finally{We=r,$n.transition=n,Ne=t,(Ne&6)===0&&Hi()}}function kh(){An=va.current,it(va)}function bo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ET(n)),Et!==null)for(n=Et.return;n!==null;){var r=n;switch(fh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rc();break;case 3:Pa(),it(wn),it(en),bh();break;case 5:wh(r);break;case 4:Pa();break;case 13:it(mt);break;case 19:it(mt);break;case 10:gh(r.type._context);break;case 22:case 23:kh()}n=n.return}if(Ut=e,Et=e=Ui(e.current,null),jt=An=t,Lt=0,fl=null,Ah=Ic=Co=0,yn=Ys=null,So!==null){for(t=0;t<So.length;t++)if(n=So[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}So=null}return e}function pS(e,t){do{var n=Et;try{if(mh(),Gu.current=fc,dc){for(var r=gt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}dc=!1}if(To=0,Nt=Dt=gt=null,$s=!1,ul=0,Ph.current=null,n===null||n.return===null){Lt=1,fl=t,Et=null;break}e:{var o=e,a=n.return,s=n,l=t;if(t=jt,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,f=c.tag;if((c.mode&1)===0&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=uy(a);if(h!==null){h.flags&=-257,cy(h,a,s,o,t),h.mode&1&&ly(o,u,t),t=h,l=u;var y=t.updateQueue;if(y===null){var S=new Set;S.add(l),t.updateQueue=S}else y.add(l);break e}else{if((t&1)===0){ly(o,u,t),Rh();break e}l=Error($(426))}}else if(ut&&s.mode&1){var b=uy(a);if(b!==null){(b.flags&65536)===0&&(b.flags|=256),cy(b,a,s,o,t),ph(Aa(l,s));break e}}o=l=Aa(l,s),Lt!==4&&(Lt=2),Ys===null?Ys=[o]:Ys.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var g=Z1(o,l,t);ny(o,g);break e;case 1:s=l;var p=o.type,m=o.stateNode;if((o.flags&128)===0&&(typeof p.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Fi===null||!Fi.has(m)))){o.flags|=65536,t&=-t,o.lanes|=t;var v=q1(o,s,t);ny(o,v);break e}}o=o.return}while(o!==null)}gS(n)}catch(x){t=x,Et===n&&n!==null&&(Et=n=n.return);continue}break}while(!0)}function hS(){var e=pc.current;return pc.current=fc,e===null?fc:e}function Rh(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),Ut===null||(Co&268435455)===0&&(Ic&268435455)===0||Pi(Ut,jt)}function gc(e,t){var n=Ne;Ne|=2;var r=hS();(Ut!==e||jt!==t)&&(Xr=null,bo(e,t));do try{KT();break}catch(i){pS(e,i)}while(!0);if(mh(),Ne=n,pc.current=r,Et!==null)throw Error($(261));return Ut=null,jt=0,Lt}function KT(){for(;Et!==null;)mS(Et)}function ZT(){for(;Et!==null&&!xE();)mS(Et)}function mS(e){var t=yS(e.alternate,e,An);e.memoizedProps=e.pendingProps,t===null?gS(e):Et=t,Ph.current=null}function gS(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=GT(n,t,An),n!==null){Et=n;return}}else{if(n=HT(n,t),n!==null){n.flags&=32767,Et=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Lt=6,Et=null;return}}if(t=t.sibling,t!==null){Et=t;return}Et=t=e}while(t!==null);Lt===0&&(Lt=5)}function vo(e,t,n){var r=We,i=$n.transition;try{$n.transition=null,We=1,qT(e,t,n,r)}finally{$n.transition=i,We=r}return null}function qT(e,t,n,r){do xa();while(Di!==null);if((Ne&6)!==0)throw Error($(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error($(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(RE(e,o),e===Ut&&(Et=Ut=null,jt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Nu||(Nu=!0,SS(qu,function(){return xa(),null})),o=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||o){o=$n.transition,$n.transition=null;var a=We;We=1;var s=Ne;Ne|=4,Ph.current=null,WT(e,n),cS(n,e),ST(Tp),Qu=!!Ep,Tp=Ep=null,e.current=n,$T(n,e,i),EE(),Ne=s,We=a,$n.transition=o}else e.current=n;if(Nu&&(Nu=!1,Di=e,mc=i),o=e.pendingLanes,o===0&&(Fi=null),IE(n.stateNode,r),_n(e,wt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(hc)throw hc=!1,e=Wp,Wp=null,e;return(mc&1)!==0&&e.tag!==0&&xa(),o=e.pendingLanes,(o&1)!==0?e===$p?Ks++:(Ks=0,$p=e):Ks=0,Hi(),null}function xa(){if(Di!==null){var e=Zy(mc),t=$n.transition,n=We;try{if($n.transition=null,We=16>e?16:e,Di===null)var r=!1;else{if(e=Di,Di=null,mc=0,(Ne&6)!==0)throw Error($(331));var i=Ne;for(Ne|=4,ae=e.current;ae!==null;){var o=ae,a=o.child;if((ae.flags&16)!==0){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(ae=u;ae!==null;){var c=ae;switch(c.tag){case 0:case 11:case 15:Xs(8,c,o)}var f=c.child;if(f!==null)f.return=c,ae=f;else for(;ae!==null;){c=ae;var d=c.sibling,h=c.return;if(sS(c),c===u){ae=null;break}if(d!==null){d.return=h,ae=d;break}ae=h}}}var y=o.alternate;if(y!==null){var S=y.child;if(S!==null){y.child=null;do{var b=S.sibling;S.sibling=null,S=b}while(S!==null)}}ae=o}}if((o.subtreeFlags&2064)!==0&&a!==null)a.return=o,ae=a;else e:for(;ae!==null;){if(o=ae,(o.flags&2048)!==0)switch(o.tag){case 0:case 11:case 15:Xs(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,ae=g;break e}ae=o.return}}var p=e.current;for(ae=p;ae!==null;){a=ae;var m=a.child;if((a.subtreeFlags&2064)!==0&&m!==null)m.return=a,ae=m;else e:for(a=p;ae!==null;){if(s=ae,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:Cc(9,s)}}catch(x){yt(s,s.return,x)}if(s===a){ae=null;break e}var v=s.sibling;if(v!==null){v.return=s.return,ae=v;break e}ae=s.return}}if(Ne=i,Hi(),xr&&typeof xr.onPostCommitFiberRoot=="function")try{xr.onPostCommitFiberRoot(yc,e)}catch(x){}r=!0}return r}finally{We=n,$n.transition=t}}return!1}function xy(e,t,n){t=Aa(n,t),t=Z1(e,t,1),e=Oi(e,t,1),t=un(),e!==null&&(pl(e,1,t),_n(e,t))}function yt(e,t,n){if(e.tag===3)xy(e,e,n);else for(;t!==null;){if(t.tag===3){xy(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fi===null||!Fi.has(r))){e=Aa(n,e),e=q1(t,e,1),t=Oi(t,e,1),e=un(),t!==null&&(pl(t,1,e),_n(t,e));break}}t=t.return}}function JT(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=un(),e.pingedLanes|=e.suspendedLanes&n,Ut===e&&(jt&n)===n&&(Lt===4||Lt===3&&(jt&130023424)===jt&&500>wt()-Dh?bo(e,0):Ah|=n),_n(e,t)}function vS(e,t){t===0&&((e.mode&1)===0?t=1:(t=xu,xu<<=1,(xu&130023424)===0&&(xu=4194304)));var n=un();e=ei(e,t),e!==null&&(pl(e,t,n),_n(e,n))}function QT(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),vS(e,n)}function eC(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(t),vS(e,n)}var yS;yS=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||wn.current)Sn=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return Sn=!1,VT(e,t,n);Sn=(e.flags&131072)!==0}else Sn=!1,ut&&(t.flags&1048576)!==0&&_1(t,ac,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ju(e,t),e=t.pendingProps;var i=Ta(t,en.current);_a(t,n),i=xh(null,t,r,e,i,n);var o=Eh();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bn(r)?(o=!0,ic(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yh(t),i.updater=Tc,t.stateNode=i,i._reactInternals=t,Mp(t,r,e,n),t=Np(null,t,r,!0,o,n)):(t.tag=0,ut&&o&&dh(t),ln(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ju(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=nC(r),e=ir(r,e),i){case 0:t=Fp(null,t,r,e,n);break e;case 1:t=py(null,t,r,e,n);break e;case 11:t=dy(null,t,r,e,n);break e;case 14:t=fy(null,t,r,ir(r.type,e),n);break e}throw Error($(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ir(r,i),Fp(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ir(r,i),py(e,t,r,i,n);case 3:e:{if(tS(t),e===null)throw Error($(387));r=t.pendingProps,o=t.memoizedState,i=o.element,P1(e,t),uc(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=Aa(Error($(423)),t),t=hy(e,t,r,n,i);break e}else if(r!==i){i=Aa(Error($(424)),t),t=hy(e,t,r,n,i);break e}else for(Dn=Mi(t.stateNode.containerInfo.firstChild),Ln=t,ut=!0,ar=null,n=C1(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ca(),r===i){t=ti(e,t,n);break e}ln(e,t,r,n)}t=t.child}return t;case 5:return A1(t),e===null&&Lp(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,a=i.children,Cp(r,i)?a=null:o!==null&&Cp(r,o)&&(t.flags|=32),eS(e,t),ln(e,t,a,n),t.child;case 6:return e===null&&Lp(t),null;case 13:return nS(e,t,n);case 4:return Sh(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ia(t,null,r,n):ln(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ir(r,i),dy(e,t,r,i,n);case 7:return ln(e,t,t.pendingProps,n),t.child;case 8:return ln(e,t,t.pendingProps.children,n),t.child;case 12:return ln(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Je(sc,r._currentValue),r._currentValue=a,o!==null)if(ur(o.value,a)){if(o.children===i.children&&!wn.current){t=ti(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=qr(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),kp(o.return,n,t),s.lanes|=n;break}l=l.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error($(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),kp(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}ln(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,_a(t,n),i=Xn(i),r=r(i),t.flags|=1,ln(e,t,r,n),t.child;case 14:return r=t.type,i=ir(r,t.pendingProps),i=ir(r.type,i),fy(e,t,r,i,n);case 15:return J1(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ir(r,i),ju(e,t),t.tag=1,bn(r)?(e=!0,ic(t)):e=!1,_a(t,n),K1(t,r,i),Mp(t,r,i,n),Np(null,t,r,!0,e,n);case 19:return rS(e,t,n);case 22:return Q1(e,t,n)}throw Error($(156,t.tag))};function SS(e,t){return $y(e,t)}function tC(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(e,t,n,r){return new tC(e,t,n,r)}function Mh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nC(e){if(typeof e=="function")return Mh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qp)return 11;if(e===eh)return 14}return 2}function Ui(e,t){var n=e.alternate;return n===null?(n=Wn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Xu(e,t,n,r,i,o){var a=2;if(r=e,typeof e=="function")Mh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case sa:return _o(n.children,i,o,t);case Jp:a=8,i|=8;break;case ip:return e=Wn(12,n,t,i|2),e.elementType=ip,e.lanes=o,e;case op:return e=Wn(13,n,t,i),e.elementType=op,e.lanes=o,e;case ap:return e=Wn(19,n,t,i),e.elementType=ap,e.lanes=o,e;case Ay:return Pc(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Iy:a=10;break e;case Py:a=9;break e;case Qp:a=11;break e;case eh:a=14;break e;case Ti:a=16,r=null;break e}throw Error($(130,e==null?e:typeof e,""))}return t=Wn(a,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function _o(e,t,n,r){return e=Wn(7,e,r,t),e.lanes=n,e}function Pc(e,t,n,r){return e=Wn(22,e,r,t),e.elementType=Ay,e.lanes=n,e.stateNode={isHidden:!1},e}function tp(e,t,n){return e=Wn(6,e,null,t),e.lanes=n,e}function np(e,t,n){return t=Wn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rC(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bf(0),this.expirationTimes=Bf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Oh(e,t,n,r,i,o,a,s,l){return e=new rC(e,t,n,s,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Wn(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yh(o),e}function iC(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:aa,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function wS(e){if(!e)return zi;e=e._reactInternals;e:{if(Ao(e)!==e||e.tag!==1)throw Error($(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error($(171))}if(e.tag===1){var n=e.type;if(bn(n))return w1(e,n,t)}return t}function bS(e,t,n,r,i,o,a,s,l){return e=Oh(n,r,!0,e,i,o,a,s,l),e.context=wS(null),n=e.current,r=un(),i=Ni(n),o=qr(r,i),o.callback=t!=null?t:null,Oi(n,o,i),e.current.lanes=i,pl(e,i,r),_n(e,r),e}function Ac(e,t,n,r){var i=t.current,o=un(),a=Ni(i);return n=wS(n),t.context===null?t.context=n:t.pendingContext=n,t=qr(o,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Oi(i,t,a),e!==null&&(lr(e,i,a,o),Vu(e,i,a)),a}function vc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ey(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Fh(e,t){Ey(e,t),(e=e.alternate)&&Ey(e,t)}function oC(){return null}var _S=typeof reportError=="function"?reportError:function(e){console.error(e)};function Nh(e){this._internalRoot=e}Dc.prototype.render=Nh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error($(409));Ac(e,t,null,null)};Dc.prototype.unmount=Nh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Io(function(){Ac(null,e,null,null)}),t[Qr]=null}};function Dc(e){this._internalRoot=e}Dc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qy();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ii.length&&t!==0&&t<Ii[n].priority;n++);Ii.splice(n,0,e),n===0&&t1(e)}};function Uh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ty(){}function aC(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=vc(a);o.call(u)}}var a=bS(t,r,e,0,null,!1,!1,"",Ty);return e._reactRootContainer=a,e[Qr]=a.current,il(e.nodeType===8?e.parentNode:e),Io(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var u=vc(l);s.call(u)}}var l=Oh(e,0,!1,null,null,!1,!1,"",Ty);return e._reactRootContainer=l,e[Qr]=l.current,il(e.nodeType===8?e.parentNode:e),Io(function(){Ac(t,l,n,r)}),l}function kc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var l=vc(a);s.call(l)}}Ac(t,a,e,i)}else a=aC(n,t,e,i,r);return vc(a)}qy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Bs(t.pendingLanes);n!==0&&(rh(t,n|1),_n(t,wt()),(Ne&6)===0&&(Da=wt()+500,Hi()))}break;case 13:Io(function(){var r=ei(e,1);if(r!==null){var i=un();lr(r,e,1,i)}}),Fh(e,1)}};ih=function(e){if(e.tag===13){var t=ei(e,134217728);if(t!==null){var n=un();lr(t,e,134217728,n)}Fh(e,134217728)}};Jy=function(e){if(e.tag===13){var t=Ni(e),n=ei(e,t);if(n!==null){var r=un();lr(n,e,t,r)}Fh(e,t)}};Qy=function(){return We};e1=function(e,t){var n=We;try{return We=e,t()}finally{We=n}};gp=function(e,t,n){switch(t){case"input":if(up(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_c(r);if(!i)throw Error($(90));Ly(r),up(r,i)}}}break;case"textarea":Ry(e,n);break;case"select":t=n.value,t!=null&&ya(e,!!n.multiple,t,!1)}};zy=Lh;Vy=Io;var sC={usingClientEntryPoint:!1,Events:[ml,da,_c,Uy,By,Lh]},Os={findFiberByHostInstance:yo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lC={bundleType:Os.bundleType,version:Os.version,rendererPackageName:Os.rendererPackageName,rendererConfig:Os.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=jy(e),e===null?null:e.stateNode},findFiberByHostInstance:Os.findFiberByHostInstance||oC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&(Fs=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Fs.isDisabled&&Fs.supportsFiber))try{yc=Fs.inject(lC),xr=Fs}catch(e){}var Fs;Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sC;Mn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uh(t))throw Error($(200));return iC(e,t,null,n)};Mn.createRoot=function(e,t){if(!Uh(e))throw Error($(299));var n=!1,r="",i=_S;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Oh(e,1,!1,null,null,n,!1,r,i),e[Qr]=t.current,il(e.nodeType===8?e.parentNode:e),new Nh(t)};Mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error($(188)):(e=Object.keys(e).join(","),Error($(268,e)));return e=jy(t),e=e===null?null:e.stateNode,e};Mn.flushSync=function(e){return Io(e)};Mn.hydrate=function(e,t,n){if(!Lc(t))throw Error($(200));return kc(null,e,t,!0,n)};Mn.hydrateRoot=function(e,t,n){if(!Uh(e))throw Error($(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=_S;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=bS(t,null,e,1,n!=null?n:null,i,!1,o,a),e[Qr]=t.current,il(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Dc(t)};Mn.render=function(e,t,n){if(!Lc(t))throw Error($(200));return kc(null,e,t,!1,n)};Mn.unmountComponentAtNode=function(e){if(!Lc(e))throw Error($(40));return e._reactRootContainer?(Io(function(){kc(null,null,e,!1,function(){e._reactRootContainer=null,e[Qr]=null})}),!0):!1};Mn.unstable_batchedUpdates=Lh;Mn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Lc(n))throw Error($(200));if(e==null||e._reactInternals===void 0)throw Error($(38));return kc(e,t,n,!1,r)};Mn.version="18.3.1-next-f1338f8080-20240426"});var CS=_e((pk,TS)=>{"use strict";function ES(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ES)}catch(e){console.error(e)}}ES(),TS.exports=xS()});var vl=_e(Bh=>{"use strict";var IS=CS();Bh.createRoot=IS.createRoot,Bh.hydrateRoot=IS.hydrateRoot;var hk});var yl=_e(Rc=>{"use strict";Rc.byteLength=fC;Rc.toByteArray=hC;Rc.fromByteArray=vC;var Tr=[],Kn=[],dC=typeof Uint8Array!="undefined"?Uint8Array:Array,zh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Do=0,OS=zh.length;Do<OS;++Do)Tr[Do]=zh[Do],Kn[zh.charCodeAt(Do)]=Do;var Do,OS;Kn[45]=62;Kn[95]=63;function FS(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function fC(e){var t=FS(e),n=t[0],r=t[1];return(n+r)*3/4-r}function pC(e,t,n){return(t+n)*3/4-n}function hC(e){var t,n=FS(e),r=n[0],i=n[1],o=new dC(pC(e,r,i)),a=0,s=i>0?r-4:r,l;for(l=0;l<s;l+=4)t=Kn[e.charCodeAt(l)]<<18|Kn[e.charCodeAt(l+1)]<<12|Kn[e.charCodeAt(l+2)]<<6|Kn[e.charCodeAt(l+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=t&255;return i===2&&(t=Kn[e.charCodeAt(l)]<<2|Kn[e.charCodeAt(l+1)]>>4,o[a++]=t&255),i===1&&(t=Kn[e.charCodeAt(l)]<<10|Kn[e.charCodeAt(l+1)]<<4|Kn[e.charCodeAt(l+2)]>>2,o[a++]=t>>8&255,o[a++]=t&255),o}function mC(e){return Tr[e>>18&63]+Tr[e>>12&63]+Tr[e>>6&63]+Tr[e&63]}function gC(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(mC(r));return i.join("")}function vC(e){for(var t,n=e.length,r=n%3,i=[],o=16383,a=0,s=n-r;a<s;a+=o)i.push(gC(e,a,a+o>s?s:a+o));return r===1?(t=e[n-1],i.push(Tr[t>>2]+Tr[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push(Tr[t>>10]+Tr[t>>4&63]+Tr[t<<2&63]+"=")),i.join("")}});var rw=_e((Tk,Oa)=>{"use strict";function Ma(e){let t=e.length;for(;--t>=0;)e[t]=0}var yC=0,GS=1,SC=2,wC=3,bC=258,Xh=29,El=256,wl=El+1+Xh,Ra=30,Yh=19,HS=2*wl+1,Lo=15,Vh=16,_C=7,Kh=256,jS=16,WS=17,$S=18,Wh=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Mc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),xC=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),XS=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),EC=512,ri=new Array((wl+2)*2);Ma(ri);var Sl=new Array(Ra*2);Ma(Sl);var bl=new Array(EC);Ma(bl);var _l=new Array(bC-wC+1);Ma(_l);var Zh=new Array(Xh);Ma(Zh);var Oc=new Array(Ra);Ma(Oc);function Gh(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}var YS,KS,ZS;function Hh(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}var qS=e=>e<256?bl[e]:bl[256+(e>>>7)],xl=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},xn=(e,t,n)=>{e.bi_valid>Vh-n?(e.bi_buf|=t<<e.bi_valid&65535,xl(e,e.bi_buf),e.bi_buf=t>>Vh-e.bi_valid,e.bi_valid+=n-Vh):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Cr=(e,t,n)=>{xn(e,n[t*2],n[t*2+1])},JS=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},TC=e=>{e.bi_valid===16?(xl(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},CC=(e,t)=>{let n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length,u,c,f,d,h,y,S=0;for(d=0;d<=Lo;d++)e.bl_count[d]=0;for(n[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<HS;u++)c=e.heap[u],d=n[n[c*2+1]*2+1]+1,d>l&&(d=l,S++),n[c*2+1]=d,!(c>r)&&(e.bl_count[d]++,h=0,c>=s&&(h=a[c-s]),y=n[c*2],e.opt_len+=y*(d+h),o&&(e.static_len+=y*(i[c*2+1]+h)));if(S!==0){do{for(d=l-1;e.bl_count[d]===0;)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,S-=2}while(S>0);for(d=l;d!==0;d--)for(c=e.bl_count[d];c!==0;)f=e.heap[--u],!(f>r)&&(n[f*2+1]!==d&&(e.opt_len+=(d-n[f*2+1])*n[f*2],n[f*2+1]=d),c--)}},QS=(e,t,n)=>{let r=new Array(Lo+1),i=0,o,a;for(o=1;o<=Lo;o++)i=i+n[o-1]<<1,r[o]=i;for(a=0;a<=t;a++){let s=e[a*2+1];s!==0&&(e[a*2]=JS(r[s]++,s))}},IC=()=>{let e,t,n,r,i,o=new Array(Lo+1);for(n=0,r=0;r<Xh-1;r++)for(Zh[r]=n,e=0;e<1<<Wh[r];e++)_l[n++]=r;for(_l[n-1]=r,i=0,r=0;r<16;r++)for(Oc[r]=i,e=0;e<1<<Mc[r];e++)bl[i++]=r;for(i>>=7;r<Ra;r++)for(Oc[r]=i<<7,e=0;e<1<<Mc[r]-7;e++)bl[256+i++]=r;for(t=0;t<=Lo;t++)o[t]=0;for(e=0;e<=143;)ri[e*2+1]=8,e++,o[8]++;for(;e<=255;)ri[e*2+1]=9,e++,o[9]++;for(;e<=279;)ri[e*2+1]=7,e++,o[7]++;for(;e<=287;)ri[e*2+1]=8,e++,o[8]++;for(QS(ri,wl+1,o),e=0;e<Ra;e++)Sl[e*2+1]=5,Sl[e*2]=JS(e,5);YS=new Gh(ri,Wh,El+1,wl,Lo),KS=new Gh(Sl,Mc,0,Ra,Lo),ZS=new Gh(new Array(0),xC,0,Yh,_C)},ew=e=>{let t;for(t=0;t<wl;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Ra;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Yh;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Kh*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},tw=e=>{e.bi_valid>8?xl(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},NS=(e,t,n,r)=>{let i=t*2,o=n*2;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},jh=(e,t,n)=>{let r=e.heap[n],i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&NS(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!NS(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},US=(e,t,n)=>{let r,i,o=0,a,s;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+o++]&255,r+=(e.pending_buf[e.sym_buf+o++]&255)<<8,i=e.pending_buf[e.sym_buf+o++],r===0?Cr(e,i,t):(a=_l[i],Cr(e,a+El+1,t),s=Wh[a],s!==0&&(i-=Zh[a],xn(e,i,s)),r--,a=qS(r),Cr(e,a,n),s=Mc[a],s!==0&&(r-=Oc[a],xn(e,r,s)));while(o<e.sym_next);Cr(e,Kh,t)},$h=(e,t)=>{let n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems,a,s,l=-1,u;for(e.heap_len=0,e.heap_max=HS,a=0;a<o;a++)n[a*2]!==0?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[a*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,n[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[u*2+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)jh(e,n,a);u=o;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],jh(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[u*2]=n[a*2]+n[s*2],e.depth[u]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[a*2+1]=n[s*2+1]=u,e.heap[1]=u++,jh(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],CC(e,t),QS(n,l,e.bl_count)},BS=(e,t,n)=>{let r,i=-1,o,a=t[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)o=a,a=t[(r+1)*2+1],!(++s<l&&o===a)&&(s<u?e.bl_tree[o*2]+=s:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[jS*2]++):s<=10?e.bl_tree[WS*2]++:e.bl_tree[$S*2]++,s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4))},zS=(e,t,n)=>{let r,i=-1,o,a=t[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),r=0;r<=n;r++)if(o=a,a=t[(r+1)*2+1],!(++s<l&&o===a)){if(s<u)do Cr(e,o,e.bl_tree);while(--s!==0);else o!==0?(o!==i&&(Cr(e,o,e.bl_tree),s--),Cr(e,jS,e.bl_tree),xn(e,s-3,2)):s<=10?(Cr(e,WS,e.bl_tree),xn(e,s-3,3)):(Cr(e,$S,e.bl_tree),xn(e,s-11,7));s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4)}},PC=e=>{let t;for(BS(e,e.dyn_ltree,e.l_desc.max_code),BS(e,e.dyn_dtree,e.d_desc.max_code),$h(e,e.bl_desc),t=Yh-1;t>=3&&e.bl_tree[XS[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},AC=(e,t,n,r)=>{let i;for(xn(e,t-257,5),xn(e,n-1,5),xn(e,r-4,4),i=0;i<r;i++)xn(e,e.bl_tree[XS[i]*2+1],3);zS(e,e.dyn_ltree,t-1),zS(e,e.dyn_dtree,n-1)},DC=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(n=32;n<El;n++)if(e.dyn_ltree[n*2]!==0)return 1;return 0},VS=!1,LC=e=>{VS||(IC(),VS=!0),e.l_desc=new Hh(e.dyn_ltree,YS),e.d_desc=new Hh(e.dyn_dtree,KS),e.bl_desc=new Hh(e.bl_tree,ZS),e.bi_buf=0,e.bi_valid=0,ew(e)},nw=(e,t,n,r)=>{xn(e,(yC<<1)+(r?1:0),3),tw(e),xl(e,n),xl(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},kC=e=>{xn(e,GS<<1,3),Cr(e,Kh,ri),TC(e)},RC=(e,t,n,r)=>{let i,o,a=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=DC(e)),$h(e,e.l_desc),$h(e,e.d_desc),a=PC(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&t!==-1?nw(e,t,n,r):e.strategy===4||o===i?(xn(e,(GS<<1)+(r?1:0),3),US(e,ri,Sl)):(xn(e,(SC<<1)+(r?1:0),3),AC(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),US(e,e.dyn_ltree,e.dyn_dtree)),ew(e),r&&tw(e)},MC=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(_l[n]+El+1)*2]++,e.dyn_dtree[qS(t)*2]++),e.sym_next===e.sym_end);Oa.exports._tr_init=LC;Oa.exports._tr_stored_block=nw;Oa.exports._tr_flush_block=RC;Oa.exports._tr_tally=MC;Oa.exports._tr_align=kC});var qh=_e((Ck,iw)=>{"use strict";var OC=(e,t,n,r)=>{let i=e&65535|0,o=e>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do i=i+t[r++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0};iw.exports=OC});var Jh=_e((Ik,ow)=>{"use strict";var FC=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},NC=new Uint32Array(FC()),UC=(e,t,n,r)=>{let i=NC,o=r+n;e^=-1;for(let a=r;a<o;a++)e=e>>>8^i[(e^t[a])&255];return e^-1};ow.exports=UC});var Fc=_e((Pk,aw)=>{"use strict";aw.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var $i=_e((Ak,sw)=>{"use strict";sw.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var vw=_e((Dk,Dr)=>{"use strict";var{_tr_init:BC,_tr_stored_block:tm,_tr_flush_block:zC,_tr_tally:Zi,_tr_align:VC}=rw(),dw=qh(),Xi=Jh(),GC=Fc(),{Z_NO_FLUSH:qi,Z_PARTIAL_FLUSH:HC,Z_FULL_FLUSH:jC,Z_FINISH:Zn,Z_BLOCK:lw,Z_OK:$t,Z_STREAM_END:uw,Z_STREAM_ERROR:Pr,Z_DATA_ERROR:WC,Z_BUF_ERROR:Qh,Z_DEFAULT_COMPRESSION:$C,Z_FILTERED:XC,Z_HUFFMAN_ONLY:Nc,Z_RLE:YC,Z_FIXED:KC,Z_DEFAULT_STRATEGY:ZC,Z_UNKNOWN:qC,Z_DEFLATED:Uc}=$i(),JC=9,QC=15,eI=8,tI=29,nI=256,nm=nI+1+tI,rI=30,iI=19,oI=2*nm+1,aI=15,Oe=3,Ki=258,Ar=Ki+Oe+1,sI=32,Na=42,lm=57,rm=69,im=73,om=91,am=103,ko=113,Cl=666,dn=1,Ba=2,Mo=3,za=4,lI=3,Ro=(e,t)=>(e.msg=GC[t],t),cw=e=>e*2-(e>4?9:0),Yi=e=>{let t=e.length;for(;--t>=0;)e[t]=0},uI=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)},cI=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,Ji=cI,On=e=>{let t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Fn=(e,t)=>{zC(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,On(e.strm)},Ve=(e,t)=>{e.pending_buf[e.pending++]=t},Tl=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},sm=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=dw(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Xi(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},fw=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,o,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-Ar?e.strstart-(e.w_size-Ar):0,u=e.window,c=e.w_mask,f=e.prev,d=e.strstart+Ki,h=u[r+a-1],y=u[r+a];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do if(i=t,!(u[i+a]!==y||u[i+a-1]!==h||u[i]!==u[r]||u[++i]!==u[r+1])){r+=2,i++;do;while(u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&r<d);if(o=Ki-(d-r),r=d-Ki,o>a){if(e.match_start=t,a=o,o>=s)break;h=u[r+a-1],y=u[r+a]}}while((t=f[t&c])>l&&--n!==0);return a<=e.lookahead?a:e.lookahead},Ua=e=>{let t=e.w_size,n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ar)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),uI(e),r+=t),e.strm.avail_in===0)break;if(n=sm(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=Oe)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Ji(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Ji(e,e.ins_h,e.window[i+Oe-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<Oe)););}while(e.lookahead<Ar&&e.strm.avail_in!==0)},pw=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,o,a=0,s=e.strm.avail_in;do{if(r=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>o&&(r=o),r<n&&(r===0&&t!==Zn||t===qi||r!==i+e.strm.avail_in)))break;a=t===Zn&&r===i+e.strm.avail_in?1:0,tm(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,On(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(sm(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(a===0);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?za:t!==qi&&t!==Zn&&e.strm.avail_in===0&&e.strstart===e.block_start?Ba:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(sm(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,n=o>e.w_size?e.w_size:o,i=e.strstart-e.block_start,(i>=n||(i||t===Zn)&&t!==qi&&e.strm.avail_in===0&&i<=o)&&(r=i>o?o:i,a=t===Zn&&e.strm.avail_in===0&&r===i?1:0,tm(e,e.block_start,r,a),e.block_start+=r,On(e.strm)),a?Mo:dn)},em=(e,t)=>{let n,r;for(;;){if(e.lookahead<Ar){if(Ua(e),e.lookahead<Ar&&t===qi)return dn;if(e.lookahead===0)break}if(n=0,e.lookahead>=Oe&&(e.ins_h=Ji(e,e.ins_h,e.window[e.strstart+Oe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Ar&&(e.match_length=fw(e,n)),e.match_length>=Oe)if(r=Zi(e,e.strstart-e.match_start,e.match_length-Oe),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Oe){e.match_length--;do e.strstart++,e.ins_h=Ji(e,e.ins_h,e.window[e.strstart+Oe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ji(e,e.ins_h,e.window[e.strstart+1]);else r=Zi(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Fn(e,!1),e.strm.avail_out===0))return dn}return e.insert=e.strstart<Oe-1?e.strstart:Oe-1,t===Zn?(Fn(e,!0),e.strm.avail_out===0?Mo:za):e.sym_next&&(Fn(e,!1),e.strm.avail_out===0)?dn:Ba},Fa=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<Ar){if(Ua(e),e.lookahead<Ar&&t===qi)return dn;if(e.lookahead===0)break}if(n=0,e.lookahead>=Oe&&(e.ins_h=Ji(e,e.ins_h,e.window[e.strstart+Oe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Oe-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Ar&&(e.match_length=fw(e,n),e.match_length<=5&&(e.strategy===XC||e.match_length===Oe&&e.strstart-e.match_start>4096)&&(e.match_length=Oe-1)),e.prev_length>=Oe&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Oe,r=Zi(e,e.strstart-1-e.prev_match,e.prev_length-Oe),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=Ji(e,e.ins_h,e.window[e.strstart+Oe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Oe-1,e.strstart++,r&&(Fn(e,!1),e.strm.avail_out===0))return dn}else if(e.match_available){if(r=Zi(e,0,e.window[e.strstart-1]),r&&Fn(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return dn}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Zi(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Oe-1?e.strstart:Oe-1,t===Zn?(Fn(e,!0),e.strm.avail_out===0?Mo:za):e.sym_next&&(Fn(e,!1),e.strm.avail_out===0)?dn:Ba},dI=(e,t)=>{let n,r,i,o,a=e.window;for(;;){if(e.lookahead<=Ki){if(Ua(e),e.lookahead<=Ki&&t===qi)return dn;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Oe&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){o=e.strstart+Ki;do;while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=Ki-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Oe?(n=Zi(e,1,e.match_length-Oe),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Zi(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Fn(e,!1),e.strm.avail_out===0))return dn}return e.insert=0,t===Zn?(Fn(e,!0),e.strm.avail_out===0?Mo:za):e.sym_next&&(Fn(e,!1),e.strm.avail_out===0)?dn:Ba},fI=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(Ua(e),e.lookahead===0)){if(t===qi)return dn;break}if(e.match_length=0,n=Zi(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Fn(e,!1),e.strm.avail_out===0))return dn}return e.insert=0,t===Zn?(Fn(e,!0),e.strm.avail_out===0?Mo:za):e.sym_next&&(Fn(e,!1),e.strm.avail_out===0)?dn:Ba};function Ir(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}var Il=[new Ir(0,0,0,0,pw),new Ir(4,4,8,4,em),new Ir(4,5,16,8,em),new Ir(4,6,32,32,em),new Ir(4,4,16,16,Fa),new Ir(8,16,32,32,Fa),new Ir(8,16,128,128,Fa),new Ir(8,32,128,256,Fa),new Ir(32,128,258,1024,Fa),new Ir(32,258,258,4096,Fa)],pI=e=>{e.window_size=2*e.w_size,Yi(e.head),e.max_lazy_match=Il[e.level].max_lazy,e.good_match=Il[e.level].good_length,e.nice_match=Il[e.level].nice_length,e.max_chain_length=Il[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Oe-1,e.match_available=0,e.ins_h=0};function hI(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Uc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(oI*2),this.dyn_dtree=new Uint16Array((2*rI+1)*2),this.bl_tree=new Uint16Array((2*iI+1)*2),Yi(this.dyn_ltree),Yi(this.dyn_dtree),Yi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(aI+1),this.heap=new Uint16Array(2*nm+1),Yi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*nm+1),Yi(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Pl=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.status!==Na&&t.status!==lm&&t.status!==rm&&t.status!==im&&t.status!==om&&t.status!==am&&t.status!==ko&&t.status!==Cl?1:0},hw=e=>{if(Pl(e))return Ro(e,Pr);e.total_in=e.total_out=0,e.data_type=qC;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?lm:t.wrap?Na:ko,e.adler=t.wrap===2?0:1,t.last_flush=-2,BC(t),$t},mw=e=>{let t=hw(e);return t===$t&&pI(e.state),t},mI=(e,t)=>Pl(e)||e.state.wrap!==2?Pr:(e.state.gzhead=t,$t),gw=(e,t,n,r,i,o)=>{if(!e)return Pr;let a=1;if(t===$C&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>JC||n!==Uc||r<8||r>15||t<0||t>9||o<0||o>KC||r===8&&a!==1)return Ro(e,Pr);r===8&&(r=9);let s=new hI;return e.state=s,s.strm=e,s.status=Na,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Oe-1)/Oe),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=t,s.strategy=o,s.method=n,mw(e)},gI=(e,t)=>gw(e,t,Uc,QC,eI,ZC),vI=(e,t)=>{if(Pl(e)||t>lw||t<0)return e?Ro(e,Pr):Pr;let n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===Cl&&t!==Zn)return Ro(e,e.avail_out===0?Qh:Pr);let r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(On(e),e.avail_out===0)return n.last_flush=-1,$t}else if(e.avail_in===0&&cw(t)<=cw(r)&&t!==Zn)return Ro(e,Qh);if(n.status===Cl&&e.avail_in!==0)return Ro(e,Qh);if(n.status===Na&&n.wrap===0&&(n.status=ko),n.status===Na){let i=Uc+(n.w_bits-8<<4)<<8,o=-1;if(n.strategy>=Nc||n.level<2?o=0:n.level<6?o=1:n.level===6?o=2:o=3,i|=o<<6,n.strstart!==0&&(i|=sI),i+=31-i%31,Tl(n,i),n.strstart!==0&&(Tl(n,e.adler>>>16),Tl(n,e.adler&65535)),e.adler=1,n.status=ko,On(e),n.pending!==0)return n.last_flush=-1,$t}if(n.status===lm){if(e.adler=0,Ve(n,31),Ve(n,139),Ve(n,8),n.gzhead)Ve(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ve(n,n.gzhead.time&255),Ve(n,n.gzhead.time>>8&255),Ve(n,n.gzhead.time>>16&255),Ve(n,n.gzhead.time>>24&255),Ve(n,n.level===9?2:n.strategy>=Nc||n.level<2?4:0),Ve(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Ve(n,n.gzhead.extra.length&255),Ve(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Xi(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=rm;else if(Ve(n,0),Ve(n,0),Ve(n,0),Ve(n,0),Ve(n,0),Ve(n,n.level===9?2:n.strategy>=Nc||n.level<2?4:0),Ve(n,lI),n.status=ko,On(e),n.pending!==0)return n.last_flush=-1,$t}if(n.status===rm){if(n.gzhead.extra){let i=n.pending,o=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+o>n.pending_buf_size;){let s=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=s,On(e),n.pending!==0)return n.last_flush=-1,$t;i=0,o-=s}let a=new Uint8Array(n.gzhead.extra);n.pending_buf.set(a.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending+=o,n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=im}if(n.status===im){if(n.gzhead.name){let i=n.pending,o;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i)),On(e),n.pending!==0)return n.last_flush=-1,$t;i=0}n.gzindex<n.gzhead.name.length?o=n.gzhead.name.charCodeAt(n.gzindex++)&255:o=0,Ve(n,o)}while(o!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=om}if(n.status===om){if(n.gzhead.comment){let i=n.pending,o;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i)),On(e),n.pending!==0)return n.last_flush=-1,$t;i=0}n.gzindex<n.gzhead.comment.length?o=n.gzhead.comment.charCodeAt(n.gzindex++)&255:o=0,Ve(n,o)}while(o!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Xi(e.adler,n.pending_buf,n.pending-i,i))}n.status=am}if(n.status===am){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(On(e),n.pending!==0))return n.last_flush=-1,$t;Ve(n,e.adler&255),Ve(n,e.adler>>8&255),e.adler=0}if(n.status=ko,On(e),n.pending!==0)return n.last_flush=-1,$t}if(e.avail_in!==0||n.lookahead!==0||t!==qi&&n.status!==Cl){let i=n.level===0?pw(n,t):n.strategy===Nc?fI(n,t):n.strategy===YC?dI(n,t):Il[n.level].func(n,t);if((i===Mo||i===za)&&(n.status=Cl),i===dn||i===Mo)return e.avail_out===0&&(n.last_flush=-1),$t;if(i===Ba&&(t===HC?VC(n):t!==lw&&(tm(n,0,0,!1),t===jC&&(Yi(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),On(e),e.avail_out===0))return n.last_flush=-1,$t}return t!==Zn?$t:n.wrap<=0?uw:(n.wrap===2?(Ve(n,e.adler&255),Ve(n,e.adler>>8&255),Ve(n,e.adler>>16&255),Ve(n,e.adler>>24&255),Ve(n,e.total_in&255),Ve(n,e.total_in>>8&255),Ve(n,e.total_in>>16&255),Ve(n,e.total_in>>24&255)):(Tl(n,e.adler>>>16),Tl(n,e.adler&65535)),On(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?$t:uw)},yI=e=>{if(Pl(e))return Pr;let t=e.state.status;return e.state=null,t===ko?Ro(e,WC):$t},SI=(e,t)=>{let n=t.length;if(Pl(e))return Pr;let r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==Na||r.lookahead)return Pr;if(i===1&&(e.adler=dw(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(Yi(r.head),r.strstart=0,r.block_start=0,r.insert=0);let l=new Uint8Array(r.w_size);l.set(t.subarray(n-r.w_size,n),0),t=l,n=r.w_size}let o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Ua(r);r.lookahead>=Oe;){let l=r.strstart,u=r.lookahead-(Oe-1);do r.ins_h=Ji(r,r.ins_h,r.window[l+Oe-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--u);r.strstart=l,r.lookahead=Oe-1,Ua(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Oe-1,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,r.wrap=i,$t};Dr.exports.deflateInit=gI;Dr.exports.deflateInit2=gw;Dr.exports.deflateReset=mw;Dr.exports.deflateResetKeep=hw;Dr.exports.deflateSetHeader=mI;Dr.exports.deflate=vI;Dr.exports.deflateEnd=yI;Dr.exports.deflateSetDictionary=SI;Dr.exports.deflateInfo="pako deflate (from Nodeca project)"});var cm=_e((Lk,um)=>{"use strict";var wI=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);um.exports.assign=function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(let r in n)wI(n,r)&&(e[r]=n[r])}}return e};um.exports.flattenChunks=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;let n=new Uint8Array(t);for(let r=0,i=0,o=e.length;r<o;r++){let a=e[r];n.set(a,i),i+=a.length}return n}});var dm=_e((kk,Bc)=>{"use strict";var yw=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){yw=!1}var Al=new Uint8Array(256);for(let e=0;e<256;e++)Al[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Al[254]=Al[254]=1;Bc.exports.string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,o,a=e.length,s=0;for(i=0;i<a;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<a&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<a&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|n&63):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|n&63):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|n&63);return t};var bI=(e,t)=>{if(t<65534&&e.subarray&&yw)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};Bc.exports.buf2string=(e,t)=>{let n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i,o=new Array(n*2);for(i=0,r=0;r<n;){let a=e[r++];if(a<128){o[i++]=a;continue}let s=Al[a];if(s>4){o[i++]=65533,r+=s-1;continue}for(a&=s===2?31:s===3?15:7;s>1&&r<n;)a=a<<6|e[r++]&63,s--;if(s>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return bI(o,i)};Bc.exports.utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Al[e[n]]>t?n:t}});var fm=_e((Rk,Sw)=>{"use strict";function _I(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}Sw.exports=_I});var xw=_e((Mk,Va)=>{"use strict";var Dl=vw(),ww=cm(),bw=dm(),pm=Fc(),xI=fm(),_w=Object.prototype.toString,{Z_NO_FLUSH:EI,Z_SYNC_FLUSH:TI,Z_FULL_FLUSH:CI,Z_FINISH:II,Z_OK:zc,Z_STREAM_END:PI,Z_DEFAULT_COMPRESSION:AI,Z_DEFAULT_STRATEGY:DI,Z_DEFLATED:LI}=$i();function Ll(e){this.options=ww.assign({level:AI,method:LI,chunkSize:16384,windowBits:15,memLevel:8,strategy:DI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new xI,this.strm.avail_out=0;let n=Dl.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==zc)throw new Error(pm[n]);if(t.header&&Dl.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=bw.string2buf(t.dictionary):_w.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=Dl.deflateSetDictionary(this.strm,r),n!==zc)throw new Error(pm[n]);this._dict_set=!0}}Ll.prototype.push=function(e,t){let n=this.strm,r=this.options.chunkSize,i,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?II:EI,typeof e=="string"?n.input=bw.string2buf(e):_w.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o===TI||o===CI)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=Dl.deflate(n,o),i===PI)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=Dl.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===zc;if(n.avail_out===0){this.onData(n.output);continue}if(o>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};Ll.prototype.onData=function(e){this.chunks.push(e)};Ll.prototype.onEnd=function(e){e===zc&&(this.result=ww.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function hm(e,t){let n=new Ll(t);if(n.push(e,!0),n.err)throw n.msg||pm[n.err];return n.result}function kI(e,t){return t=t||{},t.raw=!0,hm(e,t)}function RI(e,t){return t=t||{},t.gzip=!0,hm(e,t)}Va.exports.Deflate=Ll;Va.exports.deflate=hm;Va.exports.deflateRaw=kI;Va.exports.gzip=RI;Va.exports.constants=$i()});var Tw=_e((Ok,Ew)=>{"use strict";Ew.exports=function(t,n){let r,i,o,a,s,l,u,c,f,d,h,y,S,b,g,p,m,v,x,w,_,E,P,D,M=t.state;r=t.next_in,P=t.input,i=r+(t.avail_in-5),o=t.next_out,D=t.output,a=o-(n-t.avail_out),s=o+(t.avail_out-257),l=M.dmax,u=M.wsize,c=M.whave,f=M.wnext,d=M.window,h=M.hold,y=M.bits,S=M.lencode,b=M.distcode,g=(1<<M.lenbits)-1,p=(1<<M.distbits)-1;e:do{y<15&&(h+=P[r++]<<y,y+=8,h+=P[r++]<<y,y+=8),m=S[h&g];t:for(;;){if(v=m>>>24,h>>>=v,y-=v,v=m>>>16&255,v===0)D[o++]=m&65535;else if(v&16){x=m&65535,v&=15,v&&(y<v&&(h+=P[r++]<<y,y+=8),x+=h&(1<<v)-1,h>>>=v,y-=v),y<15&&(h+=P[r++]<<y,y+=8,h+=P[r++]<<y,y+=8),m=b[h&p];n:for(;;){if(v=m>>>24,h>>>=v,y-=v,v=m>>>16&255,v&16){if(w=m&65535,v&=15,y<v&&(h+=P[r++]<<y,y+=8,y<v&&(h+=P[r++]<<y,y+=8)),w+=h&(1<<v)-1,w>l){t.msg="invalid distance too far back",M.mode=16209;break e}if(h>>>=v,y-=v,v=o-a,w>v){if(v=w-v,v>c&&M.sane){t.msg="invalid distance too far back",M.mode=16209;break e}if(_=0,E=d,f===0){if(_+=u-v,v<x){x-=v;do D[o++]=d[_++];while(--v);_=o-w,E=D}}else if(f<v){if(_+=u+f-v,v-=f,v<x){x-=v;do D[o++]=d[_++];while(--v);if(_=0,f<x){v=f,x-=v;do D[o++]=d[_++];while(--v);_=o-w,E=D}}}else if(_+=f-v,v<x){x-=v;do D[o++]=d[_++];while(--v);_=o-w,E=D}for(;x>2;)D[o++]=E[_++],D[o++]=E[_++],D[o++]=E[_++],x-=3;x&&(D[o++]=E[_++],x>1&&(D[o++]=E[_++]))}else{_=o-w;do D[o++]=D[_++],D[o++]=D[_++],D[o++]=D[_++],x-=3;while(x>2);x&&(D[o++]=D[_++],x>1&&(D[o++]=D[_++]))}}else if((v&64)===0){m=b[(m&65535)+(h&(1<<v)-1)];continue n}else{t.msg="invalid distance code",M.mode=16209;break e}break}}else if((v&64)===0){m=S[(m&65535)+(h&(1<<v)-1)];continue t}else if(v&32){M.mode=16191;break e}else{t.msg="invalid literal/length code",M.mode=16209;break e}break}}while(r<i&&o<s);x=y>>3,r-=x,y-=x<<3,h&=(1<<y)-1,t.next_in=r,t.next_out=o,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=o<s?257+(s-o):257-(o-s),M.hold=h,M.bits=y}});var Iw=_e((Fk,Cw)=>{"use strict";var MI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),OI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),FI=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),NI=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),UI=(e,t,n,r,i,o,a,s)=>{let l=s.bits,u=0,c=0,f=0,d=0,h=0,y=0,S=0,b=0,g=0,p=0,m,v,x,w,_,E=null,P,D=new Uint16Array(16),M=new Uint16Array(16),j=null,N,L,O;for(u=0;u<=15;u++)D[u]=0;for(c=0;c<r;c++)D[t[n+c]]++;for(h=l,d=15;d>=1&&D[d]===0;d--);if(h>d&&(h=d),d===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,s.bits=1,0;for(f=1;f<d&&D[f]===0;f++);for(h<f&&(h=f),b=1,u=1;u<=15;u++)if(b<<=1,b-=D[u],b<0)return-1;if(b>0&&(e===0||d!==1))return-1;for(M[1]=0,u=1;u<15;u++)M[u+1]=M[u]+D[u];for(c=0;c<r;c++)t[n+c]!==0&&(a[M[t[n+c]]++]=c);if(e===0?(E=j=a,P=20):e===1?(E=MI,j=OI,P=257):(E=FI,j=NI,P=0),p=0,c=0,u=f,_=o,y=h,S=0,x=-1,g=1<<h,w=g-1,e===1&&g>852||e===2&&g>592)return 1;for(;;){N=u-S,a[c]+1<P?(L=0,O=a[c]):a[c]>=P?(L=j[a[c]-P],O=E[a[c]-P]):(L=96,O=0),m=1<<u-S,v=1<<y,f=v;do v-=m,i[_+(p>>S)+v]=N<<24|L<<16|O|0;while(v!==0);for(m=1<<u-1;p&m;)m>>=1;if(m!==0?(p&=m-1,p+=m):p=0,c++,--D[u]===0){if(u===d)break;u=t[n+a[c]]}if(u>h&&(p&w)!==x){for(S===0&&(S=h),_+=f,y=u-S,b=1<<y;y+S<d&&(b-=D[y+S],!(b<=0));)y++,b<<=1;if(g+=1<<y,e===1&&g>852||e===2&&g>592)return 1;x=p&w,i[x]=h<<24|y<<16|_-o|0}}return p!==0&&(i[_+p]=u-S<<24|64<<16|0),s.bits=h,0};Cw.exports=UI});var lb=_e((Nk,cr)=>{"use strict";var wm=qh(),Lr=Jh(),BI=Tw(),kl=Iw(),zI=0,Qw=1,eb=2,{Z_FINISH:Pw,Z_BLOCK:VI,Z_TREES:Vc,Z_OK:Oo,Z_STREAM_END:GI,Z_NEED_DICT:HI,Z_STREAM_ERROR:qn,Z_DATA_ERROR:tb,Z_MEM_ERROR:bm,Z_BUF_ERROR:jI,Z_DEFLATED:Aw}=$i(),Wc=16180,Dw=16181,Lw=16182,kw=16183,Rw=16184,Mw=16185,Ow=16186,Fw=16187,Nw=16188,Uw=16189,jc=16190,ii=16191,mm=16192,Bw=16193,gm=16194,zw=16195,Vw=16196,Gw=16197,Hw=16198,Gc=16199,Hc=16200,jw=16201,Ww=16202,$w=16203,Xw=16204,Yw=16205,vm=16206,Kw=16207,Zw=16208,ct=16209,_m=16210,nb=16211,WI=852,$I=592,XI=15,YI=XI,qw=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function KI(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Fo=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<Wc||t.mode>nb?1:0},rb=e=>{if(Fo(e))return qn;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Wc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(WI),t.distcode=t.distdyn=new Int32Array($I),t.sane=1,t.back=-1,Oo},ib=e=>{if(Fo(e))return qn;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,rb(e)},ob=(e,t)=>{let n;if(Fo(e))return qn;let r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?qn:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,ib(e))},ab=(e,t)=>{if(!e)return qn;let n=new KI;e.state=n,n.strm=e,n.window=null,n.mode=Wc;let r=ob(e,t);return r!==Oo&&(e.state=null),r},ZI=e=>ab(e,YI),Jw=!0,ym,Sm,qI=e=>{if(Jw){ym=new Int32Array(512),Sm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(kl(Qw,e.lens,0,288,ym,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;kl(eb,e.lens,0,32,Sm,0,e.work,{bits:5}),Jw=!1}e.lencode=ym,e.lenbits=9,e.distcode=Sm,e.distbits=5},sb=(e,t,n,r)=>{let i,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),r-=i,r?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},JI=(e,t)=>{let n,r,i,o,a,s,l,u,c,f,d,h,y,S,b=0,g,p,m,v,x,w,_,E,P=new Uint8Array(4),D,M,j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Fo(e)||!e.output||!e.input&&e.avail_in!==0)return qn;n=e.state,n.mode===ii&&(n.mode=mm),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,u=n.hold,c=n.bits,f=s,d=l,E=Oo;e:for(;;)switch(n.mode){case Wc:if(n.wrap===0){n.mode=mm;break}for(;c<16;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,P[0]=u&255,P[1]=u>>>8&255,n.check=Lr(n.check,P,2,0),u=0,c=0,n.mode=Dw;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=ct;break}if((u&15)!==Aw){e.msg="unknown compression method",n.mode=ct;break}if(u>>>=4,c-=4,_=(u&15)+8,n.wbits===0&&(n.wbits=_),_>15||_>n.wbits){e.msg="invalid window size",n.mode=ct;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=u&512?Uw:ii,u=0,c=0;break;case Dw:for(;c<16;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(n.flags=u,(n.flags&255)!==Aw){e.msg="unknown compression method",n.mode=ct;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=ct;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,n.check=Lr(n.check,P,2,0)),u=0,c=0,n.mode=Lw;case Lw:for(;c<32;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,P[2]=u>>>16&255,P[3]=u>>>24&255,n.check=Lr(n.check,P,4,0)),u=0,c=0,n.mode=kw;case kw:for(;c<16;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,n.check=Lr(n.check,P,2,0)),u=0,c=0,n.mode=Rw;case Rw:if(n.flags&1024){for(;c<16;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,n.check=Lr(n.check,P,2,0)),u=0,c=0}else n.head&&(n.head.extra=null);n.mode=Mw;case Mw:if(n.flags&1024&&(h=n.length,h>s&&(h=s),h&&(n.head&&(_=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+h),_)),n.flags&512&&n.wrap&4&&(n.check=Lr(n.check,r,h,o)),s-=h,o+=h,n.length-=h),n.length))break e;n.length=0,n.mode=Ow;case Ow:if(n.flags&2048){if(s===0)break e;h=0;do _=r[o+h++],n.head&&_&&n.length<65536&&(n.head.name+=String.fromCharCode(_));while(_&&h<s);if(n.flags&512&&n.wrap&4&&(n.check=Lr(n.check,r,h,o)),s-=h,o+=h,_)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Fw;case Fw:if(n.flags&4096){if(s===0)break e;h=0;do _=r[o+h++],n.head&&_&&n.length<65536&&(n.head.comment+=String.fromCharCode(_));while(_&&h<s);if(n.flags&512&&n.wrap&4&&(n.check=Lr(n.check,r,h,o)),s-=h,o+=h,_)break e}else n.head&&(n.head.comment=null);n.mode=Nw;case Nw:if(n.flags&512){for(;c<16;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(n.wrap&4&&u!==(n.check&65535)){e.msg="header crc mismatch",n.mode=ct;break}u=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=ii;break;case Uw:for(;c<32;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}e.adler=n.check=qw(u),u=0,c=0,n.mode=jc;case jc:if(n.havedict===0)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=c,HI;e.adler=n.check=1,n.mode=ii;case ii:if(t===VI||t===Vc)break e;case mm:if(n.last){u>>>=c&7,c-=c&7,n.mode=vm;break}for(;c<3;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}switch(n.last=u&1,u>>>=1,c-=1,u&3){case 0:n.mode=Bw;break;case 1:if(qI(n),n.mode=Gc,t===Vc){u>>>=2,c-=2;break e}break;case 2:n.mode=Vw;break;case 3:e.msg="invalid block type",n.mode=ct}u>>>=2,c-=2;break;case Bw:for(u>>>=c&7,c-=c&7;c<32;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ct;break}if(n.length=u&65535,u=0,c=0,n.mode=gm,t===Vc)break e;case gm:n.mode=zw;case zw:if(h=n.length,h){if(h>s&&(h=s),h>l&&(h=l),h===0)break e;i.set(r.subarray(o,o+h),a),s-=h,o+=h,l-=h,a+=h,n.length-=h;break}n.mode=ii;break;case Vw:for(;c<14;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(n.nlen=(u&31)+257,u>>>=5,c-=5,n.ndist=(u&31)+1,u>>>=5,c-=5,n.ncode=(u&15)+4,u>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ct;break}n.have=0,n.mode=Gw;case Gw:for(;n.have<n.ncode;){for(;c<3;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.lens[j[n.have++]]=u&7,u>>>=3,c-=3}for(;n.have<19;)n.lens[j[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},E=kl(zI,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,E){e.msg="invalid code lengths set",n.mode=ct;break}n.have=0,n.mode=Hw;case Hw:for(;n.have<n.nlen+n.ndist;){for(;b=n.lencode[u&(1<<n.lenbits)-1],g=b>>>24,p=b>>>16&255,m=b&65535,!(g<=c);){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(m<16)u>>>=g,c-=g,n.lens[n.have++]=m;else{if(m===16){for(M=g+2;c<M;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(u>>>=g,c-=g,n.have===0){e.msg="invalid bit length repeat",n.mode=ct;break}_=n.lens[n.have-1],h=3+(u&3),u>>>=2,c-=2}else if(m===17){for(M=g+3;c<M;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}u>>>=g,c-=g,_=0,h=3+(u&7),u>>>=3,c-=3}else{for(M=g+7;c<M;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}u>>>=g,c-=g,_=0,h=11+(u&127),u>>>=7,c-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ct;break}for(;h--;)n.lens[n.have++]=_}}if(n.mode===ct)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=ct;break}if(n.lenbits=9,D={bits:n.lenbits},E=kl(Qw,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,E){e.msg="invalid literal/lengths set",n.mode=ct;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},E=kl(eb,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,E){e.msg="invalid distances set",n.mode=ct;break}if(n.mode=Gc,t===Vc)break e;case Gc:n.mode=Hc;case Hc:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=c,BI(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,u=n.hold,c=n.bits,n.mode===ii&&(n.back=-1);break}for(n.back=0;b=n.lencode[u&(1<<n.lenbits)-1],g=b>>>24,p=b>>>16&255,m=b&65535,!(g<=c);){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(p&&(p&240)===0){for(v=g,x=p,w=m;b=n.lencode[w+((u&(1<<v+x)-1)>>v)],g=b>>>24,p=b>>>16&255,m=b&65535,!(v+g<=c);){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}u>>>=v,c-=v,n.back+=v}if(u>>>=g,c-=g,n.back+=g,n.length=m,p===0){n.mode=Yw;break}if(p&32){n.back=-1,n.mode=ii;break}if(p&64){e.msg="invalid literal/length code",n.mode=ct;break}n.extra=p&15,n.mode=jw;case jw:if(n.extra){for(M=n.extra;c<M;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Ww;case Ww:for(;b=n.distcode[u&(1<<n.distbits)-1],g=b>>>24,p=b>>>16&255,m=b&65535,!(g<=c);){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if((p&240)===0){for(v=g,x=p,w=m;b=n.distcode[w+((u&(1<<v+x)-1)>>v)],g=b>>>24,p=b>>>16&255,m=b&65535,!(v+g<=c);){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}u>>>=v,c-=v,n.back+=v}if(u>>>=g,c-=g,n.back+=g,p&64){e.msg="invalid distance code",n.mode=ct;break}n.offset=m,n.extra=p&15,n.mode=$w;case $w:if(n.extra){for(M=n.extra;c<M;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ct;break}n.mode=Xw;case Xw:if(l===0)break e;if(h=d-l,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ct;break}h>n.wnext?(h-=n.wnext,y=n.wsize-h):y=n.wnext-h,h>n.length&&(h=n.length),S=n.window}else S=i,y=a-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do i[a++]=S[y++];while(--h);n.length===0&&(n.mode=Hc);break;case Yw:if(l===0)break e;i[a++]=n.length,l--,n.mode=Hc;break;case vm:if(n.wrap){for(;c<32;){if(s===0)break e;s--,u|=r[o++]<<c,c+=8}if(d-=l,e.total_out+=d,n.total+=d,n.wrap&4&&d&&(e.adler=n.check=n.flags?Lr(n.check,i,d,a-d):wm(n.check,i,d,a-d)),d=l,n.wrap&4&&(n.flags?u:qw(u))!==n.check){e.msg="incorrect data check",n.mode=ct;break}u=0,c=0}n.mode=Kw;case Kw:if(n.wrap&&n.flags){for(;c<32;){if(s===0)break e;s--,u+=r[o++]<<c,c+=8}if(n.wrap&4&&u!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=ct;break}u=0,c=0}n.mode=Zw;case Zw:E=GI;break e;case ct:E=tb;break e;case _m:return bm;case nb:default:return qn}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=c,(n.wsize||d!==e.avail_out&&n.mode<ct&&(n.mode<vm||t!==Pw))&&sb(e,e.output,e.next_out,d-e.avail_out)?(n.mode=_m,bm):(f-=e.avail_in,d-=e.avail_out,e.total_in+=f,e.total_out+=d,n.total+=d,n.wrap&4&&d&&(e.adler=n.check=n.flags?Lr(n.check,i,d,e.next_out-d):wm(n.check,i,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(n.mode===ii?128:0)+(n.mode===Gc||n.mode===gm?256:0),(f===0&&d===0||t===Pw)&&E===Oo&&(E=jI),E)},QI=e=>{if(Fo(e))return qn;let t=e.state;return t.window&&(t.window=null),e.state=null,Oo},eP=(e,t)=>{if(Fo(e))return qn;let n=e.state;return(n.wrap&2)===0?qn:(n.head=t,t.done=!1,Oo)},tP=(e,t)=>{let n=t.length,r,i,o;return Fo(e)||(r=e.state,r.wrap!==0&&r.mode!==jc)?qn:r.mode===jc&&(i=1,i=wm(i,t,n,0),i!==r.check)?tb:(o=sb(e,t,n,n),o?(r.mode=_m,bm):(r.havedict=1,Oo))};cr.exports.inflateReset=ib;cr.exports.inflateReset2=ob;cr.exports.inflateResetKeep=rb;cr.exports.inflateInit=ZI;cr.exports.inflateInit2=ab;cr.exports.inflate=JI;cr.exports.inflateEnd=QI;cr.exports.inflateGetHeader=eP;cr.exports.inflateSetDictionary=tP;cr.exports.inflateInfo="pako inflate (from Nodeca project)"});var cb=_e((Uk,ub)=>{"use strict";function nP(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}ub.exports=nP});var hb=_e((Bk,Ga)=>{"use strict";var oi=lb(),fb=cm(),Tm=dm(),Cm=Fc(),rP=fm(),iP=cb(),pb=Object.prototype.toString,{Z_NO_FLUSH:oP,Z_FINISH:aP,Z_OK:Rl,Z_STREAM_END:xm,Z_NEED_DICT:Em,Z_STREAM_ERROR:sP,Z_DATA_ERROR:db,Z_MEM_ERROR:lP}=$i();function Ml(e){this.options=fb.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new rP,this.strm.avail_out=0;let n=oi.inflateInit2(this.strm,t.windowBits);if(n!==Rl)throw new Error(Cm[n]);if(this.header=new iP,oi.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Tm.string2buf(t.dictionary):pb.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=oi.inflateSetDictionary(this.strm,t.dictionary),n!==Rl)))throw new Error(Cm[n])}Ml.prototype.push=function(e,t){let n=this.strm,r=this.options.chunkSize,i=this.options.dictionary,o,a,s;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?aP:oP,pb.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),o=oi.inflate(n,a),o===Em&&i&&(o=oi.inflateSetDictionary(n,i),o===Rl?o=oi.inflate(n,a):o===db&&(o=Em));n.avail_in>0&&o===xm&&n.state.wrap>0&&e[n.next_in]!==0;)oi.inflateReset(n),o=oi.inflate(n,a);switch(o){case sP:case db:case Em:case lP:return this.onEnd(o),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(n.avail_out===0||o===xm))if(this.options.to==="string"){let l=Tm.utf8border(n.output,n.next_out),u=n.next_out-l,c=Tm.buf2string(n.output,l);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(l,l+u),0),this.onData(c)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(o===Rl&&s===0)){if(o===xm)return o=oi.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Ml.prototype.onData=function(e){this.chunks.push(e)};Ml.prototype.onEnd=function(e){e===Rl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Im(e,t){let n=new Ml(t);if(n.push(e),n.err)throw n.msg||Cm[n.err];return n.result}function uP(e,t){return t=t||{},t.raw=!0,Im(e,t)}Ga.exports.Inflate=Ml;Ga.exports.inflate=Im;Ga.exports.inflateRaw=uP;Ga.exports.ungzip=Im;Ga.exports.constants=$i()});var Pm=_e((zk,kr)=>{"use strict";var{Deflate:cP,deflate:dP,deflateRaw:fP,gzip:pP}=xw(),{Inflate:hP,inflate:mP,inflateRaw:gP,ungzip:vP}=hb(),yP=$i();kr.exports.Deflate=cP;kr.exports.deflate=dP;kr.exports.deflateRaw=fP;kr.exports.gzip=pP;kr.exports.Inflate=hP;kr.exports.inflate=mP;kr.exports.inflateRaw=gP;kr.exports.ungzip=vP;kr.exports.constants=yP});var Qi=_e(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.initializeCanvas=ee.createImageData=ee.createCanvasFromData=ee.createCanvas=ee.writeDataZipWithoutPrediction=ee.writeDataRLE=ee.writeDataRaw=ee.decodeBitmap=ee.imageDataToCanvas=ee.resetImageData=ee.hasAlpha=ee.clamp=ee.offsetForChannel=ee.Compression=ee.ChannelID=ee.MaskParams=ee.LayerMaskFlags=ee.ColorSpace=ee.createEnum=ee.revMap=ee.largeAdditionalInfoKeys=ee.layerColors=ee.toBlendMode=ee.fromBlendMode=ee.RAW_IMAGE_DATA=ee.MOCK_HANDLERS=void 0;var SP=yl(),wP=Pm();ee.MOCK_HANDLERS=!1;ee.RAW_IMAGE_DATA=!1;ee.fromBlendMode={};ee.toBlendMode={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"};Object.keys(ee.toBlendMode).forEach(function(e){return ee.fromBlendMode[ee.toBlendMode[e]]=e});ee.layerColors=["none","red","orange","yellow","green","blue","violet","gray"];ee.largeAdditionalInfoKeys=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"];function mb(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}ee.revMap=mb;function bP(e,t,n){var r=mb(n),i=function(a){var s=a.split(".")[1];if(s&&!r[s])throw new Error("Unrecognized value for enum: '".concat(a,"'"));return r[s]||t},o=function(a){if(a&&!n[a])throw new Error("Invalid value for enum: '".concat(a,"'"));return"".concat(e,".").concat(n[a]||n[t])};return{decode:i,encode:o}}ee.createEnum=bP;var _P;(function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"})(_P=ee.ColorSpace||(ee.ColorSpace={}));var xP;(function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"})(xP=ee.LayerMaskFlags||(ee.LayerMaskFlags={}));var EP;(function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"})(EP=ee.MaskParams||(ee.MaskParams={}));var TP;(function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"})(TP=ee.ChannelID||(ee.ChannelID={}));var CP;(function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"})(CP=ee.Compression||(ee.Compression={}));function IP(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}}ee.offsetForChannel=IP;function PP(e,t,n){return e<t?t:e>n?n:e}ee.clamp=PP;function AP(e){for(var t=e.width*e.height*4,n=3;n<t;n+=4)if(e.data[n]!==255)return!0;return!1}ee.hasAlpha=AP;function DP(e){for(var t=e.data,n=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,r=0,i=t.length|0;r<i;r=r+4|0)t[r+0]=0,t[r+1]=0,t[r+2]=0,t[r+3]=n}ee.resetImageData=DP;function LP(e){var t=(0,ee.createCanvas)(e.width,e.height),n;if(e.data instanceof Uint8ClampedArray)n=e;else{n=(0,ee.createImageData)(e.width,e.height);var r=e.data,i=n.data;if(r instanceof Float32Array)for(var o=0,a=r.length;o<a;o+=4)i[o+0]=Math.round(Math.pow(r[o+0],1/2.2)*255),i[o+1]=Math.round(Math.pow(r[o+1],1/2.2)*255),i[o+2]=Math.round(Math.pow(r[o+2],1/2.2)*255),i[o+3]=Math.round(r[o+3]*255);else for(var s=r instanceof Uint16Array?8:0,o=0,a=r.length;o<a;o++)i[o]=r[o]>>>s}return t.getContext("2d").putImageData(n,0,0),t}ee.imageDataToCanvas=LP;function kP(e,t,n,r){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var i=0,o=0,a=0;i<r;i++)for(var s=0;s<n;)for(var l=e[a++],u=0;u<8&&s<n;u++,s++,o+=4){var c=l&128?0:255;l=l<<1,t[o+0]=c,t[o+1]=c,t[o+2]=c,t[o+3]=255}}ee.decodeBitmap=kP;function RP(e,t,n,r){if(!(!n||!r)){for(var i=new Uint8Array(n*r),o=0;o<i.length;o++)i[o]=e.data[o*4+t];return i}}ee.writeDataRaw=RP;function MP(e,t,n,r){var i=t.data,o=t.width,a=t.height;if(!(!o||!a)){for(var s=4*o|0,l=0,u=n.length*(r?4:2)*a|0,c=0,f=n;c<f.length;c++)for(var d=f[c],h=0,y=d|0;h<a;h++){var S=h*s|0,b=S+s|0,g=b+d-4|0,p=g-4|0,m=u;for(y=S+d|0;y<b;y=y+4|0)if(y<p){var v=i[y];y=y+4|0;var x=i[y];y=y+4|0;var w=i[y];if(v===x&&v===w){for(var _=3;_<128&&y<g&&i[y+4|0]===v;)_=_+1|0,y=y+4|0;e[u++]=1-_,e[u++]=v}else{var E=u,P=!0,_=1;for(e[u++]=0,e[u++]=v;y<g&&_<128;)if(y=y+4|0,v=x,x=w,w=i[y],v===x&&v===w){y=y-12|0,P=!1;break}else _++,e[u++]=v;P&&(_<127?(e[u++]=x,e[u++]=w,_+=2):_<128?(e[u++]=x,_++,y=y-4|0):y=y-8|0),e[E]=_-1}}else y===g?(e[u++]=0,e[u++]=i[y]):(e[u++]=1,e[u++]=i[y],y=y+4|0,e[u++]=i[y]);var D=u-m;r&&(e[l++]=D>>24&255,e[l++]=D>>16&255),e[l++]=D>>8&255,e[l++]=D&255}return e.slice(0,u)}}ee.writeDataRLE=MP;function OP(e,t){for(var n=e.data,r=e.width,i=e.height,o=r*i,a=new Uint8Array(o),s=[],l=0,u=0,c=t;u<c.length;u++){for(var f=c[u],d=0,h=f;d<o;d++,h+=4)a[d]=n[h];var y=(0,wP.deflate)(a);s.push(y),l+=y.byteLength}if(s.length>0){for(var y=new Uint8Array(l),f=0,S=0,b=s;S<b.length;S++){var g=b[S];y.set(g,f),f+=g.byteLength}return y}else return s[0]}ee.writeDataZipWithoutPrediction=OP;var FP=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")};ee.createCanvas=FP;var NP=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvasFromData method")};ee.createCanvasFromData=NP;var Am=void 0,UP=function(e,t){return Am||(Am=(0,ee.createCanvas)(1,1)),Am.getContext("2d").createImageData(e,t)};ee.createImageData=UP;typeof document!="undefined"&&(ee.createCanvas=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},ee.createCanvasFromData=function(e){var t=new Image;t.src="data:image/jpeg;base64,"+(0,SP.fromByteArray)(e);var n=document.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),n});function BP(e,t,n){ee.createCanvas=e,ee.createCanvasFromData=t||ee.createCanvasFromData,ee.createImageData=n||ee.createImageData}ee.initializeCanvas=BP});var Sb=_e(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.decodeString=Rr.encodeString=Rr.encodeStringTo=Rr.stringLengthInBytes=void 0;function Dm(e){return(e&4294967168)===0?1:(e&4294965248)===0?2:(e&4294901760)===0?3:4}function vb(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319){if(n+1<e.length){var i=e.charCodeAt(n+1);(i&64512)===56320&&(n++,t+=Dm(((r&1023)<<10)+(i&1023)+65536))}}else t+=Dm(r)}return t}Rr.stringLengthInBytes=vb;function gb(e,t,n){var r=Dm(n);switch(r){case 1:e[t]=n;break;case 2:e[t]=n>>6&31|192,e[t+1]=n&63|128;break;case 3:e[t]=n>>12&15|224,e[t+1]=n>>6&63|128,e[t+2]=n&63|128;break;default:e[t]=n>>18&7|240,e[t+1]=n>>12&63|128,e[t+2]=n>>6&63|128,e[t+3]=n&63|128;break}return r}function yb(e,t,n){for(var r=0;r<n.length;r++){var i=n.charCodeAt(r);if(i>=55296&&i<=56319){if(r+1<n.length){var o=n.charCodeAt(r+1);if((o&64512)===56320){r++;var a=((i&1023)<<10)+(o&1023)+65536;t+=gb(e,t,a)}}}else t+=gb(e,t,i)}return t}Rr.encodeStringTo=yb;function zP(e){if(e.length>1e3&&typeof TextEncoder!="undefined")return new TextEncoder().encode(e);var t=new Uint8Array(vb(e));return yb(t,0,e),t}Rr.encodeString=zP;function Ha(e,t){if(t>=e.length)throw Error("Invalid byte index");var n=e[t];if((n&192)===128)return n&63;throw Error("Invalid continuation byte")}function VP(e){if(e.byteLength>1e3&&typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var t=[],n=0;n<e.length;){var r=e[n++],i=void 0;if((r&128)===0)i=r;else if((r&224)===192){var o=Ha(e,n++);if(i=(r&31)<<6|o,i<128)throw Error("Invalid continuation byte")}else if((r&240)===224){var o=Ha(e,n++),a=Ha(e,n++);if(i=(r&15)<<12|o<<6|a,i<2048)throw Error("Invalid continuation byte");if(i>=55296&&i<=57343)throw Error("Lone surrogate U+".concat(i.toString(16).toUpperCase()," is not a scalar value"))}else if((r&248)===240){var o=Ha(e,n++),a=Ha(e,n++),s=Ha(e,n++);if(i=(r&15)<<18|o<<12|a<<6|s,i<65536||i>1114111)throw Error("Invalid continuation byte")}else throw Error("Invalid UTF-8 detected");i>65535&&(i-=65536,t.push(String.fromCharCode(i>>>10&1023|55296)),i=56320|i&1023),t.push(String.fromCharCode(i))}return t.join("")}Rr.decodeString=VP});var ed=_e(k=>{"use strict";var ai=k&&k.__assign||function(){return ai=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},ai.apply(this,arguments)},GP=k&&k.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};Object.defineProperty(k,"__esModule",{value:!0});k.ESliceOrigin=k.ESliceVertAlign=k.ESliceHorzAlign=k.ESliceType=k.FrFl=k.FStl=k.ClrS=k.gradientInterpolationMethodType=k.stdTrackID=k.animInterpStyleEnum=k.GrdT=k.IGSr=k.BETE=k.BESs=k.bvlT=k.BESl=k.BlnM=k.warpStyle=k.Annt=k.Ornt=k.textGridding=k.frac=k.unitsValue=k.unitsPercentF=k.unitsPercent=k.unitsAngle=k.parseUnitsToNumber=k.parseUnitsOrNumber=k.parseUnits=k.parsePercentOrAngle=k.parsePercent=k.parseAngle=k.serializeColor=k.parseColor=k.serializeVectorContent=k.parseVectorContent=k.serializeTrackList=k.parseTrackList=k.parseEffects=k.serializeEffects=k.boundsToDescBounds=k.descBoundsToBounds=k.xyToHorzVrtc=k.horzVrtcToXY=k.writeVersionAndDescriptor=k.readVersionAndDescriptor=k.writeDescriptorStructure=k.readDescriptorStructure=k.readAsciiStringOrClassId=k.setLogErrors=void 0;k.presetKindType=k.prjM=k.FlMd=k.IntC=k.IntE=k.Drct=k.WndM=k.CntE=k.FlCl=k.ExtR=k.ExtT=k.DfsM=k.blurType=k.Lns=k.MztT=k.Chnl=k.Dstr=k.ZZTy=k.Wvtp=k.SphM=k.RplS=k.Cnvr=k.UndA=k.DspM=k.SmBQ=k.SmBM=k.BlrQ=k.BlrM=k.strokeStyleLineAlignment=k.strokeStyleLineJoinType=k.strokeStyleLineCapType=k.ESliceBGColorType=void 0;var ve=Qi(),Ce=eo(),ke=Wa();function HP(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}var Ol={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},$c=HP(Ol),Fl=!1;function jP(e){Fl=e}k.setLogErrors=jP;function Z(e,t){return{name:e,classID:t}}var Le=Z("","null"),Lm=!1,Cb={strokeStyleContent:Z("","solidColorLayer"),printProofSetup:Z(Lm?"\u6821\u6837\u8BBE\u7F6E":"Proof Setup","proofSetup"),Grad:Z(Lm?"\u6E10\u53D8":"Gradient","Grdn"),Trnf:Z(Lm?"\u53D8\u6362":"Transform","Trnf"),patternFill:Z("","patternFill"),ebbl:Z("","ebbl"),SoFi:Z("","SoFi"),GrFl:Z("","GrFl"),sdwC:Z("","RGBC"),hglC:Z("","RGBC"),"Clr ":Z("","RGBC"),tintColor:Z("","RGBC"),Ofst:Z("","Pnt "),ChFX:Z("","ChFX"),MpgS:Z("","ShpC"),DrSh:Z("","DrSh"),IrSh:Z("","IrSh"),OrGl:Z("","OrGl"),IrGl:Z("","IrGl"),TrnS:Z("","ShpC"),Ptrn:Z("","Ptrn"),FrFX:Z("","FrFX"),phase:Z("","Pnt "),frameStep:Le,duration:Le,workInTime:Le,workOutTime:Le,audioClipGroupList:Le,bounds:Z("","Rctn"),customEnvelopeWarp:Z("","customEnvelopeWarp"),warp:Z("","warp"),"Sz  ":Z("","Pnt "),origin:Z("","Pnt "),autoExpandOffset:Z("","Pnt "),keyOriginShapeBBox:Z("","unitRect"),Vrsn:Le,psVersion:Le,docDefaultNewArtboardBackgroundColor:Z("","RGBC"),artboardRect:Z("","classFloatRect"),keyOriginRRectRadii:Z("","radii"),keyOriginBoxCorners:Le,rectangleCornerA:Z("","Pnt "),rectangleCornerB:Z("","Pnt "),rectangleCornerC:Z("","Pnt "),rectangleCornerD:Z("","Pnt "),compInfo:Le,quiltWarp:Z("","quiltWarp"),generatorSettings:Le,crema:Le,FrIn:Le,blendOptions:Le,FXRf:Le,Lefx:Le,time:Le,animKey:Le,timeScope:Le,inTime:Le,outTime:Le,sheetStyle:Le,translation:Le,Skew:Le,boundingBox:Z("","boundingBox"),"Lnk ":Z("","ExternalFileLink"),frameReader:Z("","FrameReader"),effectParams:Z("","motionTrackEffectParams"),Impr:Z("None","none"),Anch:Z("","Pnt "),"Fwd ":Z("","Pnt "),"Bwd ":Z("","Pnt "),FlrC:Z("","Pnt "),meshBoundaryPath:Z("","pathClass"),filterFX:Z("","filterFXStyle"),Fltr:Z("","rigidTransform"),FrgC:Z("","RGBC"),BckC:Z("","RGBC"),sdwM:Z("Parameters","adaptCorrectTones"),hglM:Z("Parameters","adaptCorrectTones"),customShape:Z("","customShape"),origFXRefPoint:Le,FXRefPoint:Le,ClMg:Z("","ClMg")},Ib={"Crv ":Z("","CrPt"),Clrs:Z("","Clrt"),Trns:Z("","TrnS"),keyDescriptorList:Le,solidFillMulti:Z("","SoFi"),gradientFillMulti:Z("","GrFl"),dropShadowMulti:Z("","DrSh"),innerShadowMulti:Z("","IrSh"),frameFXMulti:Z("","FrFX"),FrIn:Le,FSts:Le,LaSt:Le,sheetTimelineOptions:Le,trackList:Z("","animationTrack"),globalTrackList:Z("","animationTrack"),keyList:Le,audioClipGroupList:Le,audioClipList:Le,countObjectList:Z("","countObject"),countGroupList:Z("","countGroup"),slices:Z("","slice"),"Pts ":Z("","Pthp"),SbpL:Z("","SbpL"),pathComponents:Z("","PaCm"),filterFXList:Z("","filterFX"),puppetShapeList:Z("","puppetShape"),channelDenoise:Z("","channelDenoiseParams"),ShrP:Z("","Pnt "),layerSettings:Le,list:Le,Adjs:Z("","CrvA")},wb={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment","originalPath"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ","placedLayerOCIOConversion","gradientsInterpolationMethod"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy","Cnty"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList","Adjs"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},WP=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],Pb={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long",Chnl:"enum"},Qc={};for(Xc=0,km=Object.keys(wb);Xc<km.length;Xc++)for(Rm=km[Xc],Yc=0,Mm=wb[Rm];Yc<Mm.length;Yc++)li=Mm[Yc],Qc[li]=Rm;var Rm,li,Yc,Mm,Xc,km;for(Kc=0,Om=Object.keys(Cb);Kc<Om.length;Kc++)li=Om[Kc],Qc[li]||(Qc[li]="Objc");var li,Kc,Om;for(Zc=0,Fm=Object.keys(Ib);Zc<Fm.length;Zc++)li=Fm[Zc],Pb[li]="Objc";var li,Zc,Fm;function $P(e,t,n,r){return e==="presetKind"?typeof t=="string"?"enum":"long":e==="null"&&n==="slices"?"TEXT":e==="groupID"?n==="slices"?"long":"TEXT":e==="Sz  "?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":e==="Type"?typeof t=="string"?"enum":"long":e==="AntA"?typeof t=="string"?"enum":"bool":(e==="Hrzn"||e==="Vrtc")&&(r.Type==="keyType.Pstn"||r._classID==="Ofst")?"long":e==="Hrzn"||e==="Vrtc"||e==="Top "||e==="Left"||e==="Btom"||e==="Rght"?n==="slices"?"long":typeof t=="number"?"doub":"UntF":e==="Vrsn"?typeof t=="number"?"long":"Objc":e==="Rd  "||e==="Grn "||e==="Bl  "?n==="artd"?"long":"doub":e==="Trnf"?Array.isArray(t)?"VlLs":"Objc":Qc[e]}function Mr(e){var t=(0,Ce.readInt32)(e);return(0,Ce.readAsciiString)(e,t||4)}k.readAsciiStringOrClassId=Mr;function si(e,t){if(t.length===4&&t!=="warp"&&t!=="time"&&t!=="hold"&&t!=="list")(0,ke.writeInt32)(e,0),(0,ke.writeSignature)(e,t);else{(0,ke.writeInt32)(e,t.length);for(var n=0;n<t.length;n++)(0,ke.writeUint8)(e,t.charCodeAt(n))}}function Um(e,t){for(var n=No(e),r=t?{_name:n.name,_classID:n.classID}:{},i=(0,Ce.readUint32)(e),o=0;o<i;o++){var a=Mr(e),s=(0,Ce.readSignature)(e),l=Ab(e,s,t);r[a]=l}return r}k.readDescriptorStructure=Um;function Bm(e,t,n,r,i){Fl&&!n&&console.log("Missing classId for: ",t,n,r),(0,ke.writeUnicodeStringWithPadding)(e,t),si(e,n);var o=Object.keys(r),a=o.length;"_name"in r&&a--,"_classID"in r&&a--,(0,ke.writeUint32)(e,a);for(var s=0,l=o;s<l.length;s++){var u=l[s];if(!(u==="_name"||u==="_classID")){var c=$P(u,r[u],i,r),f=Cb[u];u==="bounds"&&i==="text"?f=Z("","bounds"):u==="origin"?c=i==="slices"?"enum":"Objc":(u==="Cyn "||u==="Mgnt"||u==="Ylw "||u==="Blck")&&r._classID==="CMYC"?c="doub":/^PN[a-z][a-z]$/.test(u)?c="TEXT":/^PT[a-z][a-z]$/.test(u)?c="long":/^PF[a-z][a-z]$/.test(u)||(u==="Rds "||u==="Thsh")&&typeof r[u]=="number"&&r._classID==="SmrB"?c="doub":u==="ClSz"||u==="Rds "||u==="Amnt"?c=typeof r[u]=="number"?"long":"UntF":(u==="sdwM"||u==="hglM")&&typeof r[u]=="string"||u==="blur"&&typeof r[u]=="string"?c="enum":u==="Hght"&&typeof r[u]=="number"&&r._classID==="Embs"||u==="Angl"&&typeof r[u]=="number"&&(r._classID==="Embs"||r._classID==="smartSharpen"||r._classID==="Twrl"||r._classID==="MtnB")?c="long":u==="Angl"&&typeof r[u]=="number"?c="doub":u==="bounds"&&i==="slices"?(c="Objc",f=Z("","Rct1")):u==="Scl "?typeof r[u]=="object"&&"Hrzn"in r[u]?(c="Objc",f=Le):typeof r[u]=="number"?c="long":c="UntF":u==="audioClipGroupList"&&o.length===1?c="VlLs":(u==="Strt"||u==="Brgh")&&"H   "in r?c="doub":u==="Wdth"&&typeof r[u]=="object"?c="UntF":u==="Ofst"&&typeof r[u]=="number"?c="long":u==="Strt"&&typeof r[u]=="object"?(c="Objc",f=Le):WP.indexOf(u)!==-1?c=n==="RGBC"&&i!=="artd"?"doub":"long":u==="profile"?c=n==="printOutput"?"TEXT":"tdta":u==="strokeStyleContent"?r[u]["Clr "]?f=Z("","solidColorLayer"):r[u].Grad?f=Z("","gradientLayer"):r[u].Ptrn?f=Z("","patternLayer"):Fl&&console.log("Invalid strokeStyleContent value",r[u]):u==="bounds"&&i==="quiltWarp"&&(f=Z("","classFloatRect")),f&&f.classID==="RGBC"&&"H   "in r[u]&&(f={classID:"HSBC",name:""}),si(e,u),(0,ke.writeSignature)(e,c||"long"),Db(e,c||"long",r[u],u,f,i),Fl&&!c&&console.log("Missing descriptor field type for: '".concat(u,"' in"),r)}}}k.writeDescriptorStructure=Bm;function Ab(e,t,n){switch(t){case"obj ":return YP(e);case"Objc":case"GlbO":return Um(e,n);case"VlLs":{for(var r=(0,Ce.readInt32)(e),i=[],o=0;o<r;o++){var a=(0,Ce.readSignature)(e);i.push(Ab(e,a,n))}return i}case"doub":return(0,Ce.readFloat64)(e);case"UntF":{var s=(0,Ce.readSignature)(e),l=(0,Ce.readFloat64)(e);if(!Ol[s])throw new Error("Invalid units: ".concat(s));return{units:Ol[s],value:l}}case"UnFl":{var s=(0,Ce.readSignature)(e),l=(0,Ce.readFloat32)(e);if(!Ol[s])throw new Error("Invalid units: ".concat(s));return{units:Ol[s],value:l}}case"TEXT":return(0,Ce.readUnicodeString)(e);case"enum":{var u=Mr(e),l=Mr(e);return"".concat(u,".").concat(l)}case"long":return(0,Ce.readInt32)(e);case"comp":{var c=(0,Ce.readUint32)(e),f=(0,Ce.readUint32)(e);return{low:c,high:f}}case"bool":return!!(0,Ce.readUint8)(e);case"type":case"GlbC":return No(e);case"alis":{var d=(0,Ce.readInt32)(e);return(0,Ce.readAsciiString)(e,d)}case"tdta":{var h=(0,Ce.readInt32)(e);return(0,Ce.readBytes)(e,h)}case"ObAr":{(0,Ce.readInt32)(e),(0,Ce.readUnicodeString)(e),Mr(e);for(var y=(0,Ce.readInt32)(e),i=[],o=0;o<y;o++){var S=Mr(e);(0,Ce.readSignature)(e),(0,Ce.readSignature)(e);for(var b=(0,Ce.readInt32)(e),g=[],p=0;p<b;p++)g.push((0,Ce.readFloat64)(e));i.push({type:S,values:g})}return i}case"Pth ":{(0,Ce.readInt32)(e);var m=(0,Ce.readSignature)(e);(0,Ce.readInt32LE)(e);var v=(0,Ce.readInt32LE)(e),x=(0,Ce.readUnicodeStringWithLengthLE)(e,v);return{sig:m,path:x}}default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}var XP={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function Db(e,t,n,r,i,o){switch(t){case"obj ":KP(e,r,n);break;case"Objc":case"GlbO":{if(typeof n!="object")throw new Error("Invalid struct value: ".concat(JSON.stringify(n),", key: ").concat(r));if(!i)throw new Error("Missing ext type for: '".concat(r,"' (").concat(JSON.stringify(n),")"));var a=n._name||i.name,s=n._classID||i.classID;Bm(e,a,s,n,o);break}case"VlLs":if(!Array.isArray(n))throw new Error("Invalid list value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,ke.writeInt32)(e,n.length);for(var l=0;l<n.length;l++){var u=Pb[r];(0,ke.writeSignature)(e,u||"long"),Db(e,u||"long",n[l],"".concat(r,"[]"),Ib[r],o),Fl&&!u&&console.log("Missing descriptor array type for: '".concat(r,"' in"),n)}break;case"doub":if(typeof n!="number")throw new Error("Invalid number value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,ke.writeFloat64)(e,n);break;case"UntF":if(!$c[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(r));(0,ke.writeSignature)(e,$c[n.units]),(0,ke.writeFloat64)(e,n.value);break;case"UnFl":if(!$c[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(r));(0,ke.writeSignature)(e,$c[n.units]),(0,ke.writeFloat32)(e,n.value);break;case"TEXT":(0,ke.writeUnicodeStringWithPadding)(e,n);break;case"enum":{if(typeof n!="string")throw new Error("Invalid enum value: ".concat(JSON.stringify(n),", key: ").concat(r));var c=n.split("."),f=c[0],d=c[1];si(e,f),si(e,d);break}case"long":if(typeof n!="number")throw new Error("Invalid integer value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,ke.writeInt32)(e,n);break;case"bool":if(typeof n!="boolean")throw new Error("Invalid boolean value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,ke.writeUint8)(e,n?1:0);break;case"tdta":(0,ke.writeInt32)(e,n.byteLength),(0,ke.writeBytes)(e,n);break;case"ObAr":{(0,ke.writeInt32)(e,16),(0,ke.writeUnicodeStringWithPadding)(e,"");var h=XP[r];if(!h)throw new Error("Not implemented ObArType for: ".concat(r));si(e,h),(0,ke.writeInt32)(e,n.length);for(var l=0;l<n.length;l++){si(e,n[l].type),(0,ke.writeSignature)(e,"UnFl"),(0,ke.writeSignature)(e,"#Pxl"),(0,ke.writeInt32)(e,n[l].values.length);for(var y=0;y<n[l].values.length;y++)(0,ke.writeFloat64)(e,n[l].values[y])}break}case"Pth ":{var S=12+n.path.length*2;(0,ke.writeInt32)(e,S),(0,ke.writeSignature)(e,n.sig),(0,ke.writeInt32LE)(e,S),(0,ke.writeInt32LE)(e,n.path.length),(0,ke.writeUnicodeStringWithoutLengthLE)(e,n.path);break}default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function YP(e){for(var t=(0,Ce.readInt32)(e),n=[],r=0;r<t;r++){var i=(0,Ce.readSignature)(e);switch(i){case"prop":{No(e);var o=Mr(e);n.push(o);break}case"Clss":n.push(No(e));break;case"Enmr":{No(e);var a=Mr(e),s=Mr(e);n.push("".concat(a,".").concat(s));break}case"rele":{No(e),n.push((0,Ce.readUint32)(e));break}case"Idnt":n.push((0,Ce.readInt32)(e));break;case"indx":n.push((0,Ce.readInt32)(e));break;case"name":{No(e),n.push((0,Ce.readUnicodeString)(e));break}default:throw new Error("Invalid descriptor reference type: ".concat(i))}}return n}function KP(e,t,n){(0,ke.writeInt32)(e,n.length);for(var r=0;r<n.length;r++){var i=n[r],o="unknown";switch(typeof i=="string"&&(/^[a-z ]+\.[a-z ]+$/i.test(i)?o="Enmr":o="name"),(0,ke.writeSignature)(e,o),o){case"Enmr":{var a=i.split("."),s=a[0],l=a[1];bb(e,"\0",s),si(e,s),si(e,l);break}case"name":{bb(e,"\0","Lyr "),(0,ke.writeUnicodeString)(e,i+"\0");break}default:throw new Error("Invalid descriptor reference type: ".concat(o))}}return n}function No(e){var t=(0,Ce.readUnicodeString)(e),n=Mr(e);return{name:t,classID:n}}function bb(e,t,n){(0,ke.writeUnicodeString)(e,t),si(e,n)}function ZP(e,t){t===void 0&&(t=!1);var n=(0,Ce.readUint32)(e);if(n!==16)throw new Error("Invalid descriptor version: ".concat(n));var r=Um(e,t);return r}k.readVersionAndDescriptor=ZP;function qP(e,t,n,r,i){i===void 0&&(i=""),(0,ke.writeUint32)(e,16),Bm(e,t,n,r,i)}k.writeVersionAndDescriptor=qP;function qc(e){return{x:e.Hrzn,y:e.Vrtc}}k.horzVrtcToXY=qc;function Jc(e){return{Hrzn:e.x,Vrtc:e.y}}k.xyToHorzVrtc=Jc;function JP(e){return{top:dr(e["Top "]),left:dr(e.Left),right:dr(e.Rght),bottom:dr(e.Btom)}}k.descBoundsToBounds=JP;function QP(e){var t;return t={Left:Or(e.left,"bounds.left")},t["Top "]=Or(e.top,"bounds.top"),t.Rght=Or(e.right,"bounds.right"),t.Btom=Or(e.bottom,"bounds.bottom"),t}k.boundsToDescBounds=QP;function _b(e){var t={enabled:!!e.enab,position:k.FStl.decode(e.Styl),fillType:k.FrFl.decode(e.PntT),blendMode:k.BlnM.decode(e["Md  "]),opacity:Bt(e.Opct),size:dr(e["Sz  "])};return e.present!==void 0&&(t.present=e.present),e.showInDialog!==void 0&&(t.showInDialog=e.showInDialog),e.overprint!==void 0&&(t.overprint=e.overprint),e["Clr "]&&(t.color=Uo(e["Clr "])),e.Grad&&(t.gradient=Ob(e)),e.Ptrn&&(t.pattern=Fb(e)),t}function xb(e){var t={};return t.enab=!!e.enabled,e.present!==void 0&&(t.present=!!e.present),e.showInDialog!==void 0&&(t.showInDialog=!!e.showInDialog),t.Styl=k.FStl.encode(e.position),t.PntT=k.FrFl.encode(e.fillType),t["Md  "]=k.BlnM.encode(e.blendMode),t.Opct=Xt(e.opacity),t["Sz  "]=Or(e.size,"size"),e.color&&(t["Clr "]=Bo(e.color)),e.gradient&&(t=ai(ai({},t),Nb(e.gradient))),e.pattern&&(t=ai(ai({},t),Ub(e.pattern))),e.overprint!==void 0&&(t.overprint=!!e.overprint),t}function Lb(e,t,n){for(var r,i,o,a=n?{"Scl ":Nm((r=e.scale)!==null&&r!==void 0?r:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":Nm((i=e.scale)!==null&&i!==void 0?i:1)},s=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"],l=0,u=s;l<u.length;l++){var c=u[l];if(e[c]&&!Array.isArray(e[c]))throw new Error("".concat(c," should be an array"))}var f=function(m){return!!m&&m.length>1&&n},d=function(m){return!!m&&m.length>=1&&(!n||m.length===1)};if(d(e.dropShadow)&&(a.DrSh=Un(e.dropShadow[0],"dropShadow",t)),f(e.dropShadow)&&(a.dropShadowMulti=e.dropShadow.map(function(m){return Un(m,"dropShadow",t)})),d(e.innerShadow)&&(a.IrSh=Un(e.innerShadow[0],"innerShadow",t)),f(e.innerShadow)&&(a.innerShadowMulti=e.innerShadow.map(function(m){return Un(m,"innerShadow",t)})),e.outerGlow&&(a.OrGl=Un(e.outerGlow,"outerGlow",t)),f(e.solidFill)&&(a.solidFillMulti=e.solidFill.map(function(m){return Un(m,"solidFill",t)})),f(e.gradientOverlay)&&(a.gradientFillMulti=e.gradientOverlay.map(function(m){return Un(m,"gradientOverlay",t)})),f(e.stroke)&&(a.frameFXMulti=e.stroke.map(function(m){return xb(m)})),e.innerGlow&&(a.IrGl=Un(e.innerGlow,"innerGlow",t)),e.bevel&&(a.ebbl=Un(e.bevel,"bevel",t)),d(e.solidFill)&&(a.SoFi=Un(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(a.patternFill=Un(e.patternOverlay,"patternOverlay",t)),d(e.gradientOverlay)&&(a.GrFl=Un(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(a.ChFX=Un(e.satin,"satin",t)),d(e.stroke)&&(a.FrFX=xb((o=e.stroke)===null||o===void 0?void 0:o[0])),n){a.numModifyingFX=0;for(var h=0,y=Object.keys(e);h<y.length;h++){var c=y[h],S=e[c];if(Array.isArray(S))for(var b=0,g=S;b<g.length;b++){var p=g[b];p.enabled&&a.numModifyingFX++}else S.enabled&&a.numModifyingFX++}}return a}k.serializeEffects=Lb;function kb(e,t){var n={},r=e.masterFXSwitch,i=e.DrSh,o=e.dropShadowMulti,a=e.IrSh,s=e.innerShadowMulti,l=e.OrGl,u=e.IrGl,c=e.ebbl,f=e.SoFi,d=e.solidFillMulti,h=e.patternFill,y=e.GrFl,S=e.gradientFillMulti,b=e.ChFX,g=e.FrFX,p=e.frameFXMulti,m=e.numModifyingFX,v=GP(e,["masterFXSwitch","DrSh","dropShadowMulti","IrSh","innerShadowMulti","OrGl","IrGl","ebbl","SoFi","solidFillMulti","patternFill","GrFl","gradientFillMulti","ChFX","FrFX","frameFXMulti","numModifyingFX"]);return r||(n.disabled=!0),e["Scl "]&&(n.scale=Bt(e["Scl "])),i&&(n.dropShadow=[Nn(i,t)]),o&&(n.dropShadow=o.map(function(x){return Nn(x,t)})),a&&(n.innerShadow=[Nn(a,t)]),s&&(n.innerShadow=s.map(function(x){return Nn(x,t)})),l&&(n.outerGlow=Nn(l,t)),u&&(n.innerGlow=Nn(u,t)),c&&(n.bevel=Nn(c,t)),f&&(n.solidFill=[Nn(f,t)]),d&&(n.solidFill=d.map(function(x){return Nn(x,t)})),h&&(n.patternOverlay=Nn(h,t)),y&&(n.gradientOverlay=[Nn(y,t)]),S&&(n.gradientOverlay=S.map(function(x){return Nn(x,t)})),b&&(n.satin=Nn(b,t)),g&&(n.stroke=[_b(g)]),p&&(n.stroke=p.map(function(x){return _b(x)})),t&&Object.keys(v).length>1&&console.log("Unhandled effect keys:",v),n}k.parseEffects=kb;function Eb(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=i.time,a=o.denominator,s=o.numerator,l=i.selected,u=i.animKey,c={numerator:s,denominator:a},f=k.animInterpStyleEnum.decode(i.animInterpStyle);switch(u.Type){case"keyType.Opct":n.push({interpolation:f,time:c,selected:l,type:"opacity",value:Bt(u.Opct)});break;case"keyType.Pstn":n.push({interpolation:f,time:c,selected:l,type:"position",x:u.Hrzn,y:u.Vrtc});break;case"keyType.Trnf":n.push({interpolation:f,time:c,selected:l,type:"transform",scale:qc(u["Scl "]),skew:qc(u.Skew),rotation:u.rotation,translation:qc(u.translation)});break;case"keyType.sheetStyle":{var d={interpolation:f,time:c,selected:l,type:"style"};u.sheetStyle.Lefx&&(d.style=kb(u.sheetStyle.Lefx,t)),n.push(d);break}case"keyType.globalLighting":{n.push({interpolation:f,time:c,selected:l,type:"globalLighting",globalAngle:u.gblA,globalAltitude:u.globalAltitude});break}default:throw new Error("Unsupported keyType value")}}return n}function Tb(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=r.time,o=r.selected,a=o===void 0?!1:o,s=r.interpolation,l=k.animInterpStyleEnum.encode(s),u=void 0;switch(r.type){case"opacity":u={Type:"keyType.Opct",Opct:Xt(r.value)};break;case"position":u={Type:"keyType.Pstn",Hrzn:r.x,Vrtc:r.y};break;case"transform":u={Type:"keyType.Trnf","Scl ":Jc(r.scale),Skew:Jc(r.skew),rotation:r.rotation,translation:Jc(r.translation)};break;case"style":u={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},r.style&&(u.sheetStyle={Vrsn:1,Lefx:Lb(r.style,!1,!1),blendOptions:{}});break;case"globalLighting":{u={Type:"keyType.globalLighting",gblA:r.globalAngle,globalAltitude:r.globalAltitude};break}default:throw new Error("Unsupported keyType value")}t.push({Vrsn:1,animInterpStyle:l,time:i,animKey:u,selected:a})}return t}function eA(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o={type:k.stdTrackID.decode(i.trackID),enabled:i.enab,keys:Eb(i.keyList,t)};i.effectParams&&(o.effectParams={fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin,keys:Eb(i.effectParams.keyList,t)}),n.push(o)}return n}k.parseTrackList=eA;function tA(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(ai(ai({trackID:k.stdTrackID.encode(r.type),Vrsn:1,enab:!!r.enabled,Effc:!!r.effectParams},r.effectParams?{effectParams:{keyList:Tb(r.keys),fillCanvas:r.effectParams.fillCanvas,zoomOrigin:r.effectParams.zoomOrigin}}:{}),{keyList:Tb(r.keys)}))}return t}k.serializeTrackList=tA;function Nn(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var o=i[r],a=e[o];switch(o){case"enab":n.enabled=!!a;break;case"uglg":n.useGlobalLight=!!a;break;case"AntA":n.antialiased=!!a;break;case"Algn":n.align=!!a;break;case"Dthr":n.dither=!!a;break;case"Invr":n.invert=!!a;break;case"Rvrs":n.reverse=!!a;break;case"Clr ":n.color=Uo(a);break;case"hglC":n.highlightColor=Uo(a);break;case"sdwC":n.shadowColor=Uo(a);break;case"Styl":n.position=k.FStl.decode(a);break;case"Md  ":n.blendMode=k.BlnM.decode(a);break;case"hglM":n.highlightBlendMode=k.BlnM.decode(a);break;case"sdwM":n.shadowBlendMode=k.BlnM.decode(a);break;case"bvlS":n.style=k.BESl.decode(a);break;case"bvlD":n.direction=k.BESs.decode(a);break;case"bvlT":n.technique=k.bvlT.decode(a);break;case"GlwT":n.technique=k.BETE.decode(a);break;case"glwS":n.source=k.IGSr.decode(a);break;case"Type":n.type=k.GrdT.decode(a);break;case"gs99":n.interpolationMethod=k.gradientInterpolationMethodType.decode(a);break;case"Opct":n.opacity=Bt(a);break;case"hglO":n.highlightOpacity=Bt(a);break;case"sdwO":n.shadowOpacity=Bt(a);break;case"lagl":n.angle=Nl(a);break;case"Angl":n.angle=Nl(a);break;case"Lald":n.altitude=Nl(a);break;case"Sftn":n.soften=dr(a);break;case"srgR":n.strength=Bt(a);break;case"blur":n.size=dr(a);break;case"Nose":n.noise=Bt(a);break;case"Inpr":n.range=Bt(a);break;case"Ckmt":n.choke=dr(a);break;case"ShdN":n.jitter=Bt(a);break;case"Dstn":n.distance=dr(a);break;case"Scl ":n.scale=Bt(a);break;case"Ptrn":n.pattern={name:a["Nm  "],id:a.Idnt};break;case"phase":n.phase={x:a.Hrzn,y:a.Vrtc};break;case"Ofst":n.offset={x:Bt(a.Hrzn),y:Bt(a.Vrtc)};break;case"MpgS":case"TrnS":n.contour={name:a["Nm  "],curve:a["Crv "].map(function(s){return{x:s.Hrzn,y:s.Vrtc}})};break;case"Grad":n.gradient=Rb(a);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[o]=a;break;case"_name":case"_classID":break;default:t&&console.log("Invalid effect key: '".concat(o,"', value:"),a)}}return n}function Un(e,t,n){for(var r={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=a,l=e[s];switch(s){case"enabled":r.enab=!!l;break;case"useGlobalLight":r.uglg=!!l;break;case"antialiased":r.AntA=!!l;break;case"align":r.Algn=!!l;break;case"dither":r.Dthr=!!l;break;case"invert":r.Invr=!!l;break;case"reverse":r.Rvrs=!!l;break;case"color":r["Clr "]=Bo(l);break;case"highlightColor":r.hglC=Bo(l);break;case"shadowColor":r.sdwC=Bo(l);break;case"position":r.Styl=k.FStl.encode(l);break;case"blendMode":r["Md  "]=k.BlnM.encode(l);break;case"highlightBlendMode":r.hglM=k.BlnM.encode(l);break;case"shadowBlendMode":r.sdwM=k.BlnM.encode(l);break;case"style":r.bvlS=k.BESl.encode(l);break;case"direction":r.bvlD=k.BESs.encode(l);break;case"technique":t==="bevel"?r.bvlT=k.bvlT.encode(l):r.GlwT=k.BETE.encode(l);break;case"source":r.glwS=k.IGSr.encode(l);break;case"type":r.Type=k.GrdT.encode(l);break;case"interpolationMethod":r.gs99=k.gradientInterpolationMethodType.encode(l);break;case"opacity":r.Opct=Xt(l);break;case"highlightOpacity":r.hglO=Xt(l);break;case"shadowOpacity":r.sdwO=Xt(l);break;case"angle":t==="gradientOverlay"||t==="patternFill"?r.Angl=ja(l):r.lagl=ja(l);break;case"altitude":r.Lald=ja(l);break;case"soften":r.Sftn=Or(l,s);break;case"strength":r.srgR=Xt(l);break;case"size":r.blur=Or(l,s);break;case"noise":r.Nose=Xt(l);break;case"range":r.Inpr=Xt(l);break;case"choke":r.Ckmt=Or(l,s);break;case"jitter":r.ShdN=Xt(l);break;case"distance":r.Dstn=Or(l,s);break;case"scale":r["Scl "]=Xt(l);break;case"pattern":r.Ptrn={"Nm  ":l.name,Idnt:l.id};break;case"phase":r.phase={Hrzn:l.x,Vrtc:l.y};break;case"offset":r.Ofst={Hrzn:Xt(l.x),Vrtc:Xt(l.y)};break;case"contour":{r[t==="satin"?"MpgS":"TrnS"]={"Nm  ":l.name,"Crv ":l.curve.map(function(u){return{Hrzn:u.x,Vrtc:u.y}})};break}case"gradient":r.Grad=Mb(l);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[s]=l;break;default:n&&console.log("Invalid effect key: '".concat(s,"', value:"),l)}}return r}function Rb(e){if(e.GrdF==="GrdF.CstS"){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map(function(n){return{color:Uo(n["Clr "]),location:n.Lctn/t,midpoint:n.Mdpn/100}}),opacityStops:e.Trns.map(function(n){return{opacity:Bt(n.Opct),location:n.Lctn/t,midpoint:n.Mdpn/100}})}}else return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:k.ClrS.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map(function(n){return n/100}),max:e["Mxm "].map(function(n){return n/100})}}function Mb(e){var t,n;if(e.type==="solid"){var r=Math.round(((t=e.smoothness)!==null&&t!==void 0?t:1)*4096);return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:r,Clrs:e.colorStops.map(function(i){var o;return{"Clr ":Bo(i.color),Type:"Clry.UsrS",Lctn:Math.round(i.location*r),Mdpn:Math.round(((o=i.midpoint)!==null&&o!==void 0?o:.5)*100)}}),Trns:e.opacityStops.map(function(i){var o;return{Opct:Xt(i.opacity),Lctn:Math.round(i.location*r),Mdpn:Math.round(((o=i.midpoint)!==null&&o!==void 0?o:.5)*100)}})}}else return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:k.ClrS.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(((n=e.roughness)!==null&&n!==void 0?n:1)*4096),"Mnm ":(e.min||[0,0,0,0]).map(function(i){return i*100}),"Mxm ":(e.max||[1,1,1,1]).map(function(i){return i*100})}}function Ob(e){var t=Rb(e.Grad);return t.style=k.GrdT.decode(e.Type),e.Dthr!==void 0&&(t.dither=e.Dthr),e.gradientsInterpolationMethod!==void 0&&(t.interpolationMethod=k.gradientInterpolationMethodType.decode(e.gradientsInterpolationMethod)),e.Rvrs!==void 0&&(t.reverse=e.Rvrs),e.Angl!==void 0&&(t.angle=Nl(e.Angl)),e["Scl "]!==void 0&&(t.scale=Bt(e["Scl "])),e.Algn!==void 0&&(t.align=e.Algn),e.Ofst!==void 0&&(t.offset={x:Bt(e.Ofst.Hrzn),y:Bt(e.Ofst.Vrtc)}),t}function Fb(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return e.Lnkd!==void 0&&(t.linked=e.Lnkd),e.phase!==void 0&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function nA(e){if("Grad"in e)return Ob(e);if("Ptrn"in e)return ai({type:"pattern"},Fb(e));if("Clr "in e)return{type:"color",color:Uo(e["Clr "])};throw new Error("Invalid vector content")}k.parseVectorContent=nA;function Nb(e){var t={};return e.dither!==void 0&&(t.Dthr=e.dither),e.interpolationMethod!==void 0&&(t.gradientsInterpolationMethod=k.gradientInterpolationMethodType.encode(e.interpolationMethod)),e.reverse!==void 0&&(t.Rvrs=e.reverse),e.angle!==void 0&&(t.Angl=ja(e.angle)),t.Type=k.GrdT.encode(e.style),e.align!==void 0&&(t.Algn=e.align),e.scale!==void 0&&(t["Scl "]=Xt(e.scale)),e.offset&&(t.Ofst={Hrzn:Xt(e.offset.x),Vrtc:Xt(e.offset.y)}),t.Grad=Mb(e),t}function Ub(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return e.linked!==void 0&&(t.Lnkd=!!e.linked),e.phase!==void 0&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function rA(e){return e.type==="color"?{key:"SoCo",descriptor:{"Clr ":Bo(e.color)}}:e.type==="pattern"?{key:"PtFl",descriptor:Ub(e)}:{key:"GdFl",descriptor:Nb(e)}}k.serializeVectorContent=rA;function Uo(e){if("H   "in e)return{h:Bb(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}k.parseColor=Uo;function Bo(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":ja(e.h*360),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}else return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}k.serializeColor=Bo;function Nl(e){if(e===void 0)return 0;if(e.units!=="Angle")throw new Error("Invalid units: ".concat(e.units));return e.value}k.parseAngle=Nl;function Bt(e){if(e===void 0)return 1;if(e.units!=="Percent")throw new Error("Invalid units: ".concat(e.units));return e.value/100}k.parsePercent=Bt;function Bb(e){if(e===void 0)return 1;if(e.units==="Percent")return e.value/100;if(e.units==="Angle")return e.value/360;throw new Error("Invalid units: ".concat(e.units))}k.parsePercentOrAngle=Bb;function dr(e){var t=e.units,n=e.value;if(t!=="Pixels"&&t!=="Millimeters"&&t!=="Points"&&t!=="None"&&t!=="Picas"&&t!=="Inches"&&t!=="Centimeters"&&t!=="Density")throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:n})));return{value:n,units:t}}k.parseUnits=dr;function iA(e,t){return t===void 0&&(t="Pixels"),typeof e=="number"?{value:e,units:t}:dr(e)}k.parseUnitsOrNumber=iA;function oA(e,t){var n=e.units,r=e.value;if(n!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:n,value:r})));return r}k.parseUnitsToNumber=oA;function ja(e){return{units:"Angle",value:e||0}}k.unitsAngle=ja;function Xt(e){return{units:"Percent",value:Math.round((e||0)*100)}}k.unitsPercent=Xt;function Nm(e){return{units:"Percent",value:(e||0)*100}}k.unitsPercentF=Nm;function Or(e,t){if(e==null)return{units:"Pixels",value:0};if(typeof e!="object")throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var n=e.units,r=e.value;if(typeof r!="number")throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if(n!=="Pixels"&&n!=="Millimeters"&&n!=="Points"&&n!=="None"&&n!=="Picas"&&n!=="Inches"&&n!=="Centimeters"&&n!=="Density")throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:n,value:r}}k.unitsValue=Or;function aA(e){var t=e.numerator,n=e.denominator;return{numerator:t,denominator:n}}k.frac=aA;k.textGridding=(0,ve.createEnum)("textGridding","none",{none:"None",round:"Rnd "});k.Ornt=(0,ve.createEnum)("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"});k.Annt=(0,ve.createEnum)("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"});k.warpStyle=(0,ve.createEnum)("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"});k.BlnM=(0,ve.createEnum)("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"});k.BESl=(0,ve.createEnum)("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"});k.bvlT=(0,ve.createEnum)("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"});k.BESs=(0,ve.createEnum)("BESs","up",{up:"In  ",down:"Out "});k.BETE=(0,ve.createEnum)("BETE","softer",{softer:"SfBL",precise:"PrBL"});k.IGSr=(0,ve.createEnum)("IGSr","edge",{edge:"SrcE",center:"SrcC"});k.GrdT=(0,ve.createEnum)("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"});k.animInterpStyleEnum=(0,ve.createEnum)("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"});k.stdTrackID=(0,ve.createEnum)("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"});k.gradientInterpolationMethodType=(0,ve.createEnum)("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr ",classic:"Gcls",smooth:"Smoo"});k.ClrS=(0,ve.createEnum)("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"});k.FStl=(0,ve.createEnum)("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"});k.FrFl=(0,ve.createEnum)("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"});k.ESliceType=(0,ve.createEnum)("ESliceType","image",{image:"Img ",noImage:"noImage"});k.ESliceHorzAlign=(0,ve.createEnum)("ESliceHorzAlign","default",{default:"default"});k.ESliceVertAlign=(0,ve.createEnum)("ESliceVertAlign","default",{default:"default"});k.ESliceOrigin=(0,ve.createEnum)("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"});k.ESliceBGColorType=(0,ve.createEnum)("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "});k.strokeStyleLineCapType=(0,ve.createEnum)("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"});k.strokeStyleLineJoinType=(0,ve.createEnum)("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"});k.strokeStyleLineAlignment=(0,ve.createEnum)("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"});k.BlrM=(0,ve.createEnum)("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "});k.BlrQ=(0,ve.createEnum)("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "});k.SmBM=(0,ve.createEnum)("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"});k.SmBQ=(0,ve.createEnum)("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"});k.DspM=(0,ve.createEnum)("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"});k.UndA=(0,ve.createEnum)("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"});k.Cnvr=(0,ve.createEnum)("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"});k.RplS=(0,ve.createEnum)("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "});k.SphM=(0,ve.createEnum)("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"});k.Wvtp=(0,ve.createEnum)("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"});k.ZZTy=(0,ve.createEnum)("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"});k.Dstr=(0,ve.createEnum)("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "});k.Chnl=(0,ve.createEnum)("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"});k.MztT=(0,ve.createEnum)("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"});k.Lns=(0,ve.createEnum)("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"});k.blurType=(0,ve.createEnum)("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"});k.DfsM=(0,ve.createEnum)("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"});k.ExtT=(0,ve.createEnum)("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"});k.ExtR=(0,ve.createEnum)("ExtR","random",{random:"Rndm","level-based":"LvlB"});k.FlCl=(0,ve.createEnum)("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"});k.CntE=(0,ve.createEnum)("CntE","upper",{lower:"Lwr ",upper:"Upr "});k.WndM=(0,ve.createEnum)("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"});k.Drct=(0,ve.createEnum)("Drct","from the right",{left:"Left",right:"Rght"});k.IntE=(0,ve.createEnum)("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"});k.IntC=(0,ve.createEnum)("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"});k.FlMd=(0,ve.createEnum)("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "});k.prjM=(0,ve.createEnum)("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"});k.presetKindType=(0,ve.createEnum)("presetKindType","presetKindCustom",{custom:"presetKindCustom",default:"presetKindDefault"})});var Gm=_e(Fr=>{"use strict";var $a=Fr&&Fr.__assign||function(){return $a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},$a.apply(this,arguments)};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.resourceHandlersMap=Fr.resourceHandlers=void 0;var sA=yl(),B=eo(),z=Wa(),tn=Qi(),ad=Sb(),Ee=ed();Fr.resourceHandlers=[];Fr.resourceHandlersMap={};function be(e,t,n,r){var i={key:e,has:t,read:n,write:r};Fr.resourceHandlers.push(i),Fr.resourceHandlersMap[i.key]=i}var Jn=!1,td=[void 0,"PPI","PPCM"],nd=[void 0,"Inches","Centimeters","Points","Picas","Columns"],zb="0123456789abcdef";function Vb(e){return e<=57?e-48:e-87}function lA(e,t){return Vb(e.charCodeAt(t))<<4|Vb(e.charCodeAt(t+1))}function zm(e,t){var n=(0,B.readBytes)(e,t);return(0,ad.decodeString)(n)}function Vm(e,t){var n=(0,ad.encodeString)(t);(0,z.writeBytes)(e,n)}function uA(e){for(var t=(0,B.readUint8)(e),n=(0,B.readBytes)(e,t),r=!1,i=0;i<n.byteLength;i++)if(n[i]&128){r=!0;break}if(r){var o=new TextDecoder("gbk");return o.decode(n)}else return(0,ad.decodeString)(n)}function cA(e,t){for(var n="",r=0,i=t.codePointAt(r++);i!==void 0;i=t.codePointAt(r++))n+=i>127?"?":String.fromCodePoint(i);var o=(0,ad.encodeString)(n);(0,z.writeUint8)(e,o.byteLength),(0,z.writeBytes)(e,o)}tn.MOCK_HANDLERS&&be(1028,function(e){return e._ir1028!==void 0},function(e,t,n){Jn&&console.log("image resource 1028",n()),t._ir1028=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1028)});be(1061,function(e){return e.captionDigest!==void 0},function(e,t){for(var n="",r=0;r<16;r++){var i=(0,B.readUint8)(e);n+=zb[i>>4],n+=zb[i&15]}t.captionDigest=n},function(e,t){for(var n=0;n<16;n++)(0,z.writeUint8)(e,lA(t.captionDigest,n*2))});be(1060,function(e){return e.xmpMetadata!==void 0},function(e,t,n){t.xmpMetadata=zm(e,n())},function(e,t){Vm(e,t.xmpMetadata)});var rd=(0,tn.createEnum)("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});be(1082,function(e){return e.printInformation!==void 0},function(e,t){var n,r,i=(0,Ee.readVersionAndDescriptor)(e);t.printInformation={printerName:i.printerName||"",renderingIntent:rd.decode((n=i.Inte)!==null&&n!==void 0?n:"Inte.Img ")};var o=t.printInformation;i.PstS!==void 0&&(o.printerManagesColors=i.PstS),i["Nm  "]!==void 0&&(o.printerProfile=i["Nm  "]),i.MpBl!==void 0&&(o.blackPointCompensation=i.MpBl),i.printSixteenBit!==void 0&&(o.printSixteenBit=i.printSixteenBit),i.hardProof!==void 0&&(o.hardProof=i.hardProof),i.printProofSetup&&("Bltn"in i.printProofSetup?o.proofSetup={builtin:i.printProofSetup.Bltn.split(".")[1]}:o.proofSetup={profile:i.printProofSetup.profile,renderingIntent:rd.decode((r=i.printProofSetup.Inte)!==null&&r!==void 0?r:"Inte.Img "),blackPointCompensation:!!i.printProofSetup.MpBl,paperWhite:!!i.printProofSetup.paperWhite})},function(e,t){var n,r,i=t.printInformation,o={};i.printerManagesColors?o.PstS=!0:(i.hardProof!==void 0&&(o.hardProof=!!i.hardProof),o.ClrS="ClrS.RGBC",o["Nm  "]=(n=i.printerProfile)!==null&&n!==void 0?n:"CIE RGB"),o.Inte=rd.encode(i.renderingIntent),i.printerManagesColors||(o.MpBl=!!i.blackPointCompensation),o.printSixteenBit=!!i.printSixteenBit,o.printerName=i.printerName||"",i.proofSetup&&"profile"in i.proofSetup?o.printProofSetup={profile:i.proofSetup.profile||"",Inte:rd.encode(i.proofSetup.renderingIntent),MpBl:!!i.proofSetup.blackPointCompensation,paperWhite:!!i.proofSetup.paperWhite}:o.printProofSetup={Bltn:!((r=i.proofSetup)===null||r===void 0)&&r.builtin?"builtinProof.".concat(i.proofSetup.builtin):"builtinProof.proofCMYK"},(0,Ee.writeVersionAndDescriptor)(e,"","printOutput",o)});tn.MOCK_HANDLERS&&be(1083,function(e){return e._ir1083!==void 0},function(e,t,n){Jn&&console.log("image resource 1083",n()),t._ir1083=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1083)});be(1005,function(e){return e.resolutionInfo!==void 0},function(e,t){var n=(0,B.readFixedPoint32)(e),r=(0,B.readUint16)(e),i=(0,B.readUint16)(e),o=(0,B.readFixedPoint32)(e),a=(0,B.readUint16)(e),s=(0,B.readUint16)(e);t.resolutionInfo={horizontalResolution:n,horizontalResolutionUnit:td[r]||"PPI",widthUnit:nd[i]||"Inches",verticalResolution:o,verticalResolutionUnit:td[a]||"PPI",heightUnit:nd[s]||"Inches"}},function(e,t){var n=t.resolutionInfo;(0,z.writeFixedPoint32)(e,n.horizontalResolution||0),(0,z.writeUint16)(e,Math.max(1,td.indexOf(n.horizontalResolutionUnit))),(0,z.writeUint16)(e,Math.max(1,nd.indexOf(n.widthUnit))),(0,z.writeFixedPoint32)(e,n.verticalResolution||0),(0,z.writeUint16)(e,Math.max(1,td.indexOf(n.verticalResolutionUnit))),(0,z.writeUint16)(e,Math.max(1,nd.indexOf(n.heightUnit)))});var Gb=["centered","size to fit","user defined"];be(1062,function(e){return e.printScale!==void 0},function(e,t){t.printScale={style:Gb[(0,B.readInt16)(e)],x:(0,B.readFloat32)(e),y:(0,B.readFloat32)(e),scale:(0,B.readFloat32)(e)}},function(e,t){var n=t.printScale,r=n.style,i=n.x,o=n.y,a=n.scale;(0,z.writeInt16)(e,Math.max(0,Gb.indexOf(r))),(0,z.writeFloat32)(e,i||0),(0,z.writeFloat32)(e,o||0),(0,z.writeFloat32)(e,a||0)});be(1006,function(e){return e.alphaChannelNames!==void 0},function(e,t,n){if(t.alphaChannelNames)(0,B.skipBytes)(e,n());else for(t.alphaChannelNames=[];n()>0;){var r=uA(e);t.alphaChannelNames.push(r)}},function(e,t){for(var n=0,r=t.alphaChannelNames;n<r.length;n++){var i=r[n];cA(e,i)}});be(1045,function(e){return e.alphaChannelNames!==void 0},function(e,t,n){for(t.alphaChannelNames=[];n()>0;)t.alphaChannelNames.push((0,B.readUnicodeString)(e))},function(e,t){for(var n=0,r=t.alphaChannelNames;n<r.length;n++){var i=r[n];(0,z.writeUnicodeStringWithPadding)(e,i)}});tn.MOCK_HANDLERS&&be(1077,function(e){return e._ir1077!==void 0},function(e,t,n){Jn&&console.log("image resource 1077",n()),t._ir1077=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1077)});be(1053,function(e){return e.alphaIdentifiers!==void 0},function(e,t,n){for(t.alphaIdentifiers=[];n()>=4;)t.alphaIdentifiers.push((0,B.readUint32)(e))},function(e,t){for(var n=0,r=t.alphaIdentifiers;n<r.length;n++){var i=r[n];(0,z.writeUint32)(e,i)}});be(1010,function(e){return e.backgroundColor!==void 0},function(e,t){return t.backgroundColor=(0,B.readColor)(e)},function(e,t){return(0,z.writeColor)(e,t.backgroundColor)});be(1037,function(e){return e.globalAngle!==void 0},function(e,t){return t.globalAngle=(0,B.readInt32)(e)},function(e,t){return(0,z.writeInt32)(e,t.globalAngle)});be(1049,function(e){return e.globalAltitude!==void 0},function(e,t){return t.globalAltitude=(0,B.readUint32)(e)},function(e,t){return(0,z.writeUint32)(e,t.globalAltitude)});be(1011,function(e){return e.printFlags!==void 0},function(e,t){t.printFlags={labels:!!(0,B.readUint8)(e),cropMarks:!!(0,B.readUint8)(e),colorBars:!!(0,B.readUint8)(e),registrationMarks:!!(0,B.readUint8)(e),negative:!!(0,B.readUint8)(e),flip:!!(0,B.readUint8)(e),interpolate:!!(0,B.readUint8)(e),caption:!!(0,B.readUint8)(e),printFlags:!!(0,B.readUint8)(e)}},function(e,t){var n=t.printFlags;(0,z.writeUint8)(e,n.labels?1:0),(0,z.writeUint8)(e,n.cropMarks?1:0),(0,z.writeUint8)(e,n.colorBars?1:0),(0,z.writeUint8)(e,n.registrationMarks?1:0),(0,z.writeUint8)(e,n.negative?1:0),(0,z.writeUint8)(e,n.flip?1:0),(0,z.writeUint8)(e,n.interpolate?1:0),(0,z.writeUint8)(e,n.caption?1:0),(0,z.writeUint8)(e,n.printFlags?1:0)});tn.MOCK_HANDLERS&&be(1e4,function(e){return e._ir10000!==void 0},function(e,t,n){Jn&&console.log("image resource 10000",n()),t._ir10000=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir10000)});tn.MOCK_HANDLERS&&be(1013,function(e){return e._ir1013!==void 0},function(e,t,n){Jn&&console.log("image resource 1013",n()),t._ir1013=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1013)});tn.MOCK_HANDLERS&&be(1016,function(e){return e._ir1016!==void 0},function(e,t,n){Jn&&console.log("image resource 1016",n()),t._ir1016=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1016)});be(1080,function(e){return e.countInformation!==void 0},function(e,t){var n=(0,Ee.readVersionAndDescriptor)(e);t.countInformation=n.countGroupList.map(function(r){return{color:{r:r["Rd  "],g:r["Grn "],b:r["Bl  "]},name:r["Nm  "],size:r["Rds "],fontSize:r.fontSize,visible:r.Vsbl,points:r.countObjectList.map(function(i){return{x:i["X   "],y:i["Y   "]}})}})},function(e,t){var n={Vrsn:1,countGroupList:t.countInformation.map(function(r){return{"Rd  ":r.color.r,"Grn ":r.color.g,"Bl  ":r.color.b,"Nm  ":r.name,"Rds ":r.size,fontSize:r.fontSize,Vsbl:r.visible,countObjectList:r.points.map(function(i){return{"X   ":i.x,"Y   ":i.y}})}})};(0,Ee.writeVersionAndDescriptor)(e,"","Cnt ",n)});be(1024,function(e){return e.layerState!==void 0},function(e,t){return t.layerState=(0,B.readUint16)(e)},function(e,t){return(0,z.writeUint16)(e,t.layerState)});be(1026,function(e){return e.layersGroup!==void 0},function(e,t,n){for(t.layersGroup=[];n()>0;)t.layersGroup.push((0,B.readUint16)(e))},function(e,t){for(var n=0,r=t.layersGroup;n<r.length;n++){var i=r[n];(0,z.writeUint16)(e,i)}});be(1072,function(e){return e.layerGroupsEnabledId!==void 0},function(e,t,n){for(t.layerGroupsEnabledId=[];n()>0;)t.layerGroupsEnabledId.push((0,B.readUint8)(e))},function(e,t){for(var n=0,r=t.layerGroupsEnabledId;n<r.length;n++){var i=r[n];(0,z.writeUint8)(e,i)}});be(1069,function(e){return e.layerSelectionIds!==void 0},function(e,t){var n=(0,B.readUint16)(e);for(t.layerSelectionIds=[];n--;)t.layerSelectionIds.push((0,B.readUint32)(e))},function(e,t){(0,z.writeUint16)(e,t.layerSelectionIds.length);for(var n=0,r=t.layerSelectionIds;n<r.length;n++){var i=r[n];(0,z.writeUint32)(e,i)}});be(1032,function(e){return e.gridAndGuidesInformation!==void 0},function(e,t){var n=(0,B.readUint32)(e),r=(0,B.readUint32)(e),i=(0,B.readUint32)(e),o=(0,B.readUint32)(e);if(n!==1)throw new Error("Invalid 1032 resource version: ".concat(n));t.gridAndGuidesInformation={grid:{horizontal:r,vertical:i},guides:[]};for(var a=0;a<o;a++)t.gridAndGuidesInformation.guides.push({location:(0,B.readUint32)(e)/32,direction:(0,B.readUint8)(e)?"horizontal":"vertical"})},function(e,t){var n=t.gridAndGuidesInformation,r=n.grid||{horizontal:18*32,vertical:18*32},i=n.guides||[];(0,z.writeUint32)(e,1),(0,z.writeUint32)(e,r.horizontal),(0,z.writeUint32)(e,r.vertical),(0,z.writeUint32)(e,i.length);for(var o=0,a=i;o<a.length;o++){var s=a[o];(0,z.writeUint32)(e,s.location*32),(0,z.writeUint8)(e,s.direction==="horizontal"?1:0)}});be(1065,function(e){return e.layerComps!==void 0},function(e,t){var n=(0,Ee.readVersionAndDescriptor)(e,!0);t.layerComps={list:[]};for(var r=0,i=n.list;r<i.length;r++){var o=i[r];t.layerComps.list.push({id:o.compID,name:o["Nm  "],capturedInfo:o.capturedInfo}),"comment"in o&&(t.layerComps.list[t.layerComps.list.length-1].comment=o.comment)}"lastAppliedComp"in n&&(t.layerComps.lastApplied=n.lastAppliedComp)},function(e,t){for(var n=t.layerComps,r={list:[]},i=0,o=n.list;i<o.length;i++){var a=o[i],s={};s._classID="Comp",s["Nm  "]=a.name,"comment"in a&&(s.comment=a.comment),s.compID=a.id,s.capturedInfo=a.capturedInfo,r.list.push(s)}"lastApplied"in n&&(r.lastAppliedComp=n.lastApplied),(0,Ee.writeVersionAndDescriptor)(e,"","CompList",r)});tn.MOCK_HANDLERS&&be(1092,function(e){return e._ir1092!==void 0},function(e,t,n){Jn&&console.log("image resource 1092",n()),t._ir1092=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1092)});var Hb=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];be(1078,function(e){return e.onionSkins!==void 0},function(e,t){var n=(0,Ee.readVersionAndDescriptor)(e);t.onionSkins={enabled:n.enab,framesBefore:n.numBefore,framesAfter:n.numAfter,frameSpacing:n.Spcn,minOpacity:n.minOpacity/100,maxOpacity:n.maxOpacity/100,blendMode:Hb[n.BlnM]||"normal"}},function(e,t){var n=t.onionSkins,r={Vrsn:1,enab:n.enabled,numBefore:n.framesBefore,numAfter:n.framesAfter,Spcn:n.frameSpacing,minOpacity:n.minOpacity*100|0,maxOpacity:n.maxOpacity*100|0,BlnM:Math.max(0,Hb.indexOf(n.blendMode))};(0,Ee.writeVersionAndDescriptor)(e,"","null",r)});be(1075,function(e){return e.timelineInformation!==void 0},function(e,t){var n,r,i=(0,Ee.readVersionAndDescriptor)(e);t.timelineInformation={enabled:i.enab,frameStep:(0,Ee.frac)(i.frameStep),frameRate:i.frameRate,time:(0,Ee.frac)(i.time),duration:(0,Ee.frac)(i.duration),workInTime:(0,Ee.frac)(i.workInTime),workOutTime:(0,Ee.frac)(i.workOutTime),repeats:i.LCnt,hasMotion:i.hasMotion,globalTracks:(0,Ee.parseTrackList)(i.globalTrackList,!!e.logMissingFeatures)},!((r=(n=i.audioClipGroupList)===null||n===void 0?void 0:n.audioClipGroupList)===null||r===void 0)&&r.length&&(t.timelineInformation.audioClipGroups=i.audioClipGroupList.audioClipGroupList.map(function(o){return{id:o.groupID,muted:o.muted,audioClips:o.audioClipList.map(function(a){var s=a.clipID,l=a.timeScope,u=a.muted,c=a.audioLevel,f=a.frameReader;return{id:s,start:(0,Ee.frac)(l.Strt),duration:(0,Ee.frac)(l.duration),inTime:(0,Ee.frac)(l.inTime),outTime:(0,Ee.frac)(l.outTime),muted:u,audioLevel:c,frameReader:{type:f.frameReaderType,mediaDescriptor:f.mediaDescriptor,link:{name:f["Lnk "]["Nm  "],fullPath:f["Lnk "].fullPath,relativePath:f["Lnk "].relPath}}}})}}))},function(e,t){var n,r=t.timelineInformation,i={Vrsn:1,enab:r.enabled,frameStep:r.frameStep,frameRate:r.frameRate,time:r.time,duration:r.duration,workInTime:r.workInTime,workOutTime:r.workOutTime,LCnt:r.repeats,globalTrackList:(0,Ee.serializeTrackList)(r.globalTracks),audioClipGroupList:{audioClipGroupList:(n=r.audioClipGroups)===null||n===void 0?void 0:n.map(function(o){return{groupID:o.id,muted:o.muted,audioClipList:o.audioClips.map(function(a){return{clipID:a.id,timeScope:{Vrsn:1,Strt:a.start,duration:a.duration,inTime:a.inTime,outTime:a.outTime},frameReader:{frameReaderType:a.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":a.frameReader.link.name,fullPath:a.frameReader.link.fullPath,relPath:a.frameReader.link.relativePath},mediaDescriptor:a.frameReader.mediaDescriptor},muted:a.muted,audioLevel:a.audioLevel}})}})},hasMotion:r.hasMotion};(0,Ee.writeVersionAndDescriptor)(e,"","null",i,"anim")});be(1076,function(e){return e.sheetDisclosure!==void 0},function(e,t){var n=(0,Ee.readVersionAndDescriptor)(e);t.sheetDisclosure={},n.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=n.sheetTimelineOptions.map(function(r){return{sheetID:r.sheetID,sheetDisclosed:r.sheetDisclosed,lightsDisclosed:r.lightsDisclosed,meshesDisclosed:r.meshesDisclosed,materialsDisclosed:r.materialsDisclosed}}))},function(e,t){var n=t.sheetDisclosure,r={Vrsn:1};n.sheetTimelineOptions&&(r.sheetTimelineOptions=n.sheetTimelineOptions.map(function(i){return{Vrsn:2,sheetID:i.sheetID,sheetDisclosed:i.sheetDisclosed,lightsDisclosed:i.lightsDisclosed,meshesDisclosed:i.meshesDisclosed,materialsDisclosed:i.materialsDisclosed}})),(0,Ee.writeVersionAndDescriptor)(e,"","null",r)});be(1054,function(e){return e.urlsList!==void 0},function(e,t){var n=(0,B.readUint32)(e);t.urlsList=[];for(var r=0;r<n;r++){var i=(0,B.readSignature)(e);if(i!=="slic"&&e.throwForMissingFeatures)throw new Error("Unknown long");var o=(0,B.readUint32)(e),a=(0,B.readUnicodeString)(e);t.urlsList.push({id:o,url:a,ref:"slice"})}},function(e,t){var n=t.urlsList;(0,z.writeUint32)(e,n.length);for(var r=0;r<n.length;r++)(0,z.writeSignature)(e,"slic"),(0,z.writeUint32)(e,n[r].id),(0,z.writeUnicodeString)(e,n[r].url)});function jb(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function Wb(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function id(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}var $b=["autoGenerated","layer","userGenerated"],Xb=["noImage","image"],od=["default"];be(1050,function(e){return e.slices?e.slices.length:0},function(e,t){var n=(0,B.readUint32)(e);if(n===6){t.slices||(t.slices=[]);var r=(0,B.readInt32)(e),i=(0,B.readInt32)(e),o=(0,B.readInt32)(e),a=(0,B.readInt32)(e),s=(0,B.readUnicodeString)(e),l=(0,B.readUint32)(e);t.slices.push({bounds:{top:r,left:i,bottom:o,right:a},groupName:s,slices:[]});for(var u=t.slices[t.slices.length-1].slices,c=0;c<l;c++){var f=(0,B.readUint32)(e),d=(0,B.readUint32)(e),h=id($b,(0,B.readUint32)(e)),y=h=="layer"?(0,B.readUint32)(e):0,S=(0,B.readUnicodeString)(e),b=id(Xb,(0,B.readUint32)(e)),g=(0,B.readInt32)(e),p=(0,B.readInt32)(e),m=(0,B.readInt32)(e),v=(0,B.readInt32)(e),x=(0,B.readUnicodeString)(e),w=(0,B.readUnicodeString)(e),_=(0,B.readUnicodeString)(e),E=(0,B.readUnicodeString)(e),P=!!(0,B.readUint8)(e),D=(0,B.readUnicodeString)(e),M=id(od,(0,B.readUint32)(e)),j=id(od,(0,B.readUint32)(e)),N=(0,B.readUint8)(e),L=(0,B.readUint8)(e),O=(0,B.readUint8)(e),F=(0,B.readUint8)(e),X=N+L+O+F===0?"none":N===0?"matte":"color";u.push({id:f,groupId:d,origin:h,associatedLayerId:y,name:S,target:w,message:_,altTag:E,cellTextIsHTML:P,cellText:D,horizontalAlignment:M,verticalAlignment:j,type:b,url:x,bounds:{top:p,left:g,bottom:v,right:m},backgroundColorType:X,backgroundColor:{r:L,g:O,b:F,a:N}})}var te=(0,Ee.readVersionAndDescriptor)(e);te.slices.forEach(function(ge){var ne=u.find(function(Ie){return ge.sliceID==Ie.id});ne&&(ne.topOutset=ge.topOutset,ne.leftOutset=ge.leftOutset,ne.bottomOutset=ge.bottomOutset,ne.rightOutset=ge.rightOutset)})}else if(n===7||n===8){var te=(0,Ee.readVersionAndDescriptor)(e);t.slices||(t.slices=[]),t.slices.push({groupName:te.baseName,bounds:Wb(te.bounds),slices:te.slices.map(function(ne){return $a($a({},ne["Nm  "]?{name:ne["Nm  "]}:{}),{id:ne.sliceID,groupId:ne.groupID,associatedLayerId:0,origin:Ee.ESliceOrigin.decode(ne.origin),type:Ee.ESliceType.decode(ne.Type),bounds:Wb(ne.bounds),url:ne.url,target:ne.null,message:ne.Msge,altTag:ne.altTag,cellTextIsHTML:ne.cellTextIsHTML,cellText:ne.cellText,horizontalAlignment:Ee.ESliceHorzAlign.decode(ne.horzAlign),verticalAlignment:Ee.ESliceVertAlign.decode(ne.vertAlign),backgroundColorType:Ee.ESliceBGColorType.decode(ne.bgColorType),backgroundColor:ne.bgColor?{r:ne.bgColor["Rd  "],g:ne.bgColor["Grn "],b:ne.bgColor["Bl  "],a:ne.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:ne.topOutset||0,leftOutset:ne.leftOutset||0,bottomOutset:ne.bottomOutset||0,rightOutset:ne.rightOutset||0})})})}else throw new Error("Invalid slices version (".concat(n,")"))},function(e,t,n){var r=t.slices[n],i=r.bounds,o=r.groupName,a=r.slices;(0,z.writeUint32)(e,6),(0,z.writeInt32)(e,i.top),(0,z.writeInt32)(e,i.left),(0,z.writeInt32)(e,i.bottom),(0,z.writeInt32)(e,i.right),(0,z.writeUnicodeString)(e,o),(0,z.writeUint32)(e,a.length);for(var s=0;s<a.length;s++){var l=a[s],u=l.backgroundColor,c=u.a,f=u.r,d=u.g,h=u.b;l.backgroundColorType==="none"?c=f=d=h=0:l.backgroundColorType==="matte"&&(c=0,f=d=h=255),(0,z.writeUint32)(e,l.id),(0,z.writeUint32)(e,l.groupId),(0,z.writeUint32)(e,$b.indexOf(l.origin)),l.origin==="layer"&&(0,z.writeUint32)(e,l.associatedLayerId),(0,z.writeUnicodeString)(e,l.name||""),(0,z.writeUint32)(e,Xb.indexOf(l.type)),(0,z.writeInt32)(e,l.bounds.left),(0,z.writeInt32)(e,l.bounds.top),(0,z.writeInt32)(e,l.bounds.right),(0,z.writeInt32)(e,l.bounds.bottom),(0,z.writeUnicodeString)(e,l.url),(0,z.writeUnicodeString)(e,l.target),(0,z.writeUnicodeString)(e,l.message),(0,z.writeUnicodeString)(e,l.altTag),(0,z.writeUint8)(e,l.cellTextIsHTML?1:0),(0,z.writeUnicodeString)(e,l.cellText),(0,z.writeUint32)(e,od.indexOf(l.horizontalAlignment)),(0,z.writeUint32)(e,od.indexOf(l.verticalAlignment)),(0,z.writeUint8)(e,c),(0,z.writeUint8)(e,f),(0,z.writeUint8)(e,d),(0,z.writeUint8)(e,h)}var y={bounds:jb(i),slices:[]};a.forEach(function(S){var b=$a($a({sliceID:S.id,groupID:S.groupId,origin:Ee.ESliceOrigin.encode(S.origin),Type:Ee.ESliceType.encode(S.type),bounds:jb(S.bounds)},S.name?{"Nm  ":S.name}:{}),{url:S.url,null:S.target,Msge:S.message,altTag:S.altTag,cellTextIsHTML:S.cellTextIsHTML,cellText:S.cellText,horzAlign:Ee.ESliceHorzAlign.encode(S.horizontalAlignment),vertAlign:Ee.ESliceVertAlign.encode(S.verticalAlignment),bgColorType:Ee.ESliceBGColorType.encode(S.backgroundColorType)});if(S.backgroundColorType==="color"){var g=S.backgroundColor,p=g.r,m=g.g,v=g.b,x=g.a;b.bgColor={"Rd  ":p,"Grn ":m,"Bl  ":v,alpha:x}}b.topOutset=S.topOutset||0,b.leftOutset=S.leftOutset||0,b.bottomOutset=S.bottomOutset||0,b.rightOutset=S.rightOutset||0,y.slices.push(b)}),(0,Ee.writeVersionAndDescriptor)(e,"","null",y,"slices")});be(1064,function(e){return e.pixelAspectRatio!==void 0},function(e,t){if((0,B.readUint32)(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:(0,B.readFloat64)(e)}},function(e,t){(0,z.writeUint32)(e,2),(0,z.writeFloat64)(e,t.pixelAspectRatio.aspect)});be(1041,function(e){return e.iccUntaggedProfile!==void 0},function(e,t){t.iccUntaggedProfile=!!(0,B.readUint8)(e)},function(e,t){(0,z.writeUint8)(e,t.iccUntaggedProfile?1:0)});tn.MOCK_HANDLERS&&be(1039,function(e){return e._ir1039!==void 0},function(e,t,n){Jn&&console.log("image resource 1039",n()),t._ir1039=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1039)});be(1044,function(e){return e.idsSeedNumber!==void 0},function(e,t){return t.idsSeedNumber=(0,B.readUint32)(e)},function(e,t){return(0,z.writeUint32)(e,t.idsSeedNumber)});be(1036,function(e){return e.thumbnail!==void 0||e.thumbnailRaw!==void 0},function(e,t,n){var r=(0,B.readUint32)(e),i=(0,B.readUint32)(e),o=(0,B.readUint32)(e);(0,B.readUint32)(e),(0,B.readUint32)(e),(0,B.readUint32)(e);var a=(0,B.readUint16)(e),s=(0,B.readUint16)(e);if(r!==1||a!==24||s!==1){e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(r,", bitsPerPixel: ").concat(a,", planes: ").concat(s,")")),(0,B.skipBytes)(e,n());return}var l=n(),u=(0,B.readBytes)(e,l);e.useRawThumbnail?t.thumbnailRaw={width:i,height:o,data:u}:u.byteLength&&(t.thumbnail=(0,tn.createCanvasFromData)(u))},function(e,t){var n,r=0,i=0,o=new Uint8Array(0);if(t.thumbnailRaw)r=t.thumbnailRaw.width,i=t.thumbnailRaw.height,o=t.thumbnailRaw.data;else try{var a=(n=t.thumbnail.toDataURL("image/jpeg",1))===null||n===void 0?void 0:n.substring(23);a&&(o=(0,sA.toByteArray)(a),r=t.thumbnail.width,i=t.thumbnail.height)}catch(d){}var s=24,l=Math.floor((r*s+31)/32)*4,u=1,c=l*i*u,f=o.length;(0,z.writeUint32)(e,1),(0,z.writeUint32)(e,r),(0,z.writeUint32)(e,i),(0,z.writeUint32)(e,l),(0,z.writeUint32)(e,c),(0,z.writeUint32)(e,f),(0,z.writeUint16)(e,s),(0,z.writeUint16)(e,u),(0,z.writeBytes)(e,o)});be(1057,function(e){return e.versionInfo!==void 0},function(e,t,n){var r=(0,B.readUint32)(e);if(r!==1)throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!(0,B.readUint8)(e),writerName:(0,B.readUnicodeString)(e),readerName:(0,B.readUnicodeString)(e),fileVersion:(0,B.readUint32)(e)},(0,B.skipBytes)(e,n())},function(e,t){var n=t.versionInfo;(0,z.writeUint32)(e,1),(0,z.writeUint8)(e,n.hasRealMergedData?1:0),(0,z.writeUnicodeString)(e,n.writerName),(0,z.writeUnicodeString)(e,n.readerName),(0,z.writeUint32)(e,n.fileVersion)});tn.MOCK_HANDLERS&&be(1058,function(e){return e._ir1058!==void 0},function(e,t,n){Jn&&console.log("image resource 1058",n()),t._ir1058=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1058)});be(7e3,function(e){return e.imageReadyVariables!==void 0},function(e,t,n){t.imageReadyVariables=zm(e,n())},function(e,t){Vm(e,t.imageReadyVariables)});be(7001,function(e){return e.imageReadyDataSets!==void 0},function(e,t,n){t.imageReadyDataSets=zm(e,n())},function(e,t){Vm(e,t.imageReadyDataSets)});be(1088,function(e){return e.pathSelectionState!==void 0},function(e,t,n){var r=(0,Ee.readVersionAndDescriptor)(e);t.pathSelectionState=r.null},function(e,t){var n={null:t.pathSelectionState};(0,Ee.writeVersionAndDescriptor)(e,"","null",n)});tn.MOCK_HANDLERS&&be(1025,function(e){return e._ir1025!==void 0},function(e,t,n){Jn&&console.log("image resource 1025",n()),t._ir1025=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir1025)});var Yb=(0,tn.createEnum)("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});be(4e3,function(e){return e.animations!==void 0},function(e,t,n){var r=(0,B.readSignature)(e);if(r==="mani")(0,B.checkSignature)(e,"IRFR"),(0,B.readSection)(e,1,function(o){for(var a=function(){(0,B.checkSignature)(e,"8BIM");var s=(0,B.readSignature)(e);(0,B.readSection)(e,1,function(l){if(s==="AnDs"){var u=(0,Ee.readVersionAndDescriptor)(e);t.animations={frames:u.FrIn.map(function(f){return{id:f.FrID,delay:(f.FrDl||0)/100,dispose:f.FrDs?Yb.decode(f.FrDs):"auto"}}),animations:u.FSts.map(function(f){return{id:f.FsID,frames:f.FsFr,repeats:f.LCnt,activeFrame:f.AFrm||0}})}}else if(s==="Roll"){var c=(0,B.readBytes)(e,l());e.logDevFeatures&&e.log("#4000 Roll",c)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",s)})};o()>0;)a()});else if(r==="mopt"){var i=(0,B.readBytes)(e,n());e.logDevFeatures&&e.log("#4000 mopt",i)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",r)},function(e,t){t.animations&&((0,z.writeSignature)(e,"mani"),(0,z.writeSignature)(e,"IRFR"),(0,z.writeSection)(e,1,function(){(0,z.writeSignature)(e,"8BIM"),(0,z.writeSignature)(e,"AnDs"),(0,z.writeSection)(e,1,function(){for(var n={FrIn:[],FSts:[]},r=0;r<t.animations.frames.length;r++){var i=t.animations.frames[r],o={FrID:i.id};i.delay&&(o.FrDl=i.delay*100|0),o.FrDs=Yb.encode(i.dispose),n.FrIn.push(o)}for(var r=0;r<t.animations.animations.length;r++){var a=t.animations.animations[r],s={FsID:a.id,AFrm:a.activeFrame|0,FsFr:a.frames,LCnt:a.repeats|0};n.FSts.push(s)}(0,Ee.writeVersionAndDescriptor)(e,"","null",n)})}))});tn.MOCK_HANDLERS&&be(4001,function(e){return e._ir4001!==void 0},function(e,t,n){if(tn.MOCK_HANDLERS){Jn&&console.log("image resource 4001",n()),t._ir4001=(0,B.readBytes)(e,n());return}var r=(0,B.readSignature)(e);if(r==="mfri"){var i=(0,B.readUint32)(e);if(i!==2)throw new Error("Invalid mfri version");var o=(0,B.readUint32)(e),a=(0,B.readBytes)(e,o);e.logDevFeatures&&e.log("mfri",a)}else if(r==="mset"){var s=(0,Ee.readVersionAndDescriptor)(e);e.logDevFeatures&&e.log("mset",s)}else e.logMissingFeatures&&e.log("Unhandled key in #4001",r)},function(e,t){(0,z.writeBytes)(e,t._ir4001)});tn.MOCK_HANDLERS&&be(4002,function(e){return e._ir4002!==void 0},function(e,t,n){Jn&&console.log("image resource 4002",n()),t._ir4002=(0,B.readBytes)(e,n())},function(e,t){(0,z.writeBytes)(e,t._ir4002)})});var eo=_e(J=>{"use strict";var dA=J&&J.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};Object.defineProperty(J,"__esModule",{value:!0});J.readPattern=J.readColor=J.readSection=J.readDataRLE=J.readDataZip=J.createImageDataBitDepth=J.readAdditionalLayerInfo=J.readGlobalLayerMaskInfo=J.readData=J.readLayerInfo=J.readPsd=J.checkSignature=J.skipBytes=J.readAsciiString=J.readUnicodeStringWithLengthLE=J.readUnicodeStringWithLength=J.readUnicodeString=J.readPascalString=J.validSignatureAt=J.readSignature=J.readBytes=J.readFixedPointPath32=J.readFixedPoint32=J.readFloat64=J.readFloat32=J.readUint32=J.readInt32LE=J.readInt32=J.readUint16LE=J.readUint16=J.readInt16=J.peekUint8=J.readUint8=J.warnOrThrow=J.createReader=J.supportedColorModes=void 0;var fA=Pm(),kt=Qi(),pA=dd(),hA=Gm();J.supportedColorModes=[0,1,3,2];var mA=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function jm(e){for(var t=e.width*e.height*4,n=0;n<t;n+=4)e.data[n+1]=e.data[n],e.data[n+2]=e.data[n]}function gA(e,t,n){var r=new DataView(e,t,n);return{view:r,offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}J.createReader=gA;function ld(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}J.warnOrThrow=ld;function ot(e){return e.offset+=1,e.view.getUint8(e.offset-1)}J.readUint8=ot;function Zb(e){return e.view.getUint8(e.offset)}J.peekUint8=Zb;function to(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}J.readInt16=to;function Ue(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}J.readUint16=Ue;function qb(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}J.readUint16LE=qb;function fn(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}J.readInt32=fn;function vA(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)}J.readInt32LE=vA;function Qe(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}J.readUint32=Qe;function yA(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)}J.readFloat32=yA;function Wm(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}J.readFloat64=Wm;function SA(e){return fn(e)/65536}J.readFixedPoint32=SA;function wA(e){return fn(e)/(1<<24)}J.readFixedPointPath32=wA;function zo(e,t){var n=e.view.byteOffset+e.offset;if(e.offset+=t,n+t>e.view.buffer.byteLength){if(ld(e,"Reading bytes exceeding buffer length"),t>100*1024*1024)throw new Error("Reading past end of file");var r=new Uint8Array(t),i=Math.min(t,e.view.byteLength-n);return i>0&&r.set(new Uint8Array(e.view.buffer,n,i)),r}else return new Uint8Array(e.view.buffer,n,t)}J.readBytes=zo;function Ya(e){return t_(e,4)}J.readSignature=Ya;function Jb(e,t){var n=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return n=="8BIM"||n=="8B64"}J.validSignatureAt=Jb;function cd(e,t){for(var n=ot(e),r=n?t_(e,n):"";++n%t;)e.offset++;return r}J.readPascalString=cd;function Qb(e){var t=Qe(e);return e_(e,t)}J.readUnicodeString=Qb;function e_(e,t){for(var n="";t--;){var r=Ue(e);(r||t>0)&&(n+=String.fromCharCode(r))}return n}J.readUnicodeStringWithLength=e_;function bA(e,t){for(var n="";t--;){var r=qb(e);(r||t>0)&&(n+=String.fromCharCode(r))}return n}J.readUnicodeStringWithLengthLE=bA;function _A(e,t){for(var n="";t--;)n+=String.fromCharCode(ot(e));return n}J.readAsciiString=_A;function bt(e,t){e.offset+=t}J.skipBytes=bt;function Km(e,t,n){var r=e.offset,i=Ya(e);if(i!==t&&i!==n)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat(r.toString(16)))}J.checkSignature=Km;function t_(e,t){for(var n=zo(e,t),r="",i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}function Kb(e){return e==="8BIM"||e==="MeSa"||e==="AgHg"||e==="PHUT"||e==="DCSR"}function xA(e,t){var n;t===void 0&&(t={}),Km(e,"8BPS");var r=Ue(e);if(r!==1&&r!==2)throw new Error("Invalid PSD file version: ".concat(r));bt(e,6);var i=Ue(e),o=Qe(e),a=Qe(e),s=Ue(e),l=Ue(e),u=r===1?3e4:3e5;if(a>u||o>u)throw new Error("Invalid size: ".concat(a,"x").concat(o));if(i>16)throw new Error("Invalid channel count: ".concat(i));if(![1,8,16,32].includes(s))throw new Error("Invalid bitsPerChannel: ".concat(s));if(J.supportedColorModes.indexOf(l)===-1)throw new Error("Color mode not supported: ".concat((n=mA[l])!==null&&n!==void 0?n:l));var c={width:a,height:o,channels:i,bitsPerChannel:s,colorMode:l};Object.assign(e,t),e.large=r===2,e.globalAlpha=!1;var f=[0,1,-1,2,-2,3,-3,4,-4];fr(e,1,function(p){if(p()){if(l===2){if(p()!=768)throw new Error("Invalid color palette size");c.palette=[];for(var m=0;m<256;m++)c.palette.push({r:ot(e),g:0,b:0});for(var m=0;m<256;m++)c.palette[m].g=ot(e);for(var m=0;m<256;m++)c.palette[m].b=ot(e)}bt(e,p())}});var d={};fr(e,1,function(p){for(var m=function(){for(var v=e.offset,x="",w=0,_=f;w<_.length;w++){var E=_[w];try{e.offset=v+E,x=Ya(e)}catch(D){}if(Kb(x))break}if(!Kb(x))throw new Error("Invalid signature: '".concat(x,"' at 0x").concat(v.toString(16)));var P=Ue(e);cd(e,2),fr(e,2,function(D){var M=hA.resourceHandlersMap[P],j=P===1036&&!!e.skipThumbnail;if(M&&!j)try{M.read(e,d,D)}catch(N){if(e.throwForMissingFeatures)throw N;bt(e,D())}else bt(e,D())})};p()>0;)m()});var h=d.layersGroup,y=d.layerGroupsEnabledId,S=dA(d,["layersGroup","layerGroupsEnabledId"]);Object.keys(S)&&(c.imageResources=S),fr(e,1,function(p){if(fr(e,2,function(v){n_(e,c,d),bt(e,v())},void 0,e.large),p()>0){var m=r_(e);m&&(c.globalLayerMaskInfo=m)}else bt(e,p());for(;p()>0;){for(;p()&&Zb(e)===0;)bt(e,1);p()>=12?Zm(e,c,c,d):bt(e,p())}},void 0,e.large);var b=c.children&&c.children.length,g=e.skipCompositeImageData&&(e.skipLayerImageData||b);return g||PA(e,c),c}J.readPsd=xA;function n_(e,t,n){var r,i,o=n.layersGroup,a=o===void 0?[]:o,s=n.layerGroupsEnabledId,l=s===void 0?[]:s,u=to(e);u<0&&(e.globalAlpha=!0,u=-u);for(var c=[],f=[],d=0;d<u;d++){var h=EA(e,t,n),y=h.layer,S=h.channels;a[d]!==void 0&&(y.linkGroup=a[d]),l[d]!==void 0&&(y.linkGroupEnabled=!!l[d]),c.push(y),f.push(S)}if(!e.skipLayerImageData)for(var d=0;d<u;d++)IA(e,t,c[d],f[d]);t.children||(t.children=[]);for(var b=[t],d=c.length-1;d>=0;d--){var g=c[d],p=g.sectionDivider?g.sectionDivider.type:0;p===1||p===2?(g.opened=p===1,g.children=[],!((r=g.sectionDivider)===null||r===void 0)&&r.key&&(g.blendMode=(i=kt.toBlendMode[g.sectionDivider.key])!==null&&i!==void 0?i:g.blendMode),b[b.length-1].children.unshift(g),b.push(g)):p===3?b.pop():b[b.length-1].children.unshift(g)}}J.readLayerInfo=n_;function EA(e,t,n){var r={};r.top=fn(e),r.left=fn(e),r.bottom=fn(e),r.right=fn(e);for(var i=Ue(e),o=[],a=0;a<i;a++){var s=to(e),l=Qe(e);if(e.large){if(l!==0)throw new Error("Sizes larger than 4GB are not supported");l=Qe(e)}o.push({id:s,length:l})}Km(e,"8BIM");var u=Ya(e);if(!kt.toBlendMode[u])throw new Error("Invalid blend mode: '".concat(u,"'"));r.blendMode=kt.toBlendMode[u],r.opacity=ot(e)/255,r.clipping=ot(e)===1;var c=ot(e);return r.transparencyProtected=(c&1)!==0,r.hidden=(c&2)!==0,c&32&&(r.effectsOpen=!0),bt(e,1),fr(e,1,function(f){TA(e,r);var d=CA(e);for(d&&(r.blendingRanges=d),r.name=cd(e,1);f()>4&&!Jb(e,e.offset);)e.offset++;for(;f()>=12;)Zm(e,r,t,n);bt(e,f())}),{layer:r,channels:o}}function TA(e,t){return fr(e,1,function(n){if(n()){var r={};t.mask=r,r.top=fn(e),r.left=fn(e),r.bottom=fn(e),r.right=fn(e),r.defaultColor=ot(e);var i=ot(e);if(r.positionRelativeToLayer=(i&1)!==0,r.disabled=(i&2)!==0,r.fromVectorData=(i&8)!==0,n()>=18){var o={};t.realMask=o;var a=ot(e);o.positionRelativeToLayer=(a&1)!==0,o.disabled=(a&2)!==0,o.fromVectorData=(a&8)!==0,o.defaultColor=ot(e),o.top=fn(e),o.left=fn(e),o.bottom=fn(e),o.right=fn(e)}if(i&16){var s=ot(e);s&1&&(r.userMaskDensity=ot(e)/255),s&2&&(r.userMaskFeather=Wm(e)),s&4&&(r.vectorMaskDensity=ot(e)/255),s&8&&(r.vectorMaskFeather=Wm(e))}bt(e,n())}})}function sd(e){return[ot(e),ot(e),ot(e),ot(e)]}function CA(e){return fr(e,1,function(t){for(var n=sd(e),r=sd(e),i=[];t()>0;){var o=sd(e),a=sd(e);i.push({sourceRange:o,destRange:a})}return{compositeGrayBlendSource:n,compositeGraphBlendDestinationRange:r,ranges:i}})}function IA(e,t,n,r){var i,o,a,s,l=(n.right||0)-(n.left||0),u=(n.bottom||0)-(n.top||0),c=t.colorMode===4,f;if(l&&u)if(c){if(t.bitsPerChannel!==8)throw new Error("bitsPerChannel Not supproted");f={width:l,height:u,data:new Uint8ClampedArray(l*u*5)};for(var d=4;d<f.data.byteLength;d+=5)f.data[d]=255}else f=ud(l,u,(i=t.bitsPerChannel)!==null&&i!==void 0?i:8),(0,kt.resetImageData)(f);kt.RAW_IMAGE_DATA&&(n.imageDataRaw=[],n.imageDataRawCompression=[]);for(var h=0,y=r;h<y.length;h++){var S=y[h];if(S.length!==0){if(S.length<2)throw new Error("Invalid channel length");var b=e.offset,g=Ue(e);if(g>3&&(e.offset-=1,g=Ue(e)),g>3&&(e.offset-=3,g=Ue(e)),g>3)throw new Error("Invalid compression: ".concat(g));if(S.id===-2||S.id===-3){var p=S.id===-2?n.mask:n.realMask;if(!p)throw new Error("Missing layer ".concat(S.id===-2?"mask":"real mask"," data"));var m=(p.right||0)-(p.left||0),v=(p.bottom||0)-(p.top||0);if(m<0||v<0||m>3e4||v>3e4)throw new Error("Invalid mask size");if(m&&v){var x=ud(m,v,(o=t.bitsPerChannel)!==null&&o!==void 0?o:8);(0,kt.resetImageData)(x);var w=e.offset;$m(e,S.length,x,g,m,v,(a=t.bitsPerChannel)!==null&&a!==void 0?a:8,0,e.large,4),kt.RAW_IMAGE_DATA&&(S.id===-2?(n.maskDataRawCompression=g,n.maskDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+w,e.offset-w)):(n.realMaskDataRawCompression=g,n.realMaskDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+w,e.offset-w))),jm(x),e.useImageData?p.imageData=x:p.canvas=(0,kt.imageDataToCanvas)(x)}}else{var _=(0,kt.offsetForChannel)(S.id,c),E=f;if(_<0&&(E=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(S.id));$m(e,S.length,E,g,l,u,(s=t.bitsPerChannel)!==null&&s!==void 0?s:8,_,e.large,c?5:4),kt.RAW_IMAGE_DATA&&(n.imageDataRawCompression[S.id]=g,n.imageDataRaw[S.id]=new Uint8Array(e.view.buffer,e.view.byteOffset+b+2,S.length-2)),e.offset=b+S.length,E&&t.colorMode===1&&jm(E)}}}if(f){if(c){var P=f;f=(0,kt.createImageData)(P.width,P.height),i_(P,f,!1)}e.useImageData?n.imageData=f:n.canvas=(0,kt.imageDataToCanvas)(f)}}function $m(e,t,n,r,i,o,a,s,l,u){if(r===0)a_(e,n,i,o,a,u,s);else if(r===1)Xa(e,n,i,o,a,u,[s],l);else if(r===2)Ym(e,t,n,i,o,a,u,s,!1);else if(r===3)Ym(e,t,n,i,o,a,u,s,!0);else throw new Error("Invalid Compression type: ".concat(r))}J.readData=$m;function r_(e){return fr(e,1,function(t){if(t()){var n=Ue(e),r=Ue(e),i=Ue(e),o=Ue(e),a=Ue(e),s=Ue(e)/255,l=ot(e);return bt(e,t()),{overlayColorSpace:n,colorSpace1:r,colorSpace2:i,colorSpace3:o,colorSpace4:a,opacity:s,kind:l}}})}J.readGlobalLayerMaskInfo=r_;function Zm(e,t,n,r){var i=Ya(e);if(i!=="8BIM"&&i!=="8B64")throw new Error("Invalid signature: '".concat(i,"' at 0x").concat((e.offset-4).toString(16)));var o=Ya(e),a=i==="8B64"||e.large&&kt.largeAdditionalInfoKeys.indexOf(o)!==-1;fr(e,2,function(s){var l=pA.infoHandlersMap[o];if(l)try{l.read(e,t,s,n,r)}catch(u){if(e.throwForMissingFeatures)throw u}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(o)),bt(e,s());s()&&(e.logMissingFeatures&&e.log("Unread ".concat(s()," bytes left for additional info: ").concat(o)),bt(e,s()))},!1,a)}J.readAdditionalLayerInfo=Zm;function ud(e,t,n,r){if(r===void 0&&(r=4),n===1||n===8)return r===4?(0,kt.createImageData)(e,t):{width:e,height:t,data:new Uint8ClampedArray(e*t*r)};if(n===16)return{width:e,height:t,data:new Uint16Array(e*t*r)};if(n===32)return{width:e,height:t,data:new Float32Array(e*t*r)};throw new Error("Invalid bitDepth (".concat(n,")"))}J.createImageDataBitDepth=ud;function PA(e,t){var n,r=Ue(e),i=(n=t.bitsPerChannel)!==null&&n!==void 0?n:8;if(J.supportedColorModes.indexOf(t.colorMode)===-1)throw new Error("Color mode not supported: ".concat(t.colorMode));if(r!==0&&r!==1)throw new Error("Compression type not supported: ".concat(r));var o=ud(t.width,t.height,i);switch((0,kt.resetImageData)(o),t.colorMode){case 0:{if(i!==1)throw new Error("Invalid bitsPerChannel for bitmap color mode");var a=void 0;if(r===0)a=zo(e,Math.ceil(t.width/8)*t.height);else if(r===1)a=new Uint8Array(t.width*t.height),Xa(e,{data:a,width:t.width,height:t.height},t.width,t.height,8,1,[0],e.large);else throw new Error("Bitmap compression not supported: ".concat(r));(0,kt.decodeBitmap)(a,o.data,t.width,t.height);break}case 3:case 1:{var s=t.colorMode===1?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var l=3;l<t.channels;l++)s.push(l);else e.globalAlpha&&s.push(3);if(r===0)for(var l=0;l<s.length;l++)a_(e,o,t.width,t.height,i,4,s[l]);else if(r===1){var u=e.offset;Xa(e,o,t.width,t.height,i,4,s,e.large),kt.RAW_IMAGE_DATA&&(t.imageDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+u,e.offset-u))}t.colorMode===1&&jm(o);break}case 2:{if(i!==8)throw new Error("bitsPerChannel Not supproted");if(t.channels!==1)throw new Error("Invalid channel count");if(!t.palette)throw new Error("Missing color palette");if(r===0)throw new Error("Not implemented");if(r===1){var c={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height)};Xa(e,c,t.width,t.height,i,1,[0],e.large),AA(c,o,t.palette)}else throw new Error("Not implemented");break}case 4:{if(i!==8)throw new Error("bitsPerChannel Not supproted");if(t.channels!==4)throw new Error("Invalid channel count");var s=[0,1,2,3];if(e.globalAlpha&&s.push(4),r===0)throw new Error("Not implemented");if(r===1){var f={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height*5)},u=e.offset;Xa(e,f,t.width,t.height,i,5,s,e.large),i_(f,o,!0),kt.RAW_IMAGE_DATA&&(t.imageDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+u,e.offset-u))}else throw new Error("Not implemented");break}default:throw new Error("Color mode not supported: ".concat(t.colorMode))}if(e.globalAlpha){if(t.bitsPerChannel!==8)throw new Error("bitsPerChannel Not supproted");for(var d=o.data,h=o.width*o.height*4,l=0;l<h;l+=4){var y=d[l+3];if(y!=0&&y!=255){var S=y/255,b=1/S,g=255*(1-b);d[l+0]=d[l+0]*b+g,d[l+1]=d[l+1]*b+g,d[l+2]=d[l+2]*b+g}}}e.useImageData?t.imageData=o:t.canvas=(0,kt.imageDataToCanvas)(o)}function i_(e,t,n){for(var r=t.width*t.height*4,i=e.data,o=t.data,a=0,s=0;s<r;a+=5,s+=4){var l=i[a],u=i[a+1],c=i[a+2],f=i[a+3];o[s]=(l*f|0)/255|0,o[s+1]=(u*f|0)/255|0,o[s+2]=(c*f|0)/255|0,o[s+3]=n?255-i[a+4]:i[a+4]}}function AA(e,t,n){for(var r=e.width*e.height,i=e.data,o=t.data,a=0,s=0;a<r;a++,s+=4){var l=n[i[a]];o[s+0]=l.r,o[s+1]=l.g,o[s+2]=l.b,o[s+3]=255}}function DA(e,t){if(e.byteLength/e.length!==t.byteLength/t.length)throw new Error("Invalid array types")}function o_(e,t){if(t===8)return e;if(t===16)if(e.byteOffset%2){var n=new Uint16Array(e.byteLength/2);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}else return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);else if(t===32)if(e.byteOffset%4){var n=new Float32Array(e.byteLength/4);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}else return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4);else throw new Error("Invalid bitDepth (".concat(t,")"))}function Xm(e,t,n,r){DA(e.data,t);for(var i=e.width*e.height,o=e.data,a=0,s=n|0;a<i;a++,s=s+r|0)o[s]=t[a]}function a_(e,t,n,r,i,o,a){var s=zo(e,n*r*Math.floor(i/8));if(i==32)for(var l=0;l<s.byteLength;l+=4){var u=s[l+0],c=s[l+1],f=s[l+2],d=s[l+3];s[l+0]=d,s[l+1]=f,s[l+2]=c,s[l+3]=u}var h=o_(s,i);t&&a<o&&Xm(t,h,a,o)}function Hm(e,t,n,r){for(var i=0;i<n;i++)for(var o=i*t,a=1,s=o+1;a<t;a++,s++)e[s]=(e[s-1]+e[s])%r}function Ym(e,t,n,r,i,o,a,s,l){var u=zo(e,t),c=(0,fA.inflate)(u);if(n&&s<a){var f=o_(c,o);if(o===8)l&&Hm(c,r,i,256),Xm(n,c,s,a);else if(o===16)l&&Hm(f,r,i,65536),Xm(n,f,s,a);else if(o===32){l&&Hm(c,r*4,i,256);for(var d=s,h=new Uint32Array(n.data.buffer,n.data.byteOffset,n.data.length),y=0;y<i;y++)for(var S=r*4*y,b=0;b<r;b++,S++,d+=a){var g=S+r,p=g+r,m=p+r;h[d]=(c[S]<<24|c[g]<<16|c[p]<<8|c[m])>>>0}}else throw new Error("Invalid bitDepth")}}J.readDataZip=Ym;function Xa(e,t,n,r,i,o,a,s){var l=t&&t.data,u;if(s){u=new Uint32Array(a.length*r);for(var c=0,f=0;c<a.length;c++)for(var d=0;d<r;d++,f++)u[f]=Qe(e)}else{u=new Uint16Array(a.length*r);for(var c=0,f=0;c<a.length;c++)for(var d=0;d<r;d++,f++)u[f]=Ue(e)}if(i!==1&&i!==8)throw new Error("Invalid bit depth (".concat(i,")"));for(var h=o-1|0,y=0,f=0;y<a.length;y++){var S=a[y]|0,b=y>h||S>h;if(!l||b)for(var d=0;d<r;d++,f++)bt(e,u[f]);else for(var d=0,g=S|0;d<r;d++,f++)for(var p=u[f],m=zo(e,p),v=0,x=0;v<p;v++){var w=m[v];if(w>128){var _=m[++v];w=256-w|0;for(var E=0;E<=w&&x<n;E=E+1|0,x=x+1|0)l[g]=_,g=g+o|0}else if(w<128)for(var E=0;E<=w&&x<n;E=E+1|0,x=x+1|0)l[g]=m[++v],g=g+o|0}}}J.readDataRLE=Xa;function fr(e,t,n,r,i){r===void 0&&(r=!0),i===void 0&&(i=!1);var o=Qe(e);if(i){if(o!==0)throw new Error("Sizes larger than 4GB are not supported");o=Qe(e)}if(!(o<=0&&r)){var a=e.offset+o;if(a>e.view.byteLength)throw new Error("Section exceeds file size");var s=n(function(){return a-e.offset});for(e.offset!==a&&(e.offset>a?ld(e,"Exceeded section limits"):ld(e,"Unread section data"));a%t;)a++;return e.offset=a,s}}J.readSection=fr;function LA(e){var t=Ue(e);switch(t){case 0:{var n=Ue(e)/257,r=Ue(e)/257,i=Ue(e)/257;return bt(e,2),{r:n,g:r,b:i}}case 1:{var o=Ue(e)/65535,a=Ue(e)/65535,i=Ue(e)/65535;return bt(e,2),{h:o,s:a,b:i}}case 2:{var s=Ue(e)/257,l=Ue(e)/257,u=Ue(e)/257,c=Ue(e)/257;return{c:s,m:l,y:u,k:c}}case 7:{var f=to(e)/1e4,d=to(e),h=to(e),y=d<0?d/12800:d/12700,i=h<0?h/12800:h/12700;return bt(e,2),{l:f,a:y,b:i}}case 8:{var c=Ue(e)*255/1e4;return bt(e,6),{k:c}}default:throw new Error("Invalid color space")}}J.readColor=LA;function kA(e){Qe(e);var t=Qe(e);if(t!==1)throw new Error("Invalid pattern version: ".concat(t));var n=Qe(e),r=to(e),i=to(e);if(n!==3&&n!==1&&n!==2)throw new Error("Unsupported pattern color mode: ".concat(n));var o=Qb(e),a=cd(e,1),s=[];if(n===2){for(var l=0;l<256;l++)s.push({r:ot(e),g:ot(e),b:ot(e)});bt(e,4)}var u=Qe(e);if(u!==3)throw new Error("Invalid pattern VMAL version: ".concat(u));Qe(e);for(var c=Qe(e),f=Qe(e),d=Qe(e),h=Qe(e),y=Qe(e),S=h-f,b=d-c,g=new Uint8Array(S*b*4),l=3;l<g.byteLength;l+=4)g[l]=255;for(var l=0,p=0;l<y+2;l++){var m=Qe(e);if(m){var v=Qe(e),x=Qe(e),w=Qe(e),_=Qe(e),E=Qe(e),P=Qe(e),D=Ue(e),M=ot(e),j=v-23,N=zo(e,j);if(x!==8||D!==8)throw new Error("16bit pixel depth not supported for patterns");var L=P-_,O=E-w,F=_-f,X=w-c;if(M===0){if(n===3&&p<3)for(var te=0;te<O;te++)for(var ge=0;ge<L;ge++){var ne=ge+te*L,Ie=(F+ge+(te+X)*S)*4;g[Ie+p]=N[ne]}if(n===1&&p<1)for(var je=0;je<O;je++)for(var Q=0;Q<L;Q++){var ne=Q+je*L,Ie=(F+Q+(je+X)*S)*4,W=N[ne];g[Ie+0]=W,g[Ie+1]=W,g[Ie+2]=W}if(n===2)throw new Error("Indexed pattern color mode not implemented")}else if(M===1)e.log("Unsupported pattern compression"),o+=" (failed to decode)";else throw new Error("Invalid pattern compression mode");p++}}return{id:a,name:o,x:r,y:i,bounds:{x:f,y:c,w:S,h:b},data:g}}J.readPattern=kA});var c_=_e(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.writeEffects=Qa.readEffects=void 0;var l_=Qi(),he=eo(),se=Wa(),u_=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function Ka(e){return(0,he.checkSignature)(e,"8BIM"),l_.toBlendMode[(0,he.readSignature)(e)]||"normal"}function qa(e,t){(0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,l_.fromBlendMode[t]||"norm")}function Za(e){return(0,he.readUint8)(e)/255}function Ja(e,t){(0,se.writeUint8)(e,Math.round(t*255)|0)}function RA(e){var t=(0,he.readUint16)(e);if(t!==0)throw new Error("Invalid effects layer version: ".concat(t));for(var n=(0,he.readUint16)(e),r={},i=0;i<n;i++){(0,he.checkSignature)(e,"8BIM");var o=(0,he.readSignature)(e);switch(o){case"cmnS":{var a=(0,he.readUint32)(e),s=(0,he.readUint32)(e),l=!!(0,he.readUint8)(e);if((0,he.skipBytes)(e,2),a!==7||s!==0||!l)throw new Error("Invalid effects common state");break}case"dsdw":case"isdw":{var u=(0,he.readUint32)(e),c=(0,he.readUint32)(e);if(u!==41&&u!==51)throw new Error("Invalid shadow size: ".concat(u));if(c!==0&&c!==2)throw new Error("Invalid shadow version: ".concat(c));var a=(0,he.readFixedPoint32)(e);(0,he.readFixedPoint32)(e);var f=(0,he.readFixedPoint32)(e),d=(0,he.readFixedPoint32)(e),h=(0,he.readColor)(e),y=Ka(e),S=!!(0,he.readUint8)(e),b=!!(0,he.readUint8)(e),g=Za(e);u>=51&&(0,he.readColor)(e);var p={size:{units:"Pixels",value:a},distance:{units:"Pixels",value:d},angle:f,color:h,blendMode:y,enabled:S,useGlobalLight:b,opacity:g};o==="dsdw"?r.dropShadow=[p]:r.innerShadow=[p];break}case"oglw":{var u=(0,he.readUint32)(e),m=(0,he.readUint32)(e);if(u!==32&&u!==42)throw new Error("Invalid outer glow size: ".concat(u));if(m!==0&&m!==2)throw new Error("Invalid outer glow version: ".concat(m));var a=(0,he.readFixedPoint32)(e);(0,he.readFixedPoint32)(e);var h=(0,he.readColor)(e),y=Ka(e),S=!!(0,he.readUint8)(e),g=Za(e);u>=42&&(0,he.readColor)(e),r.outerGlow={size:{units:"Pixels",value:a},color:h,blendMode:y,enabled:S,opacity:g};break}case"iglw":{var u=(0,he.readUint32)(e),v=(0,he.readUint32)(e);if(u!==32&&u!==43)throw new Error("Invalid inner glow size: ".concat(u));if(v!==0&&v!==2)throw new Error("Invalid inner glow version: ".concat(v));var a=(0,he.readFixedPoint32)(e);(0,he.readFixedPoint32)(e);var h=(0,he.readColor)(e),y=Ka(e),S=!!(0,he.readUint8)(e),g=Za(e);u>=43&&((0,he.readUint8)(e),(0,he.readColor)(e)),r.innerGlow={size:{units:"Pixels",value:a},color:h,blendMode:y,enabled:S,opacity:g};break}case"bevl":{var u=(0,he.readUint32)(e),x=(0,he.readUint32)(e);if(u!==58&&u!==78)throw new Error("Invalid bevel size: ".concat(u));if(x!==0&&x!==2)throw new Error("Invalid bevel version: ".concat(x));var f=(0,he.readFixedPoint32)(e),w=(0,he.readFixedPoint32)(e),a=(0,he.readFixedPoint32)(e),_=Ka(e),E=Ka(e),P=(0,he.readColor)(e),D=(0,he.readColor)(e),M=u_[(0,he.readUint8)(e)]||"inner bevel",j=Za(e),N=Za(e),S=!!(0,he.readUint8)(e),b=!!(0,he.readUint8)(e),L=(0,he.readUint8)(e)?"down":"up";u>=78&&((0,he.readColor)(e),(0,he.readColor)(e)),r.bevel={size:{units:"Pixels",value:a},angle:f,strength:w,highlightBlendMode:_,shadowBlendMode:E,highlightColor:P,shadowColor:D,style:M,highlightOpacity:j,shadowOpacity:N,enabled:S,useGlobalLight:b,direction:L};break}case"sofi":{var a=(0,he.readUint32)(e),O=(0,he.readUint32)(e);if(a!==34)throw new Error("Invalid effects solid fill info size: ".concat(a));if(O!==2)throw new Error("Invalid effects solid fill info version: ".concat(O));var y=Ka(e),h=(0,he.readColor)(e),g=Za(e),S=!!(0,he.readUint8)(e);(0,he.readColor)(e),r.solidFill=[{blendMode:y,color:h,opacity:g,enabled:S}];break}default:throw new Error("Invalid effect type: '".concat(o,"'"))}}return r}Qa.readEffects=RA;function s_(e,t){var n;(0,se.writeUint32)(e,51),(0,se.writeUint32)(e,2),(0,se.writeFixedPoint32)(e,t.size&&t.size.value||0),(0,se.writeFixedPoint32)(e,0),(0,se.writeFixedPoint32)(e,t.angle||0),(0,se.writeFixedPoint32)(e,t.distance&&t.distance.value||0),(0,se.writeColor)(e,t.color),qa(e,t.blendMode),(0,se.writeUint8)(e,t.enabled?1:0),(0,se.writeUint8)(e,t.useGlobalLight?1:0),Ja(e,(n=t.opacity)!==null&&n!==void 0?n:1),(0,se.writeColor)(e,t.color)}function MA(e,t){var n,r,i,o,a,s,l=(n=t.dropShadow)===null||n===void 0?void 0:n[0],u=(r=t.innerShadow)===null||r===void 0?void 0:r[0],c=t.outerGlow,f=t.innerGlow,d=t.bevel,h=(i=t.solidFill)===null||i===void 0?void 0:i[0],y=1;if(l&&y++,u&&y++,c&&y++,f&&y++,d&&y++,h&&y++,(0,se.writeUint16)(e,0),(0,se.writeUint16)(e,y),(0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"cmnS"),(0,se.writeUint32)(e,7),(0,se.writeUint32)(e,0),(0,se.writeUint8)(e,1),(0,se.writeZeros)(e,2),l&&((0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"dsdw"),s_(e,l)),u&&((0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"isdw"),s_(e,u)),c&&((0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"oglw"),(0,se.writeUint32)(e,42),(0,se.writeUint32)(e,2),(0,se.writeFixedPoint32)(e,((o=c.size)===null||o===void 0?void 0:o.value)||0),(0,se.writeFixedPoint32)(e,0),(0,se.writeColor)(e,c.color),qa(e,c.blendMode),(0,se.writeUint8)(e,c.enabled?1:0),Ja(e,c.opacity||0),(0,se.writeColor)(e,c.color)),f&&((0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"iglw"),(0,se.writeUint32)(e,43),(0,se.writeUint32)(e,2),(0,se.writeFixedPoint32)(e,((a=f.size)===null||a===void 0?void 0:a.value)||0),(0,se.writeFixedPoint32)(e,0),(0,se.writeColor)(e,f.color),qa(e,f.blendMode),(0,se.writeUint8)(e,f.enabled?1:0),Ja(e,f.opacity||0),(0,se.writeUint8)(e,0),(0,se.writeColor)(e,f.color)),d){(0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"bevl"),(0,se.writeUint32)(e,78),(0,se.writeUint32)(e,2),(0,se.writeFixedPoint32)(e,d.angle||0),(0,se.writeFixedPoint32)(e,d.strength||0),(0,se.writeFixedPoint32)(e,((s=d.size)===null||s===void 0?void 0:s.value)||0),qa(e,d.highlightBlendMode),qa(e,d.shadowBlendMode),(0,se.writeColor)(e,d.highlightColor),(0,se.writeColor)(e,d.shadowColor);var S=u_.indexOf(d.style);(0,se.writeUint8)(e,S<=0?1:S),Ja(e,d.highlightOpacity||0),Ja(e,d.shadowOpacity||0),(0,se.writeUint8)(e,d.enabled?1:0),(0,se.writeUint8)(e,d.useGlobalLight?1:0),(0,se.writeUint8)(e,d.direction==="down"?1:0),(0,se.writeColor)(e,d.highlightColor),(0,se.writeColor)(e,d.shadowColor)}h&&((0,se.writeSignature)(e,"8BIM"),(0,se.writeSignature)(e,"sofi"),(0,se.writeUint32)(e,34),(0,se.writeUint32)(e,2),qa(e,h.blendMode),(0,se.writeColor)(e,h.color),Ja(e,h.opacity||0),(0,se.writeUint8)(e,h.enabled?1:0),(0,se.writeColor)(e,h.color))}Qa.writeEffects=MA});var p_=_e(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.serializeEngineData=es.parseEngineData=void 0;function d_(e){return e===32||e===10||e===13||e===9}function f_(e){return e>=48&&e<=57||e===46||e===45}function OA(e){var t=0;function n(){for(;t<e.length&&d_(e[t]);)t++}function r(){var p=e[t];return t++,p===92&&(p=e[t],t++),p}function i(){var p="";if(e[t]===41)return t++,p;if(e[t]!==254||e[t+1]!==255)throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&e[t]!==41;){var m=r(),v=r(),x=m<<8|v;p+=String.fromCharCode(x)}return t++,p}var o=null,a=[];function s(p){a.length?(l(p),a.push(p)):(a.push(p),o=p)}function l(p){if(!a.length)throw new Error("Invalid data");var m=a[a.length-1];if(typeof m=="string")a[a.length-2][m]=p,c();else if(Array.isArray(m))m.push(p);else throw new Error("Invalid data")}function u(p){a.length||s({});var m=a[a.length-1];if(m&&typeof m=="string")l(p==="nil"?null:"/".concat(p));else if(m&&typeof m=="object")a.push(p);else throw new Error("Invalid data")}function c(){if(!a.length)throw new Error("Invalid data");a.pop()}n();for(var f=e.length;f>0&&e[f-1]===0;)f--;for(;t<f;){var d=t,h=e[d];if(h===60&&e[d+1]===60)t+=2,s({});else if(h===62&&e[d+1]===62)t+=2,c();else if(h===47){t+=1;for(var y=t;t<e.length&&!d_(e[t]);)t++;for(var S="",b=y;b<t;b++)S+=String.fromCharCode(e[b]);u(S)}else if(h===40)t+=1,l(i());else if(h===91)t+=1,s([]);else if(h===93)t+=1,c();else if(h===110&&e[d+1]===117&&e[d+2]===108&&e[d+3]===108)t+=4,l(null);else if(h===116&&e[d+1]===114&&e[d+2]===117&&e[d+3]===101)t+=4,l(!0);else if(h===102&&e[d+1]===97&&e[d+2]===108&&e[d+3]===115&&e[d+4]===101)t+=5,l(!1);else if(f_(h)){for(var g="";t<e.length&&f_(e[t]);)g+=String.fromCharCode(e[t]),t++;l(parseFloat(g))}else t+=1,console.log("Invalid token '".concat(String.fromCharCode(h),"' (").concat(h,") at ").concat(t));n()}return o}es.parseEngineData=OA;var FA=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],NA=["RunLengthArray"];function UA(e,t){t===void 0&&(t=!1);var n=new Uint8Array(1024),r=0,i=0;function o(p){if(r>=n.length){var m=new Uint8Array(n.length*2);m.set(n),n=m}n[r]=p,r++}function a(p){for(var m=0;m<p.length;m++)o(p.charCodeAt(m))}function s(){if(t)a(" ");else for(var p=0;p<i;p++)a("	")}function l(p,m){s(),a("/".concat(p)),y(m,p,!0),t||a(`
`)}function u(p){return p.toString()}function c(p){return p.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function f(p,m){var v=m&&FA.indexOf(m)!==-1||(p|0)!==p;return v?c(p):u(p)}function d(p){var m=Object.keys(p);return m.indexOf("98")!==-1&&m.unshift.apply(m,m.splice(m.indexOf("99"),1)),m.indexOf("99")!==-1&&m.unshift.apply(m,m.splice(m.indexOf("99"),1)),m}function h(p){(p===40||p===41||p===92)&&o(92),o(p)}function y(p,m,v){v===void 0&&(v=!1);function x(){v?a(" "):s()}if(p===null)x(),a(t?"/nil":"null");else if(typeof p=="number")x(),a(f(p,m));else if(typeof p=="boolean")x(),a(p?"true":"false");else if(typeof p=="string")if(x(),(m==="99"||m==="98")&&p.charAt(0)==="/")a(p);else{a("("),o(254),o(255);for(var w=0;w<p.length;w++){var _=p.charCodeAt(w);h(_>>8&255),h(_&255)}a(")")}else if(Array.isArray(p))if(x(),p.every(function(X){return typeof X=="number"})){a("[");for(var E=NA.indexOf(m)!==-1,P=0,D=p;P<D.length;P++){var M=D[P];a(" "),a(E?f(M):c(M))}a(" ]")}else{a("["),t||a(`
`);for(var j=0,N=p;j<N.length;j++){var M=N[j];y(M,m),t||a(`
`)}s(),a("]")}else if(typeof p=="object"){v&&!t&&a(`
`),s(),a("<<"),t||a(`
`),i++;for(var L=0,O=d(p);L<O.length;L++){var F=O[L];l(F,p[F])}i--,s(),a(">>")}}if(t){if(typeof e=="object")for(var S=0,b=d(e);S<b.length;S++){var g=b[S];l(g,e[g])}}else a(`

`),y(e);return n.slice(0,r)}es.serializeEngineData=UA});var x_=_e(no=>{"use strict";var Tt=no&&no.__assign||function(){return Tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Tt.apply(this,arguments)};Object.defineProperty(no,"__esModule",{value:!0});no.encodeEngineData=no.decodeEngineData=void 0;var v_={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},fd={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},BA={font:v_,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},zA={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},Qm=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],e0=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],y_=["none","crisp","strong","smooth","sharp"],S_=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function w_(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function VA(e){var t=e.Values;switch(e.Type){case 0:return{k:t[1]*255};case 1:return t[0]===1?{r:t[1]*255,g:t[2]*255,b:t[3]*255}:{r:t[1]*255,g:t[2]*255,b:t[3]*255,a:t[0]*255};case 2:return{c:t[1]*255,m:t[2]*255,y:t[3]*255,k:t[4]*255};default:throw new Error("Unknown color type in text layer")}}function Jm(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}else return{Type:1,Values:[0,0,0,0]}}function h_(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function m_(e,t){if(!e||!t)return!1;for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if(e[i]!==t[i])return!1}for(var o=0,a=Object.keys(t);o<a.length;o++){var i=a[o];if(e[i]!==t[i])return!1}return!0}function GA(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t.name)return n;return e.push(t),e.length-1}function b_(e,t,n){for(var r={},i=0,o=t;i<o.length;i++){var a=o[i],s=w_(a);e[s]!==void 0&&(a==="justification"?r[a]=S_[e[s]]:a==="font"?r[a]=n[e[s]]:a==="fillColor"||a==="strokeColor"?r[a]=VA(e[s]):r[a]=e[s])}return r}function __(e,t,n){for(var r,i={},o=0,a=t;o<a.length;o++){var s=a[o],l=w_(s);e[s]!==void 0&&(s==="justification"?i[l]=S_.indexOf((r=e[s])!==null&&r!==void 0?r:"left"):s==="font"?i[l]=GA(n,e[s]):s==="fillColor"||s==="strokeColor"?i[l]=Jm(e[s]):i[l]=e[s])}return i}function HA(e,t){return b_(e,Qm,t)}function jA(e,t){return b_(e,e0,t)}function pd(e,t){return __(e,Qm,t)}function qm(e,t){return __(e,e0,t)}function g_(e,t,n){if(t.length){for(var r=function(s){var l=t[0].style[s];if(l!==void 0){var u=!1;Array.isArray(l)?u=t.every(function(S){return h_(S.style[s],l)}):typeof l=="object"?u=t.every(function(S){return m_(S.style[s],l)}):u=t.every(function(S){return S.style[s]===l}),u&&(e[s]=l)}var c=e[s];if(c!==void 0)for(var f=0,d=t;f<d.length;f++){var h=d[f],y=!1;Array.isArray(l)?y=h_(h.style[s],l):typeof l=="object"?y=m_(h.style[s],l):y=h.style[s]===l,y&&delete h.style[s]}},i=0,o=n;i<o.length;i++){var a=o[i];r(a)}t.every(function(s){return Object.keys(s.style).length===0})&&(t.length=0)}}function WA(e){for(var t,n,r,i,o,a,s=e.EngineDict,l=e.ResourceDict,u=l.FontSet.map(function(w){return{name:w.Name,script:w.Script,type:w.FontType,synthetic:w.Synthetic}}),c=s.Editor.Text.replace(/\r/g,`
`),f=0;/\n$/.test(c);)c=c.substring(0,c.length-1),f++;var d={text:c,antiAlias:(t=y_[s.AntiAlias])!==null&&t!==void 0?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:l.SuperscriptSize,superscriptPosition:l.SuperscriptPosition,subscriptSize:l.SubscriptSize,subscriptPosition:l.SubscriptPosition,smallCapSize:l.SmallCapSize},h=(a=(o=(i=(r=(n=s.Rendered)===null||n===void 0?void 0:n.Shapes)===null||r===void 0?void 0:r.Children)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.Cookie)===null||a===void 0?void 0:a.Photoshop;h&&(d.shapeType=h.ShapeType===1?"box":"point",h.PointBase&&(d.pointBase=h.PointBase),h.BoxBounds&&(d.boxBounds=h.BoxBounds));var y=s.ParagraphRun;d.paragraphStyle={},d.paragraphStyleRuns=[];for(var S=0;S<y.RunArray.length;S++){var b=y.RunArray[S],g=y.RunLengthArray[S],p=HA(b.ParagraphSheet.Properties,u);d.paragraphStyleRuns.push({length:g,style:p})}for(var m=f;d.paragraphStyleRuns.length&&m>0;m--)--d.paragraphStyleRuns[d.paragraphStyleRuns.length-1].length===0&&d.paragraphStyleRuns.pop();g_(d.paragraphStyle,d.paragraphStyleRuns,Qm),d.paragraphStyleRuns.length||delete d.paragraphStyleRuns;var v=s.StyleRun;d.style={},d.styleRuns=[];for(var S=0;S<v.RunArray.length;S++){var x=v.RunLengthArray[S],p=jA(v.RunArray[S].StyleSheet.StyleSheetData,u);p.font||(p.font=u[0]),d.styleRuns.push({length:x,style:p})}for(var m=f;d.styleRuns.length&&m>0;m--)--d.styleRuns[d.styleRuns.length-1].length===0&&d.styleRuns.pop();return g_(d.style,d.styleRuns,e0),d.styleRuns.length||delete d.styleRuns,d}no.decodeEngineData=WA;function $A(e){var t,n,r,i,o,a,s,l,u,c,f,d,h="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),y=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],S=((t=e.style)===null||t===void 0?void 0:t.font)||((r=(n=e.styleRuns)===null||n===void 0?void 0:n.find(function(re){return re.style.font}))===null||r===void 0?void 0:r.style.font)||v_,b=[],g=[],p=e.paragraphStyleRuns;if(p&&p.length){for(var m=h.length,v=0,x=p;v<x.length;v++){var w=x[v],_=Math.min(w.length,m);m-=_,_&&(m===1&&w===p[p.length-1]&&(_++,m--),g.push(_),b.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:pd(Tt(Tt(Tt({},fd),e.paragraphStyle),w.style),y)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}m&&(g.push(m),b.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:pd(Tt(Tt({},fd),e.paragraphStyle),y)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var E=0,P=0;E<h.length;E++)h.charCodeAt(E)===13&&(g.push(E-P+1),b.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:pd(Tt(Tt({},fd),e.paragraphStyle),y)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),P=E+1);for(var D=qm(Tt(Tt({},BA),{font:S}),y),M=e.styleRuns||[{length:h.length,style:e.style||{}}],j=[],N=[],L=h.length,O=0,F=M;O<F.length;O++){var X=F[O],_=Math.min(X.length,L);L-=_,_&&(L===1&&X===M[M.length-1]&&(_++,L--),N.push(_),j.push({StyleSheet:{StyleSheetData:qm(Tt(Tt({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),X.style),y)}}))}L&&M.length&&(N.push(L),j.push({StyleSheet:{StyleSheetData:qm(Tt({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),y)}}));var te=Tt(Tt({},zA),e.gridInfo),ge=e.orientation==="vertical"?2:0,ne=e.orientation==="vertical"?1:0,Ie=e.shapeType==="box"?1:0,je={ShapeType:Ie};Ie===0?je.PointBase=e.pointBase||[0,0]:je.BoxBounds=e.boxBounds||[0,0,0,0],je.Base={ShapeType:Ie,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var Q={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"\u3001\u3002\uFF0C\uFF0E\u30FB\uFF1A\uFF1B\uFF1F\uFF01\u30FC\u2015\u2019\u201D\uFF09\u3015\uFF3D\uFF5D\u3009\u300B\u300D\u300F\u3011\u30FD\u30FE\u309D\u309E\u3005\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u309B\u309C?!)]},.:;\u2103\u2109\xA2\uFF05\u2030",NoEnd:"\u2018\u201C\uFF08\u3014\uFF3B\uFF5B\u3008\u300A\u300C\u300E\u3010([{\uFFE5\uFF04\xA3\uFF20\xA7\u3012\uFF03",Keep:"\u2015\u2025",Hanging:"\u3001\u3002.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"\u3001\u3002\uFF0C\uFF0E\u30FB\uFF1A\uFF1B\uFF1F\uFF01\u2019\u201D\uFF09\u3015\uFF3D\uFF5D\u3009\u300B\u300D\u300F\u3011\u30FD\u30FE\u309D\u309E\u3005",NoEnd:"\u2018\u201C\uFF08\u3014\uFF3B\uFF5B\u3008\u300A\u300C\u300E\u3010",Keep:"\u2015\u2025",Hanging:"\u3001\u3002.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:pd(Tt(Tt({},fd),e.paragraphStyle),y)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:D}],FontSet:y.map(function(re){return{Name:re.name,Script:re.script||0,FontType:re.type||0,Synthetic:re.synthetic||0}}),SuperscriptSize:(i=e.superscriptSize)!==null&&i!==void 0?i:.583,SuperscriptPosition:(o=e.superscriptPosition)!==null&&o!==void 0?o:.333,SubscriptSize:(a=e.subscriptSize)!==null&&a!==void 0?a:.583,SubscriptPosition:(s=e.subscriptPosition)!==null&&s!==void 0?s:.333,SmallCapSize:(l=e.smallCapSize)!==null&&l!==void 0?l:.7},W={EngineDict:{Editor:{Text:h},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:b,RunLengthArray:g,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:j,RunLengthArray:N,IsJoinable:2},GridInfo:{GridIsOn:!!te.isOn,ShowGrid:!!te.show,GridSize:(u=te.size)!==null&&u!==void 0?u:18,GridLeading:(c=te.leading)!==null&&c!==void 0?c:22,GridColor:Jm(te.color),GridLeadingFillColor:Jm(te.color),AlignLineHeightToGridFlags:!!te.alignLineHeightToGridFlags},AntiAlias:y_.indexOf((f=e.antiAlias)!==null&&f!==void 0?f:"sharp"),UseFractionalGlyphWidths:(d=e.useFractionalGlyphWidths)!==null&&d!==void 0?d:!0,Rendered:{Version:1,Shapes:{WritingDirection:ge,Children:[{ShapeType:Ie,Procession:ne,Lines:{WritingDirection:ge,Children:[]},Cookie:{Photoshop:je}}]}}},ResourceDict:Tt({},Q),DocumentResources:Tt({},Q)};return W}no.encodeEngineData=$A});var T_=_e(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.decodeEngineData2=void 0;var t0={0:{uproot:!0,children:{0:{name:"Type"},1:{name:"Values"}}}},r0={0:{name:"Font"},1:{name:"FontSize"},2:{name:"FauxBold"},3:{name:"FauxItalic"},4:{name:"AutoLeading"},5:{name:"Leading"},6:{name:"HorizontalScale"},7:{name:"VerticalScale"},8:{name:"Tracking"},9:{name:"BaselineShift"},11:{name:"Kerning?"},12:{name:"FontCaps"},13:{name:"FontBaseline"},15:{name:"Strikethrough?"},16:{name:"Underline?"},18:{name:"Ligatures"},19:{name:"DLigatures"},23:{name:"Fractions"},24:{name:"Ordinals"},28:{name:"StylisticAlternates"},30:{name:"OldStyle?"},35:{name:"BaselineDirection"},38:{name:"Language"},52:{name:"NoBreak"},53:{name:"FillColor",children:t0},54:{name:"StrokeColor",children:t0},55:{children:{99:{uproot:!0}}},79:{children:t0}},n0={0:{name:"Justification"},1:{name:"FirstLineIndent"},2:{name:"StartIndent"},3:{name:"EndIndent"},4:{name:"SpaceBefore"},5:{name:"SpaceAfter"},7:{name:"AutoLeading"},9:{name:"AutoHyphenate"},10:{name:"HyphenatedWordSize"},11:{name:"PreHyphen"},12:{name:"PostHyphen"},13:{name:"ConsecutiveHyphens?"},14:{name:"Zone"},15:{name:"HypenateCapitalizedWords"},17:{name:"WordSpacing"},18:{name:"LetterSpacing"},19:{name:"GlyphSpacing"},32:{name:"StyleSheet",children:r0}},E_={name:"StyleSheetData",children:r0},XA={0:{name:"ResourceDict",children:{1:{name:"FontSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},2:{name:"FontType"}}}}}}}}},2:{name:"2",children:{}},3:{name:"MojiKumiSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"InternalName"}}}}}}},4:{name:"KinsokuSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{uproot:!0,children:{0:{name:"NoStart"},1:{name:"NoEnd"},2:{name:"Keep"},3:{name:"Hanging"},4:{name:"Name"}}}}}}}}},5:{name:"StyleSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},6:E_}}}}}},6:{name:"ParagraphSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{name:"Properties",children:n0},6:{name:"DefaultStyleSheet"}}}}}}},8:{name:"TextFrameSet",children:{0:{uproot:!0,children:{0:{name:"path",children:{0:{name:"name"},1:{name:"bezierCurve",children:{0:{name:"controlPoints"}}},2:{name:"data",children:{0:{name:"type"},1:{name:"orientation"},2:{name:"frameMatrix"},4:{name:"4"},6:{name:"textRange"},7:{name:"rowGutter"},8:{name:"columnGutter"},9:{name:"9"},10:{name:"baselineAlignment",children:{0:{name:"flag"},1:{name:"min"}}},11:{name:"pathData",children:{1:{name:"1"},0:{name:"reversed"},2:{name:"2"},3:{name:"3"},4:{name:"spacing"},5:{name:"5"},6:{name:"6"},7:{name:"7"},18:{name:"18"}}},12:{name:"12"},13:{name:"13"}}},3:{name:"3"},97:{name:"uuid"}}}}}}},9:{name:"Predefined",children:{0:{children:{0:{uproot:!0}}},1:{children:{0:{uproot:!0}}}}}}},1:{name:"EngineDict",children:{0:{name:"0",children:{3:{name:"SuperscriptSize"},4:{name:"SuperscriptPosition"},5:{name:"SubscriptSize"},6:{name:"SubscriptPosition"},7:{name:"SmallCapSize"},8:{name:"UseFractionalGlyphWidths"},15:{children:{0:{uproot:!0}}}}},1:{name:"Editors?",children:{0:{name:"Editor",children:{0:{name:"Text"},5:{name:"ParagraphRun",children:{0:{name:"RunArray",children:{0:{name:"ParagraphSheet",children:{0:{uproot:!0,children:{0:{name:"0"},5:{name:"5",children:n0},6:{name:"6"}}}}},1:{name:"RunLength"}}}}},6:{name:"StyleRun",children:{0:{name:"RunArray",children:{0:{name:"StyleSheet",children:{0:{uproot:!0,children:{6:E_}}}},1:{name:"RunLength"}}}}}}},1:{name:"FontVectorData ???"}}},2:{name:"StyleSheet",children:r0},3:{name:"ParagraphSheet",children:n0}}}};function Ul(e,t){var n,r;if(e===null)return e;if(Array.isArray(e))return e.map(function(l){return Ul(l,t)});if(typeof e!="object")return e;for(var i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(t[s])if(t[s].uproot){s!=="99"&&(i=Ul(e[s],(n=t[s].children)!==null&&n!==void 0?n:{})),e[99]&&(i._type=e[99]);break}else i[t[s].name||s]=Ul(e[s],(r=t[s].children)!==null&&r!==void 0?r:{});else s==="99"?i._type=e[s]:i[s]=Ul(e[s],{})}return i}function YA(e){return Ul(e,XA)}hd.decodeEngineData2=YA});var dd=_e(St=>{"use strict";var I=St&&St.__assign||function(){return I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},I.apply(this,arguments)};Object.defineProperty(St,"__esModule",{value:!0});St.hasMultiEffects=St.readVectorMask=St.booleanOperations=St.readBezierKnot=St.infoHandlersMap=St.infoHandlers=void 0;var C_=yl(),I_=c_(),zn=Qi(),T=eo(),C=Wa(),A=ed(),u0=p_(),P_=x_(),KA=T_(),Bn="abcdefghijklmnopqrstuvwxyz";St.infoHandlers=[];St.infoHandlersMap={};function ie(e,t,n,r){var i={key:e,has:t,read:n,write:r};St.infoHandlers.push(i),St.infoHandlersMap[i.key]=i}function ns(e,t){St.infoHandlersMap[e]=St.infoHandlersMap[t]}function Ge(e){return function(t){return t[e]!==void 0}}function i0(e){if((0,T.readUint32)(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return(0,T.readUint32)(e)}function o0(e,t){(0,C.writeUint32)(e,0),(0,C.writeUint32)(e,t)}ie("TySh",Ge("text"),function(e,t,n){if((0,T.readInt16)(e)!==1)throw new Error("Invalid TySh version");for(var r=[],i=0;i<6;i++)r.push((0,T.readFloat64)(e));if((0,T.readInt16)(e)!==50)throw new Error("Invalid TySh text version");var o=(0,A.readVersionAndDescriptor)(e);if((0,T.readInt16)(e)!==1)throw new Error("Invalid TySh warp version");var a=(0,A.readVersionAndDescriptor)(e);if(t.text={transform:r,left:(0,T.readFloat32)(e),top:(0,T.readFloat32)(e),right:(0,T.readFloat32)(e),bottom:(0,T.readFloat32)(e),text:o["Txt "].replace(/\r/g,`
`),index:o.TextIndex||0,gridding:A.textGridding.decode(o.textGridding),antiAlias:A.Annt.decode(o.AntA),orientation:A.Ornt.decode(o.Ornt),warp:{style:A.warpStyle.decode(a.warpStyle),value:a.warpValue||0,perspective:a.warpPerspective||0,perspectiveOther:a.warpPerspectiveOther||0,rotate:A.Ornt.decode(a.warpRotate)}},o.bounds&&(t.text.bounds=(0,A.descBoundsToBounds)(o.bounds)),o.boundingBox&&(t.text.boundingBox=(0,A.descBoundsToBounds)(o.boundingBox)),o.EngineData){var s=(0,u0.parseEngineData)(o.EngineData),l=(0,P_.decodeEngineData)(s);t.text=I(I({},t.text),l)}(0,T.skipBytes)(e,n())},function(e,t){var n=t.text,r=n.warp||{},i=n.transform||[1,0,0,1,0,0],o=I(I(I({"Txt ":(n.text||"").replace(/\r?\n/g,"\r"),textGridding:A.textGridding.encode(n.gridding),Ornt:A.Ornt.encode(n.orientation),AntA:A.Annt.encode(n.antiAlias)},n.bounds?{bounds:(0,A.boundsToDescBounds)(n.bounds)}:{}),n.boundingBox?{boundingBox:(0,A.boundsToDescBounds)(n.boundingBox)}:{}),{TextIndex:n.index||0,EngineData:(0,u0.serializeEngineData)((0,P_.encodeEngineData)(n))});(0,C.writeInt16)(e,1);for(var a=0;a<6;a++)(0,C.writeFloat64)(e,i[a]);(0,C.writeInt16)(e,50),(0,A.writeVersionAndDescriptor)(e,"","TxLr",o,"text"),(0,C.writeInt16)(e,1),(0,A.writeVersionAndDescriptor)(e,"","warp",wd(r)),(0,C.writeFloat32)(e,n.left),(0,C.writeFloat32)(e,n.top),(0,C.writeFloat32)(e,n.right),(0,C.writeFloat32)(e,n.bottom)});ie("SoCo",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&e.vectorFill.type==="color"},function(e,t){var n=(0,A.readVersionAndDescriptor)(e);t.vectorFill=(0,A.parseVectorContent)(n)},function(e,t){var n=(0,A.serializeVectorContent)(t.vectorFill).descriptor;(0,A.writeVersionAndDescriptor)(e,"","null",n)});ie("GdFl",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&(e.vectorFill.type==="solid"||e.vectorFill.type==="noise")},function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);t.vectorFill=(0,A.parseVectorContent)(r),(0,T.skipBytes)(e,n())},function(e,t){var n=(0,A.serializeVectorContent)(t.vectorFill).descriptor;(0,A.writeVersionAndDescriptor)(e,"","null",n)});ie("PtFl",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&e.vectorFill.type==="pattern"},function(e,t){var n=(0,A.readVersionAndDescriptor)(e);t.vectorFill=(0,A.parseVectorContent)(n)},function(e,t){var n=(0,A.serializeVectorContent)(t.vectorFill).descriptor;(0,A.writeVersionAndDescriptor)(e,"","null",n)});ie("vscg",function(e){return e.vectorFill!==void 0&&e.vectorStroke!==void 0},function(e,t,n){(0,T.readSignature)(e);var r=(0,A.readVersionAndDescriptor)(e);t.vectorFill=(0,A.parseVectorContent)(r),(0,T.skipBytes)(e,n())},function(e,t){var n=(0,A.serializeVectorContent)(t.vectorFill),r=n.descriptor,i=n.key;(0,C.writeSignature)(e,i),(0,A.writeVersionAndDescriptor)(e,"","null",r)});function O_(e,t,n){var r=(0,T.readFixedPointPath32)(e)*n,i=(0,T.readFixedPointPath32)(e)*t,o=(0,T.readFixedPointPath32)(e)*n,a=(0,T.readFixedPointPath32)(e)*t,s=(0,T.readFixedPointPath32)(e)*n,l=(0,T.readFixedPointPath32)(e)*t;return[i,r,a,o,l,s]}St.readBezierKnot=O_;function ZA(e,t,n,r){(0,C.writeFixedPointPath32)(e,t[1]/r),(0,C.writeFixedPointPath32)(e,t[0]/n),(0,C.writeFixedPointPath32)(e,t[3]/r),(0,C.writeFixedPointPath32)(e,t[2]/n),(0,C.writeFixedPointPath32)(e,t[5]/r),(0,C.writeFixedPointPath32)(e,t[4]/n)}St.booleanOperations=["exclude","combine","subtract","intersect"];function F_(e,t,n,r,i){for(var o=e.offset+i,a=t.paths,s=void 0;o-e.offset>=26;){var l=(0,T.readUint16)(e);switch(l){case 0:case 3:{(0,T.readUint16)(e);var u=(0,T.readInt16)(e),c=(0,T.readUint16)(e);(0,T.skipBytes)(e,18),s={open:l===3,knots:[],fillRule:c===2?"non-zero":"even-odd"},u!==-1&&(s.operation=St.booleanOperations[u]),a.push(s);break}case 1:case 2:case 4:case 5:s.knots.push({linked:l===1||l===4,points:O_(e,n,r)});break;case 6:(0,T.skipBytes)(e,24);break;case 7:{var f=(0,T.readFixedPointPath32)(e),d=(0,T.readFixedPointPath32)(e),h=(0,T.readFixedPointPath32)(e),y=(0,T.readFixedPointPath32)(e),S=(0,T.readFixedPointPath32)(e);(0,T.skipBytes)(e,4),t.clipboard={top:f,left:d,bottom:h,right:y,resolution:S};break}case 8:t.fillStartsWithAllPixels=!!(0,T.readUint16)(e),(0,T.skipBytes)(e,22);break;default:throw new Error("Invalid vmsk section")}}return a}St.readVectorMask=F_;ie("vmsk",Ge("vectorMask"),function(e,t,n,r){var i=r.width,o=r.height;if((0,T.readUint32)(e)!==3)throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var a=t.vectorMask,s=(0,T.readUint32)(e);a.invert=(s&1)!==0,a.notLink=(s&2)!==0,a.disable=(s&4)!==0,F_(e,a,i,o,n()),(0,T.skipBytes)(e,n())},function(e,t,n){var r=n.width,i=n.height,o=t.vectorMask,a=(o.invert?1:0)|(o.notLink?2:0)|(o.disable?4:0);(0,C.writeUint32)(e,3),(0,C.writeUint32)(e,a),(0,C.writeUint16)(e,6),(0,C.writeZeros)(e,24);var s=o.clipboard;s&&((0,C.writeUint16)(e,7),(0,C.writeFixedPointPath32)(e,s.top),(0,C.writeFixedPointPath32)(e,s.left),(0,C.writeFixedPointPath32)(e,s.bottom),(0,C.writeFixedPointPath32)(e,s.right),(0,C.writeFixedPointPath32)(e,s.resolution),(0,C.writeZeros)(e,4)),o.fillStartsWithAllPixels!==void 0&&((0,C.writeUint16)(e,8),(0,C.writeUint16)(e,o.fillStartsWithAllPixels?1:0),(0,C.writeZeros)(e,22));for(var l=0,u=o.paths;l<u.length;l++){var c=u[l];(0,C.writeUint16)(e,c.open?3:0),(0,C.writeUint16)(e,c.knots.length),(0,C.writeUint16)(e,c.operation?St.booleanOperations.indexOf(c.operation):-1),(0,C.writeUint16)(e,c.fillRule==="non-zero"?2:1),(0,C.writeZeros)(e,18);for(var f=c.open?4:1,d=c.open?5:2,h=0,y=c.knots;h<y.length;h++){var S=y[h],b=S.linked,g=S.points;(0,C.writeUint16)(e,b?f:d),ZA(e,g,r,i)}}});ns("vsms","vmsk");ie("vowv",Ge("vowv"),function(e,t){t.vowv=(0,T.readUint32)(e)},function(e,t){(0,C.writeUint32)(e,t.vowv)});ie("vogk",Ge("vectorOrigination"),function(e,t,n){if((0,T.readInt32)(e)!==1)throw new Error("Invalid vogk version");var r=(0,A.readVersionAndDescriptor)(e);t.vectorOrigination={keyDescriptorList:[]};for(var i=0,o=r.keyDescriptorList;i<o.length;i++){var a=o[i],s={};a.keyShapeInvalidated!=null&&(s.keyShapeInvalidated=a.keyShapeInvalidated),a.keyOriginType!=null&&(s.keyOriginType=a.keyOriginType),a.keyOriginResolution!=null&&(s.keyOriginResolution=a.keyOriginResolution),a.keyOriginShapeBBox&&(s.keyOriginShapeBoundingBox={top:(0,A.parseUnitsOrNumber)(a.keyOriginShapeBBox["Top "]),left:(0,A.parseUnitsOrNumber)(a.keyOriginShapeBBox.Left),bottom:(0,A.parseUnitsOrNumber)(a.keyOriginShapeBBox.Btom),right:(0,A.parseUnitsOrNumber)(a.keyOriginShapeBBox.Rght)});var l=a.keyOriginRRectRadii;l&&(s.keyOriginRRectRadii={topRight:(0,A.parseUnits)(l.topRight),topLeft:(0,A.parseUnits)(l.topLeft),bottomLeft:(0,A.parseUnits)(l.bottomLeft),bottomRight:(0,A.parseUnits)(l.bottomRight)});var u=a.keyOriginBoxCorners;u&&(s.keyOriginBoxCorners=[{x:u.rectangleCornerA.Hrzn,y:u.rectangleCornerA.Vrtc},{x:u.rectangleCornerB.Hrzn,y:u.rectangleCornerB.Vrtc},{x:u.rectangleCornerC.Hrzn,y:u.rectangleCornerC.Vrtc},{x:u.rectangleCornerD.Hrzn,y:u.rectangleCornerD.Vrtc}]);var c=a.Trnf;c&&(s.transform=[c.xx,c.xy,c.xy,c.yy,c.tx,c.ty]),t.vectorOrigination.keyDescriptorList.push(s)}(0,T.skipBytes)(e,n())},function(e,t){for(var n=t.vectorOrigination,r={keyDescriptorList:[]},i=0;i<n.keyDescriptorList.length;i++){var o=n.keyDescriptorList[i];r.keyDescriptorList.push({});var a=r.keyDescriptorList[r.keyDescriptorList.length-1];o.keyOriginType!=null&&(a.keyOriginType=o.keyOriginType),o.keyOriginResolution!=null&&(a.keyOriginResolution=o.keyOriginResolution);var s=o.keyOriginRRectRadii;s&&(a.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:(0,A.unitsValue)(s.topRight,"topRight"),topLeft:(0,A.unitsValue)(s.topLeft,"topLeft"),bottomLeft:(0,A.unitsValue)(s.bottomLeft,"bottomLeft"),bottomRight:(0,A.unitsValue)(s.bottomRight,"bottomRight")});var l=o.keyOriginShapeBoundingBox;l&&(a.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":(0,A.unitsValue)(l.top,"top"),Left:(0,A.unitsValue)(l.left,"left"),Btom:(0,A.unitsValue)(l.bottom,"bottom"),Rght:(0,A.unitsValue)(l.right,"right")});var u=o.keyOriginBoxCorners;u&&u.length===4&&(a.keyOriginBoxCorners={rectangleCornerA:{Hrzn:u[0].x,Vrtc:u[0].y},rectangleCornerB:{Hrzn:u[1].x,Vrtc:u[1].y},rectangleCornerC:{Hrzn:u[2].x,Vrtc:u[2].y},rectangleCornerD:{Hrzn:u[3].x,Vrtc:u[3].y}});var c=o.transform;c&&c.length===6&&(a.Trnf={xx:c[0],xy:c[1],yx:c[2],yy:c[3],tx:c[4],ty:c[5]}),o.keyShapeInvalidated!=null&&(a.keyShapeInvalidated=o.keyShapeInvalidated),a.keyOriginIndex=i}(0,C.writeInt32)(e,1),(0,A.writeVersionAndDescriptor)(e,"","null",r)});ie("lmfx",function(e){return e.effects!==void 0&&d0(e.effects)},function(e,t,n){var r=(0,T.readUint32)(e);if(r!==0)throw new Error("Invalid lmfx version");var i=(0,A.readVersionAndDescriptor)(e);t.effects=(0,A.parseEffects)(i,!!e.logMissingFeatures),(0,T.skipBytes)(e,n())},function(e,t,n,r){var i=(0,A.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,C.writeUint32)(e,0),(0,A.writeVersionAndDescriptor)(e,"","null",i)});ie("lrFX",Ge("effects"),function(e,t,n){t.effects||(t.effects=(0,I_.readEffects)(e)),(0,T.skipBytes)(e,n())},function(e,t){(0,I_.writeEffects)(e,t.effects)});ie("luni",Ge("name"),function(e,t,n){if(n()>4){var r=(0,T.readUint32)(e);n()>=r*2?t.name=(0,T.readUnicodeStringWithLength)(e,r):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");(0,T.skipBytes)(e,n())},function(e,t){(0,C.writeUnicodeString)(e,t.name)});ie("lnsr",Ge("nameSource"),function(e,t){return t.nameSource=(0,T.readSignature)(e)},function(e,t){return(0,C.writeSignature)(e,t.nameSource)});ie("lyid",Ge("id"),function(e,t){t.id=(0,T.readUint32)(e)},function(e,t,n,r){for(var i=t.id;r.layerIds.has(i);)i+=100;(0,C.writeUint32)(e,i),r.layerIds.add(i),r.layerToId.set(t,i)});ie("lsct",Ge("sectionDivider"),function(e,t,n){t.sectionDivider={type:(0,T.readUint32)(e)},n()&&((0,T.checkSignature)(e,"8BIM"),t.sectionDivider.key=(0,T.readSignature)(e)),n()&&(t.sectionDivider.subType=(0,T.readUint32)(e))},function(e,t){(0,C.writeUint32)(e,t.sectionDivider.type),t.sectionDivider.key&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,t.sectionDivider.key),t.sectionDivider.subType!==void 0&&(0,C.writeUint32)(e,t.sectionDivider.subType))});ns("lsdk","lsct");ie("clbl",Ge("blendClippendElements"),function(e,t){t.blendClippendElements=!!(0,T.readUint8)(e),(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.blendClippendElements?1:0),(0,C.writeZeros)(e,3)});ie("infx",Ge("blendInteriorElements"),function(e,t){t.blendInteriorElements=!!(0,T.readUint8)(e),(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.blendInteriorElements?1:0),(0,C.writeZeros)(e,3)});ie("knko",Ge("knockout"),function(e,t){t.knockout=!!(0,T.readUint8)(e),(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.knockout?1:0),(0,C.writeZeros)(e,3)});ie("lmgm",Ge("layerMaskAsGlobalMask"),function(e,t){t.layerMaskAsGlobalMask=!!(0,T.readUint8)(e),(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.layerMaskAsGlobalMask?1:0),(0,C.writeZeros)(e,3)});ie("lspf",Ge("protected"),function(e,t){var n=(0,T.readUint32)(e);t.protected={transparency:(n&1)!==0,composite:(n&2)!==0,position:(n&4)!==0},n&8&&(t.protected.artboards=!0)},function(e,t){var n=(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0);(0,C.writeUint32)(e,n)});ie("lclr",Ge("layerColor"),function(e,t){var n=(0,T.readUint16)(e);(0,T.skipBytes)(e,6),t.layerColor=zn.layerColors[n]},function(e,t){var n=zn.layerColors.indexOf(t.layerColor);(0,C.writeUint16)(e,n===-1?0:n),(0,C.writeZeros)(e,6)});ie("shmd",function(e){return e.timestamp!==void 0||e.animationFrames!==void 0||e.animationFrameFlags!==void 0||e.timeline!==void 0||e.comps!==void 0},function(e,t,n){for(var r=(0,T.readUint32)(e),i=function(a){(0,T.checkSignature)(e,"8BIM");var s=(0,T.readSignature)(e);(0,T.readUint8)(e),(0,T.skipBytes)(e,3),(0,T.readSection)(e,1,function(l){if(s==="cust"){var u=(0,A.readVersionAndDescriptor)(e);u.layerTime!==void 0&&(t.timestamp=u.layerTime)}else if(s==="mlst"){var u=(0,A.readVersionAndDescriptor)(e);t.animationFrames=[];for(var c=0;c<u.LaSt.length;c++){var f=u.LaSt[c],d={frames:f.FrLs};f.enab!==void 0&&(d.enable=f.enab),f.Ofst&&(d.offset=(0,A.horzVrtcToXY)(f.Ofst)),f.FXRf&&(d.referencePoint=(0,A.horzVrtcToXY)(f.FXRf)),f.Lefx&&(d.effects=(0,A.parseEffects)(f.Lefx,!!e.logMissingFeatures)),f.blendOptions&&f.blendOptions.Opct&&(d.opacity=(0,A.parsePercent)(f.blendOptions.Opct)),t.animationFrames.push(d)}}else if(s==="mdyn"){(0,T.readUint16)(e);var h=(0,T.readUint8)(e),y=(0,T.readUint8)(e);t.animationFrameFlags={propagateFrameOne:!h,unifyLayerPosition:(y&1)!==0,unifyLayerStyle:(y&2)!==0,unifyLayerVisibility:(y&4)!==0}}else if(s==="tmln"){var u=(0,A.readVersionAndDescriptor)(e),S=u.timeScope,b={start:(0,A.frac)(S.Strt),duration:(0,A.frac)(S.duration),inTime:(0,A.frac)(S.inTime),outTime:(0,A.frac)(S.outTime),autoScope:u.autoScope,audioLevel:u.audioLevel};u.trackList&&(b.tracks=(0,A.parseTrackList)(u.trackList,!!e.logMissingFeatures)),t.timeline=b}else if(s==="cmls"){var u=(0,A.readVersionAndDescriptor)(e);t.comps={settings:[]},u.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:u.origFXRefPoint.Hrzn,y:u.origFXRefPoint.Vrtc});for(var g=0,p=u.layerSettings;g<p.length;g++){var m=p[g];t.comps.settings.push({compList:m.compList});var v=t.comps.settings[t.comps.settings.length-1];"enab"in m&&(v.enabled=m.enab),m.Ofst&&(v.offset={x:m.Ofst.Hrzn,y:m.Ofst.Vrtc}),m.FXRefPoint&&(v.effectsReferencePoint={x:m.FXRefPoint.Hrzn,y:m.FXRefPoint.Vrtc})}}else if(s==="extn"){var u=(0,A.readVersionAndDescriptor)(e);e.logMissingFeatures&&e.log('Unhandled "shmd" section key',s)}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',s);(0,T.skipBytes)(e,l())})},o=0;o<r;o++)i(o);(0,T.skipBytes)(e,n())},function(e,t,n,r){var i=t.animationFrames,o=t.animationFrameFlags,a=t.timestamp,s=t.timeline,l=t.comps,u=0;i&&u++,o&&u++,s&&u++,a!==void 0&&u++,l&&u++,(0,C.writeUint32)(e,u),i&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,"mlst"),(0,C.writeUint8)(e,0),(0,C.writeZeros)(e,3),(0,C.writeSection)(e,2,function(){for(var c,f={LaID:(c=t.id)!==null&&c!==void 0?c:0,LaSt:[]},d=0;d<i.length;d++){var h=i[d],y={};h.enable!==void 0&&(y.enab=h.enable),y.FrLs=h.frames,h.offset&&(y.Ofst=(0,A.xyToHorzVrtc)(h.offset)),h.referencePoint&&(y.FXRf=(0,A.xyToHorzVrtc)(h.referencePoint)),h.effects&&(y.Lefx=(0,A.serializeEffects)(h.effects,!1,!1)),h.opacity!==void 0&&(y.blendOptions={Opct:(0,A.unitsPercent)(h.opacity)}),f.LaSt.push(y)}(0,A.writeVersionAndDescriptor)(e,"","null",f)},!0)),o&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,"mdyn"),(0,C.writeUint8)(e,0),(0,C.writeZeros)(e,3),(0,C.writeSection)(e,2,function(){(0,C.writeUint16)(e,0),(0,C.writeUint8)(e,o.propagateFrameOne?0:15),(0,C.writeUint8)(e,(o.unifyLayerPosition?1:0)|(o.unifyLayerStyle?2:0)|(o.unifyLayerVisibility?4:0))})),s&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,"tmln"),(0,C.writeUint8)(e,0),(0,C.writeZeros)(e,3),(0,C.writeSection)(e,2,function(){var c={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(c.trackList=(0,A.serializeTrackList)(s.tracks));var f=r.layerToId.get(t)||t.id;if(!f)throw new Error("You need to provide layer.id value whan writing document with animations");c.LyrI=f,(0,A.writeVersionAndDescriptor)(e,"","null",c,"anim")},!0)),a!==void 0&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,"cust"),(0,C.writeUint8)(e,0),(0,C.writeZeros)(e,3),(0,C.writeSection)(e,2,function(){var c={layerTime:a};(0,A.writeVersionAndDescriptor)(e,"","metadata",c)},!0)),l&&((0,C.writeSignature)(e,"8BIM"),(0,C.writeSignature)(e,"cmls"),(0,C.writeUint8)(e,0),(0,C.writeZeros)(e,3),(0,C.writeSection)(e,2,function(){var c=r.layerToId.get(t)||t.id;if(!c)throw new Error("You need to provide layer.id value whan writing document with layer comps");var f={};l.originalEffectsReferencePoint&&(f.origFXRefPoint={Hrzn:l.originalEffectsReferencePoint.x,Vrtc:l.originalEffectsReferencePoint.y}),f.LyrI=c,f.layerSettings=[];for(var d=0,h=l.settings;d<h.length;d++){var y=h[d],S={};y.enabled!==void 0&&(S.enab=y.enabled),y.offset&&(S.Ofst={Hrzn:y.offset.x,Vrtc:y.offset.y}),y.effectsReferencePoint&&(S.FXRefPoint={Hrzn:y.effectsReferencePoint.x,Vrtc:y.effectsReferencePoint.y}),S.compList=y.compList,f.layerSettings.push(S)}(0,A.writeVersionAndDescriptor)(e,"","null",f)},!0))});ie("vstk",Ge("vectorStroke"),function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);t.vectorStroke={strokeEnabled:r.strokeEnabled,fillEnabled:r.fillEnabled,lineWidth:(0,A.parseUnits)(r.strokeStyleLineWidth),lineDashOffset:(0,A.parseUnits)(r.strokeStyleLineDashOffset),miterLimit:r.strokeStyleMiterLimit,lineCapType:A.strokeStyleLineCapType.decode(r.strokeStyleLineCapType),lineJoinType:A.strokeStyleLineJoinType.decode(r.strokeStyleLineJoinType),lineAlignment:A.strokeStyleLineAlignment.decode(r.strokeStyleLineAlignment),scaleLock:r.strokeStyleScaleLock,strokeAdjust:r.strokeStyleStrokeAdjust,lineDashSet:r.strokeStyleLineDashSet.map(A.parseUnits),blendMode:A.BlnM.decode(r.strokeStyleBlendMode),opacity:(0,A.parsePercent)(r.strokeStyleOpacity),content:(0,A.parseVectorContent)(r.strokeStyleContent),resolution:r.strokeStyleResolution},(0,T.skipBytes)(e,n())},function(e,t){var n,r,i,o=t.vectorStroke,a={strokeStyleVersion:2,strokeEnabled:!!o.strokeEnabled,fillEnabled:!!o.fillEnabled,strokeStyleLineWidth:o.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:o.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:(n=o.miterLimit)!==null&&n!==void 0?n:100,strokeStyleLineCapType:A.strokeStyleLineCapType.encode(o.lineCapType),strokeStyleLineJoinType:A.strokeStyleLineJoinType.encode(o.lineJoinType),strokeStyleLineAlignment:A.strokeStyleLineAlignment.encode(o.lineAlignment),strokeStyleScaleLock:!!o.scaleLock,strokeStyleStrokeAdjust:!!o.strokeAdjust,strokeStyleLineDashSet:o.lineDashSet||[],strokeStyleBlendMode:A.BlnM.encode(o.blendMode),strokeStyleOpacity:(0,A.unitsPercent)((r=o.opacity)!==null&&r!==void 0?r:1),strokeStyleContent:(0,A.serializeVectorContent)(o.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:(i=o.resolution)!==null&&i!==void 0?i:72};(0,A.writeVersionAndDescriptor)(e,"","strokeStyle",a)});ie("artb",Ge("artboard"),function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e),i=r.artboardRect;t.artboard={rect:{top:i["Top "],left:i.Left,bottom:i.Btom,right:i.Rght},guideIndices:r.guideIndeces,presetName:r.artboardPresetName,color:(0,A.parseColor)(r["Clr "]),backgroundType:r.artboardBackgroundType},(0,T.skipBytes)(e,n())},function(e,t){var n,r=t.artboard,i=r.rect,o={artboardRect:{"Top ":i.top,Left:i.left,Btom:i.bottom,Rght:i.right},guideIndeces:r.guideIndices||[],artboardPresetName:r.presetName||"","Clr ":(0,A.serializeColor)(r.color),artboardBackgroundType:(n=r.backgroundType)!==null&&n!==void 0?n:1};(0,A.writeVersionAndDescriptor)(e,"","artboard",o)});ie("sn2P",Ge("usingAlignedRendering"),function(e,t){return t.usingAlignedRendering=!!(0,T.readUint32)(e)},function(e,t){return(0,C.writeUint32)(e,t.usingAlignedRendering?1:0)});var ts=["unknown","vector","raster","image stack"];function N_(e){var t,n,r,i,o,a,s=I(I({style:A.warpStyle.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:A.Ornt.decode(e.warpRotate),bounds:e.bounds&&{top:(0,A.parseUnitsOrNumber)(e.bounds["Top "]),left:(0,A.parseUnitsOrNumber)(e.bounds.Left),bottom:(0,A.parseUnitsOrNumber)(e.bounds.Btom),right:(0,A.parseUnitsOrNumber)(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});(e.deformNumRows!=null||e.deformNumCols!=null)&&(s.deformNumRows=e.deformNumRows,s.deformNumCols=e.deformNumCols);var l=e.customEnvelopeWarp;if(l){s.customEnvelopeWarp={meshPoints:[]};for(var u=((t=l.meshPoints.find(function(d){return d.type==="Hrzn"}))===null||t===void 0?void 0:t.values)||[],c=((n=l.meshPoints.find(function(d){return d.type==="Vrtc"}))===null||n===void 0?void 0:n.values)||[],f=0;f<u.length;f++)s.customEnvelopeWarp.meshPoints.push({x:u[f],y:c[f]});(l.quiltSliceX||l.quiltSliceY)&&(s.customEnvelopeWarp.quiltSliceX=((i=(r=l.quiltSliceX)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.values)||[],s.customEnvelopeWarp.quiltSliceY=((a=(o=l.quiltSliceY)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.values)||[])}return s}function c0(e){var t,n;return e.deformNumCols!=null||e.deformNumRows!=null||((t=e.customEnvelopeWarp)===null||t===void 0?void 0:t.quiltSliceX)||((n=e.customEnvelopeWarp)===null||n===void 0?void 0:n.quiltSliceY)}function wd(e){var t=e.bounds,n=I(I({warpStyle:A.warpStyle.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:A.Ornt.encode(e.rotate),bounds:{"Top ":(0,A.unitsValue)(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:(0,A.unitsValue)(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:(0,A.unitsValue)(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:(0,A.unitsValue)(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),r=c0(e);if(r){var i=n;i.deformNumRows=e.deformNumRows||0,i.deformNumCols=e.deformNumCols||0}var o=e.customEnvelopeWarp;if(o){var a=o.meshPoints||[];if(r){var i=n;i.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:o.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:o.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:a.map(function(l){return l.x})},{type:"Vrtc",values:a.map(function(l){return l.y})}]}}else n.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:a.map(function(s){return s.x})},{type:"Vrtc",values:a.map(function(s){return s.y})}]}}return n}ie("PlLd",Ge("placedLayer"),function(e,t,n){if((0,T.readSignature)(e)!=="plcL")throw new Error("Invalid PlLd signature");if((0,T.readInt32)(e)!==3)throw new Error("Invalid PlLd version");var r=(0,T.readPascalString)(e,1),i=(0,T.readInt32)(e),o=(0,T.readInt32)(e);(0,T.readInt32)(e);var a=(0,T.readInt32)(e);if(!ts[a])throw new Error("Invalid PlLd type");for(var s=[],l=0;l<8;l++)s.push((0,T.readFloat64)(e));var u=(0,T.readInt32)(e);if(u!==0)throw new Error("Invalid Warp version ".concat(u));var c=(0,A.readVersionAndDescriptor)(e);t.placedLayer=t.placedLayer||{id:r,type:ts[a],pageNumber:i,totalPages:o,transform:s,warp:N_(c)},(0,T.skipBytes)(e,n())},function(e,t){var n=t.placedLayer;if((0,C.writeSignature)(e,"plcL"),(0,C.writeInt32)(e,3),!n.id||typeof n.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(n.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if((0,C.writePascalString)(e,n.id,1),(0,C.writeInt32)(e,1),(0,C.writeInt32)(e,1),(0,C.writeInt32)(e,16),ts.indexOf(n.type)===-1)throw new Error("Invalid placedLayer type");(0,C.writeInt32)(e,ts.indexOf(n.type));for(var r=0;r<8;r++)(0,C.writeFloat64)(e,n.transform[r]);(0,C.writeInt32)(e,0);var i=U_(n),o=c0(i),a=o?"quiltWarp":"warp";(0,A.writeVersionAndDescriptor)(e,"",a,wd(i),a)});function qA(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}function JA(e){return new Uint32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}function a0(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function Sd(e){for(var t=[],n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t}function Bl(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t}function A_(e){return Sd(qA(e))}function zl(e){return{x:(0,A.parseUnits)(e.Hrzn),y:(0,A.parseUnits)(e.Vrtc)}}function Vl(e){return{_name:"",_classID:"Pnt ",Hrzn:(0,A.unitsValue)(e.x,"x"),Vrtc:(0,A.unitsValue)(e.y,"y")}}function QA(e,t){var n={name:e["Nm  "],opacity:(0,A.parsePercent)(e.blendOptions.Opct),blendMode:A.BlnM.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:(0,A.parseColor)(e.FrgC),backgroundColor:(0,A.parseColor)(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return I(I({},n),{type:"box blur",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"GsnB":return I(I({},n),{type:"gaussian blur",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"MtnB":return I(I({},n),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:(0,A.parseUnits)(e.Fltr.Dstn)}});case"RdlB":return I(I({},n),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:A.BlrM.decode(e.Fltr.BlrM),quality:A.BlrQ.decode(e.Fltr.BlrQ)}});case"shapeBlur":return I(I({},n),{type:"shape blur",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return I(I({},n),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:A.SmBQ.decode(e.Fltr.SmBQ),mode:A.SmBM.decode(e.Fltr.SmBM)}});case"surfaceBlur":return I(I({},n),{type:"surface blur",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return I(I({},n),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:A.DspM.decode(e.Fltr.DspM),undefinedAreas:A.UndA.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return I(I({},n),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return I(I({},n),{type:"polar coordinates",filter:{conversion:A.Cnvr.decode(e.Fltr.Cnvr)}});case"Rple":return I(I({},n),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:A.RplS.decode(e.Fltr.RplS)}});case"Shr ":return I(I({},n),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map(function(s){return{x:s.Hrzn,y:s.Vrtc}}),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:A.UndA.decode(e.Fltr.UndA)}});case"Sphr":return I(I({},n),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:A.SphM.decode(e.Fltr.SphM)}});case"Twrl":return I(I({},n),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return I(I({},n),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:A.Wvtp.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:A.UndA.decode(e.Fltr.UndA)}});case"ZgZg":return I(I({},n),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:A.ZZTy.decode(e.Fltr.ZZTy)}});case"AdNs":return I(I({},n),{type:"add noise",filter:{amount:(0,A.parsePercent)(e.Fltr.Nose),distribution:A.Dstr.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return I(I({},n),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return I(I({},n),{type:"median",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"denoise":return I(I({},n),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:(0,A.parsePercent)(e.Fltr.ClNs),sharpenDetails:(0,A.parsePercent)(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map(function(s){return I({channels:s.Chnl.map(function(l){return A.Chnl.decode(l)}),amount:s.Amnt},s.EdgF?{preserveDetails:s.EdgF}:{})})}});case"ClrH":return I(I({},n),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return I(I({},n),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return I(I({},n),{type:"mezzotint",filter:{type:A.MztT.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return I(I({},n),{type:"mosaic",filter:{cellSize:(0,A.parseUnits)(e.Fltr.ClSz)}});case"Pntl":return I(I({},n),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return I(I({},n),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return I(I({},n),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return I(I({},n),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return I(I({},n),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:A.Lns.decode(e.Fltr["Lns "])}});case"smartSharpen":return I(I({},n),{type:"smart sharpen",filter:{amount:(0,A.parsePercent)(e.Fltr.Amnt),radius:(0,A.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:A.blurType.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:(0,A.parsePercent)(e.Fltr.sdwM.Amnt),tonalWidth:(0,A.parsePercent)(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:(0,A.parsePercent)(e.Fltr.hglM.Amnt),tonalWidth:(0,A.parsePercent)(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return I(I({},n),{type:"unsharp mask",filter:{amount:(0,A.parsePercent)(e.Fltr.Amnt),radius:(0,A.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return I(I({},n),{type:"diffuse",filter:{mode:A.DfsM.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return I(I({},n),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return I(I({},n),{type:"extrude",filter:{type:A.ExtT.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:A.ExtR.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return I(I({},n),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:A.FlCl.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return I(I({},n),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:A.CntE.decode(e.Fltr["Edg "])}});case"Wnd ":return I(I({},n),{type:"wind",filter:{method:A.WndM.decode(e.Fltr.WndM),direction:A.Drct.decode(e.Fltr.Drct)}});case"Dntr":return I(I({},n),{type:"de-interlace",filter:{eliminate:A.IntE.decode(e.Fltr.IntE),newFieldsBy:A.IntC.decode(e.Fltr.IntC)}});case"Cstm":return I(I({},n),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return I(I({},n),{type:"high pass",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"Mxm ":return I(I({},n),{type:"maximum",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"Mnm ":return I(I({},n),{type:"minimum",filter:{radius:(0,A.parseUnits)(e.Fltr["Rds "])}});case"Ofst":return I(I({},n),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:A.FlMd.decode(e.Fltr["Fl  "])}});case"rigidTransform":return I(I({},n),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map(function(s){return{rigidType:s.rigidType,originalVertexArray:A_(s.originalVertexArray),deformedVertexArray:A_(s.deformedVertexArray),indexArray:Array.from(JA(s.indexArray)),pinOffsets:Sd(s.pinOffsets),posFinalPins:Sd(s.posFinalPins),pinVertexIndices:s.pinVertexIndices,selectedPin:s.selectedPin,pinPosition:Sd(s.PinP),pinRotation:s.PnRt,pinOverlay:s.PnOv,pinDepth:s.PnDp,meshQuality:s.meshQuality,meshExpansion:s.meshExpansion,meshRigidity:s.meshRigidity,imageResolution:s.imageResolution,meshBoundaryPath:{pathComponents:s.meshBoundaryPath.pathComponents.map(function(l){return{shapeOperation:l.shapeOperation.split(".")[1],paths:l.SbpL.map(function(u){return{closed:u.Clsp,points:u["Pts "].map(function(c){return{anchor:zl(c.Anch),forward:zl(c["Fwd "]),backward:zl(c["Bwd "]),smooth:c.Smoo}})}})}})}}})}});case"PbPl":{for(var r=[],i=e.Fltr,o=0;o<Bn.length&&i["PN".concat(Bn[o],"a")];o++)for(var a=0;a<Bn.length&&i["PN".concat(Bn[o]).concat(Bn[a])];a++)r.push({name:i["PN".concat(Bn[o]).concat(Bn[a])],value:i["PF".concat(Bn[o]).concat(Bn[a])]});return I(I({},n),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:r}})}case"HsbP":return I(I({},n),{type:"hsb/hsl",filter:{inputMode:A.ClrS.decode(e.Fltr.Inpt),rowOrder:A.ClrS.decode(e.Fltr.Otpt)}});case"oilPaint":return I(I({},n),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return I(I({},n),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});case"perspectiveWarpTransform":return I(I({},n),{type:"perspective warp",filter:{vertices:e.Fltr.vertices.map(zl),warpedVertices:e.Fltr.warpedVertices.map(zl),quads:e.Fltr.quads.map(function(s){return s.indices})}});case"Crvs":return I(I({},n),{type:"curves",filter:{presetKind:A.presetKindType.decode(e.Fltr.presetKind),adjustments:e.Fltr.Adjs.map(function(s){var l=s.Chnl.map(function(u){return A.Chnl.decode(u)});if(s["Crv "])return{channels:l,curve:s["Crv "].map(function(u){var c={x:u.Hrzn,y:u.Vrtc};return u.Cnty&&(c.curved=!0),c})};if(s.Mpng)return{channels:l,values:s.Mpng};throw new Error("Unknown curve adjustment")})}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return I(I({},n),{type:"average"});case 1114403360:return I(I({},n),{type:"blur"});case 1114403405:return I(I({},n),{type:"blur more"});case 1148416099:return I(I({},n),{type:"despeckle"});case 1180922912:return I(I({},n),{type:"facet"});case 1181902701:return I(I({},n),{type:"fragment"});case 1399353968:return I(I({},n),{type:"sharpen"});case 1399353925:return I(I({},n),{type:"sharpen edges"});case 1399353933:return I(I({},n),{type:"sharpen more"});case 1181639749:return I(I({},n),{type:"find edges"});case 1399616122:return I(I({},n),{type:"solarize"});case 1314149187:return I(I({},n),{type:"ntsc colors"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}function eD(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map(function(n){return QA(n,t)}).filter(function(n){return!!n})}}function Nr(e){return(0,A.unitsValue)(e.radius,"radius")}function tD(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:(0,A.unitsPercentF)(e.opacity),"Md  ":A.BlnM.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:(0,A.serializeColor)(e.foregroundColor),BckC:(0,A.serializeColor)(e.backgroundColor)};switch(e.type){case"average":return I(I({},t),{filterID:1098281575});case"blur":return I(I({},t),{filterID:1114403360});case"blur more":return I(I({},t),{filterID:1114403405});case"box blur":return I(I({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":Nr(e.filter)},filterID:697});case"gaussian blur":return I(I({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":Nr(e.filter)},filterID:1198747202});case"motion blur":return I(I({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:(0,A.unitsValue)(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return I(I({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:A.BlrM.encode(e.filter.method),BlrQ:A.BlrQ.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return I(I({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":Nr(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return I(I({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:A.SmBQ.encode(e.filter.quality),SmBM:A.SmBM.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return I(I({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":Nr(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return I(I({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:A.DspM.encode(e.filter.displacementMap),UndA:A.UndA.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return I(I({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return I(I({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:A.Cnvr.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return I(I({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:A.RplS.encode(e.filter.size)},filterID:1383099493});case"shear":return I(I({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map(function(l){return{_name:"",_classID:"Pnt ",Hrzn:l.x,Vrtc:l.y}}),UndA:A.UndA.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return I(I({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:A.SphM.encode(e.filter.mode)},filterID:1399875698});case"twirl":return I(I({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return I(I({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:A.Wvtp.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:A.UndA.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return I(I({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:A.ZZTy.encode(e.filter.style)},filterID:1516722791});case"add noise":return I(I({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:A.Dstr.encode(e.filter.distribution),Nose:(0,A.unitsPercentF)(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return I(I({},t),{filterID:1148416099});case"dust and scratches":return I(I({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return I(I({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":Nr(e.filter)},filterID:1298427424});case"reduce noise":return I(I({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:(0,A.unitsPercentF)(e.filter.reduceColorNoise),Shrp:(0,A.unitsPercentF)(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map(function(l){return I({_name:"",_classID:"channelDenoiseParams",Chnl:l.channels.map(function(u){return A.Chnl.encode(u)}),Amnt:l.amount},l.preserveDetails?{EdgF:l.preserveDetails}:{})}),preset:e.filter.preset},filterID:633});case"color halftone":return I(I({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return I(I({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return I(I({},t),{filterID:1180922912});case"fragment":return I(I({},t),{filterID:1181902701});case"mezzotint":return I(I({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:A.MztT.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return I(I({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:(0,A.unitsValue)(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return I(I({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return I(I({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return I(I({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return I(I({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return I(I({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":A.Lns.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return I(I({},t),{filterID:1399353968});case"sharpen edges":return I(I({},t),{filterID:1399353925});case"sharpen more":return I(I({},t),{filterID:1399353933});case"smart sharpen":return I(I({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:(0,A.unitsPercentF)(e.filter.amount),"Rds ":Nr(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:A.blurType.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:(0,A.unitsPercentF)(e.filter.shadow.fadeAmount),Wdth:(0,A.unitsPercentF)(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:(0,A.unitsPercentF)(e.filter.highlight.fadeAmount),Wdth:(0,A.unitsPercentF)(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return I(I({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:(0,A.unitsPercentF)(e.filter.amount),"Rds ":Nr(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return I(I({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":A.DfsM.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return I(I({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return I(I({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:A.ExtT.encode(e.filter.type),ExtR:A.ExtR.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return I(I({},t),{filterID:1181639749});case"solarize":return I(I({},t),{filterID:1399616122});case"tiles":return I(I({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:A.FlCl.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return I(I({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":A.CntE.encode(e.filter.edge)},filterID:1416782659});case"wind":return I(I({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:A.WndM.encode(e.filter.method),Drct:A.Drct.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return I(I({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:A.IntE.encode(e.filter.eliminate),IntC:A.IntC.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return I(I({},t),{filterID:1314149187});case"custom":return I(I({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return I(I({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":Nr(e.filter)},filterID:1214736464});case"maximum":return I(I({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":Nr(e.filter)},filterID:1299737888});case"minimum":return I(I({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":Nr(e.filter)},filterID:1299082528});case"offset":return I(I({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":A.FlMd.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return I(I({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map(function(l){return{_name:"",_classID:"puppetShape",rigidType:l.rigidType,VrsM:1,VrsN:0,originalVertexArray:a0(new Float32Array(Bl(l.originalVertexArray))),deformedVertexArray:a0(new Float32Array(Bl(l.deformedVertexArray))),indexArray:a0(new Uint32Array(l.indexArray)),pinOffsets:Bl(l.pinOffsets),posFinalPins:Bl(l.posFinalPins),pinVertexIndices:l.pinVertexIndices,PinP:Bl(l.pinPosition),PnRt:l.pinRotation,PnOv:l.pinOverlay,PnDp:l.pinDepth,meshQuality:l.meshQuality,meshExpansion:l.meshExpansion,meshRigidity:l.meshRigidity,imageResolution:l.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:l.meshBoundaryPath.pathComponents.map(function(u){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(u.shapeOperation),SbpL:u.paths.map(function(c){return{_name:"",_classID:"Sbpl",Clsp:c.closed,"Pts ":c.points.map(function(f){return{_name:"",_classID:"Pthp",Anch:Vl(f.anchor),"Fwd ":Vl(f.forward),"Bwd ":Vl(f.backward),Smoo:f.smooth}})}})}})},selectedPin:l.selectedPin}}),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":{for(var n={},r=0;r<e.filter.parameters.length;r++){var i=e.filter.parameters[r],o=i.name,a=i.value,s="".concat(Bn[Math.floor(r/Bn.length)]).concat(Bn[r%Bn.length]);n["PN".concat(s)]=o,n["PT".concat(s)]=0,n["PF".concat(s)]=a}return I(I({},t),{Fltr:I({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},n),filterID:1348620396})}case"oil paint":return I(I({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return I(I({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});case"perspective warp":return I(I({},t),{Fltr:{_name:"Perspective Warp",_classID:"perspectiveWarpTransform",vertices:e.filter.vertices.map(Vl),warpedVertices:e.filter.warpedVertices.map(Vl),quads:e.filter.quads.map(function(l){return{indices:l}})},filterID:442});case"curves":return I(I({},t),{Fltr:{_name:"Curves",_classID:"Crvs",presetKind:A.presetKindType.encode(e.filter.presetKind),Adjs:e.filter.adjustments.map(function(l){return"curve"in l?{_name:"",_classID:"CrvA",Chnl:l.channels.map(function(u){return A.Chnl.encode(u)}),"Crv ":l.curve.map(function(u){return I({_name:"",_classID:"Pnt ",Hrzn:u.x,Vrtc:u.y},u.curved?{Cnty:!0}:{})})}:{_name:"",_classID:"CrvA",Chnl:l.channels.map(function(u){return A.Chnl.encode(u)}),Mpng:l.values}})},filterID:1131574899});default:throw new Error("Unknow filter type: ".concat(e.type))}}function U_(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,n=e.height,r=0,i=t/3,o=t*2/3,a=t,s=0,l=n/3,u=n*2/3,c=n;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:n,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:r,y:s},{x:i,y:s},{x:o,y:s},{x:a,y:s},{x:r,y:l},{x:i,y:l},{x:o,y:l},{x:a,y:l},{x:r,y:u},{x:i,y:u},{x:o,y:u},{x:a,y:u},{x:r,y:c},{x:i,y:c},{x:o,y:c},{x:a,y:c}]}}}ie("SoLd",Ge("placedLayer"),function(e,t,n){if((0,T.readSignature)(e)!=="soLD")throw new Error("Invalid SoLd type");var r=(0,T.readInt32)(e);if(r!==4&&r!==5)throw new Error("Invalid SoLd version");var i=(0,A.readVersionAndDescriptor)(e,!0);t.placedLayer={id:i.Idnt,placed:i.placed,type:ts[i.Type],pageNumber:i.PgNm,totalPages:i.totalPages,frameStep:(0,A.frac)(i.frameStep),duration:(0,A.frac)(i.duration),frameCount:i.frameCount,transform:i.Trnf,width:i["Sz  "].Wdth,height:i["Sz  "].Hght,resolution:(0,A.parseUnits)(i.Rslt),warp:N_(i.quiltWarp||i.warp)},i.nonAffineTransform&&i.nonAffineTransform.some(function(o,a){return o!==i.Trnf[a]})&&(t.placedLayer.nonAffineTransform=i.nonAffineTransform),i.Crop&&(t.placedLayer.crop=i.Crop),i.comp&&(t.placedLayer.comp=i.comp),i.compInfo&&(t.placedLayer.compInfo={compID:i.compInfo.compID,originalCompID:i.compInfo.originalCompID}),i.filterFX&&(t.placedLayer.filter=eD(i.filterFX,e)),(0,T.skipBytes)(e,n())},function(e,t){var n,r;(0,C.writeSignature)(e,"soLD"),(0,C.writeInt32)(e,4);var i=t.placedLayer;if(!i.id||typeof i.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var o=I(I({Idnt:i.id,placed:(n=i.placed)!==null&&n!==void 0?n:i.id,PgNm:i.pageNumber||1,totalPages:i.totalPages||1},i.crop?{Crop:i.crop}:{}),{frameStep:i.frameStep||{numerator:0,denominator:600},duration:i.duration||{numerator:0,denominator:600},frameCount:i.frameCount||0,Annt:16,Type:ts.indexOf(i.type),Trnf:i.transform,nonAffineTransform:(r=i.nonAffineTransform)!==null&&r!==void 0?r:i.transform,warp:wd(U_(i)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:i.width||0,Hght:i.height||0},Rslt:i.resolution?(0,A.unitsValue)(i.resolution,"resolution"):{units:"Density",value:72}});if(i.filter&&(o.filterFX={_name:"",_classID:"filterFXStyle",enab:i.filter.enabled,validAtPosition:i.filter.validAtPosition,filterMaskEnable:i.filter.maskEnabled,filterMaskLinked:i.filter.maskLinked,filterMaskExtendWithWhite:i.filter.maskExtendWithWhite,filterFXList:i.filter.list.map(function(s){return tD(s)})}),i.warp&&c0(i.warp)){var a=wd(i.warp);o.quiltWarp=a,o.warp={warpStyle:"warpStyle.warpNone",warpValue:a.warpValue,warpPerspective:a.warpPerspective,warpPerspectiveOther:a.warpPerspectiveOther,warpRotate:a.warpRotate,bounds:a.bounds,uOrder:a.uOrder,vOrder:a.vOrder}}else delete o.quiltWarp;i.comp&&(o.comp=i.comp),i.compInfo&&(o.compInfo=i.compInfo),(0,A.writeVersionAndDescriptor)(e,"","null",o,o.quiltWarp?"quiltWarp":"warp")});ns("SoLE","SoLd");ie("fxrp",Ge("referencePoint"),function(e,t){t.referencePoint={x:(0,T.readFloat64)(e),y:(0,T.readFloat64)(e)}},function(e,t){(0,C.writeFloat64)(e,t.referencePoint.x),(0,C.writeFloat64)(e,t.referencePoint.y)});ie("Lr16",function(){return!1},function(e,t,n,r,i){(0,T.readLayerInfo)(e,r,i)},function(e,t){});ie("Lr32",function(){return!1},function(e,t,n,r,i){(0,T.readLayerInfo)(e,r,i)},function(e,t){});ie("LMsk",Ge("userMask"),function(e,t){t.userMask={colorSpace:(0,T.readColor)(e),opacity:(0,T.readUint16)(e)/255};var n=(0,T.readUint8)(e);if(n!==128)throw new Error("Invalid flag value");(0,T.skipBytes)(e,1)},function(e,t){var n=t.userMask;(0,C.writeColor)(e,n.colorSpace),(0,C.writeUint16)(e,(0,zn.clamp)(n.opacity,0,1)*255),(0,C.writeUint8)(e,128),(0,C.writeZeros)(e,1)});zn.MOCK_HANDLERS?ie("Patt",function(e){return e._Patt!==void 0},function(e,t,n){t._Patt=(0,T.readBytes)(e,n())},function(e,t){return!1}):ie("Patt",function(e){return!e},function(e,t,n){n()&&(0,T.skipBytes)(e,n())},function(e,t){});zn.MOCK_HANDLERS&&ie("CAI ",function(e){return e._CAI_!==void 0},function(e,t,n){t._CAI_=(0,T.readBytes)(e,n())},function(e,t){(0,C.writeBytes)(e,t._CAI_)});zn.MOCK_HANDLERS&&ie("OCIO",function(e){return e._OCIO!==void 0},function(e,t,n){t._OCIO=(0,T.readBytes)(e,n())},function(e,t){(0,C.writeBytes)(e,t._OCIO)});zn.MOCK_HANDLERS&&ie("GenI",function(e){return e._GenI!==void 0},function(e,t,n){t._GenI=(0,T.readBytes)(e,n())},function(e,t){(0,C.writeBytes)(e,t._GenI)});function D_(e){var t=(0,T.readInt32)(e),n=(0,T.readInt32)(e),r=(0,T.readInt32)(e),i=(0,T.readInt32)(e);return{top:t,left:n,bottom:r,right:i}}function L_(e,t){(0,C.writeInt32)(e,t.top),(0,C.writeInt32)(e,t.left),(0,C.writeInt32)(e,t.bottom),(0,C.writeInt32)(e,t.right)}ie("Anno",function(e){return e.annotations!==void 0},function(e,t,n){var r=(0,T.readUint16)(e),i=(0,T.readUint16)(e);if(r!==2||i!==1)throw new Error("Invalid Anno version");for(var o=(0,T.readUint32)(e),a=[],s=0;s<o;s++){(0,T.readUint32)(e);var l=(0,T.readSignature)(e),u=!!(0,T.readUint8)(e);(0,T.readUint8)(e),(0,T.readUint16)(e);var c=D_(e),f=D_(e),d=(0,T.readColor)(e),h=(0,T.readPascalString)(e,2),y=(0,T.readPascalString)(e,2),S=(0,T.readPascalString)(e,2);(0,T.readUint32)(e),(0,T.readSignature)(e);var b=(0,T.readUint32)(e),g=void 0;if(l==="txtA")b>=2&&(0,T.readUint16)(e)===65279?g=(0,T.readUnicodeStringWithLength)(e,(b-2)/2):(e.offset-=2,g=(0,T.readAsciiString)(e,b)),g=g.replace(/\r/g,`
`);else if(l==="sndA")g=(0,T.readBytes)(e,b);else throw new Error("Unknown annotation type");a.push({type:l==="txtA"?"text":"sound",open:u,iconLocation:c,popupLocation:f,color:d,author:h,name:y,date:S,data:g})}t.annotations=a,(0,T.skipBytes)(e,n())},function(e,t){var n=t.annotations;(0,C.writeUint16)(e,2),(0,C.writeUint16)(e,1),(0,C.writeUint32)(e,n.length);for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o.type==="sound";if(a&&!(o.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!a&&typeof o.data!="string")throw new Error("Text annotation data should be string");var s=e.offset;(0,C.writeUint32)(e,0),(0,C.writeSignature)(e,a?"sndA":"txtA"),(0,C.writeUint8)(e,o.open?1:0),(0,C.writeUint8)(e,28),(0,C.writeUint16)(e,1),L_(e,o.iconLocation),L_(e,o.popupLocation),(0,C.writeColor)(e,o.color),(0,C.writePascalString)(e,o.author||"",2),(0,C.writePascalString)(e,o.name||"",2),(0,C.writePascalString)(e,o.date||"",2);var l=e.offset;(0,C.writeUint32)(e,0),(0,C.writeSignature)(e,a?"sndM":"txtC"),(0,C.writeUint32)(e,0);var u=e.offset;if(a)(0,C.writeBytes)(e,o.data);else{(0,C.writeUint16)(e,65279);for(var c=o.data.replace(/\n/g,"\r"),f=0;f<c.length;f++)(0,C.writeUint16)(e,c.charCodeAt(f))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(l,e.offset-l,!1),e.view.setUint32(u-4,e.offset-u,!1)}});function B_(e){ie(e,function(t){var n=t;return!(!n.linkedFiles||!n.linkedFiles.length||e==="lnkE"&&!n.linkedFiles.some(function(r){return r.linkedFile}))},function(t,n,r,i){var o=n;for(o.linkedFiles=o.linkedFiles||[];r()>8;){var a=i0(t),s=t.offset,l=(0,T.readSignature)(t),u=(0,T.readInt32)(t),c=(0,T.readPascalString)(t,1),f=(0,T.readUnicodeString)(t),d=(0,T.readSignature)(t).trim(),h=(0,T.readSignature)(t).trim(),y=i0(t),S=(0,T.readUint8)(t),b=S?(0,A.readVersionAndDescriptor)(t):void 0,g=l==="liFE"?(0,A.readVersionAndDescriptor)(t):void 0,p={id:c,name:f};if(d&&(p.type=d),h&&(p.creator=h),b&&(p.descriptor={compInfo:{compID:b.compInfo.compID,originalCompID:b.compInfo.originalCompID}}),l==="liFE"&&u>3){var m=(0,T.readInt32)(t),v=(0,T.readUint8)(t),x=(0,T.readUint8)(t),w=(0,T.readUint8)(t),_=(0,T.readUint8)(t),E=(0,T.readFloat64)(t),P=Math.floor(E),D=(E-P)*1e3;p.time=new Date(Date.UTC(m,v,x,w,_,P,D)).toISOString()}var M=l==="liFE"?i0(t):0;for(l==="liFA"&&(0,T.skipBytes)(t,8),l==="liFD"&&(p.data=(0,T.readBytes)(t,y)),u>=5&&(p.childDocumentID=(0,T.readUnicodeString)(t)),u>=6&&(p.assetModTime=(0,T.readFloat64)(t)),u>=7&&(p.assetLockedState=(0,T.readUint8)(t)),l==="liFE"&&u===2&&(p.data=(0,T.readBytes)(t,M)),t.skipLinkedFilesData&&(p.data=void 0),e==="lnkE"&&(p.linkedFile={fileSize:M,name:(g==null?void 0:g["Nm  "])||"",fullPath:(g==null?void 0:g.fullPath)||"",originalPath:(g==null?void 0:g.originalPath)||"",relativePath:(g==null?void 0:g.relPath)||""}),o.linkedFiles.push(p);a%4;)a++;t.offset=s+a}(0,T.skipBytes)(t,r())},function(t,n){for(var r,i,o,a,s,l,u,c,f,d=n,h=0,y=d.linkedFiles;h<y.length;h++){var S=y[h];if(e==="lnkE"==!!S.linkedFile){var b=2;S.assetLockedState!=null?b=7:S.assetModTime!=null?b=6:S.childDocumentID!=null?b=5:e=="lnkE"&&(b=3),o0(t,0);var g=t.offset;if((0,C.writeSignature)(t,e==="lnkE"?"liFE":S.data?"liFD":"liFA"),(0,C.writeInt32)(t,b),!S.id||typeof S.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(S.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if((0,C.writePascalString)(t,S.id,1),(0,C.writeUnicodeStringWithPadding)(t,S.name||""),(0,C.writeSignature)(t,S.type?"".concat(S.type,"    ").substring(0,4):"    "),(0,C.writeSignature)(t,S.creator?"".concat(S.creator,"    ").substring(0,4):"\0\0\0\0"),o0(t,S.data?S.data.byteLength:0),S.descriptor&&S.descriptor.compInfo){var p={compInfo:{compID:S.descriptor.compInfo.compID,originalCompID:S.descriptor.compInfo.originalCompID}};(0,C.writeUint8)(t,1),(0,A.writeVersionAndDescriptor)(t,"","null",p)}else(0,C.writeUint8)(t,0);if(e==="lnkE"){var p={descVersion:2,"Nm  ":(i=(r=S.linkedFile)===null||r===void 0?void 0:r.name)!==null&&i!==void 0?i:"",fullPath:(a=(o=S.linkedFile)===null||o===void 0?void 0:o.fullPath)!==null&&a!==void 0?a:"",originalPath:(l=(s=S.linkedFile)===null||s===void 0?void 0:s.originalPath)!==null&&l!==void 0?l:"",relPath:(c=(u=S.linkedFile)===null||u===void 0?void 0:u.relativePath)!==null&&c!==void 0?c:""};(0,A.writeVersionAndDescriptor)(t,"","ExternalFileLink",p);var m=S.time?new Date(S.time):new Date;(0,C.writeInt32)(t,m.getUTCFullYear()),(0,C.writeUint8)(t,m.getUTCMonth()),(0,C.writeUint8)(t,m.getUTCDate()),(0,C.writeUint8)(t,m.getUTCHours()),(0,C.writeUint8)(t,m.getUTCMinutes()),(0,C.writeFloat64)(t,m.getUTCSeconds()+m.getUTCMilliseconds()/1e3)}S.data?(0,C.writeBytes)(t,S.data):o0(t,((f=S.linkedFile)===null||f===void 0?void 0:f.fileSize)||0),b>=5&&(0,C.writeUnicodeStringWithPadding)(t,S.childDocumentID||""),b>=6&&(0,C.writeFloat64)(t,S.assetModTime||0),b>=7&&(0,C.writeUint8)(t,S.assetLockedState||0);var v=t.offset-g;for(t.view.setUint32(g-4,v,!1);v%4;)v++,(0,C.writeUint8)(t,0)}}})}B_("lnk2");B_("lnkE");ns("lnkD","lnk2");ns("lnk3","lnk2");ie("pths",Ge("pathList"),function(e,t){var n=(0,A.readVersionAndDescriptor)(e,!0);t.pathList=[]},function(e,t){var n={pathList:[]};(0,A.writeVersionAndDescriptor)(e,"","pathsDataClass",n)});ie("lyvr",Ge("version"),function(e,t){return t.version=(0,T.readUint32)(e)},function(e,t){return(0,C.writeUint32)(e,t.version)});ie("lfxs",function(){return!1},function(e,t,n){var r=(0,T.readUint32)(e);if(r!==0)throw new Error("Invalid lfxs version");var i=(0,A.readVersionAndDescriptor)(e);t.effects=(0,A.parseEffects)(i,!!e.logMissingFeatures),(0,T.skipBytes)(e,n())},function(e,t,n,r){var i=(0,A.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,C.writeUint32)(e,0),(0,A.writeVersionAndDescriptor)(e,"","null",i)});function nn(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}ie("brit",nn("brightness/contrast"),function(e,t,n){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:(0,T.readInt16)(e),contrast:(0,T.readInt16)(e),meanValue:(0,T.readInt16)(e),labColorOnly:!!(0,T.readUint8)(e),useLegacy:!0}),(0,T.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,C.writeInt16)(e,r.brightness||0),(0,C.writeInt16)(e,r.contrast||0),(0,C.writeInt16)(e,(n=r.meanValue)!==null&&n!==void 0?n:127),(0,C.writeUint8)(e,r.labColorOnly?1:0),(0,C.writeZeros)(e,1)});function md(e){var t=(0,T.readInt16)(e),n=(0,T.readInt16)(e),r=(0,T.readInt16)(e),i=(0,T.readInt16)(e),o=(0,T.readInt16)(e)/100;return{shadowInput:t,highlightInput:n,shadowOutput:r,highlightOutput:i,midtoneInput:o}}function Gl(e,t){(0,C.writeInt16)(e,t.shadowInput),(0,C.writeInt16)(e,t.highlightInput),(0,C.writeInt16)(e,t.shadowOutput),(0,C.writeInt16)(e,t.highlightOutput),(0,C.writeInt16)(e,Math.round(t.midtoneInput*100))}ie("levl",nn("levels"),function(e,t,n){if((0,T.readUint16)(e)!==2)throw new Error("Invalid levl version");t.adjustment=I(I({},t.adjustment),{type:"levels",rgb:md(e),red:md(e),green:md(e),blue:md(e)}),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};(0,C.writeUint16)(e,2),Gl(e,n.rgb||r),Gl(e,n.red||r),Gl(e,n.blue||r),Gl(e,n.green||r);for(var i=0;i<59;i++)Gl(e,r)});function gd(e){for(var t=(0,T.readUint16)(e),n=[],r=0;r<t;r++){var i=(0,T.readInt16)(e),o=(0,T.readInt16)(e);n.push({input:o,output:i})}return n}function ro(e,t){(0,C.writeUint16)(e,t.length);for(var n=0,r=t;n<r.length;n++){var i=r[n];(0,C.writeUint16)(e,i.output),(0,C.writeUint16)(e,i.input)}}ie("curv",nn("curves"),function(e,t,n){if((0,T.readUint8)(e),(0,T.readUint16)(e)!==1)throw new Error("Invalid curv version");(0,T.readUint16)(e);var r=(0,T.readUint16)(e),i={type:"curves"};r&1&&(i.rgb=gd(e)),r&2&&(i.red=gd(e)),r&4&&(i.green=gd(e)),r&8&&(i.blue=gd(e)),t.adjustment=I(I({},t.adjustment),i),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r=n.rgb,i=n.red,o=n.green,a=n.blue,s=0,l=0;r&&r.length&&(s|=1,l++),i&&i.length&&(s|=2,l++),o&&o.length&&(s|=4,l++),a&&a.length&&(s|=8,l++),(0,C.writeUint8)(e,0),(0,C.writeUint16)(e,1),(0,C.writeUint16)(e,0),(0,C.writeUint16)(e,s),r&&r.length&&ro(e,r),i&&i.length&&ro(e,i),o&&o.length&&ro(e,o),a&&a.length&&ro(e,a),(0,C.writeSignature)(e,"Crv "),(0,C.writeUint16)(e,4),(0,C.writeUint16)(e,0),(0,C.writeUint16)(e,l),r&&r.length&&((0,C.writeUint16)(e,0),ro(e,r)),i&&i.length&&((0,C.writeUint16)(e,1),ro(e,i)),o&&o.length&&((0,C.writeUint16)(e,2),ro(e,o)),a&&a.length&&((0,C.writeUint16)(e,3),ro(e,a)),(0,C.writeZeros)(e,2)});ie("expA",nn("exposure"),function(e,t,n){if((0,T.readUint16)(e)!==1)throw new Error("Invalid expA version");t.adjustment=I(I({},t.adjustment),{type:"exposure",exposure:(0,T.readFloat32)(e),offset:(0,T.readFloat32)(e),gamma:(0,T.readFloat32)(e)}),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,C.writeUint16)(e,1),(0,C.writeFloat32)(e,n.exposure),(0,C.writeFloat32)(e,n.offset),(0,C.writeFloat32)(e,n.gamma),(0,C.writeZeros)(e,2)});ie("vibA",nn("vibrance"),function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);t.adjustment={type:"vibrance"},r.vibrance!==void 0&&(t.adjustment.vibrance=r.vibrance),r.Strt!==void 0&&(t.adjustment.saturation=r.Strt),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={};n.vibrance!==void 0&&(r.vibrance=n.vibrance),n.saturation!==void 0&&(r.Strt=n.saturation),(0,A.writeVersionAndDescriptor)(e,"","null",r)});function Vo(e){return{a:(0,T.readInt16)(e),b:(0,T.readInt16)(e),c:(0,T.readInt16)(e),d:(0,T.readInt16)(e),hue:(0,T.readInt16)(e),saturation:(0,T.readInt16)(e),lightness:(0,T.readInt16)(e)}}function Go(e,t){var n=t||{};(0,C.writeInt16)(e,n.a||0),(0,C.writeInt16)(e,n.b||0),(0,C.writeInt16)(e,n.c||0),(0,C.writeInt16)(e,n.d||0),(0,C.writeInt16)(e,n.hue||0),(0,C.writeInt16)(e,n.saturation||0),(0,C.writeInt16)(e,n.lightness||0)}ie("hue2",nn("hue/saturation"),function(e,t,n){if((0,T.readUint16)(e)!==2)throw new Error("Invalid hue2 version");t.adjustment=I(I({},t.adjustment),{type:"hue/saturation",master:Vo(e),reds:Vo(e),yellows:Vo(e),greens:Vo(e),cyans:Vo(e),blues:Vo(e),magentas:Vo(e)}),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,C.writeUint16)(e,2),Go(e,n.master),Go(e,n.reds),Go(e,n.yellows),Go(e,n.greens),Go(e,n.cyans),Go(e,n.blues),Go(e,n.magentas)});function s0(e){return{cyanRed:(0,T.readInt16)(e),magentaGreen:(0,T.readInt16)(e),yellowBlue:(0,T.readInt16)(e)}}function l0(e,t){(0,C.writeInt16)(e,t.cyanRed||0),(0,C.writeInt16)(e,t.magentaGreen||0),(0,C.writeInt16)(e,t.yellowBlue||0)}ie("blnc",nn("color balance"),function(e,t,n){t.adjustment={type:"color balance",shadows:s0(e),midtones:s0(e),highlights:s0(e),preserveLuminosity:!!(0,T.readUint8)(e)},(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment;l0(e,n.shadows||{}),l0(e,n.midtones||{}),l0(e,n.highlights||{}),(0,C.writeUint8)(e,n.preserveLuminosity?1:0),(0,C.writeZeros)(e,1)});ie("blwh",nn("black & white"),function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);t.adjustment={type:"black & white",reds:r["Rd  "],yellows:r.Yllw,greens:r["Grn "],cyans:r["Cyn "],blues:r["Bl  "],magentas:r.Mgnt,useTint:!!r.useTint,presetKind:r.bwPresetKind,presetFileName:r.blackAndWhitePresetFileName},r.tintColor!==void 0&&(t.adjustment.tintColor=(0,A.parseColor)(r.tintColor)),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={"Rd  ":n.reds||0,Yllw:n.yellows||0,"Grn ":n.greens||0,"Cyn ":n.cyans||0,"Bl  ":n.blues||0,Mgnt:n.magentas||0,useTint:!!n.useTint,tintColor:(0,A.serializeColor)(n.tintColor),bwPresetKind:n.presetKind||0,blackAndWhitePresetFileName:n.presetFileName||""};(0,A.writeVersionAndDescriptor)(e,"","null",r)});ie("phfl",nn("photo filter"),function(e,t,n){var r=(0,T.readUint16)(e);if(r!==2&&r!==3)throw new Error("Invalid phfl version");var i;r===2?i=(0,T.readColor)(e):i={l:(0,T.readInt32)(e)/100,a:(0,T.readInt32)(e)/100,b:(0,T.readInt32)(e)/100},t.adjustment={type:"photo filter",color:i,density:(0,T.readUint32)(e)/100,preserveLuminosity:!!(0,T.readUint8)(e)},(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,C.writeUint16)(e,2),(0,C.writeColor)(e,n.color||{l:0,a:0,b:0}),(0,C.writeUint32)(e,(n.density||0)*100),(0,C.writeUint8)(e,n.preserveLuminosity?1:0),(0,C.writeZeros)(e,3)});function vd(e){var t=(0,T.readInt16)(e),n=(0,T.readInt16)(e),r=(0,T.readInt16)(e);(0,T.skipBytes)(e,2);var i=(0,T.readInt16)(e);return{red:t,green:n,blue:r,constant:i}}function Hl(e,t){var n=t||{};(0,C.writeInt16)(e,n.red),(0,C.writeInt16)(e,n.green),(0,C.writeInt16)(e,n.blue),(0,C.writeZeros)(e,2),(0,C.writeInt16)(e,n.constant)}ie("mixr",nn("channel mixer"),function(e,t,n){if((0,T.readUint16)(e)!==1)throw new Error("Invalid mixr version");var r=t.adjustment=I(I({},t.adjustment),{type:"channel mixer",monochrome:!!(0,T.readUint16)(e)});r.monochrome||(r.red=vd(e),r.green=vd(e),r.blue=vd(e)),r.gray=vd(e),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,C.writeUint16)(e,1),(0,C.writeUint16)(e,n.monochrome?1:0),n.monochrome?(Hl(e,n.gray),(0,C.writeZeros)(e,3*5*2)):(Hl(e,n.red),Hl(e,n.green),Hl(e,n.blue),Hl(e,n.gray))});var k_=(0,zn.createEnum)("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),R_=(0,zn.createEnum)("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),yd=(0,zn.createEnum)("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});ie("clrL",nn("color lookup"),function(e,t,n){if((0,T.readUint16)(e)!==1)throw new Error("Invalid clrL version");var r=(0,A.readVersionAndDescriptor)(e);t.adjustment={type:"color lookup"};var i=t.adjustment;r.lookupType!==void 0&&(i.lookupType=k_.decode(r.lookupType)),r["Nm  "]!==void 0&&(i.name=r["Nm  "]),r.Dthr!==void 0&&(i.dither=r.Dthr),r.profile!==void 0&&(i.profile=r.profile),r.LUTFormat!==void 0&&(i.lutFormat=R_.decode(r.LUTFormat)),r.dataOrder!==void 0&&(i.dataOrder=yd.decode(r.dataOrder)),r.tableOrder!==void 0&&(i.tableOrder=yd.decode(r.tableOrder)),r.LUT3DFileData!==void 0&&(i.lut3DFileData=r.LUT3DFileData),r.LUT3DFileName!==void 0&&(i.lut3DFileName=r.LUT3DFileName),(0,T.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={};n.lookupType!==void 0&&(r.lookupType=k_.encode(n.lookupType)),n.name!==void 0&&(r["Nm  "]=n.name),n.dither!==void 0&&(r.Dthr=n.dither),n.profile!==void 0&&(r.profile=n.profile),n.lutFormat!==void 0&&(r.LUTFormat=R_.encode(n.lutFormat)),n.dataOrder!==void 0&&(r.dataOrder=yd.encode(n.dataOrder)),n.tableOrder!==void 0&&(r.tableOrder=yd.encode(n.tableOrder)),n.lut3DFileData!==void 0&&(r.LUT3DFileData=n.lut3DFileData),n.lut3DFileName!==void 0&&(r.LUT3DFileName=n.lut3DFileName),(0,C.writeUint16)(e,1),(0,A.writeVersionAndDescriptor)(e,"","null",r)});ie("nvrt",nn("invert"),function(e,t,n){t.adjustment={type:"invert"},(0,T.skipBytes)(e,n())},function(){});ie("post",nn("posterize"),function(e,t,n){t.adjustment={type:"posterize",levels:(0,T.readUint16)(e)},(0,T.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,C.writeUint16)(e,(n=r.levels)!==null&&n!==void 0?n:4),(0,C.writeZeros)(e,2)});ie("thrs",nn("threshold"),function(e,t,n){t.adjustment={type:"threshold",level:(0,T.readUint16)(e)},(0,T.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,C.writeUint16)(e,(n=r.level)!==null&&n!==void 0?n:128),(0,C.writeZeros)(e,2)});var M_=["","","","rgb","hsb","","lab"];ie("grdm",nn("gradient map"),function(e,t,n){if((0,T.readUint16)(e)!==1)throw new Error("Invalid grdm version");var r={type:"gradient map",gradientType:"solid"};r.reverse=!!(0,T.readUint8)(e),r.dither=!!(0,T.readUint8)(e),r.name=(0,T.readUnicodeString)(e),r.colorStops=[],r.opacityStops=[];for(var i=(0,T.readUint16)(e),o=0;o<i;o++)r.colorStops.push({location:(0,T.readUint32)(e),midpoint:(0,T.readUint32)(e)/100,color:(0,T.readColor)(e)}),(0,T.skipBytes)(e,2);for(var a=(0,T.readUint16)(e),o=0;o<a;o++)r.opacityStops.push({location:(0,T.readUint32)(e),midpoint:(0,T.readUint32)(e)/100,opacity:(0,T.readUint16)(e)/255});var s=(0,T.readUint16)(e);if(s!==2)throw new Error("Invalid grdm expansion count");var l=(0,T.readUint16)(e);r.smoothness=l/4096;var u=(0,T.readUint16)(e);if(u!==32)throw new Error("Invalid grdm length");r.gradientType=(0,T.readUint16)(e)?"noise":"solid",r.randomSeed=(0,T.readUint32)(e),r.addTransparency=!!(0,T.readUint16)(e),r.restrictColors=!!(0,T.readUint16)(e),r.roughness=(0,T.readUint32)(e)/4096,r.colorModel=M_[(0,T.readUint16)(e)]||"rgb",r.min=[(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768],r.max=[(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768,(0,T.readUint16)(e)/32768],(0,T.skipBytes)(e,n());for(var c=0,f=r.colorStops;c<f.length;c++){var d=f[c];d.location/=l}for(var h=0,y=r.opacityStops;h<y.length;h++){var d=y[h];d.location/=l}t.adjustment=r},function(e,t){var n,r,i,o=t.adjustment;(0,C.writeUint16)(e,1),(0,C.writeUint8)(e,o.reverse?1:0),(0,C.writeUint8)(e,o.dither?1:0),(0,C.writeUnicodeStringWithPadding)(e,o.name||""),(0,C.writeUint16)(e,o.colorStops&&o.colorStops.length||0);for(var a=Math.round(((n=o.smoothness)!==null&&n!==void 0?n:1)*4096),s=0,l=o.colorStops||[];s<l.length;s++){var u=l[s];(0,C.writeUint32)(e,Math.round(u.location*a)),(0,C.writeUint32)(e,Math.round(u.midpoint*100)),(0,C.writeColor)(e,u.color),(0,C.writeZeros)(e,2)}(0,C.writeUint16)(e,o.opacityStops&&o.opacityStops.length||0);for(var c=0,f=o.opacityStops||[];c<f.length;c++){var u=f[c];(0,C.writeUint32)(e,Math.round(u.location*a)),(0,C.writeUint32)(e,Math.round(u.midpoint*100)),(0,C.writeUint16)(e,Math.round(u.opacity*255))}(0,C.writeUint16)(e,2),(0,C.writeUint16)(e,a),(0,C.writeUint16)(e,32),(0,C.writeUint16)(e,o.gradientType==="noise"?1:0),(0,C.writeUint32)(e,o.randomSeed||0),(0,C.writeUint16)(e,o.addTransparency?1:0),(0,C.writeUint16)(e,o.restrictColors?1:0),(0,C.writeUint32)(e,Math.round(((r=o.roughness)!==null&&r!==void 0?r:1)*4096));var d=M_.indexOf((i=o.colorModel)!==null&&i!==void 0?i:"rgb");(0,C.writeUint16)(e,d===-1?3:d);for(var h=0;h<4;h++)(0,C.writeUint16)(e,Math.round((o.min&&o.min[h]||0)*32768));for(var h=0;h<4;h++)(0,C.writeUint16)(e,Math.round((o.max&&o.max[h]||0)*32768));(0,C.writeZeros)(e,4)});function ui(e){return{c:(0,T.readInt16)(e),m:(0,T.readInt16)(e),y:(0,T.readInt16)(e),k:(0,T.readInt16)(e)}}function ci(e,t){var n=t||{};(0,C.writeInt16)(e,n.c),(0,C.writeInt16)(e,n.m),(0,C.writeInt16)(e,n.y),(0,C.writeInt16)(e,n.k)}ie("selc",nn("selective color"),function(e,t){if((0,T.readUint16)(e)!==1)throw new Error("Invalid selc version");var n=(0,T.readUint16)(e)?"absolute":"relative";(0,T.skipBytes)(e,8),t.adjustment={type:"selective color",mode:n,reds:ui(e),yellows:ui(e),greens:ui(e),cyans:ui(e),blues:ui(e),magentas:ui(e),whites:ui(e),neutrals:ui(e),blacks:ui(e)}},function(e,t){var n=t.adjustment;(0,C.writeUint16)(e,1),(0,C.writeUint16)(e,n.mode==="absolute"?1:0),(0,C.writeZeros)(e,8),ci(e,n.reds),ci(e,n.yellows),ci(e,n.greens),ci(e,n.cyans),ci(e,n.blues),ci(e,n.magentas),ci(e,n.whites),ci(e,n.neutrals),ci(e,n.blacks)});ie("CgEd",function(e){var t=e.adjustment;return t?t.type==="brightness/contrast"&&!t.useLegacy||(t.type==="levels"||t.type==="curves"||t.type==="exposure"||t.type==="channel mixer"||t.type==="hue/saturation")&&t.presetFileName!==void 0:!1},function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);if(r.Vrsn!==1)throw new Error("Invalid CgEd version");"presetFileName"in r?t.adjustment=I(I({},t.adjustment),{presetKind:r.presetKind,presetFileName:r.presetFileName}):"curvesPresetFileName"in r?t.adjustment=I(I({},t.adjustment),{presetKind:r.curvesPresetKind,presetFileName:r.curvesPresetFileName}):"mixerPresetFileName"in r?t.adjustment=I(I({},t.adjustment),{presetKind:r.mixerPresetKind,presetFileName:r.mixerPresetFileName}):t.adjustment={type:"brightness/contrast",brightness:r.Brgh,contrast:r.Cntr,meanValue:r.means,useLegacy:!!r.useLegacy,labColorOnly:!!r["Lab "],auto:!!r.Auto},(0,T.skipBytes)(e,n())},function(e,t){var n,r,i,o,a=t.adjustment;if(a.type==="levels"||a.type==="exposure"||a.type==="hue/saturation"){var s={Vrsn:1,presetKind:(n=a.presetKind)!==null&&n!==void 0?n:1,presetFileName:a.presetFileName||""};(0,A.writeVersionAndDescriptor)(e,"","null",s)}else if(a.type==="curves"){var s={Vrsn:1,curvesPresetKind:(r=a.presetKind)!==null&&r!==void 0?r:1,curvesPresetFileName:a.presetFileName||""};(0,A.writeVersionAndDescriptor)(e,"","null",s)}else if(a.type==="channel mixer"){var s={Vrsn:1,mixerPresetKind:(i=a.presetKind)!==null&&i!==void 0?i:1,mixerPresetFileName:a.presetFileName||""};(0,A.writeVersionAndDescriptor)(e,"","null",s)}else if(a.type==="brightness/contrast"){var s={Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:(o=a.meanValue)!==null&&o!==void 0?o:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto};(0,A.writeVersionAndDescriptor)(e,"","null",s)}else throw new Error("Unhandled CgEd case")});function nD(e){var t=[];function n(r){var i;if(r.children)for(var o=0,a=r.children;o<a.length;o++){var s=a[o];((i=s.text)===null||i===void 0?void 0:i.index)!==void 0&&(t[s.text.index]=s),n(s)}}return n(e),t}ie("Txt2",Ge("engineData"),function(e,t,n,r){var i=(0,T.readBytes)(e,n());t.engineData=(0,C_.fromByteArray)(i);var o=nD(r),a=(0,u0.parseEngineData)(i),s=(0,KA.decodeEngineData2)(a),l=s.ResourceDict.TextFrameSet;if(l)for(var u=0;u<l.length;u++){var c=o[u];l[u].path&&(c!=null&&c.text)&&(c.text.textPath=l[u].path)}},function(e,t){var n=(0,C_.toByteArray)(t.engineData);(0,C.writeBytes)(e,n)});ie("FEid",Ge("filterEffectsMasks"),function(e,t,n){var r=(0,T.readInt32)(e);if(r<1||r>3)throw new Error("Invalid filterEffects version ".concat(r));for(t.filterEffectsMasks=[];n()>8;){if((0,T.readUint32)(e))throw new Error("filterEffects: 64 bit length is not supported");var i=(0,T.readUint32)(e),o=e.offset+i,a=(0,T.readPascalString)(e,1),s=(0,T.readInt32)(e);if(s!==1)throw new Error("Invalid filterEffect version ".concat(s));if((0,T.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");(0,T.readUint32)(e);for(var l=(0,T.readInt32)(e),u=(0,T.readInt32)(e),c=(0,T.readInt32)(e),f=(0,T.readInt32)(e),d=(0,T.readInt32)(e),h=(0,T.readInt32)(e),y=[],S=0;S<h+2;S++){var b=(0,T.readInt32)(e);if(b){if((0,T.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");var g=(0,T.readUint32)(e);if(!g)throw new Error("filterEffect: Empty channel");var p=(0,T.readUint16)(e),m=(0,T.readBytes)(e,g-2);y.push({compressionMode:p,data:m})}else y.push(void 0)}if(t.filterEffectsMasks.push({id:a,top:l,left:u,bottom:c,right:f,depth:d,channels:y}),e.offset<o&&(0,T.readUint8)(e)){var v=(0,T.readInt32)(e),x=(0,T.readInt32)(e),w=(0,T.readInt32)(e),_=(0,T.readInt32)(e);if((0,T.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");var E=(0,T.readUint32)(e),p=(0,T.readUint16)(e),m=(0,T.readBytes)(e,E-2);t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={top:v,left:x,bottom:w,right:_,compressionMode:p,data:m}}e.offset=o;for(var P=i;P%4;)e.offset++,P++}},function(e,t){var n;(0,C.writeInt32)(e,3);for(var r=0,i=t.filterEffectsMasks;r<i.length;r++){var o=i[r];(0,C.writeUint32)(e,0),(0,C.writeUint32)(e,0);var a=e.offset;(0,C.writePascalString)(e,o.id,1),(0,C.writeInt32)(e,1),(0,C.writeUint32)(e,0),(0,C.writeUint32)(e,0);var s=e.offset;(0,C.writeInt32)(e,o.top),(0,C.writeInt32)(e,o.left),(0,C.writeInt32)(e,o.bottom),(0,C.writeInt32)(e,o.right),(0,C.writeInt32)(e,o.depth);var l=Math.max(0,o.channels.length-2);(0,C.writeInt32)(e,l);for(var u=0;u<l+2;u++){var c=o.channels[u];(0,C.writeInt32)(e,c?1:0),c&&((0,C.writeUint32)(e,0),(0,C.writeUint32)(e,c.data.length+2),(0,C.writeUint16)(e,c.compressionMode),(0,C.writeBytes)(e,c.data))}e.view.setUint32(s-4,e.offset-s,!1);var f=(n=t.filterEffectsMasks[t.filterEffectsMasks.length-1])===null||n===void 0?void 0:n.extra;f&&((0,C.writeUint8)(e,1),(0,C.writeInt32)(e,f.top),(0,C.writeInt32)(e,f.left),(0,C.writeInt32)(e,f.bottom),(0,C.writeInt32)(e,f.right),(0,C.writeUint32)(e,0),(0,C.writeUint32)(e,f.data.byteLength+2),(0,C.writeUint16)(e,f.compressionMode),(0,C.writeBytes)(e,f.data));var d=e.offset-a;for(e.view.setUint32(a-4,d,!1);d%4;)(0,C.writeZeros)(e,1),d++}});ns("FXid","FEid");ie("FMsk",Ge("filterMask"),function(e,t){t.filterMask={colorSpace:(0,T.readColor)(e),opacity:(0,T.readUint16)(e)/255}},function(e,t){var n;(0,C.writeColor)(e,t.filterMask.colorSpace),(0,C.writeUint16)(e,(0,zn.clamp)((n=t.filterMask.opacity)!==null&&n!==void 0?n:1,0,1)*255)});ie("artd",function(e){return e.artboards!==void 0},function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);t.artboards={count:r["Cnt "],autoExpandOffset:{horizontal:r.autoExpandOffset.Hrzn,vertical:r.autoExpandOffset.Vrtc},origin:{horizontal:r.origin.Hrzn,vertical:r.origin.Vrtc},autoExpandEnabled:r.autoExpandEnabled,autoNestEnabled:r.autoNestEnabled,autoPositionEnabled:r.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!r.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:(0,A.parseColor)(r.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:r.docDefaultNewArtboardBackgroundType},(0,T.skipBytes)(e,n())},function(e,t){var n,r,i,o,a,s=t.artboards,l={"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:(n=s.autoExpandEnabled)!==null&&n!==void 0?n:!0,autoNestEnabled:(r=s.autoNestEnabled)!==null&&r!==void 0?r:!0,autoPositionEnabled:(i=s.autoPositionEnabled)!==null&&i!==void 0?i:!0,shrinkwrapOnSaveEnabled:(o=s.shrinkwrapOnSaveEnabled)!==null&&o!==void 0?o:!0,docDefaultNewArtboardBackgroundColor:(0,A.serializeColor)(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:(a=s.docDefaultNewArtboardBackgroundType)!==null&&a!==void 0?a:1};(0,A.writeVersionAndDescriptor)(e,"","null",l,"artd")});function d0(e){return Object.keys(e).map(function(t){return e[t]}).some(function(t){return Array.isArray(t)&&t.length>1})}St.hasMultiEffects=d0;ie("lfx2",function(e){return e.effects!==void 0&&!d0(e.effects)},function(e,t,n){var r=(0,T.readUint32)(e);if(r!==0)throw new Error("Invalid lfx2 version");var i=(0,A.readVersionAndDescriptor)(e);t.effects=(0,A.parseEffects)(i,!!e.logMissingFeatures),(0,T.skipBytes)(e,n())},function(e,t,n,r){var i=(0,A.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,C.writeUint32)(e,0),(0,A.writeVersionAndDescriptor)(e,"","null",i)});ie("cinf",Ge("compositorUsed"),function(e,t,n){var r=(0,A.readVersionAndDescriptor)(e);function i(o){return o.split(".")[1]}t.compositorUsed={description:r.description,reason:r.reason,engine:i(r.Engn)},r.Vrsn&&(t.compositorUsed.version=r.Vrsn),r.psVersion&&(t.compositorUsed.photoshopVersion=r.psVersion),r.enableCompCore&&(t.compositorUsed.enableCompCore=i(r.enableCompCore)),r.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=i(r.enableCompCoreGPU)),r.enableCompCoreThreads&&(t.compositorUsed.enableCompCoreThreads=i(r.enableCompCoreThreads)),r.compCoreSupport&&(t.compositorUsed.compCoreSupport=i(r.compCoreSupport)),r.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=i(r.compCoreGPUSupport)),(0,T.skipBytes)(e,n())},function(e,t){var n=t.compositorUsed,r={Vrsn:n.version||{major:1,minor:0,fix:0}};n.photoshopVersion&&(r.psVersion=n.photoshopVersion),r.description=n.description,r.reason=n.reason,r.Engn="Engn.".concat(n.engine),n.enableCompCore&&(r.enableCompCore="enable.".concat(n.enableCompCore)),n.enableCompCoreGPU&&(r.enableCompCoreGPU="enable.".concat(n.enableCompCoreGPU)),n.enableCompCoreThreads&&(r.enableCompCoreThreads="enable.".concat(n.enableCompCoreThreads)),n.compCoreSupport&&(r.compCoreSupport="reason.".concat(n.compCoreSupport)),n.compCoreGPUSupport&&(r.compCoreGPUSupport="reason.".concat(n.compCoreGPUSupport)),(0,A.writeVersionAndDescriptor)(e,"","null",r)});ie("extn",function(e){return e._extn!==void 0},function(e,t){var n=(0,A.readVersionAndDescriptor)(e);zn.MOCK_HANDLERS&&(t._extn=n)},function(e,t){zn.MOCK_HANDLERS&&(0,A.writeVersionAndDescriptor)(e,"","null",t._extn)});ie("iOpa",Ge("fillOpacity"),function(e,t){t.fillOpacity=(0,T.readUint8)(e)/255,(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.fillOpacity*255),(0,C.writeZeros)(e,3)});ie("brst",Ge("channelBlendingRestrictions"),function(e,t,n){for(t.channelBlendingRestrictions=[];n()>4;)t.channelBlendingRestrictions.push((0,T.readInt32)(e))},function(e,t){for(var n=0,r=t.channelBlendingRestrictions;n<r.length;n++){var i=r[n];(0,C.writeInt32)(e,i)}});ie("tsly",Ge("transparencyShapesLayer"),function(e,t){t.transparencyShapesLayer=!!(0,T.readUint8)(e),(0,T.skipBytes)(e,3)},function(e,t){(0,C.writeUint8)(e,t.transparencyShapesLayer?1:0),(0,C.writeZeros)(e,3)})});var Wa=_e(me=>{"use strict";var io=me&&me.__assign||function(){return io=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},io.apply(this,arguments)};Object.defineProperty(me,"__esModule",{value:!0});me.writeColor=me.writePsd=me.writeSection=me.writeUnicodeStringWithPadding=me.writeUnicodeString=me.writeUnicodeStringWithoutLengthLE=me.writeUnicodeStringWithoutLength=me.writePascalString=me.writeSignature=me.writeZeros=me.writeBytes=me.writeFixedPointPath32=me.writeFixedPoint32=me.writeFloat64=me.writeFloat32=me.writeUint32=me.writeInt32LE=me.writeInt32=me.writeUint16LE=me.writeUint16=me.writeInt16=me.writeUint8=me.getWriterBufferNoCopy=me.getWriterBuffer=me.createWriter=void 0;var Rt=Qi(),rD=dd(),iD=Gm();function oD(e){e===void 0&&(e=4096);var t=new ArrayBuffer(e),n=new DataView(t),r=0;return{buffer:t,view:n,offset:r,tempBuffer:void 0}}me.createWriter=oD;function aD(e){return e.buffer.slice(0,e.offset)}me.getWriterBuffer=aD;function sD(e){return new Uint8Array(e.buffer,0,e.offset)}me.getWriterBufferNoCopy=sD;function et(e,t){var n=fi(e,1);e.view.setUint8(n,t)}me.writeUint8=et;function rs(e,t){var n=fi(e,2);e.view.setInt16(n,t,!1)}me.writeInt16=rs;function xe(e,t){var n=fi(e,2);e.view.setUint16(n,t,!1)}me.writeUint16=xe;function H_(e,t){var n=fi(e,2);e.view.setUint16(n,t,!0)}me.writeUint16LE=H_;function pn(e,t){var n=fi(e,4);e.view.setInt32(n,t,!1)}me.writeInt32=pn;function lD(e,t){var n=fi(e,4);e.view.setInt32(n,t,!0)}me.writeInt32LE=lD;function di(e,t){var n=fi(e,4);e.view.setUint32(n,t,!1)}me.writeUint32=di;function uD(e,t){var n=fi(e,4);e.view.setFloat32(n,t,!1)}me.writeFloat32=uD;function f0(e,t){var n=fi(e,8);e.view.setFloat64(n,t,!1)}me.writeFloat64=f0;function cD(e,t){pn(e,t*65536)}me.writeFixedPoint32=cD;function dD(e,t){pn(e,t*(1<<24))}me.writeFixedPointPath32=dD;function _d(e,t){if(t){K_(e,e.offset+t.length);var n=new Uint8Array(e.buffer);n.set(t,e.offset),e.offset+=t.length}}me.writeBytes=_d;function is(e,t){for(var n=0;n<t;n++)et(e,0)}me.writeZeros=is;function Ho(e,t){if(t.length!==4)throw new Error("Invalid signature: '".concat(t,"'"));for(var n=0;n<4;n++)et(e,t.charCodeAt(n))}me.writeSignature=Ho;function p0(e,t,n){var r=t.length;if(r>255)throw new Error("String too long");et(e,r);for(var i=0;i<r;i++){var o=t.charCodeAt(i);et(e,o<128?o:63)}for(;++r%n;)et(e,0)}me.writePascalString=p0;function j_(e,t){for(var n=0;n<t.length;n++)xe(e,t.charCodeAt(n))}me.writeUnicodeStringWithoutLength=j_;function fD(e,t){for(var n=0;n<t.length;n++)H_(e,t.charCodeAt(n))}me.writeUnicodeStringWithoutLengthLE=fD;function pD(e,t){di(e,t.length),j_(e,t)}me.writeUnicodeString=pD;function hD(e,t){di(e,t.length+1);for(var n=0;n<t.length;n++)xe(e,t.charCodeAt(n));xe(e,0)}me.writeUnicodeStringWithPadding=hD;function W_(e){e===void 0&&(e=[]);for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];if(i.canvas||i.imageData){var o=h0(i),a=o.width,s=o.height;t=Math.max(t,2*s+2*a*s)}i.children&&(t=Math.max(t,W_(i.children)))}return t}function pr(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=!1),i&&di(e,0);var o=e.offset;di(e,0),n();for(var a=e.offset-o-4,s=a;s%t!==0;)et(e,0),s++;r&&(a=s),e.view.setUint32(o,a,!1)}me.writeSection=pr;function $_(e){var t;(t=e.children)===null||t===void 0||t.forEach($_);var n=e.imageData;if(n&&(n.data instanceof Uint32Array||n.data instanceof Uint16Array))throw new Error("imageData has incorrect bitDepth");if("mask"in e&&e.mask){var r=e.mask.imageData;if(r&&(r.data instanceof Uint32Array||r.data instanceof Uint16Array))throw new Error("mask imageData has incorrect bitDepth")}}function mD(e,t,n){var r;if(n===void 0&&(n={}),!(+t.width>0&&+t.height>0))throw new Error("Invalid document size");if((t.width>3e4||t.height>3e4)&&!n.psb)throw new Error("Document size is too large (max is 30000x30000, use PSB format instead)");var i=(r=t.bitsPerChannel)!==null&&r!==void 0?r:8;if(i!==8)throw new Error("bitsPerChannel other than 8 are not supported for writing");$_(t);var o=io({},t.imageResources),a=io(io({},n),{layerIds:new Set,layerToId:new Map});a.generateThumbnail&&(o.thumbnail=bD(t));var s=t.imageData;if(!s&&t.canvas&&(s=t.canvas.getContext("2d").getImageData(0,0,t.canvas.width,t.canvas.height)),s&&(t.width!==s.width||t.height!==s.height))throw new Error("Document canvas must have the same size as document");var l=!!s&&(0,Rt.hasAlpha)(s),u=Math.max(W_(t.children),4*2*t.width*t.height+2*t.height);e.tempBuffer=new Uint8Array(u),Ho(e,"8BPS"),xe(e,n.psb?2:1),is(e,6),xe(e,l?4:3),di(e,t.height),di(e,t.width),xe(e,i),xe(e,3),pr(e,1,function(){var x,w,_;if(t.palette){for(var E=0;E<256;E++)et(e,((x=t.palette[E])===null||x===void 0?void 0:x.r)||0);for(var E=0;E<256;E++)et(e,((w=t.palette[E])===null||w===void 0?void 0:w.g)||0);for(var E=0;E<256;E++)et(e,((_=t.palette[E])===null||_===void 0?void 0:_.b)||0)}});var c=[];Y_(c,t.children),c.length||c.push({}),o.layersGroup=c.map(function(x){return x.linkGroup||0}),o.layerGroupsEnabledId=c.map(function(x){return x.linkGroupEnabled==!1?0:1}),pr(e,1,function(){for(var x=function(P){for(var D=P.has(o),M=D===!1?0:D===!0?1:D,j=function(L){Ho(e,"8BIM"),xe(e,P.key),p0(e,"",2),pr(e,2,function(){return P.write(e,o,L)})},N=0;N<M;N++)j(N)},w=0,_=iD.resourceHandlers;w<_.length;w++){var E=_[w];x(E)}}),pr(e,2,function(){gD(e,c,t,l,a),SD(e,t.globalLayerMaskInfo),X_(e,t,t,a)},void 0,!!a.psb);var f=l?[0,1,2,3]:[0,1,2],d=s?s.width:t.width,h=s?s.height:t.height,y={data:new Uint8Array(d*h*4),width:d,height:h};if(xe(e,1),Rt.RAW_IMAGE_DATA&&t.imageDataRaw)console.log("writing raw image data"),_d(e,t.imageDataRaw);else{if(s&&y.data.set(new Uint8Array(s.data.buffer,s.data.byteOffset,s.data.byteLength)),l)for(var S=y.width*y.height*4,b=y.data,g=0;g<S;g+=4){var p=b[g+3];if(p!=0&&p!=255){var m=p/255,v=255*(1-m);b[g+0]=b[g+0]*m+v,b[g+1]=b[g+1]*m+v,b[g+2]=b[g+2]*m+v}}_d(e,(0,Rt.writeDataRLE)(e.tempBuffer,y,f,!!n.psb))}}me.writePsd=mD;function gD(e,t,n,r,i){pr(e,4,function(){var o;rs(e,r?-t.length:t.length);for(var a=t.map(function(b,g){return _D(e.tempBuffer,b,g===0,i)}),s=function(b){var g=b.layer,p=b.top,m=b.left,v=b.bottom,x=b.right,w=b.channels;pn(e,p),pn(e,m),pn(e,v),pn(e,x),xe(e,w.length);for(var _=0,E=w;_<E.length;_++){var P=E[_];rs(e,P.channelId),i.psb&&di(e,0),di(e,P.length)}Ho(e,"8BIM"),Ho(e,Rt.fromBlendMode[g.blendMode]||"norm"),et(e,Math.round((0,Rt.clamp)((o=g.opacity)!==null&&o!==void 0?o:1,0,1)*255)),et(e,g.clipping?1:0);var D=8;g.transparencyProtected&&(D|=1),g.hidden&&(D|=2),(g.vectorMask||g.sectionDivider&&g.sectionDivider.type!==0||g.adjustment)&&(D|=16),g.effectsOpen&&(D|=32),et(e,D),et(e,0),pr(e,1,function(){vD(e,g,b),yD(e,g),p0(e,(g.name||"").substring(0,255),4),X_(e,g,n,i)})},l=0,u=a;l<u.length;l++){var c=u[l];s(c)}for(var f=0,d=a;f<d.length;f++)for(var c=d[f],h=0,y=c.channels;h<y.length;h++){var S=y[h];xe(e,S.compression),S.buffer&&_d(e,S.buffer)}},!0,i.psb)}function vD(e,t,n){var r=t.mask,i=t.realMask;pr(e,1,function(){if(!(!r&&!i)){var o=0,a=0,s=0;r&&(r.userMaskDensity!==void 0&&(o|=1),r.userMaskFeather!==void 0&&(o|=2),r.vectorMaskDensity!==void 0&&(o|=4),r.vectorMaskFeather!==void 0&&(o|=8),r.disabled&&(a|=2),r.positionRelativeToLayer&&(a|=1),r.fromVectorData&&(a|=8),o&&(a|=16));var l=n.mask||{};if(pn(e,l.top||0),pn(e,l.left||0),pn(e,l.bottom||0),pn(e,l.right||0),et(e,r&&r.defaultColor||0),et(e,a),i){i.disabled&&(s|=2),i.positionRelativeToLayer&&(s|=1),i.fromVectorData&&(s|=8);var u=n.realMask||{};et(e,s),et(e,i.defaultColor||0),pn(e,u.top||0),pn(e,u.left||0),pn(e,u.bottom||0),pn(e,u.right||0)}o&&r&&(et(e,o),r.userMaskDensity!==void 0&&et(e,Math.round(r.userMaskDensity*255)),r.userMaskFeather!==void 0&&f0(e,r.userMaskFeather),r.vectorMaskDensity!==void 0&&et(e,Math.round(r.vectorMaskDensity*255)),r.vectorMaskFeather!==void 0&&f0(e,r.vectorMaskFeather)),is(e,2)}})}function bd(e,t){et(e,t[0]),et(e,t[1]),et(e,t[2]),et(e,t[3])}function yD(e,t){pr(e,1,function(){var n=t.blendingRanges;if(n){bd(e,n.compositeGrayBlendSource),bd(e,n.compositeGraphBlendDestinationRange);for(var r=0,i=n.ranges;r<i.length;r++){var o=i[r];bd(e,o.sourceRange),bd(e,o.destRange)}}})}function SD(e,t){pr(e,1,function(){t&&(xe(e,t.overlayColorSpace),xe(e,t.colorSpace1),xe(e,t.colorSpace2),xe(e,t.colorSpace3),xe(e,t.colorSpace4),xe(e,t.opacity*255),et(e,t.kind),is(e,3))})}function X_(e,t,n,r){for(var i=function(l){var u=l.key;if(u==="Txt2"&&r.invalidateTextLayers)return"continue";if(u==="vmsk"&&r.psb&&(u="vsms"),l.has(t)){var c=r.psb&&Rt.largeAdditionalInfoKeys.indexOf(u)!==-1,f=u!=="Txt2"&&u!=="cinf"&&u!=="extn"&&u!=="CAI "&&u!=="OCIO",d=u==="Txt2"||u==="luni"||u==="vmsk"||u==="artb"||u==="artd"||u==="vogk"||u==="SoLd"||u==="lnk2"||u==="vscg"||u==="vsms"||u==="GdFl"||u==="lmfx"||u==="lrFX"||u==="cinf"||u==="PlLd"||u==="Anno"||u==="CAI "||u==="OCIO"||u==="GenI"||u==="FEid";Ho(e,c?"8B64":"8BIM"),Ho(e,u),pr(e,d?4:2,function(){l.write(e,t,n,r)},f,c)}},o=0,a=rD.infoHandlers;o<a.length;o++){var s=a[o];i(s)}}function Y_(e,t){if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.children&&i.canvas)throw new Error("Invalid layer, cannot have both 'canvas' and 'children' properties");if(i.children&&i.imageData)throw new Error("Invalid layer, cannot have both 'imageData' and 'children' properties");i.children?(e.push({name:"</Layer group>",sectionDivider:{type:3}}),Y_(e,i.children),e.push(io(io({},i),{blendMode:i.blendMode==="pass through"?"normal":i.blendMode,sectionDivider:{type:i.opened===!1?2:1,key:Rt.fromBlendMode[i.blendMode]||"pass",subType:0}}))):e.push(io({},i))}}function wD(e,t){var n=e.buffer.byteLength;do n*=2;while(t>n);var r=new ArrayBuffer(n),i=new Uint8Array(r),o=new Uint8Array(e.buffer);i.set(o),e.buffer=r,e.view=new DataView(e.buffer)}function K_(e,t){t>e.buffer.byteLength&&wD(e,t)}function fi(e,t){var n=e.offset;return K_(e,e.offset+=t),n}function bD(e){var t=(0,Rt.createCanvas)(10,10),n=1;e.width>e.height?(t.width=160,t.height=Math.floor(e.height*(t.width/e.width)),n=t.width/e.width):(t.height=160,t.width=Math.floor(e.width*(t.height/e.height)),n=t.height/e.height);var r=t.getContext("2d");return r.scale(n,n),e.imageData?r.drawImage((0,Rt.imageDataToCanvas)(e.imageData),0,0):e.canvas&&r.drawImage(e.canvas,0,0),t}function z_(e,t,n,r,i,o){var a=r.top|0,s=r.left|0,l=r.right|0,u=r.bottom|0,c=h0(r),f=c.width,d=c.height,h=r.imageData;if(!h&&r.canvas&&f&&d&&(h=r.canvas.getContext("2d").getImageData(0,0,f,d)),f&&d&&h){if(l=s+f,u=a+d,h.width!==f||h.height!==d)throw new Error("Invalid imageData dimentions");var y=void 0,S=void 0;Rt.RAW_IMAGE_DATA&&n[o?"realMaskDataRaw":"maskDataRaw"]?(y=n[o?"realMaskDataRaw":"maskDataRaw"],S=n[o?"realMaskDataRawCompression":"maskDataRawCompression"]):i.compress?(y=(0,Rt.writeDataZipWithoutPrediction)(h,[0]),S=2):(y=(0,Rt.writeDataRLE)(e,h,[0],!!i.psb),S=1),t.channels.push({channelId:o?-3:-2,compression:S,buffer:y,length:2+y.length})}t[o?"realMask":"mask"]={top:a,left:s,right:l,bottom:u}}function _D(e,t,n,r){var i=ED(e,t,n,r);return t.mask&&z_(e,i,t,t.mask,r,!1),t.realMask&&z_(e,i,t,t.realMask,r,!0),i}function h0(e){var t=e.canvas,n=e.imageData;return n||t||{width:0,height:0}}function xD(e,t,n,r,i){if(e.data instanceof Uint32Array||e.data instanceof Uint16Array)throw new Error("imageData has incorrect bit depth");for(var o=(0,Rt.createImageData)(r,i),a=e.data,s=o.data,l=0;l<i;l++)for(var u=0;u<r;u++){var c=(u+t+(l+n)*e.width)*4,f=(u+l*r)*4;s[f]=a[c],s[f+1]=a[c+1],s[f+2]=a[c+2],s[f+3]=a[c+3]}return o}function ED(e,t,n,r){var i,o=t.top|0,a=t.left|0,s=t.right|0,l=t.bottom|0,u=[{channelId:-1,compression:0,buffer:void 0,length:2},{channelId:0,compression:0,buffer:void 0,length:2},{channelId:1,compression:0,buffer:void 0,length:2},{channelId:2,compression:0,buffer:void 0,length:2}],c=h0(t),f=c.width,d=c.height;if(!(t.canvas||t.imageData)||!f||!d)return s=a,l=o,{layer:t,top:o,left:a,right:s,bottom:l,channels:u};s=a+f,l=o+d;var h=t.imageData||t.canvas.getContext("2d").getImageData(0,0,f,d);if(r.trimImageData){var y=TD(h);if(y.left!==0||y.top!==0||y.right!==h.width||y.bottom!==h.height){if(a+=y.left,o+=y.top,s-=h.width-y.right,l-=h.height-y.bottom,f=s-a,d=l-o,!f||!d)return{layer:t,top:o,left:a,right:s,bottom:l,channels:u};h=xD(h,y.left,y.top,f,d)}}var S=[0,1,2];return(!n||r.noBackground||t.mask||(0,Rt.hasAlpha)(h)||Rt.RAW_IMAGE_DATA&&(!((i=t.imageDataRaw)===null||i===void 0)&&i[-1]))&&S.unshift(-1),u=S.map(function(b){var g=(0,Rt.offsetForChannel)(b,!1),p,m;return Rt.RAW_IMAGE_DATA&&t.imageDataRaw?(p=t.imageDataRaw[b],m=t.imageDataRawCompression[b]):r.compress?(p=(0,Rt.writeDataZipWithoutPrediction)(h,[g]),m=2):(p=(0,Rt.writeDataRLE)(e,h,[g],!!r.psb),m=1),{channelId:b,compression:m,buffer:p,length:2+p.length}}),{layer:t,top:o,left:a,right:s,bottom:l,channels:u}}function V_(e,t,n,r){for(var i=e.data,o=e.width,a=(t*o+n)*4+3|0,s=a+(r-n)*4|0,l=a;l<s;l=l+4|0)if(i[l]!==0)return!1;return!0}function G_(e,t,n,r){for(var i=e.data,o=e.width,a=o*4|0,s=n*a+t*4+3|0,l=n,u=s;l<r;l++,u=u+a|0)if(i[u]!==0)return!1;return!0}function TD(e){for(var t=0,n=0,r=e.width,i=e.height;t<i&&V_(e,t,n,r);)t++;for(;i>t&&V_(e,i-1,n,r);)i--;for(;n<r&&G_(e,n,t,i);)n++;for(;r>n&&G_(e,r-1,t,i);)r--;return{top:t,left:n,right:r,bottom:i}}function CD(e,t){t?"r"in t?(xe(e,0),xe(e,Math.round(t.r*257)),xe(e,Math.round(t.g*257)),xe(e,Math.round(t.b*257)),xe(e,0)):"fr"in t?(xe(e,0),xe(e,Math.round(t.fr*255*257)),xe(e,Math.round(t.fg*255*257)),xe(e,Math.round(t.fb*255*257)),xe(e,0)):"l"in t?(xe(e,7),rs(e,Math.round(t.l*1e4)),rs(e,Math.round(t.a<0?t.a*12800:t.a*12700)),rs(e,Math.round(t.b<0?t.b*12800:t.b*12700)),xe(e,0)):"h"in t?(xe(e,1),xe(e,Math.round(t.h*65535)),xe(e,Math.round(t.s*65535)),xe(e,Math.round(t.b*65535)),xe(e,0)):"c"in t?(xe(e,2),xe(e,Math.round(t.c*257)),xe(e,Math.round(t.m*257)),xe(e,Math.round(t.y*257)),xe(e,Math.round(t.k*257))):(xe(e,8),xe(e,Math.round(t.k*1e4/255)),is(e,6)):(xe(e,0),is(e,8))}me.writeColor=CD});var q_=_e(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.readAbr=void 0;var at=ed(),Mt=eo(),ID=["off","fade","pen pressure","pen tilt","stylus wheel","initial direction","direction","initial rotation","rotation"],PD={_:"brush",MixB:"mixer brush",SmTl:"smudge brush"};function rn(e){return{control:ID[e.bVTy],steps:e.fStp,jitter:(0,at.parsePercent)(e.jitter),minimum:(0,at.parsePercent)(e["Mnm "])}}function Z_(e){var t={size:(0,at.parseUnitsToNumber)(e.Dmtr,"Pixels"),angle:(0,at.parseAngle)(e.Angl),roundness:(0,at.parsePercent)(e.Rndn),spacingOn:e.Intr,spacing:(0,at.parsePercent)(e.Spcn),flipX:e.flipX,flipY:e.flipY};return e["Nm  "]&&(t.name=e["Nm  "]),e.Hrdn&&(t.hardness=(0,at.parsePercent)(e.Hrdn)),e.sampledData&&(t.sampledData=e.sampledData),t}function AD(e,t){var n,r,i,o;t===void 0&&(t={});var a=(0,Mt.createReader)(e.buffer,e.byteOffset,e.byteLength),s=(0,Mt.readInt16)(a),l=[],u=[],c=[];if(s===1||s===2)throw new Error("Unsupported ABR version (".concat(s,")"));if(s===6||s===7||s===9||s===10){var f=(0,Mt.readInt16)(a);if(f!==1&&f!==2)throw new Error("Unsupported ABR minor version");for(;a.offset<a.view.byteLength;){(0,Mt.checkSignature)(a,"8BIM");var d=(0,Mt.readSignature)(a),h=(0,Mt.readUint32)(a),y=a.offset+h;switch(d){case"samp":{for(;a.offset<y;){for(var S=(0,Mt.readUint32)(a);S&3;)S++;var b=a.offset+S,g=(0,Mt.readPascalString)(a,1);(0,Mt.skipBytes)(a,f===1?10:264);var p=(0,Mt.readInt32)(a),m=(0,Mt.readInt32)(a),v=(0,Mt.readInt32)(a)-p,x=(0,Mt.readInt32)(a)-m;if(x<=0||v<=0)throw new Error("Invalid bounds");var w=(0,Mt.readInt16)(a),_=(0,Mt.readUint8)(a),E=new Uint8Array(x*v);if(w===8)if(_===0)E.set((0,Mt.readBytes)(a,E.byteLength));else if(_===1)(0,Mt.readDataRLE)(a,{width:x,height:v,data:E},x,v,w,1,[0],!1);else throw new Error("Invalid compression");else if(w===16)if(_===0)for(var P=0;P<E.byteLength;P++)E[P]=(0,Mt.readUint16)(a)>>8;else throw _===1?new Error("not implemented (16bit RLE)"):new Error("Invalid compression");else throw new Error("Invalid depth");l.push({id:g,bounds:{x:m,y:p,w:x,h:v},alpha:E}),a.offset=b}break}case"desc":{for(var D=(0,at.readVersionAndDescriptor)(a,!0),M=0,j=D.Brsh;M<j.length;M++){var N=j[M],L={name:N["Nm  "],shape:Z_(N.Brsh),spacing:(0,at.parsePercent)(N.Spcn),wetEdges:N.Wtdg,noise:N.Nose,useBrushSize:N.useBrushSize};N.interpretation!=null&&(L.interpretation=N.interpretation),N.protectTexture!=null&&(L.protectTexture=N.protectTexture),N.useTipDynamics&&(L.shapeDynamics={tiltScale:(0,at.parsePercent)(N.tiltScale),sizeDynamics:rn(N.szVr),angleDynamics:rn(N.angleDynamics),roundnessDynamics:rn(N.roundnessDynamics),flipX:N.flipX,flipY:N.flipY,brushProjection:N.brushProjection,minimumDiameter:(0,at.parsePercent)(N.minimumDiameter),minimumRoundness:(0,at.parsePercent)(N.minimumRoundness)}),N.useScatter&&(L.scatter={count:N["Cnt "],bothAxes:N.bothAxes,countDynamics:rn(N.countDynamics),scatterDynamics:rn(N.scatterDynamics)}),N.useTexture&&N.Txtr&&(L.texture={id:N.Txtr.Idnt,name:N.Txtr["Nm  "],blendMode:at.BlnM.decode(N.textureBlendMode),depth:(0,at.parsePercent)(N.textureDepth),depthMinimum:(0,at.parsePercent)(N.minimumDepth),depthDynamics:rn(N.textureDepthDynamics),scale:(0,at.parsePercent)(N.textureScale),invert:N.InvT,brightness:N.textureBrightness,contrast:N.textureContrast});var O=N.dualBrush;O&&O.useDualBrush&&(L.dualBrush={flip:O.Flip,shape:Z_(O.Brsh),blendMode:at.BlnM.decode(O.BlnM),useScatter:O.useScatter,spacing:(0,at.parsePercent)(O.Spcn),count:O["Cnt "],bothAxes:O.bothAxes,countDynamics:rn(O.countDynamics),scatterDynamics:rn(O.scatterDynamics)}),N.useColorDynamics&&(L.colorDynamics={foregroundBackground:rn(N.clVr),hue:(0,at.parsePercent)(N["H   "]),saturation:(0,at.parsePercent)(N.Strt),brightness:(0,at.parsePercent)(N.Brgh),purity:(0,at.parsePercent)(N.purity),perTip:N.colorDynamicsPerTip}),N.usePaintDynamics&&(L.transfer={flowDynamics:rn(N.prVr),opacityDynamics:rn(N.opVr),wetnessDynamics:rn(N.wtVr),mixDynamics:rn(N.mxVr)}),N.useBrushPose&&(L.brushPose={overrideAngle:N.overridePoseAngle,overrideTiltX:N.overridePoseTiltX,overrideTiltY:N.overridePoseTiltY,overridePressure:N.overridePosePressure,pressure:(0,at.parsePercent)(N.brushPosePressure),tiltX:N.brushPoseTiltX,tiltY:N.brushPoseTiltY,angle:N.brushPoseAngle});var F=N.toolOptions;F&&(L.toolOptions={type:PD[F._classID]||"brush",brushPreset:F.brushPreset,flow:(n=F.flow)!==null&&n!==void 0?n:100,smooth:(r=F.Smoo)!==null&&r!==void 0?r:0,mode:at.BlnM.decode(F["Md  "]||"BlnM.Nrml"),opacity:(i=F.Opct)!==null&&i!==void 0?i:100,smoothing:!!F.smoothing,smoothingValue:F.smoothingValue||0,smoothingRadiusMode:!!F.smoothingRadiusMode,smoothingCatchup:!!F.smoothingCatchup,smoothingCatchupAtEnd:!!F.smoothingCatchupAtEnd,smoothingZoomCompensation:!!F.smoothingZoomCompensation,pressureSmoothing:!!F.pressureSmoothing,usePressureOverridesSize:!!F.usePressureOverridesSize,usePressureOverridesOpacity:!!F.usePressureOverridesOpacity,useLegacy:!!F.useLegacy},F.prVr&&(L.toolOptions.flowDynamics=rn(F.prVr)),F.opVr&&(L.toolOptions.opacityDynamics=rn(F.opVr)),F.szVr&&(L.toolOptions.sizeDynamics=rn(F.szVr)),"wetness"in F&&(L.toolOptions.wetness=F.wetness),"dryness"in F&&(L.toolOptions.dryness=F.dryness),"mix"in F&&(L.toolOptions.mix=F.mix),"autoFill"in F&&(L.toolOptions.autoFill=F.autoFill),"autoClean"in F&&(L.toolOptions.autoClean=F.autoClean),"loadSolidColorOnly"in F&&(L.toolOptions.loadSolidColorOnly=F.loadSolidColorOnly),"sampleAllLayers"in F&&(L.toolOptions.sampleAllLayers=F.sampleAllLayers),"SmdF"in F&&(L.toolOptions.smudgeFingerPainting=F.SmdF),"SmdS"in F&&(L.toolOptions.smudgeSampleAllLayers=F.SmdS),"Prs "in F&&(L.toolOptions.strength=F["Prs "]),"SmdF"in F&&(L.toolOptions.smudgeFingerPainting=F.SmdF),"SmdS"in F&&(L.toolOptions.smudgeSampleAllLayers=F.SmdS)),u.push(L)}break}case"patt":{a.offset<y&&(c.push((0,Mt.readPattern)(a)),a.offset=y);break}case"phry":{var D=(0,at.readVersionAndDescriptor)(a);t.logMissingFeatures&&!((o=D.hierarchy)===null||o===void 0)&&o.length&&console.log("unhandled phry section",D);break}default:throw new Error("Invalid brush type: ".concat(d))}for(;h%4;)a.offset++,h++}}else throw new Error("Unsupported ABR version (".concat(s,")"));return{samples:l,patterns:c,brushes:u}}xd.readAbr=AD});var J_=_e(os=>{"use strict";var m0=os&&os.__assign||function(){return m0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},m0.apply(this,arguments)};Object.defineProperty(os,"__esModule",{value:!0});os.readCsh=void 0;var DD=dd(),Qn=eo();function LD(e){var t=(0,Qn.createReader)(e.buffer,e.byteOffset,e.byteLength),n={shapes:[]};if((0,Qn.checkSignature)(t,"cush"),(0,Qn.readUint32)(t)!==2)throw new Error("Invalid version");for(var r=(0,Qn.readUint32)(t),i=0;i<r;i++){for(var o=(0,Qn.readUnicodeString)(t);t.offset%4;)t.offset++;if((0,Qn.readUint32)(t)!==1)throw new Error("Invalid shape version");var a=(0,Qn.readUint32)(t),s=t.offset+a,l=(0,Qn.readPascalString)(t,1),u=(0,Qn.readUint32)(t),c=(0,Qn.readUint32)(t),f=(0,Qn.readUint32)(t),d=(0,Qn.readUint32)(t),h=d-c,y=f-u,S={paths:[]};(0,DD.readVectorMask)(t,S,h,y,s-t.offset),n.shapes.push(m0({name:o,id:l,width:h,height:y},S)),t.offset=s}return n}os.readCsh=LD});var Q_=_e(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.LayerCompCapturedInfo=hr.SectionDividerType=hr.ColorMode=void 0;var kD;(function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"})(kD=hr.ColorMode||(hr.ColorMode={}));var RD;(function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"})(RD=hr.SectionDividerType||(hr.SectionDividerType={}));var MD;(function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"})(MD=hr.LayerCompCapturedInfo||(hr.LayerCompCapturedInfo={}))});var jl=_e(_t=>{"use strict";var OD=_t&&_t.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),v0=_t&&_t.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&OD(t,e,n)};Object.defineProperty(_t,"__esModule",{value:!0});_t.writePsdBuffer=_t.writePsdUint8Array=_t.writePsd=_t.readPsd=_t.byteArrayToBase64=_t.initializeCanvas=void 0;var as=Wa(),g0=eo(),FD=yl();v0(q_(),_t);v0(J_(),_t);var ND=Qi();Object.defineProperty(_t,"initializeCanvas",{enumerable:!0,get:function(){return ND.initializeCanvas}});v0(Q_(),_t);_t.byteArrayToBase64=FD.fromByteArray;function UD(e,t){var n="buffer"in e?(0,g0.createReader)(e.buffer,e.byteOffset,e.byteLength):(0,g0.createReader)(e);return(0,g0.readPsd)(n,t)}_t.readPsd=UD;function BD(e,t){var n=(0,as.createWriter)();return(0,as.writePsd)(n,e,t),(0,as.getWriterBuffer)(n)}_t.writePsd=BD;function ex(e,t){var n=(0,as.createWriter)();return(0,as.writePsd)(n,e,t),(0,as.getWriterBufferNoCopy)(n)}_t.writePsdUint8Array=ex;function zD(e,t){if(typeof Buffer=="undefined")throw new Error("Buffer not supported on this platform");return Buffer.from(ex(e,t))}_t.writePsdBuffer=zD});var Tx=_e(Wd=>{"use strict";var ZD=Fe(),qD=Symbol.for("react.element"),JD=Symbol.for("react.fragment"),QD=Object.prototype.hasOwnProperty,eL=ZD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tL={key:!0,ref:!0,__self:!0,__source:!0};function Ex(e,t,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)QD.call(t,r)&&!tL.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:qD,type:e,key:o,ref:a,props:i,_owner:eL.current}}Wd.Fragment=JD;Wd.jsx=Ex;Wd.jsxs=Ex});var fe=_e((uO,Cx)=>{"use strict";Cx.exports=Tx()});var Lx=_e((Xd,Dx)=>{(function(e,t){typeof Xd=="object"&&typeof Dx!="undefined"?t(Xd):typeof define=="function"&&define.amd?define(["exports"],t):(e=e||self,t(e.spectral={}))})(Xd,function(e){"use strict";class r{constructor(...O){cu(this,"inGamut",({epsilon:O=0}={})=>i(this.lRGB,O));cu(this,"toGamut",({method:O="map"}={})=>{switch(O.toLowerCase()){case"clip":return new r(this.sRGB.map(F=>P.clamp(F,0,255)));case"map":return a(this);default:throw new TypeError(`Unknown method: '${O}'`)}});cu(this,"toString",({format:O="hex",method:F="map"}={})=>{let X;if(this.inGamut())X=this.sRGB;else switch(F.toLowerCase()){case"clip":X=this.sRGB.map(te=>P.clamp(te,0,255));break;case"map":X=a(this).sRGB;break;default:throw new TypeError(`Unknown method: '${F}'`)}switch(O.toLowerCase()){case"hex":return`#${X.map(te=>te.toString(16).padStart(2,"0")).join("").toUpperCase()}`;case"rgb":return`rgb(${X.join(", ")})`;default:throw new TypeError(`Unknown format: '${O}'`)}});O.length===1&&(typeof O[0]=="string"&&(this.sRGB=D(O[0]).slice(0,3),this.lRGB=y(this.sRGB),this.R=E(this.lRGB),this.XYZ=_(this.R)),Array.isArray(O[0])&&(O[0].length===38?(this.R=O[0],this.XYZ=_(this.R),this.lRGB=b(this.XYZ),this.sRGB=S(this.lRGB)):(this.sRGB=O[0],this.lRGB=y(this.sRGB),this.R=E(this.lRGB),this.XYZ=_(this.R))))}get OKLab(){var O;return(O=this._OKLab)!=null?O:this._OKLab=m(this.XYZ)}get OKLCh(){var O;return(O=this._OKLCh)!=null?O:this._OKLCh=x(this.OKLab)}get KS(){var O;return(O=this._KS)!=null?O:this._KS=this.R.map(F=>s(F))}get luminance(){var O;return(O=this._luminance)!=null?O:this._luminance=Math.max(Number.EPSILON,this.XYZ[1])}get tintingStrength(){var O;return(O=this._tintingStrength)!=null?O:this._tintingStrength=1}set tintingStrength(O){this._tintingStrength=O}}let i=(L,{epsilon:O=0}={})=>L.every(F=>F>=-O&&F<=1+O),o=(L,O)=>{let[F,X,te]=L,[ge,ne,Ie]=O;return((F-ge)**2+(X-ne)**2+(te-Ie)**2)**.5},a=(L,{jnd:O=.03,e:F=1e-4}={})=>{let X=L.OKLCh[0];if(X>=1)return new r([255,255,255]);if(X<=0)return new r([0,0,0]);if(i(L.lRGB))return L;let te=L.OKLCh[2],ge=0,ne=L.OKLCh[1],Ie=!0,je=L.lRGB,Q=p(je.map(re=>P.clamp(re))),W=o(Q,p(je));if(W<O)return new r(S(b(v(Q))));for(;ne-ge>F;){let re=(ge+ne)/2,K=w([X,re,te]),q=v(K);if(je=b(q),Ie&&i(je))ge=re;else if(Q=p(je.map(Se=>P.clamp(Se))),W=o(Q,K),W<O){if(O-W<F)break;Ie=!1,ge=re}else ne=re}return new r(S(b(v(Q))))},s=L=>(1-L)**2/(2*L),l=L=>1+L-(L**2+2*L)**.5,u=(...L)=>{let O=new Array(38);for(let F=0;F<38;F++){let X=0,te=0;for(let[ge,ne]of L){let Ie=ne**2*ge.tintingStrength**2*ge.luminance;te+=Ie,X+=ge.KS[F]*Ie}O[F]=l(X/te)}return new r(O)},c=(L,O,F)=>{let X=new Array(F);for(let te=0;te<F;te++)X[te]=u([L,F-1-te],[O,te]);return X},f=(L,...O)=>{let F=null,X=null;for(let[ge,ne]of O)ne<=L&&(!F||ne>F[1])&&(F=[ge,ne]),ne>=L&&(!X||ne<X[1])&&(X=[ge,ne]);if(!F)return X[0];if(!X||F[1]===X[1])return F[0];let te=(L-F[1])/(X[1]-F[1]);return u([F[0],1-te],[X[0],te])},d=L=>L>.04045?((L+.055)/1.055)**2.4:L/12.92,h=L=>L>.0031308?1.055*L**(1/2.4)-.055:L*12.92,y=L=>L.map(O=>d(O/255)),S=L=>L.map(O=>Math.round(h(O)*255)),b=L=>P.mulMatVec(N.XYZ_RGB,L),g=L=>P.mulMatVec(N.RGB_XYZ,L),p=L=>m(g(L)),m=L=>{let O=P.mulMatVec(N.XYZ_LMS,L).map(F=>Math.cbrt(F));return P.mulMatVec(N.LMS_LAB,O)},v=L=>{let O=P.mulMatVec(N.LAB_LMS,L).map(F=>F**3);return P.mulMatVec(N.LMS_XYZ,O)},x=L=>{let[O,F,X]=L,te=(F*F+X*X)**.5,ge=Math.atan2(X,F)*180/Math.PI;return[O,te,ge>=0?ge:ge+360]},w=L=>{let[O,F,X]=L,te=F*Math.cos(X*Math.PI/180),ge=F*Math.sin(X*Math.PI/180);return[O,te,ge]},_=L=>P.mulMatVec(j.CMF,L),E=L=>{let O=Math.min(...L);L=[L[0]-O,L[1]-O,L[2]-O];let F=Math.min(L[1],L[2]),X=Math.min(L[0],L[2]),te=Math.min(L[0],L[1]),ge=Math.max(0,Math.min(L[0]-L[2],L[0]-L[1])),ne=Math.max(0,Math.min(L[1]-L[2],L[1]-L[0])),Ie=Math.max(0,Math.min(L[2]-L[1],L[2]-L[0])),je=new Array(38);for(let Q=0;Q<38;Q++)je[Q]=Math.max(Number.EPSILON,O*M.W[Q]+F*M.C[Q]+X*M.M[Q]+te*M.Y[Q]+ge*M.R[Q]+ne*M.G[Q]+Ie*M.B[Q]);return je},P={lerp:(L,O,F)=>L+(O-L)*F,clamp:(L,O=0,F=1)=>Math.min(Math.max(L,O),F),dot:(L,O)=>L.reduce((F,X,te)=>F+X*O[te],0),mulMatVec:(L,O)=>L.map(F=>P.dot(F,O))},D=L=>L[0]==="#"?(L=L.length===4?L.replace(/./g,O=>O+O).slice(1):L.slice(1),[parseInt(L.substring(0,2),16),parseInt(L.substring(2,4),16),parseInt(L.substring(4,6),16),L.length===8?parseInt(L.substring(6,8),16)/255:1]):L.startsWith("rgb")?L.slice(L.indexOf("(")+1,-1).split(",").map((O,F)=>F<3&&O.includes("%")?Math.round(parseFloat(O)*2.55):parseFloat(O)):NaN,M=Object.freeze({W:[1.00116072718764,1.00116065159728,1.00116031922747,1.00115867270789,1.00115259844552,1.00113252528998,1.00108500663327,1.00099687889453,1.00086525152274,1.0006962900094,1.00050496114888,1.00030808187992,1.00011966602013,.999952765968407,.999821836899297,.999738609557593,.999709551639612,.999731930210627,.999799436346195,.999900330316671,1.00002040652611,1.00014478793658,1.00025997903412,1.00035579697089,1.00042753780269,1.00047623344888,1.00050720967508,1.00052519156373,1.00053509606896,1.00054022097482,1.00054272816784,1.00054389569087,1.00054448212151,1.00054476959992,1.00054489887762,1.00054496254689,1.00054498927058,1.000544996993],C:[.970585001322962,.970592498143425,.970625348729891,.970786806119017,.971368673228248,.973163230621252,.976740223158765,.981587605491377,.986280265652949,.989949147689134,.99249270153842,.994145680405256,.995183975033212,.995756750110818,.99591281828671,.995606157834528,.994597600961854,.99221571549237,.986236452783249,.967943337264541,.891285004244943,.536202477862053,.154108119001878,.0574575093228929,.0315349873107007,.0222633920086335,.0182022841492439,.016299055973264,.0153656239334613,.0149111568733976,.0146954339898235,.0145964146717719,.0145470156699655,.0145228771899495,.0145120341118965,.0145066940939832,.0145044507314479,.0145038009464639],M:[.990673557319988,.990671524961979,.990662582353421,.990618107644795,.99045148087871,.989871081400204,.98828660875964,.984290692797504,.973934905625306,.941817838460145,.817390326195156,.432472805065729,.13845397825887,.0537347216940033,.0292174996673231,.021313651750859,.0201349530181136,.0241323096280662,.0372236145223627,.0760506552706601,.205375471942399,.541268903460439,.815841685086486,.912817704123976,.946339830166962,.959927696331991,.966260595230312,.969325970058424,.970854536721399,.971605066528128,.971962769757392,.972127272274509,.972209417745812,.972249577678424,.972267621998742,.97227650946215,.972280243306874,.97228132482656],Y:[.0210523371789306,.0210564627517414,.0210746178695038,.0211649058448753,.0215027957272504,.0226738799041561,.0258235649693629,.0334879385639851,.0519069663740307,.100749014833473,.239129899706847,.534804312272748,.79780757864303,.911449894067384,.953797963004507,.971241615465429,.979303123807588,.983380119507575,.985461246567755,.986435046976605,.986738250670141,.986617882445032,.986277776758643,.985860592444056,.98547492767621,.985176934765558,.984971574014181,.984846303415712,.984775351811199,.984738066625265,.984719648311765,.984711023391939,.984706683300676,.984704554393091,.98470359630937,.984703124077552,.98470292561509,.984702868122795],R:[.0315605737777207,.0315520718330149,.0315148215513658,.0313318044982702,.0306729857725527,.0286480476989607,.0246450407045709,.0192960753663651,.0142066612220556,.0102942608878609,.0076191460521811,.005898041083542,.0048233247781713,.0042298748350633,.0040599171299341,.0043533695594676,.0053434425970201,.0076917201010463,.0135969795736536,.0316975442661115,.107861196355249,.463812603168704,.847055405272011,.943185409393918,.968862150696558,.978030667473603,.982043643854306,.983923623718707,.984845484154382,.985294275814596,.985507295219825,.985605071539837,.985653849933578,.985677685033883,.985688391806122,.985693664690031,.985695879848205,.985696521463762],G:[.0095560747554212,.0095581580120851,.0095673245444588,.0096129126297349,.0097837090401843,.010378622705871,.0120026452378567,.0160977721473922,.026706190223168,.0595555440185881,.186039826532826,.570579820116159,.861467768400292,.945879089767658,.970465486474305,.97841363028445,.979589031411224,.975533536908632,.962288755397813,.92312157451312,.793434018943111,.459270135902429,.185574103666303,.0881774959955372,.05436302287667,.0406288447060719,.034221520431697,.0311185790956966,.0295708898336134,.0288108739348928,.0284486271324597,.0282820301724731,.0281988376490237,.0281581655342037,.0281398910216386,.0281308901665811,.0281271086805816,.0281260133612096],B:[.979404752502014,.97940070684313,.979382903470261,.979294364945594,.97896301460857,.977814466694043,.974724321133836,.967198482343973,.949079657530575,.900850128940977,.76315044546224,.465922171649319,.201263280451005,.0877524413419623,.0457176793291679,.0284706050521843,.020527176756985,.0165302792310211,.0145135107212858,.0136003508637687,.0133604258769571,.013548894314568,.0139594356366992,.014443425575357,.0148854440621406,.0152254296999746,.0154592848180209,.0156018026485961,.0156824871281936,.0157248764360615,.0157458108784121,.0157556123350225,.0157605443964911,.0157629637515278,.0157640525629106,.015764589232951,.0157648147772649,.0157648801149616]}),j=Object.freeze({CMF:[[646919989576e-16,.0002194098998132,.0011205743509343,.0037666134117111,.011880553603799,.0232864424191771,.0345594181969747,.0372237901162006,.0324183761091486,.021233205609381,.0104909907685421,.0032958375797931,.0005070351633801,.0009486742057141,.0062737180998318,.0168646241897775,.028689649025981,.0426748124691731,.0562547481311377,.0694703972677158,.0830531516998291,.0861260963002257,.0904661376847769,.0850038650591277,.0709066691074488,.0506288916373645,.035473961885264,.0214682102597065,.0125164567619117,.0068045816390165,.0034645657946526,.0014976097506959,.000769700480928,.0004073680581315,.0001690104031614,952245150365e-16,490309872958e-16,199961492222e-16],[1844289444e-15,62053235865e-16,310096046799e-16,.0001047483849269,.0003536405299538,.0009514714056444,.0022822631748318,.004207329043473,.0066887983719014,.0098883960193565,.0152494514496311,.0214183109449723,.0334229301575068,.0513100134918512,.070402083939949,.0878387072603517,.0942490536184085,.0979566702718931,.0941521856862608,.0867810237486753,.0788565338632013,.0635267026203555,.05374141675682,.042646064357412,.0316173492792708,.020885205921391,.0138601101360152,.0081026402038399,.004630102258803,.0024913800051319,.0012593033677378,.000541646522168,.0002779528920067,.0001471080673854,610327472927e-16,343873229523e-16,177059860053e-16,7220974913e-15],[.000305017147638,.0010368066663574,.0053131363323992,.0179543925899536,.0570775815345485,.113651618936287,.17335872618355,.196206575558657,.186082370706296,.139950475383207,.0891745294268649,.0478962113517075,.0281456253957952,.0161376622950514,.0077591019215214,.0042961483736618,.0020055092122156,.0008614711098802,.0003690387177652,.0001914287288574,.0001495555858975,923109285104e-16,681349182337e-16,288263655696e-16,157671820553e-16,39406041027e-16,1584012587e-15,0,0,0,0,0,0,0,0,0,0,0]]}),N=Object.freeze({RGB_XYZ:[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],XYZ_RGB:[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],XYZ_LMS:[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],LMS_XYZ:[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],LMS_LAB:[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],LAB_LMS:[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]]});e.Color=r,e.mix=u,e.palette=c,e.gradient=f})});var o2=_e((EF,i2)=>{"use strict";var Ig=function(e,t){return Ig=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ig(e,t)};function He(e,t){Ig(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Be=function(){return Be=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Be.apply(this,arguments)};function vi(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?o(c.value):i(c.value).then(s,l)}u((r=r.apply(e,t||[])).next())})}function yi(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(c){u=[6,c],i=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var dL=function(){function e(t,n){n===void 0&&(n=void 0),this.replacement=t,this.message=n}return e.prototype.toString=function(){var t="";return this.replacement&&(t+="Use ".concat(this.replacement," instead.")),this.message&&(t+=" ".concat(this.message)),t},e}(),co={},Xx=function(){function e(t){this._parts=t.split(".")}return e.prototype.contains=function(t){if(t._parts.length>this._parts.length)return!1;for(var n=0;n<t._parts.length;n++)if(t._parts[n]!==this._parts[n])return!1;return!0},e.prototype.toString=function(){return this._parts.join(".")},e}();function Hr(e,t,n){n===void 0&&(n=void 0),co[e]=new dL(t,n)}function fL(e,t,n){var r=function(i){Yx(e,r),n(i)};Dg(e,t,r)}function pL(e,t,n){Vr.has(e)||Vr.set(e,[]),Vr.get(e).push({type:new Xx(t),listener:n})}function Dg(e,t,n,r){r===void 0&&(r={}),Object.keys(co).includes(t)&&console.warn("Event ".concat(t," is deprecated. ").concat(co[t])),r.once?fL(e,t,n):pL(e,t,n)}function Yx(e,t){if(!Vr.has(e)||!Vr.get(e).map(function(r){return r.listener}).includes(t))throw new Error("No matching event listener to remove");var n=Vr.get(e).filter(function(r){return r.listener!==t});Vr.set(e,n)}function Wx(e,t,n){n.target=e,n.type=t;var r=new Xx(t);if(!Vr.has(e))return null;for(var i=[],o=0;o<Vr.get(e).length;o++){var a=Vr.get(e)[o];r.contains(a.type)&&i.push(a.listener)}for(var o=0;o<i.length;o++){var s=i[o];s(n)}return n}function Cn(e,t,n){if(Object.keys(co).includes(t)&&co[t].replacement)throw new Error("Event ".concat(t," is deprecated. ").concat(co[t]));for(var r in co){var i=co[r];t===i.replacement&&Wx(e,r,Be({},n))}return Wx(e,t,n)}var Vr=new WeakMap,hL=Object.freeze({__proto__:null,deprecate:Hr,subscribe:Dg,unsubscribe:Yx,publish:Cn});function mL(e,t){do{var n=Object.getOwnPropertyDescriptor(e,t);if(n)return n;e=Object.getPrototypeOf(e)}while(e)}function Zo(e,t){var n=t.getDefaultOptions();for(var r in e)if(!n.hasOwnProperty(r))throw new Error("Invalid option: '"+r+"'");e=Be(Be({},n),e);for(var r in e){var i=mL(t,r);(!i||i.set)&&(t[r]=e[r])}}var fo=new WeakMap;function gL(e,t,n){fo.has(e.movie)||fo.set(e.movie,new WeakMap);var r=fo.get(e.movie);r.has(e)||r.set(e,{});var i=r.get(e);return i[t]=n,n}function vL(e,t){return fo.has(e.movie)&&fo.get(e.movie).has(e)&&t in fo.get(e.movie).get(e)}function yL(e,t){return fo.get(e.movie).get(e)[t]}function Kx(e){fo.delete(e)}var Zx=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.value=t,this.interpolationKeys=[]}return e.prototype.withKeys=function(t){return this.interpolationKeys=t,this},e.prototype.evaluate=function(t){if(this.value.length===0)throw new Error("Empty keyframe");if(t===void 0)throw new Error("|time| is undefined or null");var n=this.value[0][0];if(t<n)throw new Error("No keyframe point before |time|");for(var r=0;r<this.value.length;r++){var i=this.value[r][0],o=this.value[r][1],a=this.value[r].length===3?this.value[r][2]:Lg;if(r+1<this.value.length){var s=this.value[r+1][0],l=this.value[r+1][1];if(i<=t&&t<s)if(typeof o=="number"||typeof l=="object"){if(typeof o!=typeof l)throw new Error("Type mismatch in keyframe values");var u=(t-i)/(s-i);return a(o,l,u,this.interpolationKeys)}else return o}else return o}},e}();function pe(e,t,n){if(vL(e,t))return yL(e,t);for(var r=t.split("."),i=e[r.shift()];r.length>0;)i=i[r.shift()];var o=e.propertyFilters[t],a;return i instanceof Zx?a=i.evaluate(n):typeof i=="function"?a=i(e,n):a=i,gL(e,t,o?o.call(e,a):a)}function Lg(e,t,n,r){if(typeof e!=typeof t)throw new Error("Type mismatch");if(typeof e!="number"&&typeof e!="object")return e;if(typeof e=="object"){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))throw new Error("Prototype mismatch");for(var i=Object.create(Object.getPrototypeOf(e)),o=Object.keys(e)||r,a=0;a<o.length;a++){var s=o[a];!e.hasOwnProperty(s)||!t.hasOwnProperty(s)||(i[s]=Lg(e[s],t[s],n))}return i}return(1-n)*e+n*t}function qx(e,t,n,r){if(typeof e!=typeof t)throw new Error("Type mismatch");if(typeof e!="number"&&typeof e!="object")return e;if(typeof e=="object"&&typeof t=="object"){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))throw new Error("Prototype mismatch");for(var i=Object.create(Object.getPrototypeOf(e)),o=Object.keys(e)||r,a=0;a<o.length;a++){var s=o[a];!e.hasOwnProperty(s)||!t.hasOwnProperty(s)||(i[s]=qx(e[s],t[s],n))}return i}var l=Math.cos(Math.PI/2*n);return l*e+(1-l)*t}var kg=function(){function e(t,n,r,i){i===void 0&&(i=1),this.r=t,this.g=n,this.b=r,this.a=i}return e.prototype.toString=function(){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(this.a,")")},e}(),Pg=document.createElement("canvas");Pg.width=Pg.height=1;var tf=Pg.getContext("2d");function Rg(e){tf.clearRect(0,0,1,1),tf.fillStyle=e,tf.fillRect(0,0,1,1);var t=tf.getImageData(0,0,1,1).data;return new kg(t[0],t[1],t[2],t[3]/255)}var Jx=function(){function e(t,n,r,i,o,a,s,l){i===void 0&&(i="normal"),o===void 0&&(o="normal"),a===void 0&&(a="normal"),s===void 0&&(s="normal"),l===void 0&&(l="normal"),this.size=t,this.sizeUnit=n,this.family=r,this.style=i,this.variant=o,this.weight=a,this.stretch=s,this.lineHeight=l}return e.prototype.toString=function(){var t="";return this.style!=="normal"&&(t+=this.style+" "),this.variant!=="normal"&&(t+=this.variant+" "),this.weight!=="normal"&&(t+=this.weight+" "),this.stretch!=="normal"&&(t+=this.stretch+" "),t+="".concat(this.size).concat(this.sizeUnit," "),this.lineHeight!=="normal"&&(t+=this.lineHeight+" "),t+=this.family,t},e}(),Cg=document.createElement("div");function SL(e){Cg.setAttribute("style","font: ".concat(e));var t=Cg.style,n=t.fontSize,r=t.fontFamily,i=t.fontStyle,o=t.fontVariant,a=t.fontWeight,s=t.lineHeight;Cg.removeAttribute("style");var l=parseFloat(n),u=n.substring(l.toString().length);return new Jx(l,u,r,i,o,a,s)}function wL(e,t,n,r,i,o,a,s){s===void 0&&(s=!0),r=r||0,i=i||0,o=o||t.width,a=a||t.height;for(var l=n.getImageData(r,i,o,a),u=0,c=l.data.length;u<c;u+=4)e(l.data,u);s&&n.putImageData(l,r,i)}function Mg(e){var t=function(n){He(r,n);function r(i){var o=this,a;if(!i.source)throw new Error('Property "source" is required in options');var s=i.onload;delete i.onload,o=n.call(this,Be(Be({},i),{duration:(a=i.duration)!==null&&a!==void 0?a:0}))||this,o._initialized=!1,o._sourceStartTime=i.sourceStartTime||0,Zo(i,o);var l=function(){if(i.duration<0)throw new Error("Invalid options.duration. It must be a non-negative value.");if(o.sourceStartTime>o.source.duration)throw new Error("options.sourceStartTime cannot exceed options.source.duration");o._unstretchedDuration=i.duration||o.source.duration-o.sourceStartTime,o.duration=o._unstretchedDuration/o.playbackRate,s&&s.bind(o)(o.source,i)};return o.source.readyState>=2?l():o.source.addEventListener("loadedmetadata",l),o.source.addEventListener("durationchange",function(){o.duration=i.duration||o.source.duration-o.sourceStartTime}),o}return r.prototype.whenReady=function(){return vi(this,void 0,void 0,function(){var i=this;return yi(this,function(o){switch(o.label){case 0:return[4,n.prototype.whenReady.call(this)];case 1:return o.sent(),this.source.readyState<4?[4,new Promise(function(a){i.source.addEventListener("canplaythrough",a)})]:[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}})})},r.prototype.attach=function(i){var o=this;n.prototype.attach.call(this,i),Dg(i,"audiodestinationupdate",function(a){o.audioNode.disconnect(o._lastAudioDestination),o.audioNode.connect(a.destination),o._lastAudioDestination=a.destination}),this._audioNode=this.audioNode||i.actx.createMediaElementSource(this.source),this.audioNode.connect(i.actx.destination),this._lastAudioDestination=i.actx.destination},r.prototype.detach=function(){var i=this.movie.actx.destination;n.prototype.detach.call(this),this.audioNode.disconnect(i)},r.prototype.start=function(){this.source.currentTime=this.currentTime+this.sourceStartTime,this.source.play()},r.prototype.seek=function(i){n.prototype.seek.call(this,i),isNaN(this.currentTime)?this.source.currentTime=this.sourceStartTime:this.source.currentTime=this.currentTime+this.sourceStartTime},r.prototype.render=function(){n.prototype.render.call(this),this.source.muted=pe(this,"muted",this.currentTime),this.source.volume=pe(this,"volume",this.currentTime),this.source.playbackRate=pe(this,"playbackRate",this.currentTime)},r.prototype.stop=function(){n.prototype.stop.call(this),this.source.pause()},Object.defineProperty(r.prototype,"audioNode",{get:function(){return this._audioNode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(i){this._playbackRate=i,this._unstretchedDuration!==void 0&&(this.duration=this._unstretchedDuration/i)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"startTime",{get:function(){return this.__startTime},set:function(i){if(this.__startTime=i,this._initialized){var o=this.movie.currentTime-this.startTime;this.source.currentTime=this.sourceStartTime+o}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"sourceStartTime",{get:function(){return this._sourceStartTime},set:function(i){if(this._sourceStartTime=i,this._initialized){var o=this.movie.currentTime-this.startTime;this.source.currentTime=o+this.sourceStartTime}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ready",{get:function(){var i=Object.getOwnPropertyDescriptor(e.prototype,"ready").get.call(this);return i&&this.source.readyState===4},enumerable:!1,configurable:!0}),r.prototype.getDefaultOptions=function(){return Be(Be({},e.prototype.getDefaultOptions()),{source:void 0,sourceStartTime:0,duration:void 0,muted:!1,volume:1,playbackRate:1})},r}(e);return t}var Gr=function(){function e(t){if(t.duration===null||t.duration===void 0)throw new Error('Property "duration" is required in BaseOptions');if(t.startTime===null||t.startTime===void 0)throw new Error('Property "startTime" is required in BaseOptions');this._startTime=t.startTime,this._duration=t.duration,Zo(t,this),this.active=!1,this.enabled=!0,this._occurrenceCount=0,this._movie=null}return e.prototype.whenReady=function(){return vi(this,void 0,void 0,function(){return yi(this,function(t){return[2]})})},e.prototype.tryAttach=function(t){this._occurrenceCount===0&&this.attach(t),this._occurrenceCount++},e.prototype.attach=function(t){this._movie=t},e.prototype.tryDetach=function(){if(this.movie===null)throw new Error("No movie to detach from");this._occurrenceCount--,this._occurrenceCount===0&&this.detach()},e.prototype.detach=function(){this._movie=null},e.prototype.start=function(){},e.prototype.seek=function(t){this._currentTime=t},e.prototype.progress=function(t){this._currentTime=t},e.prototype.render=function(){},e.prototype.stop=function(){this._currentTime=void 0},Object.defineProperty(e.prototype,"parent",{get:function(){return this._movie},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(t){this._startTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},set:function(t){this._duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movie",{get:function(){return this._movie},enumerable:!1,configurable:!0}),e.prototype.getDefaultOptions=function(){return{startTime:void 0,duration:void 0}},e}();Gr.prototype.type="layer";Gr.prototype.publicExcludes=["active"];Gr.prototype.propertyFilters={};var Qx=function(e){He(t,e);function t(n){if(typeof n.source=="string"){var r=document.createElement("audio");r.src=n.source,n.source=r}return e.call(this,n)||this}return t.prototype.getDefaultOptions=function(){return Be(Be({},Object.getPrototypeOf(this).getDefaultOptions()),{sourceStartTime:0,duration:void 0})},t}(Mg(Gr)),nf=function(){function e(){}return e}(),rf=function(e){He(t,e);function t(n,r){for(var i=e.call(this)||this,o=0,a=n;o<a.length;o++){var s=a[o];r.onAdd(s)}return new Proxy(n,{deleteProperty:function(l,u){var c=l[u];return delete l[u],r.onRemove(c),!0},set:function(l,u,c){var f=l[u];return l[u]=c,isNaN(Number(u))||(f!==void 0&&r.onRemove(f),r.onAdd(c)),!0}})}return t}(Array),bL=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r._layer=n,r}return t.prototype.onAdd=function(n){n.tryAttach(this._layer)},t.prototype.onRemove=function(n){n.tryDetach()},t}(nf),_L=function(e){He(t,e);function t(n,r){return e.call(this,n,new bL(r))||this}return t}(rf),Si=function(e){He(t,e);function t(n){var r=e.call(this,n)||this;return Zo(n,r),r.canvas=document.createElement("canvas"),r.cctx=r.canvas.getContext("2d"),r.effects=new _L([],r),r}return t.prototype.whenReady=function(){return vi(this,void 0,void 0,function(){return yi(this,function(n){switch(n.label){case 0:return[4,e.prototype.whenReady.call(this)];case 1:return n.sent(),[4,Promise.all(this.effects.map(function(r){return r.whenReady()}))];case 2:return n.sent(),[2]}})})},t.prototype.render=function(){var n=pe(this,"width",this.currentTime),r=pe(this,"height",this.currentTime);n===0||r===0||(this.beginRender(),this.doRender(),this.endRender())},t.prototype.beginRender=function(){this.canvas.width=pe(this,"width",this.currentTime),this.canvas.height=pe(this,"height",this.currentTime),this.cctx.globalAlpha=pe(this,"opacity",this.currentTime)},t.prototype.doRender=function(){this.background&&(this.cctx.fillStyle=pe(this,"background",this.currentTime),this.cctx.fillRect(0,0,this.canvas.width,this.canvas.height));var n=pe(this,"border",this.currentTime);n&&n.color&&(this.cctx.strokeStyle=n.color,this.cctx.lineWidth=n.thickness||1)},t.prototype.endRender=function(){var n=pe(this,"width",this.currentTime)||pe(this.movie,"width",this.movie.currentTime),r=pe(this,"height",this.currentTime)||pe(this.movie,"height",this.movie.currentTime);n*r>0&&this._applyEffects()},t.prototype._applyEffects=function(){for(var n=0;n<this.effects.length;n++){var r=this.effects[n];r&&r.enabled&&r.apply(this,this.movie.currentTime-this.startTime)}},t.prototype.addEffect=function(n){return this.effects.push(n),this},Object.defineProperty(t.prototype,"ready",{get:function(){var n=Object.getOwnPropertyDescriptor(Gr.prototype,"ready").get.call(this);return n&&this.effects.every(function(r){return r.ready})},enumerable:!1,configurable:!0}),t.prototype.getDefaultOptions=function(){return Be(Be({},Gr.prototype.getDefaultOptions()),{x:0,y:0,width:null,height:null,background:null,border:null,opacity:1})},t}(Gr);Si.prototype.publicExcludes=Gr.prototype.publicExcludes.concat(["canvas","cctx","effects"]);Si.prototype.propertyFilters=Be(Be({},Gr.prototype.propertyFilters),{width:function(e){return e!=null?e:this._movie.width},height:function(e){return e!=null?e:this._movie.height}});function Og(e){var t=function(n){He(r,n);function r(i){var o=this;if(!i.source)throw new Error('Property "source" is required in options');return o=n.call(this,i)||this,Zo(i,o),o}return r.prototype.whenReady=function(){return vi(this,void 0,void 0,function(){var i=this;return yi(this,function(o){switch(o.label){case 0:return[4,n.prototype.whenReady.call(this)];case 1:return o.sent(),[4,new Promise(function(a){i.source instanceof HTMLImageElement?i.source.complete?a():i.source.addEventListener("load",function(){a()}):i.source.readyState===4?a():i.source.addEventListener("canplaythrough",function(){a()})})];case 2:return o.sent(),[2]}})})},r.prototype.doRender=function(){n.prototype.doRender.call(this),this.cctx.drawImage(this.source,pe(this,"sourceX",this.currentTime),pe(this,"sourceY",this.currentTime),pe(this,"sourceWidth",this.currentTime),pe(this,"sourceHeight",this.currentTime),pe(this,"destX",this.currentTime),pe(this,"destY",this.currentTime),pe(this,"destWidth",this.currentTime),pe(this,"destHeight",this.currentTime))},Object.defineProperty(r.prototype,"ready",{get:function(){var i=Object.getOwnPropertyDescriptor(e.prototype,"ready").get.call(this),o=this.source instanceof HTMLImageElement?this.source.complete:this.source.readyState===4;return i&&o},enumerable:!1,configurable:!0}),r.prototype.getDefaultOptions=function(){return Be(Be({},e.prototype.getDefaultOptions()),{source:void 0,sourceX:0,sourceY:0,sourceWidth:void 0,sourceHeight:void 0,destX:0,destY:0,destWidth:void 0,destHeight:void 0})},r}(e);return t.prototype.propertyFilters=Be(Be({},Si.prototype.propertyFilters),{sourceWidth:function(n){var r=this.source instanceof HTMLImageElement?this.source.width:this.source.videoWidth;return n!=null?n:r},sourceHeight:function(n){var r=this.source instanceof HTMLImageElement?this.source.height:this.source.videoHeight;return n!=null?n:r},destWidth:function(n){return n!=null?n:pe(this,"sourceWidth",this.currentTime)},destHeight:function(n){return n!=null?n:pe(this,"sourceHeight",this.currentTime)},width:function(n){return n!=null?n:pe(this,"destWidth",this.currentTime)},height:function(n){return n!=null?n:pe(this,"destHeight",this.currentTime)}}),t}var xL=function(e){He(t,e);function t(n){if(typeof n.source=="string"){var r=document.createElement("img");r.src=n.source,n.source=r}return e.call(this,n)||this}return t}(Og(Si)),ps;(function(e){e[e.Inside=0]="Inside",e[e.Center=1]="Center",e[e.Outside=2]="Outside"})(ps||(ps={}));var EL=function(e){He(t,e);function t(n){var r=this;if(!n.text)throw new Error('Property "text" is required in TextOptions');return r=e.call(this,Be({background:null},n))||this,Zo(n,r),r}return t.prototype.doRender=function(){var n,r;e.prototype.doRender.call(this);var i=pe(this,"text",this.currentTime),o=pe(this,"font",this.currentTime),a=this.maxWidth?pe(this,"maxWidth",this.currentTime):void 0;this.cctx.font=o,this.cctx.fillStyle=pe(this,"color",this.currentTime),this.cctx.textAlign=pe(this,"textAlign",this.currentTime),this.cctx.textBaseline=pe(this,"textBaseline",this.currentTime),this.cctx.direction=pe(this,"textDirection",this.currentTime),this.cctx.fillText(i,pe(this,"textX",this.currentTime),pe(this,"textY",this.currentTime),a);var s=pe(this,"textStroke",this.currentTime);if(s){this.cctx.strokeStyle=s.color,this.cctx.lineWidth=(n=s.thickness)!==null&&n!==void 0?n:1;var l=(r=s.position)!==null&&r!==void 0?r:"outer",u=this.cctx.globalCompositeOperation;switch(l){case ps.Inside:this.cctx.globalCompositeOperation="source-atop",this.cctx.lineWidth*=2;break;case ps.Center:break;case ps.Outside:this.cctx.globalCompositeOperation="destination-over",this.cctx.lineWidth*=2;break}this.cctx.strokeText(i,pe(this,"textX",this.currentTime),pe(this,"textY",this.currentTime),a),this.cctx.globalCompositeOperation=u}this._prevText=i,this._prevFont=o,this._prevMaxWidth=a},t.prototype.getDefaultOptions=function(){return Be(Be({},Si.prototype.getDefaultOptions()),{background:null,text:void 0,font:"10px sans-serif",color:Rg("#fff"),textX:0,textY:0,maxWidth:null,textAlign:"start",textBaseline:"top",textDirection:"ltr",textStroke:null})},t}(Si),e2=function(e){He(t,e);function t(n){var r;if(typeof n.source=="string"){var i=document.createElement("video");i.src=n.source,n.source=i}return e.call(this,Be(Be({},n),{duration:(r=n.duration)!==null&&r!==void 0?r:0}))||this}return t}(Mg(Og(Si))),TL=Object.freeze({__proto__:null,AudioSourceMixin:Mg,Audio:Qx,Base:Gr,Image:xL,Text:EL,get TextStrokePosition(){return ps},Video:e2,VisualSourceMixin:Og,Visual:Si}),ql=function(){function e(){this.enabled=!0,this._occurrenceCount=0,this._target=null}return e.prototype.whenReady=function(){return vi(this,void 0,void 0,function(){return yi(this,function(t){return[2]})})},e.prototype.tryAttach=function(t){this._occurrenceCount===0&&this.attach(t),this._occurrenceCount++},e.prototype.attach=function(t){this._target=t},e.prototype.tryDetach=function(){if(this._target===null)throw new Error("No movie to detach from");this._occurrenceCount--,this._occurrenceCount===0&&this.detach()},e.prototype.detach=function(){this._target=null},e.prototype.apply=function(t,n){},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._target?this._target.currentTime:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movie",{get:function(){return this._target?this._target.movie:void 0},enumerable:!1,configurable:!0}),e.prototype.getDefaultOptions=function(){return{}},e}();ql.prototype.type="effect";ql.prototype.publicExcludes=[];ql.prototype.propertyFilters={};var Jl=function(e){He(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(n,r){e.prototype.apply.call(this,n,r)},t}(ql),wi=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this)||this,i=n.fragmentSource||t._IDENTITY_FRAGMENT_SOURCE,o=n.uniforms||{},a=n.textures||{},s=n.sourceTextureOptions||{},l=r._initGl();return r._program=t._initShaderProgram(l,t._VERTEX_SOURCE,i),r._buffers=t._initRectBuffers(l),r._initTextures(o,a,s),r._initAttribs(),r._initUniforms(o),r}return t.prototype._initGl=function(){this._canvas=document.createElement("canvas");var n=this._canvas.getContext("webgl");if(n===null)throw new Error("Unable to initialize WebGL. Your browser or machine may not support it.");return this._gl=n,n},t.prototype._initTextures=function(n,r,i){var o=this._gl,a=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS);r.length>a&&console.warn("Too many textures!"),this._userTextures={};for(var s in r){var l=r[s],u=Be(Be({},t._DEFAULT_TEXTURE_OPTIONS),l);if(u.createUniform){if(n[s])throw new Error("Texture - uniform naming conflict: ".concat(s,"!"));n[s]="1i"}this._userTextures[s]=u}this._sourceTextureOptions=Be(Be({},t._DEFAULT_TEXTURE_OPTIONS),i)},t.prototype._initAttribs=function(){var n=this._gl;this._attribLocations={textureCoord:n.getAttribLocation(this._program,"a_TextureCoord")}},t.prototype._initUniforms=function(n){var r=this._gl;this._uniformLocations={source:r.getUniformLocation(this._program,"u_Source"),size:r.getUniformLocation(this._program,"u_Size")},this._userUniforms={};for(var i in n){var o=n[i];this._userUniforms[i]=typeof o=="string"?{type:o}:o}for(var a in n){var s="u_"+a.charAt(0).toUpperCase()+(a.length>1?a.slice(1):"");this._uniformLocations[a]=r.getUniformLocation(this._program,s)}},t.prototype.apply=function(n,r){this._checkDimensions(n),this._refreshGl(),this._enablePositionAttrib(),this._enableTexCoordAttrib(),this._prepareTextures(n,r),this._gl.useProgram(this._program),this._prepareUniforms(n,r),this._draw(n)},t.prototype._checkDimensions=function(n){var r=this._gl;(this._canvas.width!==n.canvas.width||this._canvas.height!==n.canvas.height)&&(this._canvas.width=n.canvas.width,this._canvas.height=n.canvas.height,r.viewport(0,0,n.canvas.width,n.canvas.height))},t.prototype._refreshGl=function(){var n=this._gl;n.clearColor(0,0,0,1),n.blendFuncSeparate(n.SRC_ALPHA,n.SRC_ALPHA,n.ONE,n.ZERO),n.enable(n.BLEND),n.disable(n.DEPTH_TEST),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype._enablePositionAttrib=function(){var n=this._gl,r=2,i=n.FLOAT,o=!1,a=0,s=0;n.bindBuffer(n.ARRAY_BUFFER,this._buffers.position),n.vertexAttribPointer(this._attribLocations.vertexPosition,r,i,o,a,s),n.enableVertexAttribArray(this._attribLocations.vertexPosition)},t.prototype._enableTexCoordAttrib=function(){var n=this._gl,r=2,i=n.FLOAT,o=!1,a=0,s=0;n.bindBuffer(n.ARRAY_BUFFER,this._buffers.textureCoord),n.vertexAttribPointer(this._attribLocations.textureCoord,r,i,o,a,s),n.enableVertexAttribArray(this._attribLocations.textureCoord)},t.prototype._prepareTextures=function(n,r){var i=this._gl;i.activeTexture(i.TEXTURE0),this._inputTexture=t._loadTexture(i,n.canvas,this._sourceTextureOptions),i.bindTexture(i.TEXTURE_2D,this._inputTexture);var o=0;for(var a in this._userTextures){var s=this._userTextures[a];i.activeTexture(i.TEXTURE0+(t.INTERNAL_TEXTURE_UNITS+o));var l=t._loadTexture(i,pe(this,a,r),s);i.bindTexture(i[s.target],l),o++}},t.prototype._prepareUniforms=function(n,r){var i=this._gl;this._uniformLocations.source&&i.uniform1i(this._uniformLocations.source,0),this._uniformLocations.size&&i.uniform2iv(this._uniformLocations.size,[n.canvas.width,n.canvas.height]);for(var o in this._userUniforms){var a=this._userUniforms[o],s=pe(this,o,r),l=this._prepareValue(s,a.type,r,a),u=this._uniformLocations[o];i["uniform"+a.type](u,l)}i.uniform1i(this._uniformLocations.test,0)},t.prototype._draw=function(n){var r=this._gl,i=0,o=4;r.drawArrays(r.TRIANGLE_STRIP,i,o),n.cctx.clearRect(0,0,n.canvas.width,n.canvas.height),n.cctx.drawImage(this._canvas,0,0)},t.prototype._prepareValue=function(n,r,i,o){o===void 0&&(o={});var a=o.defaultFloatComponent||0;if(r==="1i"){var s=0;for(var l in this._userTextures){var u=pe(this,l,i);n===u&&(n=t.INTERNAL_TEXTURE_UNITS+s),s++}}if(r==="3fv"){if(Array.isArray(n)&&(n.length===3||n.length===4))return n;if(typeof n=="object")return[n.r!==void 0?n.r:a,n.g!==void 0?n.g:a,n.b!==void 0?n.b:a];throw new Error("Invalid type: ".concat(r," or value: ").concat(n))}if(r==="4fv"){if(Array.isArray(n)&&n.length===4)return n;if(typeof n=="object")return[n.r!==void 0?n.r:a,n.g!==void 0?n.g:a,n.b!==void 0?n.b:a,n.a!==void 0?n.a:a];throw new Error("Invalid type: ".concat(r," or value: ").concat(n))}return n},t._initRectBuffers=function(n){var r=[-1,1,1,1,-1,-1,1,-1],i=[0,0,1,0,0,1,1,1];return{position:t._initBuffer(n,r),textureCoord:t._initBuffer(n,i)}},t._initBuffer=function(n,r){var i=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),i},t._loadTexture=function(n,r,i){i===void 0&&(i={}),i=Be(Be({},t._DEFAULT_TEXTURE_OPTIONS),i);var o=n[i.target],a=i.level,s=n[i.internalFormat],l=n[i.srcFormat],u=n[i.srcType],c=n[i.wrapS],f=n[i.wrapT],d=n[i.minFilter],h=n[i.magFilter],y=n.createTexture();n.bindTexture(o,y),n.texImage2D(o,a,s,l,u,r);var S=o instanceof HTMLVideoElement?o.videoWidth:o.width,b=o instanceof HTMLVideoElement?o.videoHeight:o.height;return n.texParameteri(o,n.TEXTURE_MIN_FILTER,d),n.texParameteri(o,n.TEXTURE_MAG_FILTER,h),S&&$x(S)&&b&&$x(b)?(n.texParameteri(o,n.TEXTURE_WRAP_S,c),n.texParameteri(o,n.TEXTURE_WRAP_T,f),n.generateMipmap(o)):((c!==n.CLAMP_TO_EDGE||f!==n.CLAMP_TO_EDGE)&&console.warn("Wrap mode is not CLAMP_TO_EDGE for a non-power-of-two texture. Defaulting to CLAMP_TO_EDGE"),n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),y},t._initShaderProgram=function(n,r,i){var o=t._loadShader(n,n.VERTEX_SHADER,r),a=t._loadShader(n,n.FRAGMENT_SHADER,i),s=n.createProgram();return n.attachShader(s,o),n.attachShader(s,a),n.linkProgram(s),n.getProgramParameter(s,n.LINK_STATUS)?s:(console.warn("Unable to link shader program: "+n.getProgramInfoLog(s)),null)},t._loadShader=function(n,r,i){var o=n.createShader(r);return n.shaderSource(o,i),n.compileShader(o),n.getShaderParameter(o,n.COMPILE_STATUS)?o:(console.warn("An error occured compiling shader: "+n.getShaderInfoLog(o)),n.deleteShader(o),null)},t.INTERNAL_TEXTURE_UNITS=1,t._DEFAULT_TEXTURE_OPTIONS={createUniform:!0,target:"TEXTURE_2D",level:0,internalFormat:"RGBA",srcFormat:"RGBA",srcType:"UNSIGNED_BYTE",minFilter:"LINEAR",magFilter:"LINEAR",wrapS:"CLAMP_TO_EDGE",wrapT:"CLAMP_TO_EDGE"},t._VERTEX_SOURCE=`
    attribute vec4 a_VertexPosition;
    attribute vec2 a_TextureCoord;

    varying highp vec2 v_TextureCoord;

    void main() {
        // no need for projection or model-view matrices, since we're just rendering a rectangle
        // that fills the screen (see position values)
        gl_Position = a_VertexPosition;
        v_TextureCoord = a_TextureCoord;
    }
  `,t._IDENTITY_FRAGMENT_SOURCE=`
    precision mediump float;

    uniform sampler2D u_Source;

    varying highp vec2 v_TextureCoord;

    void main() {
        gl_FragColor = texture2D(u_Source, v_TextureCoord);
    }
  `,t}(Jl),$x=function(e){return(e&&e-1)===0},CL=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform float u_Brightness;

        varying highp vec2 v_TextureCoord;

        void main() {
          vec4 color = texture2D(u_Source, v_TextureCoord);
          vec3 rgb = clamp(color.rgb + u_Brightness / 255.0, 0.0, 1.0);
          gl_FragColor = vec4(rgb, color.a);
        }
      `,uniforms:{brightness:"1f"}})||this;return r.brightness=n.brightness||0,r}return t}(wi),IL=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform vec4 u_Factors;

        varying highp vec2 v_TextureCoord;

        void main() {
          vec4 color = texture2D(u_Source, v_TextureCoord);
          gl_FragColor = clamp(u_Factors * color, 0.0, 1.0);
        }
      `,uniforms:{factors:{type:"4fv",defaultFloatComponent:1}}})||this;return r.factors=n.factors||{},r}return t}(wi),PL=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform vec3 u_Target;
        uniform float u_Threshold;
        uniform bool u_Interpolate;

        varying highp vec2 v_TextureCoord;

        void main() {
          vec4 color = texture2D(u_Source, v_TextureCoord);
          float alpha = color.a;
          vec3 dist = abs(color.rgb - u_Target / 255.0);
          if (!u_Interpolate) {
            // Standard way that most video editors probably use (all-or-nothing method)
            float thresh = u_Threshold / 255.0;
            bool transparent = dist.r <= thresh && dist.g <= thresh && dist.b <= thresh;
            if (transparent)
              alpha = 0.0;
          } else {
            /*
             better way IMHO:
             Take the average of the absolute differences between the pixel and the target for each channel
             */
            float transparency = (dist.r + dist.g + dist.b) / 3.0;
            // TODO: custom or variety of interpolation methods
            alpha = transparency;
          }
          gl_FragColor = vec4(color.rgb, alpha);
        }
      `,uniforms:{target:"3fv",threshold:"1f",interpolate:"1i"}})||this;return r.target=n.target||new kg(0,0,0),r.threshold=n.threshold||0,r.interpolate=n.interpolate||!1,r}return t}(wi),AL=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform float u_Contrast;

        varying highp vec2 v_TextureCoord;

        void main() {
          vec4 color = texture2D(u_Source, v_TextureCoord);
          vec3 rgb = clamp(u_Contrast * (color.rgb - 0.5) + 0.5, 0.0, 1.0);
          gl_FragColor = vec4(rgb, color.a);
        }
      `,uniforms:{contrast:"1f"}})||this;return r.contrast=n.contrast||1,r}return t}(wi),DL=function(){function e(){}return e}(),LL=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r.x=n.x,r.y=n.y,r.radiusX=n.radiusX,r.radiusY=n.radiusY,r.rotation=n.rotation||0,r.startAngle=n.startAngle||0,r.endAngle=n.endAngle!==void 0?n.endAngle:2*Math.PI,r.anticlockwise=n.anticlockwise||!1,r._tmpCanvas=document.createElement("canvas"),r._tmpCtx=r._tmpCanvas.getContext("2d"),r}return t.prototype.apply=function(n,r){var i=n.cctx,o=n.canvas,a=pe(this,"x",r),s=pe(this,"y",r),l=pe(this,"radiusX",r),u=pe(this,"radiusY",r),c=pe(this,"rotation",r),f=pe(this,"startAngle",r),d=pe(this,"endAngle",r),h=pe(this,"anticlockwise",r);this._tmpCanvas.width=n.canvas.width,this._tmpCanvas.height=n.canvas.height,this._tmpCtx.drawImage(o,0,0),i.clearRect(0,0,o.width,o.height),i.save(),i.beginPath(),i.ellipse(a,s,l,u,c,f,d,h),i.closePath(),i.clip(),i.drawImage(this._tmpCanvas,0,0),i.restore()},t}(Jl),kL=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r._stack=n,r}return t.prototype.onAdd=function(n){this._stack.parent&&n.tryAttach(this._stack.parent)},t.prototype.onRemove=function(n){this._stack.parent&&n.tryDetach()},t}(nf),RL=function(e){He(t,e);function t(n,r){return e.call(this,n,new kL(r))||this}return t}(rf),t2=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r.effects=new RL(n.effects,r),n.effects.forEach(function(i){return r.effects.push(i)}),r}return t.prototype.attach=function(n){e.prototype.attach.call(this,n),this.effects.filter(function(r){return!!r}).forEach(function(r){r.tryAttach(n)})},t.prototype.detach=function(){e.prototype.detach.call(this),this.effects.filter(function(n){return!!n}).forEach(function(n){n.tryDetach()})},t.prototype.apply=function(n,r){for(var i=0;i<this.effects.length;i++){var o=this.effects[i];o&&o.apply(n,r)}},t.prototype.addEffect=function(n){return this.effects.push(n),this},t}(Jl),ML=function(e){He(t,e);function t(n){return e.call(this,{effects:[new n2(n),new r2(n)]})||this}return t}(t2),Fg=function(e){He(t,e);function t(n){var r=e.call(this,{fragmentSource:n.fragmentSource,uniforms:{radius:"1i"},textures:{shape:{minFilter:"NEAREST",magFilter:"NEAREST"}}})||this;return r.radius=n.radius,r._radiusCache=void 0,r}return t.prototype.apply=function(n,r){var i=pe(this,"radius",r);i!==this._radiusCache&&(this.shape=t._render1DKernel(t._gen1DKernel(i))),this._radiusCache=i,e.prototype.apply.call(this,n,r)},t._render1DKernel=function(n){var r=document.createElement("canvas");r.width=n.length,r.height=1;for(var i=r.getContext("2d"),o=i.createImageData(r.width,r.height),a=0;a<n.length;a++)o.data[4*a+0]=255*n[a],o.data[4*a+1]=0,o.data[4*a+2]=0,o.data[4*a+3]=255;return i.putImageData(o,0,0),r},t._gen1DKernel=function(n){for(var r=t._genPascalRow(2*n+1),i=0,o=0;o<r.length;o++)i+=r[o];for(var o=0;o<r.length;o++)r[o]/=i;return r},t._genPascalRow=function(n){if(n<0)throw new Error("Invalid index ".concat(n));for(var r=[1],i=1;i<n;i++){var o=[];o.length=r.length+1,o[0]=o[o.length-1]=1;for(var a=1;a<o.length-1;a++)o[a]=r[a-1]+r[a];r=o}return r},t}(wi);Fg.prototype.publicExcludes=wi.prototype.publicExcludes.concat(["shape"]);var n2=function(e){He(t,e);function t(n){return e.call(this,{fragmentSource:`
        #define MAX_RADIUS 250

        precision mediump float;

        uniform sampler2D u_Source;
        uniform ivec2 u_Size;   // pixel dimensions of input and output
        uniform sampler2D u_Shape;  // pseudo one-dimension of blur distribution (would be 1D but webgl doesn't support it)
        uniform int u_Radius;   // TODO: support floating-point radii

        varying highp vec2 v_TextureCoord;

        void main() {
          /*
           * Ideally, totalWeight should end up being 1, but due to rounding errors, it sometimes ends up less than 1
           * (I believe JS canvas stores values as integers, which rounds down for the majority of the Gaussian curve)
           * So, normalize by accumulating all the weights and dividing by that.
           */
          float totalWeight = 0.0;
          vec4 avg = vec4(0.0);
          // GLSL can only use constants in for-loop declaration, so start at zero, and stop before 2 * u_Radius + 1,
          // opposed to starting at -u_Radius and stopping _at_ +u_Radius.
          for (int i = 0; i < 2 * MAX_RADIUS + 1; i++) {
            if (i >= 2 * u_Radius + 1)
              break;  // GLSL can only use constants in for-loop declaration, so we break here.
            // (2 * u_Radius + 1) is the width of u_Shape, by definition
            float weight = texture2D(u_Shape, vec2(float(i) / float(2 * u_Radius + 1), 0.5)).r;   // TODO: use single-channel format
            totalWeight += weight;
            vec4 sample = texture2D(u_Source, v_TextureCoord + vec2(i - u_Radius, 0.0) / vec2(u_Size));
            avg += weight * sample;
          }
          gl_FragColor = avg / totalWeight;
        }
      `,radius:n.radius})||this}return t}(Fg),r2=function(e){He(t,e);function t(n){return e.call(this,{fragmentSource:`
        #define MAX_RADIUS 250

        precision mediump float;

        uniform sampler2D u_Source;
        uniform ivec2 u_Size;   // pixel dimensions of input and output
        uniform sampler2D u_Shape;  // pseudo one-dimension of blur distribution (would be 1D but webgl doesn't support it)
        uniform int u_Radius;   // TODO: support floating-point radii

        varying highp vec2 v_TextureCoord;

        void main() {
          /*
           * Ideally, totalWeight should end up being 1, but due to rounding errors, it sometimes ends up less than 1
           * (I believe JS canvas stores values as integers, which rounds down for the majority of the Gaussian curve)
           * So, normalize by accumulating all the weights and dividing by that.
           */
          float totalWeight = 0.0;
          vec4 avg = vec4(0.0);
          // GLSL can only use constants in for-loop declaration, so start at zero, and stop before 2 * u_Radius + 1,
          // opposed to starting at -u_Radius and stopping _at_ +u_Radius.
          for (int i = 0; i < 2 * MAX_RADIUS + 1; i++) {
            if (i >= 2 * u_Radius + 1)
              break;  // GLSL can only use constants in for-loop declaration, so we break here.
            // (2 * u_Radius + 1) is the width of u_Shape, by definition
            float weight = texture2D(u_Shape, vec2(float(i) / float(2 * u_Radius + 1), 0.5)).r;   // TODO: use single-channel format
            totalWeight += weight;
            vec4 sample = texture2D(u_Source, v_TextureCoord + vec2(0.0, i - u_Radius) / vec2(u_Size));
            avg += weight * sample;
          }
          gl_FragColor = avg / totalWeight;
        }
      `,radius:n.radius})||this}return t}(Fg),OL=function(e){He(t,e);function t(){return e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform vec4 u_Factors;

        varying highp vec2 v_TextureCoord;

        float max3(float x, float y, float z) {
          return max(x, max(y, z));
        }

        float min3(float x, float y, float z) {
          return min(x, min(y, z));
        }

        void main() {
          vec4 color = texture2D(u_Source, v_TextureCoord);
          // Desaturate
          float value = (max3(color.r, color.g, color.b) + min3(color.r, color.g, color.b)) / 2.0;
          gl_FragColor = vec4(value, value, value, color.a);
        }
      `})||this}return t}(wi),FL=function(e){He(t,e);function t(n){n===void 0&&(n={});var r=e.call(this,{fragmentSource:`
        precision mediump float;

        uniform sampler2D u_Source;
        uniform ivec2 u_Size;
        uniform int u_PixelSize;

        varying highp vec2 v_TextureCoord;

        void main() {
          int ps = u_PixelSize;

          // Snap to nearest block's center
          vec2 loc = vec2(u_Size) * v_TextureCoord; // pixel-space
          vec2 snappedLoc = float(ps) * floor(loc / float(ps));
          vec2 centeredLoc = snappedLoc + vec2(float(u_PixelSize) / 2.0 + 0.5);
          vec2 clampedLoc = clamp(centeredLoc, vec2(0.0), vec2(u_Size));
          gl_FragColor = texture2D(u_Source, clampedLoc / vec2(u_Size));
        }
      `,uniforms:{pixelSize:"1i"}})||this;return r.pixelSize=n.pixelSize||1,r}return t.prototype.apply=function(n,r){var i=pe(this,"pixelSize",r);if(i%1!==0||i<0)throw new Error("Pixel size must be a nonnegative integer");e.prototype.apply.call(this,n,r)},t}(wi),Ag=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r.matrix=n.matrix,r._tmpMatrix=new t.Matrix,r._tmpCanvas=document.createElement("canvas"),r._tmpCtx=r._tmpCanvas.getContext("2d"),r}return t.prototype.apply=function(n,r){n.canvas.width!==this._tmpCanvas.width&&(this._tmpCanvas.width=n.canvas.width),n.canvas.height!==this._tmpCanvas.height&&(this._tmpCanvas.height=n.canvas.height),this._tmpMatrix.data=pe(this,"matrix",r).data,this._tmpCtx.setTransform(this._tmpMatrix.a,this._tmpMatrix.b,this._tmpMatrix.c,this._tmpMatrix.d,this._tmpMatrix.e,this._tmpMatrix.f),this._tmpCtx.drawImage(n.canvas,0,0),this._tmpCtx.setTransform(1,0,0,0,1,0),n.cctx.clearRect(0,0,n.canvas.width,n.canvas.height),n.cctx.drawImage(this._tmpCanvas,0,0)},t}(Jl);(function(e){var t=function(){function n(r){this.data=r||[1,0,0,0,1,0,0,0,1]}return n.prototype.identity=function(){for(var r=0;r<this.data.length;r++)this.data[r]=n.IDENTITY.data[r];return this},n.prototype.cell=function(r,i,o){return o!==void 0&&(this.data[3*i+r]=o),this.data[3*i+r]},Object.defineProperty(n.prototype,"a",{get:function(){return this.data[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"b",{get:function(){return this.data[3]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"c",{get:function(){return this.data[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"d",{get:function(){return this.data[4]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"e",{get:function(){return this.data[2]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"f",{get:function(){return this.data[5]},enumerable:!1,configurable:!0}),n.prototype.multiply=function(r){for(var i=0;i<3;i++)for(var o=0;o<3;o++){for(var a=0,s=0;s<3;s++)a+=this.cell(i,s)*r.cell(s,o);n._TMP_MATRIX.cell(i,o,a)}for(var s=0;s<n._TMP_MATRIX.data.length;s++)this.data[s]=n._TMP_MATRIX.data[s];return this},n.prototype.translate=function(r,i){return this.multiply(new n([1,0,r,0,1,i,0,0,1])),this},n.prototype.scale=function(r,i){return this.multiply(new n([r,0,0,0,i,0,0,0,1])),this},n.prototype.rotate=function(r){var i=Math.cos(r),o=Math.sin(r);return this.multiply(new n([i,o,0,-o,i,0,0,0,1])),this},n.IDENTITY=new n,n._TMP_MATRIX=new n,n}();e.Matrix=t})(Ag||(Ag={}));var NL=Object.freeze({__proto__:null,Base:ql,Brightness:CL,Channels:IL,ChromaKey:PL,Contrast:AL,EllipticalMaskOptions:DL,EllipticalMask:LL,GaussianBlur:ML,GaussianBlurHorizontal:n2,GaussianBlurVertical:r2,Grayscale:OL,Pixelate:FL,Shader:wi,Stack:t2,get Transform(){return Ag},Visual:Jl}),UL=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r._movie=n,r}return t.prototype.onAdd=function(n){n.tryAttach(this._movie)},t.prototype.onRemove=function(n){n.tryDetach()},t}(nf),BL=function(e){He(t,e);function t(n,r){return e.call(this,n,new UL(r))||this}return t}(rf),zL=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r._movie=n,r}return t.prototype.onAdd=function(n){n.tryAttach(this._movie)},t.prototype.onRemove=function(n){n.tryDetach()},t}(nf),VL=function(e){He(t,e);function t(n,r){return e.call(this,n,new zL(r))||this}return t}(rf),GL=function(){function e(){}return e}(),Ng=function(){function e(t){if(this._recording=!1,this.actx=t.actx||t.audioContext||new AudioContext||new window.webkitAudioContext,delete t.actx,!t.canvas)throw new Error('Required option "canvas" not provided to Movie');this._canvas=this._visibleCanvas=t.canvas,delete t.canvas,this._cctx=this.canvas.getContext("2d"),Zo(t,this),this.effects=new BL([],this),this.layers=new VL([],this),this._paused=!0,this._ended=!1,this._renderingFrame=!1,this.currentTime=0}return e.prototype._whenReady=function(){return vi(this,void 0,void 0,function(){return yi(this,function(t){switch(t.label){case 0:return[4,Promise.all([Promise.all(this.layers.map(function(n){return n.whenReady()})),Promise.all(this.effects.map(function(n){return n.whenReady()}))])];case 1:return t.sent(),[2]}})})},e.prototype.play=function(t){var n;return t===void 0&&(t={}),vi(this,void 0,void 0,function(){var r=this;return yi(this,function(i){switch(i.label){case 0:return[4,this._whenReady()];case 1:if(i.sent(),!this.paused)throw new Error("Already playing");return this._paused=this._ended=!1,this._lastRealTime=performance.now(),this._endTime=t.duration?this.currentTime+t.duration:this.duration,(n=t.onStart)===null||n===void 0||n.call(t),Cn(this,"movie.play",{}),[4,new Promise(function(o){r.renderingFrame||r._render(void 0,o),r._renderingFrame=!1})];case 2:return i.sent(),this._lastRealTime=void 0,[2]}})})},e.prototype._show=function(){this._canvas=this._visibleCanvas,this._cctx=this.canvas.getContext("2d"),Cn(this,"audiodestinationupdate",{movie:this,destination:this.actx.destination})},e.prototype.stream=function(t){return vi(this,void 0,void 0,function(){var n,r,i,o,a,s=this;return yi(this,function(l){switch(l.label){case 0:if(!t||!t.frameRate)throw new Error('Required option "frameRate" not provided to Movie.stream');if(t.video===!1&&t.audio===!1)throw new Error("Both video and audio cannot be disabled");if(!this.paused)throw new Error("Cannot stream movie while it's already playing");return[4,this._whenReady()];case 1:return l.sent(),this._canvas=document.createElement("canvas"),this.canvas.width=this._visibleCanvas.width,this.canvas.height=this._visibleCanvas.height,this._cctx=this.canvas.getContext("2d"),n=[],t.video!==!1&&(r=this.canvas.captureStream(t.frameRate),n=n.concat(r.getTracks())),i=this.layers.some(function(u){return u instanceof Qx||u instanceof e2}),i&&t.audio!==!1&&(o=this.actx.createMediaStreamDestination(),a=o.stream,n=n.concat(a.getTracks()),Cn(this,"audiodestinationupdate",{movie:this,destination:o})),this._currentStream=new MediaStream(n),[4,this.play({onStart:function(){t.onStart(s._currentStream)},duration:t.duration})];case 2:return l.sent(),this._currentStream.getTracks().forEach(function(u){u.stop()}),this._currentStream=null,this._show(),[2]}})})},e.prototype.record=function(t){var n;return vi(this,void 0,void 0,function(){var r,i,o,a,s=this;return yi(this,function(l){switch(l.label){case 0:if(t.video===!1&&t.audio===!1)throw new Error("Both video and audio cannot be disabled");if(!this.paused)throw new Error("Cannot record movie while it's already playing");if(r=t.type||"video/webm",MediaRecorder&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(r))throw new Error("Please pass a valid MIME type for the exported video");return[4,new Promise(function(u){s.stream({frameRate:t.frameRate,duration:t.duration,video:t.video,audio:t.audio,onStart:u}).then(function(){s._recorder.requestData(),s._recorder.stop()})})];case 1:return i=l.sent(),o=[],a=Be(Be({},t.mediaRecorderOptions||{}),{mimeType:r}),this._recorder=new MediaRecorder(i,a),this._recorder.ondataavailable=function(u){u.data.size>0&&o.push(u.data)},this._recorder.start(),this._recording=!0,(n=t.onStart)===null||n===void 0||n.call(t,this._recorder),Cn(this,"movie.record",{options:t}),[4,new Promise(function(u,c){s._recorder.onstop=function(){u()},s._recorder.onerror=c})];case 2:return l.sent(),this._paused=!0,this._ended=!0,this._recording=!1,[2,new Blob(o,{type:r})]}})})},e.prototype.pause=function(){this._paused=!0;for(var t=0;t<this.layers.length;t++)if(Object.prototype.hasOwnProperty.call(this.layers,t)){var n=this.layers[t];n.active&&(n.stop(),n.active=!1)}return Cn(this,"movie.pause",{}),this},e.prototype.stop=function(){return this.pause(),this.currentTime=0,this},e.prototype._render=function(t,n){var r=this;if(t===void 0&&(t=performance.now()),n===void 0&&(n=void 0),Kx(this),!this.rendering){n&&n();return}if(this.ready){Cn(this,"movie.loadeddata",{movie:this}),this._recording&&this._recorder.state==="paused"&&this._recorder.resume();var i=this._currentStream?this._endTime:this.duration;if(this._updateCurrentTime(t,i),this.currentTime===i&&(this.recording&&Cn(this,"movie.recordended",{movie:this}),this.currentTime===this.duration&&Cn(this,"movie.ended",{movie:this,repeat:this.repeat}),this._currentTime=0,Cn(this,"movie.timeupdate",{movie:this}),this._renderingFrame=!1,!(!this.recording&&this.repeat))){this._paused=!0,this._ended=!0;for(var o=0;o<this.layers.length;o++)if(Object.prototype.hasOwnProperty.call(this.layers,o)){var a=this.layers[o];if(!a||!a.active)continue;a.stop(),a.active=!1}Cn(this,"movie.pause",{}),n&&n();return}this._renderBackground(t),this._renderLayers(),this._applyEffects()}else this.recording&&this._recorder.state==="recording"&&this._recorder.pause();if(this._renderingFrame&&this.ready){this._renderingFrame=!1,n&&n();return}window.requestAnimationFrame(function(){r._render(void 0,n)})},e.prototype._updateCurrentTime=function(t,n){if(!this._renderingFrame){var r=t/1e3,i=r-this._lastRealTime;this._lastRealTime=r,i>0&&(this._currentTime+=i,Cn(this,"movie.timeupdate",{movie:this})),this.currentTime>n&&(this._currentTime=n)}},e.prototype._renderBackground=function(t){this.cctx.clearRect(0,0,this.canvas.width,this.canvas.height);var n=pe(this,"background",t);n&&(this.cctx.fillStyle=n,this.cctx.fillRect(0,0,this.canvas.width,this.canvas.height))},e.prototype._renderLayers=function(){for(var t=0;t<this.layers.length;t++)if(Object.prototype.hasOwnProperty.call(this.layers,t)){var n=this.layers[t];if(n){var r=this.currentTime-n.startTime;if(!pe(n,"enabled",r)||this.currentTime<n.startTime||this.currentTime>n.startTime+n.duration){n.active&&!this._renderingFrame&&(n.stop(),n.active=!1);continue}if(this._renderingFrame||n.progress(r),!n.active&&pe(n,"enabled",r)&&!this._renderingFrame&&(n.start(),n.active=!0),n.render(),n instanceof Si){var i=n.canvas;i.width*i.height>0&&this.cctx.drawImage(i,pe(n,"x",r),pe(n,"y",r),i.width,i.height)}}}},e.prototype._applyEffects=function(){for(var t=0;t<this.effects.length;t++){var n=this.effects[t];n&&n.apply(this,this.currentTime)}},e.prototype.refresh=function(){var t=this;if(!this.paused)throw new Error("Already playing");return new Promise(function(n){t._renderingFrame=!0,t._render(void 0,n)})},e.prototype._publishToLayers=function(t,n){for(var r=0;r<this.layers.length;r++)Object.prototype.hasOwnProperty.call(this.layers,r)&&Cn(this.layers[r],t,n)},Object.defineProperty(e.prototype,"rendering",{get:function(){return!this.paused||this._renderingFrame},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingFrame",{get:function(){return this._renderingFrame},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"recording",{get:function(){return this._recording},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.layers.reduce(function(t,n){return Math.max(n.startTime+n.duration,t)},0)},enumerable:!1,configurable:!0}),e.prototype.addLayer=function(t){return this.layers.push(t),this},e.prototype.addEffect=function(t){return this.effects.push(t),this},Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),e.prototype.seek=function(t){this._currentTime=t;for(var n=0;n<this.layers.length;n++){var r=this.layers[n];if(r){var i=t-r.startTime;i>=0&&i<=r.duration?r.seek(i):r.seek(void 0)}}Cn(this,"movie.seek",{})},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},set:function(t){this.seek(t)},enumerable:!1,configurable:!0}),e.prototype.setCurrentTime=function(t,n){var r=this;return n===void 0&&(n=!0),new Promise(function(i,o){r.seek(t),n?r.refresh().then(i).catch(o):i()})},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this.layers.every(function(r){return r.ready}),n=this.effects.every(function(r){return r.ready});return t&&n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cctx",{get:function(){return this._cctx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movie",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.getDefaultOptions=function(){return{canvas:void 0,background:Rg("#000"),repeat:!1}},e}();Ng.prototype.type="movie";Ng.prototype.propertyFilters={};Hr("movie.audiodestinationupdate","audiodestinationupdate");Hr("movie.ended",void 0);Hr("movie.loadeddata",void 0);Hr("movie.pause",void 0,"Wait for `play()`, `stream()`, or `record()` to resolve instead.");Hr("movie.play",void 0,"Provide an `onStart` callback to `play()`, `stream()`, or `record()` instead.");Hr("movie.record",void 0,"Provide an `onStart` callback to `record()` instead.");Hr("movie.recordended",void 0,"Wait for `record()` to resolve instead.");Hr("movie.seek",void 0,"Override the `seek` method on layers instead.");Hr("movie.timeupdate",void 0,"Override the `progress` method on layers instead.");var HL=Object.freeze({__proto__:null,layer:TL,effect:NL,event:hL,MovieOptions:GL,Movie:Ng,applyOptions:Zo,clearCachedValues:Kx,KeyFrame:Zx,val:pe,linearInterp:Lg,cosineInterp:qx,Color:kg,parseColor:Rg,Font:Jx,parseFont:SL,mapPixels:wL});i2.exports=HL});var ok={};j2(ok,{default:()=>Sf});module.exports=W2(ok);var M2=require("obsidian");var ef=require("obsidian");var Hx=H(vl(),1),jx=H(Fe(),1);var ls=require("obsidian");var LS=require("obsidian");var uC={STORYBOARD_TOGGLE:"\u7D75\u30B3\u30F3\u30C6\u5207\u66FF",CHARACTER_EDIT:"\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\u7DE8\u96C6",CHARACTER_NAME:"\u30AD\u30E3\u30E9\u540D",DESCRIPTION:"\u8AAC\u660E",DELETE:"\u524A\u9664",CANCEL:"\u30AD\u30E3\u30F3\u30BB\u30EB",SAVE:"\u4FDD\u5B58",NO_SPEAKER:"\u8A71\u8005\u306A\u3057",EDIT_CHARACTERS:"\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\u60C5\u5831\u3092\u8FFD\u52A0\u30FB\u7DE8\u96C6",DIALOGUE_PLACEHOLDER:"\u53F0\u8A5E",AI_GENERATE:"AI\u751F\u6210",FILE_SELECT:"\u30D5\u30A1\u30A4\u30EB\u9078\u629E",GENERATING:"\u751F\u6210\u4E2D",MOVE_ROW_UP:"\u884C\u3092\u4E0A\u306B\u79FB\u52D5",MOVE_ROW_DOWN:"\u884C\u3092\u4E0B\u306B\u79FB\u52D5",INSERT_ROW_BELOW:"\u4E00\u3064\u4E0B\u306B\u65B0\u898F\u8FFD\u52A0",PROMPT_REQUIRED:"\u30D7\u30ED\u30F3\u30D7\u30C8\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",HEADER_IMAGE:"\u753B\u50CF",HEADER_DIALOGUE:"\u8A71\u8005\u3068\u30BB\u30EA\u30D5",HEADER_SE:"SE",HEADER_PREVIEW:"\u30D7\u30ED\u30F3\u30D7\u30C8",LOADING:"\u8AAD\u307F\u8FBC\u307F\u4E2D...",NEW_CHAPTER_PLACEHOLDER:"\u65B0\u3057\u3044BGM\u30D7\u30ED\u30F3\u30D7\u30C8\u3092\u8FFD\u52A0",PROMPT_PLACEHOLDER:"\u30D7\u30ED\u30F3\u30D7\u30C8",IMAGE_PROMPT_PLACEHOLDER:"\u753B\u50CF\u751F\u6210\u30D7\u30ED\u30F3\u30D7\u30C8(\u4EFB\u610F)",PSD_THUMBNAIL:"PSD\u30B5\u30E0\u30CD\u30A4\u30EB",CLEAR_PATH:"\u30AF\u30EA\u30A2",TOOL_BRUSH:"\u30D6\u30E9\u30B7",TOOL_ERASER:"\u6D88\u3057\u30B4\u30E0",TOOL_SELECTION:"\u9078\u629E",TOOL_HAND:"\u624B\u306E\u3072\u3089",TOOL_PEN:"\u30DA\u30F3",TOOL_PAINT_BRUSH:"\u7B46",TOOL_COLOR_MIXER:"\u8272\u6DF7\u305C",BRUSH_SIZE:"\u30D6\u30E9\u30B7\u30B5\u30A4\u30BA",BRUSH_OPACITY:"\u30D6\u30E9\u30B7\u4E0D\u900F\u660E\u5EA6",COLOR_MIX_RATIO:"\u6DF7\u8272\u6BD4\u7387\uFF08\u30AD\u30E3\u30F3\u30D0\u30B9\uFF1A\u30DA\u30F3\uFF1D{canvas}:{pen}\uFF09",BLEND_STRENGTH:"\u306B\u3058\u307F\u5F37\u5EA6",SELECTION_TYPE:"\u9078\u629E\u7A2E\u5225",SELECT_RECT:"\u77E9\u5F62",SELECT_LASSO:"\u6295\u3052\u7E04",SELECT_MAGIC:"\u30DE\u30B8\u30C3\u30AF\u30EF\u30F3\u30C9",CANVAS_SIZE:"\u30AD\u30E3\u30F3\u30D0\u30B9\u30B5\u30A4\u30BA",ZOOM_LEVEL:"\u62E1\u5927\u7387",ROTATION_ANGLE:"\u56DE\u8EE2\u89D2",LAYERS:"\u30EC\u30A4\u30E4\u30FC",NEW_LAYER:"\u65B0\u898F\u30EC\u30A4\u30E4\u30FC",IMAGE_LAYER:"\u753B\u50CF\u30EC\u30A4\u30E4\u30FC",DELETE_LAYER:"\u30EC\u30A4\u30E4\u30FC\u524A\u9664",ENTER_LAYER_NAME:"\u30EC\u30A4\u30E4\u30FC\u540D\u3092\u5165\u529B",BACKGROUND:"\u80CC\u666F",AI_RESPONSE_ERROR:"AI\u5FDC\u7B54\u30A8\u30E9\u30FC",BACK_TO_STORYBOARD:"\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u306B\u623B\u308B",BGM_LABEL:"BGM",BGM_PROMPT_PLACEHOLDER:"BGM\u751F\u6210\u30D7\u30ED\u30F3\u30D7\u30C8(\u4EFB\u610F)",CHAT_INPUT_PLACEHOLDER:"\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u5165\u529B...",NO_LAYERS:"\u30EC\u30A4\u30E4\u30FC\u304C\u3042\u308A\u307E\u305B\u3093",ATTACH_IMAGE:"\u52A0\u5DE5\u5143\u753B\u50CF",ATTACH_MASK:"\u30DE\u30B9\u30AF",ATTACH_REFERENCE:"\u53C2\u8003",SEND:"\u9001\u4FE1",CREATE_PSD:"PSD\u30DA\u30A4\u30F3\u30BF\u30FC\u3092\u65B0\u898F\u4F5C\u6210",EXPORT_IMAGE:"\u753B\u50CF\u51FA\u529B",EXPORT_VIDEO:"\u52D5\u753B\u51FA\u529B",NEW_CHAPTER_BGM_LABEL:"BGM\u30D7\u30ED\u30F3\u30D7\u30C8",NEW_CHAPTER_BGM_PLACEHOLDER:"calm acoustic guitar, soft piano, peaceful ambient, instrumental",ADD_SILENT_SECTION:"\u7121\u97F3\u30BB\u30AF\u30B7\u30E7\u30F3\u3092\u8FFD\u52A0",OPEN_PSD:"PSD\u30DA\u30A4\u30F3\u30BF\u30FC\u3092\u958B\u304F",LAYER:"\u30EC\u30A4\u30E4\u30FC",UNDO:"\u5143\u306B\u623B\u3059",REDO:"\u3084\u308A\u76F4\u3057",LAYOUT_SETTINGS:"\u30EC\u30A4\u30A2\u30A6\u30C8\u8A2D\u5B9A",LAYOUT_HORIZONTAL:"\u6A2A\u4E26\u3073",LAYOUT_VERTICAL:"\u7E26\u4E26\u3073",DRAWING_MODE:"\u63CF\u753B\u30E2\u30FC\u30C9",DRAWING_MODE_NORMAL:"\u901A\u5E38\u63CF\u753B",DRAWING_MODE_SPECTRAL:"\u30B9\u30DA\u30AF\u30C8\u30E9\u30EB\u6DF7\u8272",DRAWING_MODE_ERASE_SOFT:"\u6D88\u3057\u30B4\u30E0",BLEND_MODE_NORMAL:"\u901A\u5E38",BLEND_MODE_MULTIPLY:"\u4E57\u7B97",BLEND_MODE_SCREEN:"\u30B9\u30AF\u30EA\u30FC\u30F3",BLEND_MODE_OVERLAY:"\u30AA\u30FC\u30D0\u30FC\u30EC\u30A4",BLEND_MODE_DARKEN:"\u6BD4\u8F03\uFF08\u6697\uFF09",BLEND_MODE_LIGHTEN:"\u6BD4\u8F03\uFF08\u660E\uFF09",BLEND_MODE_COLOR_DODGE:"\u8986\u3044\u713C\u304D",BLEND_MODE_COLOR_BURN:"\u713C\u304D\u8FBC\u307F",BLEND_MODE_HARD_LIGHT:"\u30CF\u30FC\u30C9\u30E9\u30A4\u30C8",BLEND_MODE_SOFT_LIGHT:"\u30BD\u30D5\u30C8\u30E9\u30A4\u30C8",BLEND_MODE_DIFFERENCE:"\u5DEE\u306E\u7D76\u5BFE\u5024",BLEND_MODE_EXCLUSION:"\u9664\u5916",BLEND_MODE_HUE:"\u8272\u76F8",BLEND_MODE_SATURATION:"\u5F69\u5EA6",BLEND_MODE_COLOR:"\u30AB\u30E9\u30FC",BLEND_MODE_LUMINOSITY:"\u8F1D\u5EA6",CLIPPING_MASK:"\u30AF\u30EA\u30C3\u30D4\u30F3\u30B0\u30DE\u30B9\u30AF",EDIT_MENU:"\u7DE8\u96C6",FILE_MENU:"\u30D5\u30A1\u30A4\u30EB",EXPORT_MERGED_IMAGE:"\u753B\u50CF\u3092\u7D71\u5408\u3057\u3066\u66F8\u304D\u51FA\u3057",TOOL_SETTINGS:"\u8A2D\u5B9A"},PS=uC;var cC={STORYBOARD_TOGGLE:"Toggle storyboard",CHARACTER_EDIT:"Edit characters",CHARACTER_NAME:"Character name",DESCRIPTION:"Description",DELETE:"Delete",CANCEL:"Cancel",SAVE:"Save",NO_SPEAKER:"No speaker",EDIT_CHARACTERS:"Add/edit character information",DIALOGUE_PLACEHOLDER:"Dialogue",AI_GENERATE:"AI generate",FILE_SELECT:"Select file",GENERATING:"Generating",MOVE_ROW_UP:"Move row up",MOVE_ROW_DOWN:"Move row down",INSERT_ROW_BELOW:"Insert row below",PROMPT_REQUIRED:"Please enter a prompt",HEADER_IMAGE:"Image",HEADER_DIALOGUE:"Speaker and dialogue",HEADER_SE:"SE",HEADER_PREVIEW:"Prompt",LOADING:"Loading...",NEW_CHAPTER_PLACEHOLDER:"Add new BGM prompt",PROMPT_PLACEHOLDER:"Prompt",IMAGE_PROMPT_PLACEHOLDER:"Image generation prompt (optional)",PSD_THUMBNAIL:"PSD thumbnail",CLEAR_PATH:"Clear",TOOL_BRUSH:"Brush",TOOL_ERASER:"Eraser",TOOL_SELECTION:"Select",TOOL_HAND:"Hand",TOOL_PEN:"Pen",TOOL_PAINT_BRUSH:"Paint brush",TOOL_COLOR_MIXER:"Color mixer",BRUSH_SIZE:"Brush size",BRUSH_OPACITY:"Brush opacity",COLOR_MIX_RATIO:"Color mix ratio (Canvas:Pen = {canvas}:{pen})",BLEND_STRENGTH:"Blend strength",SELECTION_TYPE:"Selection mode",SELECT_RECT:"Rectangle",SELECT_LASSO:"Lasso",SELECT_MAGIC:"Magic wand",CANVAS_SIZE:"Canvas Size",ZOOM_LEVEL:"Zoom",ROTATION_ANGLE:"Rotation",LAYERS:"Layers",NEW_LAYER:"New Layer",IMAGE_LAYER:"Image Layer",DELETE_LAYER:"Delete Layer",ENTER_LAYER_NAME:"Enter layer name",AI_RESPONSE_ERROR:"AI response error",BACK_TO_STORYBOARD:"Back to storyboard",BGM_LABEL:"BGM",BGM_PROMPT_PLACEHOLDER:"BGM prompt (optional)",CHAT_INPUT_PLACEHOLDER:"Enter message...",NO_LAYERS:"No layers",ATTACH_IMAGE:"Image",ATTACH_MASK:"Mask",ATTACH_REFERENCE:"Reference",SEND:"Send",CREATE_PSD:"Create PSD Painter",EXPORT_IMAGE:"Export image",EXPORT_VIDEO:"Export video",NEW_CHAPTER_BGM_LABEL:"BGM prompt",NEW_CHAPTER_BGM_PLACEHOLDER:"calm acoustic guitar, soft piano, peaceful ambient, instrumental",ADD_SILENT_SECTION:"Add silent section",OPEN_PSD:"Open PSD Painter",BACKGROUND:"Background",LAYER:"Layer",UNDO:"Undo",REDO:"Redo",LAYOUT_SETTINGS:"Layout settings",LAYOUT_HORIZONTAL:"Horizontal",LAYOUT_VERTICAL:"Vertical",DRAWING_MODE:"Drawing mode",DRAWING_MODE_NORMAL:"Normal",DRAWING_MODE_SPECTRAL:"Spectral mixing",DRAWING_MODE_ERASE_SOFT:"Soft eraser",BLEND_MODE_NORMAL:"Normal",BLEND_MODE_MULTIPLY:"Multiply",BLEND_MODE_SCREEN:"Screen",BLEND_MODE_OVERLAY:"Overlay",BLEND_MODE_DARKEN:"Darken",BLEND_MODE_LIGHTEN:"Lighten",BLEND_MODE_COLOR_DODGE:"Color Dodge",BLEND_MODE_COLOR_BURN:"Color Burn",BLEND_MODE_HARD_LIGHT:"Hard Light",BLEND_MODE_SOFT_LIGHT:"Soft Light",BLEND_MODE_DIFFERENCE:"Difference",BLEND_MODE_EXCLUSION:"Exclusion",BLEND_MODE_HUE:"Hue",BLEND_MODE_SATURATION:"Saturation",BLEND_MODE_COLOR:"Color",BLEND_MODE_LUMINOSITY:"Luminosity",CLIPPING_MASK:"Clipping Mask",EDIT_MENU:"Edit",FILE_MENU:"File",EXPORT_MERGED_IMAGE:"Export flattened image",TOOL_SETTINGS:"Settings"},AS=cC;var kS=null;function RS(e){kS=e}var DS={ja:PS,en:AS};function V(e){var r,i;if(!kS)return console.warn("App instance not set for i18n"),e;let t=LS.moment.locale();return(i=((r=DS[t])!=null?r:DS.en)[e])!=null?i:e}var ji;(i=>{function r(o,a,s){i.tools=o,i.aiEnabledTools=a,i.config=s}i.initialize=r})(ji||(ji={}));var Wi=class{static initialize(t,n,r){ji.initialize(t,n,r)}static async executeTool(t,n){let r=ji.tools.get(t);if(!r){let i=Array.from(ji.tools.keys()).join(", ");throw new Error(`Tool "${t}" not found. Available tools: ${i}`)}try{return await r.execute(n)}catch(i){throw new Error(`Tool execution failed for "${t}": ${i}`)}}static isAiEnabled(t){return ji.aiEnabledTools.has(t)}static hasToolRegistered(t){return ji.tools.has(t)}static getTool(t){return ji.tools.get(t)}};var de={CREATE_STORYBOARD_FILE:"create_storyboard_file",RENAME_FILE_EXTENSION:"rename_file_extension",TOGGLE_STORYBOARD_VIEW:"toggle_storyboard_view",LOAD_STORYBOARD_DATA:"load_storyboard_data",SAVE_STORYBOARD_DATA:"save_storyboard_data",EXPORT_STORYBOARD_JSON:"export_storyboard_json",CREATE_USD_FILE:"create_usd_file",LOAD_USD_FILE:"load_usd_file",SAVE_USD_FILE:"save_usd_file",CONVERT_MD_TO_USD:"convert_md_to_usd",CONVERT_USD_TO_MD:"convert_usd_to_md",INITIALIZE_TIMING:"initialize_timing",CREATE_PAINTER_FILE:"create_painter_file",LOAD_PAINTER_FILE:"load_painter_file",SAVE_PAINTER_FILE:"save_painter_file",GENERATE_THUMBNAIL:"generate_thumbnail",EXPORT_MERGED_IMAGE:"export_merged_image",UNDO_PAINTER:"undo_painter",REDO_PAINTER:"redo_painter",ADD_LAYER:"add_layer",REMOVE_LAYER:"remove_layer",SET_LAYER_OPACITY:"set_layer_opacity",SET_LAYER_BLEND_MODE:"set_layer_blend_mode",SET_LAYER_CLIPPING:"set_layer_clipping",RENAME_LAYER:"rename_layer",TOGGLE_LAYER_VISIBILITY:"toggle_layer_visibility",GENERATE_TEXT:"generate_text",GENERATE_IMAGE:"generate_image",GENERATE_VIDEO:"generate_video",INPAINT_IMAGE:"inpaint_image",GENERATIVE_FILL:"generative_fill"},ze={STORYBOARD:"storyboard",PAINTER:"painter",TIMELINE:"timeline",MARKDOWN:"markdown"},MS={tools:[{name:de.CREATE_STORYBOARD_FILE,modulePath:"../api/storyboard-tool/create-storyboard-file",exportName:"createStoryboardFileTool",ai_enabled:!1,description:"Create a new storyboard file with sample content",category:ze.STORYBOARD},{name:de.RENAME_FILE_EXTENSION,modulePath:"../api/storyboard-tool/rename-file-extension",exportName:"renameFileExtensionTool",ai_enabled:!1,description:"Rename file extension with collision avoidance",category:ze.STORYBOARD},{name:de.TOGGLE_STORYBOARD_VIEW,modulePath:"../api/storyboard-tool/toggle-storyboard-view",exportName:"toggleStoryboardViewTool",ai_enabled:!1,description:"Toggle between markdown and storyboard view",category:ze.STORYBOARD},{name:de.LOAD_STORYBOARD_DATA,modulePath:"../api/storyboard-tool/load-storyboard-data",exportName:"loadStoryboardDataTool",ai_enabled:!1,description:"Load storyboard data from file",category:ze.STORYBOARD},{name:de.SAVE_STORYBOARD_DATA,modulePath:"../api/storyboard-tool/save-storyboard-data",exportName:"saveStoryboardDataTool",ai_enabled:!1,description:"Save storyboard data to file",category:ze.STORYBOARD},{name:de.EXPORT_STORYBOARD_JSON,modulePath:"../api/storyboard-tool/export-storyboard-json",exportName:"exportStoryboardJsonTool",ai_enabled:!1,description:"Export storyboard data as JSON file",category:ze.STORYBOARD},{name:de.CREATE_USD_FILE,modulePath:"../api/usd-tool/create-usd-file",exportName:"createUsdFileTool",ai_enabled:!1,description:"Create new USD file",category:ze.TIMELINE},{name:de.LOAD_USD_FILE,modulePath:"../api/usd-tool/load-usd-file",exportName:"loadUsdFileTool",ai_enabled:!1,description:"Load USD file",category:ze.TIMELINE},{name:de.SAVE_USD_FILE,modulePath:"../api/usd-tool/save-usd-file",exportName:"saveUsdFileTool",ai_enabled:!1,description:"Save USD file",category:ze.TIMELINE},{name:de.CONVERT_MD_TO_USD,modulePath:"../api/usd-tool/convert-md-to-usd",exportName:"convertMdToUsdTool",ai_enabled:!1,description:"Convert Markdown storyboard to USD stage",category:ze.TIMELINE},{name:de.CONVERT_USD_TO_MD,modulePath:"../api/usd-tool/convert-usd-to-md",exportName:"convertUsdToMdTool",ai_enabled:!1,description:"Convert USD stage to Markdown storyboard",category:ze.TIMELINE},{name:de.INITIALIZE_TIMING,modulePath:"../api/markdown-tool/initialize-timing",exportName:"initializeTimingTool",ai_enabled:!1,description:"Initialize timing information in markdown storyboard",category:ze.MARKDOWN},{name:de.CREATE_PAINTER_FILE,modulePath:"../api/painter-tool/create-painter-file",exportName:"createPainterFileTool",ai_enabled:!1,description:"Create new PSD file",category:ze.PAINTER},{name:de.LOAD_PAINTER_FILE,modulePath:"../api/painter-tool/load-painter-file",exportName:"loadPainterFileTool",ai_enabled:!1,description:"Load PSD file",category:ze.PAINTER},{name:de.SAVE_PAINTER_FILE,modulePath:"../api/painter-tool/save-painter-file",exportName:"savePainterFileTool",ai_enabled:!1,description:"Save PSD file",category:ze.PAINTER},{name:de.EXPORT_MERGED_IMAGE,modulePath:"../api/painter-tool/export-merged-image",exportName:"exportMergedImageTool",ai_enabled:!1,description:"Export merged image as PNG",category:ze.PAINTER},{name:de.GENERATE_THUMBNAIL,modulePath:"../api/painter-tool/generate-thumbnail",exportName:"generateThumbnailTool",ai_enabled:!1,description:"Generate thumbnail from PSD file",category:ze.PAINTER},{name:de.UNDO_PAINTER,modulePath:"../api/painter-tool/undo-painter",exportName:"undoPainterTool",ai_enabled:!1,description:"Undo painter view",category:ze.PAINTER},{name:de.REDO_PAINTER,modulePath:"../api/painter-tool/redo-painter",exportName:"redoPainterTool",ai_enabled:!1,description:"Redo painter view",category:ze.PAINTER},{name:de.ADD_LAYER,modulePath:"../api/layer-tool/add-layer",exportName:"addLayerTool",ai_enabled:!1,description:"Add new layer to painter view (supports fileData)",category:ze.PAINTER},{name:de.REMOVE_LAYER,modulePath:"../api/layer-tool/remove-layer",exportName:"removeLayerTool",ai_enabled:!1,description:"Remove layer from painter view",category:ze.PAINTER},{name:de.SET_LAYER_OPACITY,modulePath:"../api/layer-tool/set-layer-opacity",exportName:"setLayerOpacityTool",ai_enabled:!1,description:"Set layer opacity in painter view",category:ze.PAINTER},{name:de.SET_LAYER_BLEND_MODE,modulePath:"../api/layer-tool/set-layer-blend-mode",exportName:"setLayerBlendModeTool",ai_enabled:!1,description:"Set layer blend mode in painter view",category:ze.PAINTER},{name:de.SET_LAYER_CLIPPING,modulePath:"../api/layer-tool/set-layer-clipping",exportName:"setLayerClippingTool",ai_enabled:!1,description:"Set layer clipping in painter view",category:ze.PAINTER},{name:de.RENAME_LAYER,modulePath:"../api/layer-tool/rename-layer",exportName:"renameLayerTool",ai_enabled:!1,description:"Rename layer in painter view",category:ze.PAINTER},{name:de.TOGGLE_LAYER_VISIBILITY,modulePath:"../api/layer-tool/toggle-layer-visibility",exportName:"toggleLayerVisibilityTool",ai_enabled:!1,description:"Toggle layer visibility in painter view",category:ze.PAINTER},{name:de.GENERATE_TEXT,modulePath:"../api/ai-tool/generate-text",exportName:"generateTextTool",ai_enabled:!1,description:"Generate text via AI agent",category:ze.MARKDOWN},{name:de.GENERATE_IMAGE,modulePath:"../api/ai-tool/generate-image",exportName:"generateImageTool",ai_enabled:!1,description:"Generate image via AI",category:ze.PAINTER},{name:de.GENERATE_VIDEO,modulePath:"../api/ai-tool/generate-video",exportName:"generateVideoTool",ai_enabled:!1,description:"Generate video via AI",category:ze.TIMELINE},{name:de.INPAINT_IMAGE,modulePath:"../api/ai-tool/inpaint-image",exportName:"inpaintImageTool",ai_enabled:!1,description:"Inpaint image via AI",category:ze.PAINTER},{name:de.GENERATIVE_FILL,modulePath:"../api/ai-tool/generative-fill",exportName:"generativeFillTool",ai_enabled:!1,description:"Generative fill via AI",category:ze.PAINTER}],config:{autoRegister:!0,enableLogging:!0,failOnError:!1}};var tx=H(jl(),1),Ed;(i=>{i.CREATE_PAINTER_FILE_METADATA={name:"create_painter_file",description:"Create new PSD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},imageFile:{type:"object",description:"Source image file",nullable:!0}},required:["app"]}};async function r(o){let{app:a,imageFile:s}=o,l=document.createElement("canvas"),u=l.getContext("2d");if(!u)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");if(s){let b=await a.vault.readBinary(s),g=new Blob([b]),p=URL.createObjectURL(g),m=await new Promise((v,x)=>{let w=new Image;w.onload=()=>v(w),w.onerror=x,w.src=p});l.width=m.width,l.height=m.height,u.drawImage(m,0,0),URL.revokeObjectURL(p)}else l.width=800,l.height=600,u.fillStyle="white",u.fillRect(0,0,l.width,l.height);let c={width:l.width,height:l.height,children:[{name:s?s.basename:"Background",hidden:!1,opacity:1,blendMode:"normal",canvas:l,left:0,top:0}],canvas:l},f=tx.writePsd(c,{generateThumbnail:!1}),d=1,h=`untitled-${d}.psd`;for(;a.vault.getAbstractFileByPath(h);)d++,h=`untitled-${d}.psd`;let S={filePath:(await a.vault.createBinary(h,f)).path,message:`PSD\u30D5\u30A1\u30A4\u30EB\u300C${h}\u300D\u3092\u4F5C\u6210\u3057\u307E\u3057\u305F`};return JSON.stringify(S)}i.executeCreatePainterFile=r})(Ed||(Ed={}));var y0={name:"create_painter_file",description:"Create new PSD file",parameters:Ed.CREATE_PAINTER_FILE_METADATA.parameters,execute:Ed.executeCreatePainterFile};var nx=H(jl(),1);function VD(e,t,n){if(typeof document=="undefined"||typeof HTMLCanvasElement=="undefined")return e;let r=document.createElement("canvas");r.width=t,r.height=n;let i=r.getContext("2d");if(!i)return r;if(e&&e.canvas&&typeof HTMLCanvasElement!="undefined"&&e.canvas instanceof HTMLCanvasElement)i.drawImage(e.canvas,0,0);else if(e&&e.canvas&&e.canvas.data)try{let o=new ImageData(new Uint8ClampedArray(e.canvas.data),e.canvas.width||t,e.canvas.height||n);i.putImageData(o,0,0)}catch(o){console.error(o)}else if(e&&e.data)try{let o=new ImageData(new Uint8ClampedArray(e.data),e.width||t,e.height||n);i.putImageData(o,0,0)}catch(o){console.error(o)}else i.fillStyle="white",i.fillRect(0,0,t,n);return r}var Td;(r=>{r.LOAD_PAINTER_FILE_METADATA={name:"load_painter_file",description:"Load PSD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"}},required:["app","file"]}};function t(i,o,a){var u,c;let s=((u=i.canvas)==null?void 0:u.width)||i.width||o,l=((c=i.canvas)==null?void 0:c.height)||i.height||a;return{canvas:VD(i,s,l),width:s,height:l}}async function n(i){let{app:o,file:a}=i,s=await o.vault.readBinary(a),l=nx.readPsd(s),u=(l.children||[]).map((f,d)=>{var g,p,m;let y=t(f,l.width,l.height).canvas,S=typeof HTMLCanvasElement!="undefined",b="";if(S&&y instanceof HTMLCanvasElement)try{b=y.toDataURL("image/png")}catch(v){console.error(v)}return{name:(g=f.name)!=null?g:`Layer ${d}`,visible:!f.hidden,opacity:f.opacity!==void 0?f.opacity:1,blendMode:(p=f.blendMode)!=null?p:"normal",clippingMask:(m=f.clipping)!=null?m:!1,width:l.width,height:l.height,...S?{canvasDataUrl:b}:{canvas:f.canvas}}}),c={width:l.width,height:l.height,layers:u};return JSON.stringify(c)}r.executeLoadPainterFile=n})(Td||(Td={}));var S0={name:"load_painter_file",description:"Load PSD file",parameters:Td.LOAD_PAINTER_FILE_METADATA.parameters,execute:Td.executeLoadPainterFile};var rx=H(jl(),1);function w0(e,t,n){var a,s,l,u;if(typeof HTMLCanvasElement!="undefined"&&e.canvas instanceof HTMLCanvasElement||typeof document=="undefined"||typeof HTMLCanvasElement=="undefined")return e.canvas;let r=document.createElement("canvas");r.width=(s=(a=e.canvas)==null?void 0:a.width)!=null?s:t,r.height=(u=(l=e.canvas)==null?void 0:l.height)!=null?u:n;let i=r.getContext("2d",{willReadFrequently:!0});if(!i)return e.canvas=r,r;let o=e.canvas;if(o&&"data"in o&&o.data instanceof Uint8ClampedArray)try{let c=new ImageData(o.data,r.width,r.height);i.putImageData(c,0,0)}catch(c){i.fillStyle="white",i.fillRect(0,0,r.width,r.height)}else if(o&&"getContext"in o&&typeof o.getContext=="function")try{i.drawImage(o,0,0)}catch(c){console.error(c)}else i.fillStyle="white",i.fillRect(0,0,r.width,r.height);return e.canvas=r,r}var Cd;(n=>{n.SAVE_PAINTER_FILE_METADATA={name:"save_painter_file",description:"Save PSD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"},layers:{type:"array",description:"Layer data"}},required:["app","file","layers"]}};async function t(r){var y,S;let{app:i,file:o,layers:a}=r;if(!a||a.length===0)return"no-op";let s=w0(a[0],((y=a[0].canvas)==null?void 0:y.width)||800,((S=a[0].canvas)==null?void 0:S.height)||600),l=s.width,u=s.height,c=document.createElement("canvas");c.width=l,c.height=u;let f=c.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");f.clearRect(0,0,l,u);for(let b of a)if(b.visible&&b.canvas)try{f.globalAlpha=b.opacity!==void 0?b.opacity:1;let g=b.blendMode==="normal"?"source-over":b.blendMode;f.globalCompositeOperation=g;let p=w0(b,l,u);p instanceof HTMLCanvasElement&&f.drawImage(p,0,0)}catch(g){console.error(g)}let d={width:l,height:u,children:a.map(b=>{let g=w0(b,l,u);return{name:b.name,canvas:g,hidden:!b.visible,opacity:b.opacity,blendMode:b.blendMode,clipping:b.clippingMask||!1,left:0,top:0}}),canvas:c},h=rx.writePsd(d,{generateThumbnail:!1});return await i.vault.modifyBinary(o,h),"saved"}n.executeSavePainterFile=t})(Cd||(Cd={}));var b0={name:"save_painter_file",description:"Save PSD file",parameters:Cd.SAVE_PAINTER_FILE_METADATA.parameters,execute:Cd.executeSavePainterFile};var ix=H(jl(),1),Id;(n=>{n.GENERATE_THUMBNAIL_METADATA={name:"generate_thumbnail",description:"Generate thumbnail from PSD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"PSD file to generate thumbnail from"}},required:["app","file"]}};async function t(r){var a;let{app:i,file:o}=r;try{let s=await i.vault.readBinary(o),l=ix.readPsd(s);if((a=l.imageResources)!=null&&a.thumbnail){if(l.imageResources.thumbnail instanceof HTMLCanvasElement){let c={thumbnailData:l.imageResources.thumbnail.toDataURL("image/jpeg"),message:"\u30B5\u30E0\u30CD\u30A4\u30EB\u53D6\u5F97\u306B\u6210\u529F\u3057\u307E\u3057\u305F"};return JSON.stringify(c)}}else{let c=document.createElement("canvas");c.width=l.width,c.height=l.height;let f=c.getContext("2d");if(!f)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");f.clearRect(0,0,l.width,l.height);let d=[...l.children||[]].reverse();for(let p of d)if(!p.hidden){f.globalAlpha=p.opacity!==void 0?p.opacity:1;let m=p.blendMode==="normal"?"source-over":p.blendMode;f.globalCompositeOperation=m,p.canvas&&f.drawImage(p.canvas,0,0)}let h=document.createElement("canvas"),y=512,S=Math.min(y/l.width,y/l.height);h.width=l.width*S,h.height=l.height*S;let b=h.getContext("2d");if(!b)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");b.drawImage(c,0,0,h.width,h.height);let g={thumbnailData:h.toDataURL("image/jpeg",.8),message:"\u30B5\u30E0\u30CD\u30A4\u30EB\u751F\u6210\u306B\u6210\u529F\u3057\u307E\u3057\u305F"};return JSON.stringify(g)}return JSON.stringify({thumbnailData:null,message:"\u30B5\u30E0\u30CD\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F"})}catch(s){let l={thumbnailData:null,message:"\u30B5\u30E0\u30CD\u30A4\u30EB\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F: "+s.message};return JSON.stringify(l)}}n.executeGenerateThumbnail=t})(Id||(Id={}));var _0={name:"generate_thumbnail",description:"Generate thumbnail from PSD file",parameters:Id.GENERATE_THUMBNAIL_METADATA.parameters,execute:Id.executeGenerateThumbnail};var x0=require("obsidian");function ox(e,t,n){var a,s,l,u;if(typeof HTMLCanvasElement!="undefined"&&e.canvas instanceof HTMLCanvasElement||typeof document=="undefined"||typeof HTMLCanvasElement=="undefined")return e.canvas;let r=document.createElement("canvas");r.width=(s=(a=e.canvas)==null?void 0:a.width)!=null?s:t,r.height=(u=(l=e.canvas)==null?void 0:l.height)!=null?u:n;let i=r.getContext("2d",{willReadFrequently:!0});if(!i)return e.canvas=r,r;let o=e.canvas;if(o&&"data"in o&&o.data instanceof Uint8ClampedArray)try{let c=new ImageData(o.data,r.width,r.height);i.putImageData(c,0,0)}catch(c){i.fillStyle="white",i.fillRect(0,0,r.width,r.height)}else if(o&&"getContext"in o&&typeof o.getContext=="function")try{i.drawImage(o,0,0)}catch(c){console.error(c)}else i.fillStyle="white",i.fillRect(0,0,r.width,r.height);return e.canvas=r,r}var Pd;(r=>{r.EXPORT_MERGED_IMAGE_METADATA={name:"export_merged_image",description:"Export merged image as PNG",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},layers:{type:"array",description:"Layer data"},fileName:{type:"string",description:"File name",nullable:!0}},required:["app","layers"]}};function t(i){let o=i.split(",")[1];return Uint8Array.from(atob(o),a=>a.charCodeAt(0))}async function n(i){var _,E,P,D;let{app:o,layers:a,fileName:s}=i;if(!a||a.length===0)throw new Error("no layers");let l=ox(a[0],((_=a[0].canvas)==null?void 0:_.width)||800,((E=a[0].canvas)==null?void 0:E.height)||600),u=l.width,c=l.height,f=document.createElement("canvas");f.width=u,f.height=c;let d=f.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");d.clearRect(0,0,u,c);for(let M of a)if(M.visible&&M.canvas)try{d.globalAlpha=M.opacity!==void 0?M.opacity:1;let j=M.blendMode==="normal"?"source-over":M.blendMode;d.globalCompositeOperation=j;let N=ox(M,u,c);N instanceof HTMLCanvasElement&&d.drawImage(N,0,0)}catch(j){console.error(j)}let h=f.toDataURL("image/png"),y=t(h),S=((D=(P=o.workspace.getActiveFile())==null?void 0:P.parent)==null?void 0:D.path)||"",b=(0,x0.normalizePath)(`${S}/assets`);try{o.vault.getAbstractFileByPath(b)||await o.vault.createFolder(b)}catch(M){}let g="png",p=s!=null?s:`merged-${Date.now()}.${g}`;p.endsWith(`.${g}`)||(p+=`.${g}`);let m=(0,x0.normalizePath)(`${b}/${p}`),v=1;for(;o.vault.getAbstractFileByPath(m);)m=`${b}/${Date.now()}_${v}.${g}`,v++;let x=await o.vault.createBinary(m,y),w={filePath:x.path,message:`\u753B\u50CF\u3092\u66F8\u304D\u51FA\u3057\u307E\u3057\u305F: ${x.path}`};return JSON.stringify(w)}r.executeExportMergedImage=n})(Pd||(Pd={}));var E0={name:"export_merged_image",description:"Export merged image as PNG",parameters:Pd.EXPORT_MERGED_IMAGE_METADATA.parameters,execute:Pd.executeExportMergedImage};var ax=e=>{let t,n=new Set,r=(u,c)=>{let f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){let d=t;t=(c!=null?c:typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,s={setState:r,getState:i,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u))},l=t=e(r,i,s);return s},sx=e=>e?ax(e):ax;var T0=H(Fe(),1);var GD=e=>e;function HD(e,t=GD){let n=T0.default.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return T0.default.useDebugValue(n),n}var lx=e=>{let t=sx(e),n=r=>HD(t,r);return Object.assign(n,t),n},En=e=>e?lx(e):lx;var jD=e=>(t,n,r)=>{let i=r.subscribe;return r.subscribe=(a,s,l)=>{let u=a;if(s){let c=(l==null?void 0:l.equalityFn)||Object.is,f=a(r.getState());u=d=>{let h=a(d);if(!c(f,h)){let y=f;s(f=h,y)}},l!=null&&l.fireImmediately&&s(f,f)}return i(u)},e(t,n,r)},ux=jD;function WD(e,t){let n;try{n=e()}catch(i){return}return{getItem:i=>{var o;let a=l=>l===null?null:JSON.parse(l,t==null?void 0:t.reviver),s=(o=n.getItem(i))!=null?o:null;return s instanceof Promise?s.then(a):a(s)},setItem:(i,o)=>n.setItem(i,JSON.stringify(o,t==null?void 0:t.replacer)),removeItem:i=>n.removeItem(i)}}var C0=e=>t=>{try{let n=e(t);return n instanceof Promise?n:{then(r){return C0(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return C0(r)(n)}}}},$D=(e,t)=>(n,r,i)=>{let o={storage:WD(()=>localStorage),partialize:S=>S,version:0,merge:(S,b)=>({...b,...S}),...t},a=!1,s=new Set,l=new Set,u=o.storage;if(!u)return e((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...S)},r,i);let c=()=>{let S=o.partialize({...r()});return u.setItem(o.name,{state:S,version:o.version})},f=i.setState;i.setState=(S,b)=>{f(S,b),c()};let d=e((...S)=>{n(...S),c()},r,i);i.getInitialState=()=>d;let h,y=()=>{var S,b;if(!u)return;a=!1,s.forEach(p=>{var m;return p((m=r())!=null?m:d)});let g=((b=o.onRehydrateStorage)==null?void 0:b.call(o,(S=r())!=null?S:d))||void 0;return C0(u.getItem.bind(u))(o.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==o.version){if(o.migrate){let m=o.migrate(p.state,p.version);return m instanceof Promise?m.then(v=>[!0,v]):[!0,m]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var m;let[v,x]=p;if(h=o.merge(x,(m=r())!=null?m:d),n(h,!0),v)return c()}).then(()=>{g==null||g(h,void 0),h=r(),a=!0,l.forEach(p=>p(h))}).catch(p=>{g==null||g(void 0,p)})};return i.persist={setOptions:S=>{o={...o,...S},S.storage&&(u=S.storage)},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:S=>(s.add(S),()=>{s.delete(S)}),onFinishHydration:S=>(l.add(S),()=>{l.delete(S)})},o.skipHydration||y(),h||d},cx=$D;var Ad=class{constructor(t){this.func=t;this.timeout=null;this.saveHistory=[]}execute(...t){let n=Date.now();this.saveHistory=this.saveHistory.filter(i=>n-i<6e4);let r=this.saveHistory.length;if(r===0)this.saveHistory.push(n),this.func(...t);else{let i=Math.min(r,5)*1e3;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.saveHistory.push(Date.now()),this.func(...t)},i)}}getCurrentDelay(){let t=this.saveHistory.filter(n=>Date.now()-n<6e4).length;return Math.min(t,5)*1e3}};var oo=new Ad(async(e,t)=>{if(!(e.length===0||!t||t.extension!=="psd"))try{let n=window.app;n?await le.executeTool("save_painter_file",{app:n,file:t,layers:e}):console.warn("\u26A0\uFE0F Obsidian app\u30A4\u30F3\u30B9\u30BF\u30F3\u30B9\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093")}catch(n){console.error("\u274C \u81EA\u52D5\u4FDD\u5B58\u30A8\u30E9\u30FC:",n)}}),ye=En()(ux((e,t)=>({layers:[],currentPsdFile:null,updateLayers:n=>{e({layers:n});let r=t();r.layers.length>0&&oo.execute(r.layers,r.currentPsdFile)},initializeLayers:n=>{e({layers:n})},addLayer:n=>e(r=>({layers:[...r.layers,n]})),removeLayer:n=>e(r=>({layers:r.layers.filter((i,o)=>o!==n)})),toggleLayerVisibility:n=>{e(i=>({layers:i.layers.map((o,a)=>a===n?{...o,visible:!o.visible}:o)}));let r=t();r.layers.length>0&&oo.execute(r.layers,r.currentPsdFile)},setLayerOpacity:(n,r)=>{e(o=>({layers:o.layers.map((a,s)=>s===n?{...a,opacity:r}:a)}));let i=t();i.layers.length>0&&oo.execute(i.layers,i.currentPsdFile)},setLayerBlendMode:(n,r)=>{e(o=>({layers:o.layers.map((a,s)=>s===n?{...a,blendMode:r}:a)}));let i=t();i.layers.length>0&&oo.execute(i.layers,i.currentPsdFile)},setLayerClippingMask:(n,r)=>{e(o=>({layers:o.layers.map((a,s)=>s===n?{...a,clippingMask:r}:a)}));let i=t();i.layers.length>0&&oo.execute(i.layers,i.currentPsdFile)},renameLayer:(n,r)=>{e(o=>({layers:o.layers.map((a,s)=>s===n?{...a,name:r}:a)}));let i=t();i.layers.length>0&&oo.execute(i.layers,i.currentPsdFile)},clearLayers:()=>e({layers:[],currentPsdFile:null}),setCurrentPsdFile:n=>e({currentPsdFile:n}),clearCurrentPsdFile:()=>e({currentPsdFile:null}),getCurrentSaveDelay:()=>oo.getCurrentDelay(),triggerAutoSave:()=>{let n=t();n.layers.length>0&&oo.execute(n.layers,n.currentPsdFile)}})));var Ye=En(e=>({currentLayerIndex:0,setCurrentLayerIndex:t=>e({currentLayerIndex:t})}));var dt=En((e,t)=>({history:[],currentIndex:-1,maxHistorySize:20,saveHistory:(n,r)=>{let i=t(),a={layers:n.map(l=>{let u=document.createElement("canvas");u.width=l.canvas.width,u.height=l.canvas.height;let c=u.getContext("2d");return c&&c.drawImage(l.canvas,0,0),{...l,canvas:u}}),currentLayerIndex:r,timestamp:Date.now()},s=i.history.slice(0,i.currentIndex+1);s.push(a),s.length>i.maxHistorySize?s.shift():e({currentIndex:i.currentIndex+1}),e({history:s})},undo:()=>{let n=t();if(n.currentIndex>0){let r=n.currentIndex-1;return e({currentIndex:r}),n.history[r]}return null},redo:()=>{let n=t();if(n.currentIndex<n.history.length-1){let r=n.currentIndex+1;return e({currentIndex:r}),n.history[r]}return null},canUndo:()=>t().currentIndex>0,canRedo:()=>{let n=t();return n.currentIndex<n.history.length-1},clearHistory:()=>e({history:[],currentIndex:-1})}));var Dd;(n=>{n.UNDO_PAINTER_METADATA={name:"undo_painter",description:"Undo current painter view",parameters:{type:"object",properties:{},required:[]}};async function t(r){let i=dt.getState();if(!i.canUndo())return"no-undo-available";let o=i.undo();return o?(ye.getState().updateLayers(o.layers),Ye.getState().setCurrentLayerIndex(o.currentLayerIndex),"undo-success"):"undo-failed"}n.executeUndoPainter=t})(Dd||(Dd={}));var I0={name:"undo_painter",description:"Undo current painter view",parameters:Dd.UNDO_PAINTER_METADATA.parameters,execute:Dd.executeUndoPainter};var Ld;(n=>{n.REDO_PAINTER_METADATA={name:"redo_painter",description:"Redo painter view",parameters:{type:"object",properties:{},required:[]}};async function t(r){let i=dt.getState();if(!i.canRedo())return"no-redo-available";let o=i.redo();return o?(ye.getState().updateLayers(o.layers),Ye.getState().setCurrentLayerIndex(o.currentLayerIndex),"redo-success"):"redo-failed"}n.executeRedoPainter=t})(Ld||(Ld={}));var P0={name:"redo_painter",description:"Redo painter view",parameters:Ld.REDO_PAINTER_METADATA.parameters,execute:Ld.executeRedoPainter};var A0;(n=>{n.CREATE_STORYBOARD_FILE_METADATA={name:de.CREATE_STORYBOARD_FILE,description:"Create a new storyboard file with sample content",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"}},required:["app"]}};async function t(r){let{app:i}=r,o=`### calm acoustic guitar, soft piano, peaceful ambient, instrumental

#### 
`;try{let a=1,s=`\u7121\u984C\u306E\u30D5\u30A1\u30A4\u30EB ${a}.board`;for(;i.vault.getAbstractFileByPath(s);)a++,s=`\u7121\u984C\u306E\u30D5\u30A1\u30A4\u30EB ${a}.board`;let u={filePath:(await i.vault.create(s,o)).path,message:`\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u30D5\u30A1\u30A4\u30EB "${s}" \u3092\u4F5C\u6210\u3057\u307E\u3057\u305F`};return JSON.stringify(u)}catch(a){return JSON.stringify({filePath:"",message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u30D5\u30A1\u30A4\u30EB\u306E\u4F5C\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}}n.executeCreateStoryboardFile=t})(A0||(A0={}));var D0={name:de.CREATE_STORYBOARD_FILE,description:"Create a new storyboard file with sample content",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"}},required:["app"]},execute:A0.executeCreateStoryboardFile};var L0;(n=>{n.RENAME_FILE_EXTENSION_METADATA={name:de.RENAME_FILE_EXTENSION,description:"Rename file extension with collision avoidance",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file to rename"},newExt:{type:"string",description:"New file extension"}},required:["app","file","newExt"]}};async function t(r){var f,d;let{app:i,file:o,newExt:a}=r,s=(d=(f=o.parent)==null?void 0:f.path)!=null?d:"",l=o.basename,u=0,c=s&&s!=="/"?`${s}/${l}.${a}`:`${l}.${a}`;for(;i.vault.getAbstractFileByPath(c);)u+=1,c=s&&s!=="/"?`${s}/${l}-${u}.${a}`:`${l}-${u}.${a}`;try{return await i.vault.rename(o,c),JSON.stringify({newPath:c,message:`\u30D5\u30A1\u30A4\u30EB\u62E1\u5F35\u5B50\u3092 ${a} \u306B\u5909\u66F4\u3057\u307E\u3057\u305F`})}catch(h){throw new Error("\u30D5\u30A1\u30A4\u30EB\u62E1\u5F35\u5B50\u306E\u5909\u66F4\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}}n.executeRenameFileExtension=t})(L0||(L0={}));var k0={name:de.RENAME_FILE_EXTENSION,description:"Rename file extension with collision avoidance",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file to rename"},newExt:{type:"string",description:"New file extension"}},required:["app","file","newExt"]},execute:L0.executeRenameFileExtension};var dx=require("obsidian");var R0;(n=>{n.TOGGLE_STORYBOARD_VIEW_METADATA={name:de.TOGGLE_STORYBOARD_VIEW,description:"Toggle between markdown and storyboard view",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},leaf:{type:"object",description:"Target workspace leaf"},factory:{type:"object",description:"Storyboard factory instance"}},required:["app","leaf","factory"]}};async function t(r){var c,f,d,h;let{app:i,leaf:o,factory:a}=r;if(!(o.view instanceof dx.MarkdownView))return"\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u30D3\u30E5\u30FC\u3067\u306F\u3042\u308A\u307E\u305B\u3093";let l=o.view.file;if(!l)return"\u30D5\u30A1\u30A4\u30EB\u304C\u3042\u308A\u307E\u305B\u3093";if(a.getCurrentViewMode(o)==="markdown"){if(l.extension!=="board"){let y=(f=(c=l.parent)==null?void 0:c.path)!=null?f:"",S=l.basename,b=0,g=y&&y!=="/"?`${y}/${S}.board`:`${S}.board`;for(;i.vault.getAbstractFileByPath(g)&&i.vault.getAbstractFileByPath(g)!==l;)b+=1,g=y&&y!=="/"?`${y}/${S}-${b}.board`:`${S}-${b}.board`;if(g!==l.path)try{await i.vault.rename(l,g)}catch(p){console.error(p)}}return await a.switchToStoryboardViewMode(o,i),"\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u30D3\u30E5\u30FC\u306B\u5207\u308A\u66FF\u3048\u307E\u3057\u305F"}else{if(l.extension==="board"){let y=(h=(d=l.parent)==null?void 0:d.path)!=null?h:"",S=l.basename,b=0,g=y&&y!=="/"?`${y}/${S}.md`:`${S}.md`;for(;i.vault.getAbstractFileByPath(g)&&i.vault.getAbstractFileByPath(g)!==l;)b+=1,g=y&&y!=="/"?`${y}/${S}-${b}.md`:`${S}-${b}.md`;if(g!==l.path)try{await i.vault.rename(l,g)}catch(p){console.error(p)}}return a.switchToMarkdownViewMode(o),"\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u30D3\u30E5\u30FC\u306B\u5207\u308A\u66FF\u3048\u307E\u3057\u305F"}}n.executeToggleStoryboardView=t})(R0||(R0={}));var Wl={name:de.TOGGLE_STORYBOARD_VIEW,description:"Toggle between markdown and storyboard view",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},leaf:{type:"object",description:"Target workspace leaf"},factory:{type:"object",description:"Storyboard factory instance"}},required:["app","leaf","factory"]},execute:R0.executeToggleStoryboardView};var M0;(n=>{function e(r){let i=r.split(`
`),o=[],a=!1;for(let g of i){if(g.trim().startsWith("```")){a=!a;continue}a||o.push(g)}let s=o,l={title:"",chapters:[],characters:[]},u=null,c=null,f=!1,d=!1,h=null,y=null;function S(){return{dialogues:"",speaker:"",imageUrl:void 0,imagePrompt:void 0,prompt:void 0,endTime:void 0}}function b(){u&&c&&c.frames.push(u),u=null}for(let g=0;g<s.length;g++){let p=s[g].trimEnd();if(p.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){f=!0,d=!1,c&&(b(),l.chapters.push(c),c=null);continue}if(p.startsWith("### ")){let m=p.replace(/^###\s*/,"");c&&(b(),l.chapters.push(c)),c={bgmPrompt:m,frames:[]},f=!1,d=!0;continue}if(f)if(p.startsWith("####"))h&&l.characters&&l.characters.push(h),h={name:p.replace(/^####\s*/,"").trim(),attributes:{\u8AAC\u660E:""}},y=null;else if(p.startsWith("- ")){let m=p.slice(2).trim();m==="\u8AAC\u660E"?y=m:y=null}else p.startsWith("  - ")&&h&&y==="\u8AAC\u660E"&&(h.attributes.\u8AAC\u660E=p.slice(4).trim());else if(d){if(p.startsWith("####"))b(),u=S(),u.speaker=p.replace(/^####\s*/,"");else if(u){let m=p.match(/^>\s*\[!INFO\]\s*(.*)$/),v=p.match(/^\[(.*)\]\((.*)\)$/);if(m){let w=m[1].trim().match(/start:\s*(\d+(?:\.\d+)?),\s*duration:\s*(\d+(?:\.\d+)?)/);w&&(u.startTime=parseFloat(w[1]),u.duration=parseFloat(w[2]));let _=[];for(;g+1<s.length&&s[g+1].trimStart().startsWith(">");){let E=s[g+1].replace(/^>\s*/,"").trim();E&&_.push(E),g++}_.length>0&&(u.prompt=_.join(`
`))}else v?(u.imagePrompt=v[1],u.imageUrl=v[2]):u.imageUrl||(u.dialogues+=(u.dialogues?`
`:"")+p)}}}return f&&h&&l.characters&&l.characters.push(h),b(),c&&l.chapters.push(c),l}async function t(r){let{app:i,file:o}=r,a=await i.vault.read(o),s=e(a);return JSON.stringify(s)}n.executeLoadStoryboardData=t})(M0||(M0={}));var O0={name:de.LOAD_STORYBOARD_DATA,description:"Load storyboard data from file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"}},required:["app","file"]},execute:M0.executeLoadStoryboardData};var F0;(n=>{function e(r){let i="";return i+=`### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC

`,r.characters&&r.characters.length>0&&r.characters.forEach(o=>{i+=`#### ${o.name}
`,i+=`- \u8AAC\u660E
  - ${o.attributes.\u8AAC\u660E||""}
`}),r.chapters.forEach(o=>{var a;i+=`
### ${(a=o.bgmPrompt)!=null?a:""}

`,o.frames.forEach(s=>{var l,u,c,f;if(i+=`#### ${s.speaker||""}
`,i+=`${s.dialogues||""}
`,(s.imageUrl!==void 0||s.imagePrompt!==void 0)&&(i+=`[${(l=s.imagePrompt)!=null?l:""}](${(u=s.imageUrl)!=null?u:""})
`),s.startTime!==void 0||s.duration!==void 0||s.prompt!==void 0){let d="> [!INFO]";if(s.startTime!==void 0||s.duration!==void 0){let h=(c=s.startTime)!=null?c:0,y=(f=s.duration)!=null?f:0;d+=` start: ${h}, duration: ${y}`}i+=d.trimEnd()+`
`,s.prompt!==void 0&&s.prompt.split(`
`).forEach(h=>{i+=`> ${h}
`})}})}),i.trimEnd()+(r.chapters.some(o=>o.frames.length>0)?`
`:"")}async function t(r){let{app:i,file:o,data:a}=r;try{let s=JSON.parse(a),l=e(s);return await i.vault.modify(o,l),`\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u30D5\u30A1\u30A4\u30EB "${o.name}" \u3092\u4FDD\u5B58\u3057\u307E\u3057\u305F`}catch(s){return"\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u30D5\u30A1\u30A4\u30EB\u306E\u4FDD\u5B58\u306B\u5931\u6557\u3057\u307E\u3057\u305F"}}n.executeSaveStoryboardData=t})(F0||(F0={}));var N0={name:de.SAVE_STORYBOARD_DATA,description:"Save storyboard data to file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"},data:{type:"string",description:"Storyboard data as JSON string"}},required:["app","file","data"]},execute:F0.executeSaveStoryboardData};var U0=require("obsidian");var B0;(n=>{function e(r){let i=r.split(`
`),o=[],a=!1;for(let g of i){if(g.trim().startsWith("```")){a=!a;continue}a||o.push(g)}let s=o,l={title:"",chapters:[],characters:[]},u=null,c=null,f=!1,d=!1,h=null,y=null;function S(){return{dialogues:"",speaker:"",imageUrl:void 0,imagePrompt:void 0,prompt:void 0,endTime:void 0}}function b(){u&&c&&c.frames.push(u),u=null}for(let g=0;g<s.length;g++){let p=s[g].trimEnd();if(p.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){f=!0,d=!1,c&&(b(),l.chapters.push(c),c=null);continue}if(p.startsWith("### ")){let m=p.replace(/^###\s*/,"");c&&(b(),l.chapters.push(c)),c={bgmPrompt:m,frames:[]},f=!1,d=!0;continue}if(f)if(p.startsWith("####"))h&&l.characters&&l.characters.push(h),h={name:p.replace(/^####\s*/,"").trim(),attributes:{\u8AAC\u660E:""}},y=null;else if(p.startsWith("- ")){let m=p.slice(2).trim();m==="\u8AAC\u660E"?y=m:y=null}else p.startsWith("  - ")&&h&&y==="\u8AAC\u660E"&&(h.attributes.\u8AAC\u660E=p.slice(4).trim());else if(d){if(p.startsWith("####"))b(),u=S(),u.speaker=p.replace(/^####\s*/,"");else if(u){let m=p.match(/^>\s*\[!INFO\]\s*(.*)$/),v=p.match(/^\[(.*)\]\((.*)\)$/);if(m){let w=m[1].trim().match(/start:\s*(\d+(?:\.\d+)?),\s*duration:\s*(\d+(?:\.\d+)?)/);w&&(u.startTime=parseFloat(w[1]),u.duration=parseFloat(w[2]));let _=[];for(;g+1<s.length&&s[g+1].trimStart().startsWith(">");){let E=s[g+1].replace(/^>\s*/,"").trim();E&&_.push(E),g++}_.length>0&&(u.prompt=_.join(`
`))}else v?(u.imagePrompt=v[1],u.imageUrl=v[2]):u.imageUrl||(u.dialogues+=(u.dialogues?`
`:"")+p)}}}return f&&h&&l.characters&&l.characters.push(h),b(),c&&l.chapters.push(c),l}async function t(r){var S;let{app:i,file:o}=r,a=await i.vault.read(o),s=e(a),l=((S=o.parent)==null?void 0:S.path)||"",u=o.basename,c=0,f=l?(0,U0.normalizePath)(`${l}/${u}.json`):`${u}.json`;for(;i.vault.getAbstractFileByPath(f);)c+=1,f=l?(0,U0.normalizePath)(`${l}/${u}-${c}.json`):`${u}-${c}.json`;let d=JSON.stringify(s,null,2),h=await i.vault.create(f,d),y={filePath:h.path,message:`\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9\u3092JSON\u3068\u3057\u3066\u66F8\u304D\u51FA\u3057\u307E\u3057\u305F: ${h.name}`};return JSON.stringify(y)}n.executeExportStoryboardJson=t})(B0||(B0={}));var z0={name:de.EXPORT_STORYBOARD_JSON,description:"Export storyboard data as JSON file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target storyboard file"}},required:["app","file"]},execute:B0.executeExportStoryboardJson};var V0=require("obsidian");var G0;(n=>{function e(){return`#usda 1.0
(
    defaultPrim = "Main Stage"
    upAxis = "Y"
    metersPerUnit = 1
    timeCodesPerSecond = 30
)

def Xform "Main Stage" {
}`}async function t(r){let{app:i,filename:o="untitled"}=r,a=o.endsWith(".usda")?o.slice(0,-5):o,s=1,l=(0,V0.normalizePath)(`${a}.usda`);for(;i.vault.getAbstractFileByPath(l);)l=(0,V0.normalizePath)(`${a} ${s}.usda`),s++;let u=e(),c=await i.vault.create(l,u),f={filePath:c.path,message:`USD\u30D5\u30A1\u30A4\u30EB\u300C${c.name}\u300D\u3092\u4F5C\u6210\u3057\u307E\u3057\u305F`};return JSON.stringify(f)}n.executeCreateUsdFile=t})(G0||(G0={}));var H0={name:de.CREATE_USD_FILE,description:"Create new USD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},filename:{type:"string",description:"Base file name",nullable:!0}},required:["app"]},execute:G0.executeCreateUsdFile};var j0;(r=>{function e(i){let o=i.match(/customLayerData\s*=\s*\{([\s\S]*?)\}/);if(!o)return null;let s=o[1].match(/string\s+originalContent\s*=\s*"((?:[^"\\]|\\.)*)"/);return s?s[1].replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\"):null}function t(){return`#usda 1.0
(
    defaultPrim = "Main Stage"
    upAxis = "Y"
    metersPerUnit = 1
    timeCodesPerSecond = 30
)

def Xform "Main Stage" {
}`}async function n(i){let{app:o,file:a}=i,s=await o.vault.read(a);return s.trim()||(s=t(),await o.vault.modify(a,s)),s}r.executeLoadUsdFile=n})(j0||(j0={}));var W0={name:de.LOAD_USD_FILE,description:"Load USD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"}},required:["app","file"]},execute:j0.executeLoadUsdFile};var $0;(t=>{async function e(n){let{app:r,file:i,content:o}=n;return await r.vault.modify(i,o),"saved"}t.executeSaveUsdFile=e})($0||($0={}));var X0={name:de.SAVE_USD_FILE,description:"Save USD file",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target file"},content:{type:"string",description:"USDA file content"}},required:["app","file","content"]},execute:$0.executeSaveUsdFile};var fx=require("obsidian");var ss=class{static removeUsdaBlocks(t){let n=t.split(`
`),r=[],i=!1;for(let o of n){if(o.trim()==="```usda"||o.trim()==="```json"){i=!0;continue}if(i&&o.trim()==="```"){i=!1;continue}i||r.push(o)}return r.join(`
`).trim()}static generateUsdaContent(t){return this.isTimelineProject(t)?this.generateTimelineUsdaContent(t):this.generateModernUsdaContent(t)}static isTimelineProject(t){return"stage"in t&&"tracks"in t.stage}static generateModernUsdaContent(t){let n=[];if(n.push("#usda 1.0"),n.push("("),n.push('    defaultPrim = "Root"'),t.stage.layerMetadata.upAxis&&n.push(`    upAxis = "${t.stage.layerMetadata.upAxis}"`),t.stage.layerMetadata.metersPerUnit&&n.push(`    metersPerUnit = ${t.stage.layerMetadata.metersPerUnit}`),t.stage.layerMetadata.timeCodesPerSecond&&n.push(`    timeCodesPerSecond = ${t.stage.layerMetadata.timeCodesPerSecond}`),t.applicationMetadata.sourceMarkdown){n.push("    customLayerData = {");let r=t.applicationMetadata.sourceMarkdown.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n");n.push(`        string originalContent = "${r}"`),n.push("    }")}return n.push(")"),n.push(""),n.push(...this.generatePrimContent(t.stage.rootPrim,0)),n.join(`
`)}static generateTimelineUsdaContent(t){let n=[];if(n.push("#usda 1.0"),n.push("("),n.push('    defaultPrim = "Root"'),n.push(`    timeCodesPerSecond = ${t.stage.timeCodesPerSecond}`),t.applicationMetadata.sourceMarkdown){n.push("    customLayerData = {");let r=t.applicationMetadata.sourceMarkdown.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n");n.push(`        string originalContent = "${r}"`),n.push("    }")}return n.push(")"),n.push(""),n.push('def Xform "Root" {'),t.stage.tracks.forEach(r=>{n.push(...this.generateSimpleTrackPrim(r,1))}),n.push("}"),n.join(`
`)}static generateSimpleTrackPrim(t,n){let r="    ".repeat(n),i=[];return i.push(`${r}def Xform "${t.name}" {`),t.trackType&&i.push(`${r}    string trackType = "${t.trackType}"`),t.clips.forEach(o=>{i.push(...this.generateSimpleClipPrim(o,n+1))}),i.push(`${r}}`),i}static generateSimpleClipPrim(t,n){let r="    ".repeat(n),i=[];return i.push(`${r}def Xform "${t.name}" {`),t.clipType&&i.push(`${r}    string clipType = "${t.clipType}"`),t.assetPath&&i.push(`${r}    asset assetPath = @${t.assetPath}@`),i.push(`${r}    double startTime = ${t.startTime}`),i.push(`${r}    double duration = ${t.duration}`),i.push(`${r}}`),i}static generatePrimContent(t,n){let r="    ".repeat(n),i=[],o=t.typeName||"Xform",a=t.path.split("/").pop()||"Unnamed";return i.push(`${r}${t.specifier} ${o} "${a}" {`),Object.entries(t.attributes).forEach(([s,l])=>{if(l.value!==void 0){let u=this.formatAttributeValue(l.value,l.typeName);i.push(`${r}    ${l.typeName} ${s} = ${u}`)}}),t.children.forEach(s=>{i.push(...this.generatePrimContent(s,n+1))}),i.push(`${r}}`),i}static formatAttributeValue(t,n){return n==="string"||n==="token"?`"${t}"`:n==="asset"?`@${t}@`:Array.isArray(t)?`[${t.map(r=>typeof r=="string"?`"${r}"`:String(r)).join(", ")}]`:String(t)}static generateTrackPrim(t,n){let r="    ".repeat(n),i=[];return i.push(`${r}def Xform "${t.name}" {`),t.trackType&&i.push(`${r}    string trackType = "${t.trackType}"`),t.clips.forEach(o=>{i.push(...this.generateClipPrim(o,n+1))}),i.push(`${r}}`),i}static generateClipPrim(t,n){let r="    ".repeat(n),i=[];return i.push(`${r}def Xform "${t.name}" {`),t.clipType&&i.push(`${r}    string clipType = "${t.clipType}"`),t.assetPath&&i.push(`${r}    asset assetPath = @${t.assetPath}@`),i.push(`${r}    double startTime = ${t.startTime}`),i.push(`${r}    double duration = ${t.duration}`),i.push(`${r}}`),i}static parseUsdaContent(t){return{USD_SCHEMA:"Stage.1",schema_version:1,name:"Parsed Project",stage:{name:"Main Stage",type:"Stage",tracks:[],global_start_time:{value:0,rate:30},global_end_time:{value:0,rate:30},metadata:{}},metadata:{timeCodesPerSecond:30,resolution:{width:1920,height:1080},upAxis:"Y",metersPerUnit:1}}}};var Y0;(n=>{function e(r){return{schemaIdentifier:"usd",schemaVersion:"1.0",name:"Converted Project",stage:{rootPrim:{path:"/Root",typeName:"Xform",specifier:"def",attributes:{},relationships:{},children:[],metadata:{}},layerMetadata:{defaultPrim:"Root",upAxis:"Y",metersPerUnit:1,timeCodesPerSecond:30,startTimeCode:0,endTimeCode:0},timeCodesPerSecond:30,startTimeCode:0,endTimeCode:0},applicationMetadata:{version:"1.0",creator:"Obsidian Storyboard",resolution:{width:1920,height:1080},sourceMarkdown:r}}}async function t(r){var w;let{app:i,file:o}=r;await le.executeTool("initialize_timing",{app:i,file:o});let s=(await i.vault.read(o)).split(`
`),l=[],u=[],c=!1;for(let _=0;_<s.length;_++){let E=s[_];if(E.trim()==="```usda"){c=!0;continue}if(c&&E.trim()==="```"){c=!1;continue}c?u.push(E):l.push(E)}let d=l.join(`
`).trim(),h=u.join(`
`).trim(),y=e(d),S=ss.generateUsdaContent(y),b=((w=o.parent)==null?void 0:w.path)||"",g=o.basename,p=b?(0,fx.normalizePath)(`${b}/${g}.usda`):`${g}.usda`,m=S;await i.vault.delete(o);let v=await i.vault.create(p,m),x={filePath:v.path,message:`\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u3092USD\u306B\u5909\u63DB\u3057\u307E\u3057\u305F: ${v.name}`};return JSON.stringify(x)}n.executeConvertMdToUsd=t})(Y0||(Y0={}));var K0={name:"convert_md_to_usd",description:"Convert Markdown storyboard to USD stage",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Source markdown file"}},required:["app","file"]},execute:Y0.executeConvertMdToUsd};var $l=require("obsidian"),Z0;(o=>{function e(a){let s=a.replace(/\s/g,"").length;return Math.max(s*.2,2)}function t(a){let s=a.split(`
`),l=[],u=!1;for(let c of s){if(c.trim()==="```usda"||c.trim()==="```json"){u=!0;continue}if(u&&c.trim()==="```"){u=!1;continue}u||l.push(c)}return l.join(`
`).trim()}function n(a){let s=a.split(`
`),l=0,u=!1,c=null,f=[];for(let d=0;d<s.length;d++){let h=s[d];if(h.startsWith("### ")&&!h.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){u=!0,l=0,f.push(h);continue}if(h.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){u=!1,f.push(h);continue}if(u){if(h.startsWith("#### ")){c={dialogues:"",hasInfo:!1},f.push(h);continue}let y=h.match(/^>\s*\[!INFO\]\s*(.*)$/);if(y&&c){let S=y[1].trim(),b=c.dialogues?e(c.dialogues):2,g=`> [!INFO] start: ${l}, duration: ${b}`;for(f.push(g),c.hasInfo=!0,l+=b,S&&!S.match(/start:\s*\d+.*duration:\s*\d+/)&&S.split(`
`).forEach(m=>{m.trim()&&f.push(`> ${m.trim()}`)});d+1<s.length&&s[d+1].trimStart().startsWith(">");){d++;let p=s[d].replace(/^>\s*/,"").trim();p&&f.push(`> ${p}`)}continue}c&&!h.startsWith(">")&&h.trim()&&(h.match(/^\[(.*)\]\((.*)\)$/)||(c.dialogues+=(c.dialogues?`
`:"")+h))}f.push(h)}return f.join(`
`)}function r(a){let s=a.match(/customLayerData\s*=\s*\{([\s\S]*?)\}/);if(!s)return{markdown:"",cleanUsda:a};let u=s[1].match(/string\s+originalContent\s*=\s*"((?:[^"\\]|\\.)*)"/),c="";u&&(c=u[1].replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));let f=a.split(`
`),d=[],h=!1,y=0;for(let b of f){if(b.trim().startsWith("customLayerData")){h=!0,y=0;for(let p of b)p==="{"&&y++,p==="}"&&y--;y<=0&&(h=!1);continue}if(h){for(let p of b)p==="{"&&y++,p==="}"&&y--;y<=0&&(h=!1);continue}d.push(b)}let S=d.join(`
`);return{markdown:c,cleanUsda:S}}async function i(a){var p,m;let{app:s,file:l}=a,u=await s.vault.read(l),{markdown:c,cleanUsda:f}=r(u),d="";if(c&&c.trim()!==""){let v=t(c);d=n(v)}else{let v=((p=l.parent)==null?void 0:p.path)||"",x=l.basename,w=v?(0,$l.normalizePath)(`${v}/${x}.md`):`${x}.md`,_=s.vault.getAbstractFileByPath(w);if(_ instanceof $l.TFile)try{let E=await s.vault.read(_);d=t(E),d=n(d)}catch(E){console.error("Failed to read existing markdown file:",E),d=`# \u65B0\u3057\u3044\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9

### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC

### \u30C1\u30E3\u30D7\u30BF\u30FC1`}else d=`# \u65B0\u3057\u3044\u30B9\u30C8\u30FC\u30EA\u30FC\u30DC\u30FC\u30C9

### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC

### \u30C1\u30E3\u30D7\u30BF\u30FC1`}d+="\n\n```usda\n",d+=f,d+="\n```";let h=((m=l.parent)==null?void 0:m.path)||"",y=l.basename,S=h?(0,$l.normalizePath)(`${h}/${y}.md`):`${y}.md`;await s.vault.delete(l);let b=await s.vault.create(S,d),g={filePath:b.path,message:`USD\u3092\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u306B\u5909\u63DB\u3057\u307E\u3057\u305F: ${b.name}`};return JSON.stringify(g)}o.executeConvertUsdToMd=i})(Z0||(Z0={}));var q0={name:"convert_usd_to_md",description:"Convert USD stage to Markdown storyboard",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Source USD file"}},required:["app","file"]},execute:Z0.executeConvertUsdToMd};var J0;(r=>{function e(i){let o=i.replace(/\s/g,"").length;return Math.max(o*.2,2)}function t(i){let o=i.split(`
`),a=0,s=!1,l=null,u=[];for(let c=0;c<o.length;c++){let f=o[c];if(f.startsWith("### ")&&!f.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){s=!0,a=0,u.push(f);continue}if(f.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){s=!1,u.push(f);continue}if(s){if(f.startsWith("#### ")){l={dialogues:"",hasInfo:!1},u.push(f);continue}let d=f.match(/^>\s*\[!INFO\]\s*(.*)$/);if(d&&l){let h=d[1].trim(),y=l.dialogues?e(l.dialogues):2,S=`> [!INFO] start: ${a}, duration: ${y}`;for(u.push(S),l.hasInfo=!0,a+=y,h&&!h.match(/start:\s*\d+.*duration:\s*\d+/)&&h.split(`
`).forEach(g=>{g.trim()&&u.push(`> ${g.trim()}`)});c+1<o.length&&o[c+1].trimStart().startsWith(">");){c++;let b=o[c].replace(/^>\s*/,"").trim();b&&u.push(`> ${b}`)}continue}l&&!f.startsWith(">")&&f.trim()&&(f.match(/^\[(.*)\]\((.*)\)$/)||(l.dialogues+=(l.dialogues?`
`:"")+f))}u.push(f)}return u.join(`
`)}async function n(i){let{app:o,file:a}=i,s=await o.vault.read(a),l=t(s);return await o.vault.modify(a,l),`\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u30D5\u30A1\u30A4\u30EB "${a.name}" \u306E\u6642\u9593\u60C5\u5831\u3092\u521D\u671F\u5316\u3057\u307E\u3057\u305F`}r.executeInitializeTiming=n})(J0||(J0={}));var px={name:"initialize_timing",description:"Initialize timing information in markdown storyboard",parameters:{type:"object",properties:{app:{type:"object",description:"Obsidian app instance"},file:{type:"object",description:"Target markdown file"}},required:["app","file"]},execute:J0.executeInitializeTiming};var kd;(i=>{i.ADD_LAYER_METADATA={name:"add_layer",description:"Create and add new layer",parameters:{type:"object",properties:{name:{type:"string",description:"Layer name",nullable:!0},imageFile:{type:"object",description:"Image file",nullable:!0},fileData:{type:"object",description:"Image data",nullable:!0},width:{type:"number",description:"Canvas width",default:800},height:{type:"number",description:"Canvas height",default:600},app:{type:"object",description:"Obsidian app instance",nullable:!0}},required:[]}};let t=800,n=600;async function r(o){let{name:a="New Layer",imageFile:s,fileData:l,width:u=t,height:c=n,app:f}=o,d=ye.getState(),h=Ye.getState();dt.getState().saveHistory(d.layers,h.currentLayerIndex);let S=document.createElement("canvas");S.width=u,S.height=c;let b=S.getContext("2d");if(!b)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");let g;if(s&&f?g=await f.vault.readBinary(s):l&&(l instanceof Blob?g=await l.arrayBuffer():g=l),g){let m=new Blob([g]),v=URL.createObjectURL(m),x=await new Promise((E,P)=>{let D=new Image;D.onload=()=>E(D),D.onerror=P,D.src=v}),w=(S.width-x.width)/2,_=(S.height-x.height)/2;b.drawImage(x,w,_),URL.revokeObjectURL(v)}else b.fillStyle="transparent",b.fillRect(0,0,S.width,S.height);let p={name:a,visible:!0,opacity:1,blendMode:"normal",canvas:S};return d.addLayer(p),"layer_added"}i.executeAddLayer=r})(kd||(kd={}));var Q0={name:"add_layer",description:"Create and add new layer",parameters:kd.ADD_LAYER_METADATA.parameters,execute:kd.executeAddLayer};var Rd;(n=>{n.REMOVE_LAYER_METADATA={name:"remove_layer",description:"Remove layer at specified index",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index to remove"}},required:["index"]}};async function t(r){let{index:i}=r,o=ye.getState(),a=Ye.getState(),s=dt.getState(),l=o.layers,u=a.currentLayerIndex;if(l.length<=1||i<0||i>=l.length)return"no-op";s.saveHistory(l,u),o.removeLayer(i);let c=u;return c>=l.length-1&&(c=l.length-2),a.setCurrentLayerIndex(c),"layer_removed"}n.executeRemoveLayer=t})(Rd||(Rd={}));var eg={name:"remove_layer",description:"Remove layer at specified index",parameters:Rd.REMOVE_LAYER_METADATA.parameters,execute:Rd.executeRemoveLayer};var Md;(n=>{n.SET_LAYER_OPACITY_METADATA={name:"set_layer_opacity",description:"Set layer opacity",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index"},opacity:{type:"number",description:"Opacity value (0-1)"}},required:["index","opacity"]}};async function t(r){let{index:i,opacity:o}=r,a=ye.getState().layers;return i<0||i>=a.length?"no-op":(ye.getState().setLayerOpacity(i,o),"layer_opacity_set")}n.executeSetLayerOpacity=t})(Md||(Md={}));var tg={name:"set_layer_opacity",description:"Set layer opacity",parameters:Md.SET_LAYER_OPACITY_METADATA.parameters,execute:Md.executeSetLayerOpacity};var Od;(n=>{n.SET_LAYER_BLEND_MODE_METADATA={name:"set_layer_blend_mode",description:"Set layer blend mode",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index"},blendMode:{type:"string",description:"Blend mode (normal, multiply, screen, etc.)"}},required:["index","blendMode"]}};async function t(r){let{index:i,blendMode:o}=r,a=ye.getState().layers;return i<0||i>=a.length?"no-op":(ye.getState().setLayerBlendMode(i,o),"layer_blend_mode_set")}n.executeSetLayerBlendMode=t})(Od||(Od={}));var ng={name:"set_layer_blend_mode",description:"Set layer blend mode",parameters:Od.SET_LAYER_BLEND_MODE_METADATA.parameters,execute:Od.executeSetLayerBlendMode};var Fd;(n=>{n.SET_LAYER_CLIPPING_METADATA={name:"set_layer_clipping",description:"Set layer clipping mask",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index"},clippingMask:{type:"boolean",description:"Enable clipping"}},required:["index","clippingMask"]}};async function t(r){let{index:i,clippingMask:o}=r,a=ye.getState().layers;return i<0||i>=a.length?"no-op":(ye.getState().setLayerClippingMask(i,o),"layer_clipping_set")}n.executeSetLayerClipping=t})(Fd||(Fd={}));var rg={name:"set_layer_clipping",description:"Set layer clipping mask",parameters:Fd.SET_LAYER_CLIPPING_METADATA.parameters,execute:Fd.executeSetLayerClipping};var Nd;(n=>{n.RENAME_LAYER_METADATA={name:"rename_layer",description:"Rename layer",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index"},name:{type:"string",description:"New layer name"}},required:["index","name"]}};async function t(r){let{index:i,name:o}=r,a=ye.getState(),s=Ye.getState(),l=dt.getState(),u=a.layers;return i<0||i>=u.length?"no-op":(l.saveHistory(u,s.currentLayerIndex),a.renameLayer(i,o),"layer_renamed")}n.executeRenameLayer=t})(Nd||(Nd={}));var ig={name:"rename_layer",description:"Rename layer",parameters:Nd.RENAME_LAYER_METADATA.parameters,execute:Nd.executeRenameLayer};var Ud;(n=>{n.TOGGLE_LAYER_VISIBILITY_METADATA={name:"toggle_layer_visibility",description:"Toggle layer visibility",parameters:{type:"object",properties:{index:{type:"number",description:"Layer index"}},required:["index"]}};async function t(r){let{index:i}=r,o=ye.getState().layers;return i<0||i>=o.length?"no-op":(ye.getState().toggleLayerVisibility(i),"layer_visibility_toggled")}n.executeToggleLayerVisibility=t})(Ud||(Ud={}));var og={name:"toggle_layer_visibility",description:"Toggle layer visibility",parameters:Ud.TOGGLE_LAYER_VISIBILITY_METADATA.parameters,execute:Ud.executeToggleLayerVisibility};function hx(e){var t,n,r;return{apiKey:e.apiKey,instructions:(t=e.instructions)!=null?t:"You are a helpful assistant.",model:(n=e.model)!=null?n:"gpt-4o",tools:(r=e.tools)!=null?r:[],history:[]}}async function mx(e,t){let n=await fetch("https://api.fal.ai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok)throw new Error(`fal.ai API error: ${n.status} ${await n.text()}`);return await n.json()}function YD(e){return e.map(({role:t,content:n,name:r,attachments:i})=>{if(i&&i.length>0){let o=[];n&&o.push({type:"text",text:n});for(let a of i)o.push({type:"text",text:`[${a.type}]`}),o.push({type:"image_url",image_url:{url:a.url}});return{role:t,content:o,name:r}}return{role:t,content:n,name:r}})}function KD(e){return e.tools.map(t=>({name:t.name,description:t.description,parameters:t.parameters}))}async function gx(e,t,n=[]){var s,l,u,c;let r=[{role:"system",content:e.instructions},...e.history,{role:"user",content:t,attachments:n}],i={model:e.model,messages:YD(r),max_tokens:512,temperature:.8};e.tools.length&&Object.assign(i,{functions:KD(e),function_call:"auto"});let a=(l=(s=(await mx(e.apiKey,i)).choices)==null?void 0:s[0])==null?void 0:l.message;return a&&(e.history.push({role:"user",content:t,attachments:n}),e.history.push(a)),{finalOutput:(c=(u=a==null?void 0:a.content)==null?void 0:u.trim())!=null?c:null,history:e.history}}var Bd;(n=>{n.GENERATE_TEXT_METADATA={name:"generate_text",description:"Generate text response from AI agent",parameters:{type:"object",properties:{apiKey:{type:"string",description:"API key"},provider:{type:"string",description:"Service provider"},instructions:{type:"string",description:"System instructions",nullable:!0},model:{type:"string",description:"Model name",nullable:!0},message:{type:"string",description:"User message"},history:{type:"array",description:"Chat history",nullable:!0},attachments:{type:"array",description:"Image attachments",nullable:!0},tools:{type:"array",description:"Tools",nullable:!0}},required:["apiKey","provider","message"]}};async function t(r){let{message:i,history:o=[],attachments:a=[],...s}=r,l=hx(s);l.history=o;let u=await gx(l,i,a),c={text:u.finalOutput,history:u.history};return JSON.stringify(c)}n.executeGenerateText=t})(Bd||(Bd={}));var ag={name:"generate_text",description:"Generate text response from AI agent",parameters:Bd.GENERATE_TEXT_METADATA.parameters,execute:Bd.executeGenerateText};var vx=require("obsidian"),zd;(n=>{n.GENERATE_IMAGE_METADATA={name:"generate_image",description:"Generate image via AI and save to assets",parameters:{type:"object",properties:{prompt:{type:"string",description:"Prompt text"},apiKey:{type:"string",description:"API key"},app:{type:"object",description:"Obsidian app instance"},fileName:{type:"string",description:"File name",nullable:!0}},required:["prompt","apiKey","app"]}};async function t(r){var w,_;let{prompt:i,apiKey:o,app:a,fileName:s}=r,l="https://api.fal.ai/v1/predictions",u=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({version:"stable-diffusion",input:{prompt:i}})});if(!u.ok)throw new Error(`fal.ai API \u30A8\u30E9\u30FC: ${u.status} ${await u.text()}`);let c=await u.json(),f;for(;;){let P=await(await fetch(`${l}/${c.id}`,{headers:{Authorization:`Bearer ${o}`}})).json();if(P.status==="succeeded"){f=P.output[0];break}else if(P.status==="failed")throw new Error("\u753B\u50CF\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F");await new Promise(D=>setTimeout(D,1e3))}let d=f;if(!d)throw new Error("\u753B\u50CF\u30C7\u30FC\u30BF\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F");let h=Uint8Array.from(atob(d),E=>E.charCodeAt(0)),y=((_=(w=a.workspace.getActiveFile())==null?void 0:w.parent)==null?void 0:_.path)||"",S=(0,vx.normalizePath)(`${y}/assets`),b="png",g=s!=null?s:`generated-${Date.now()}.${b}`;g.endsWith(`.${b}`)||(g+=`.${b}`);let p=`${S}/${g}`;try{a.vault.getAbstractFileByPath(S)||await a.vault.createFolder(S)}catch(E){}let m=1;for(;a.vault.getAbstractFileByPath(p);)p=`${S}/${Date.now()}_${m}.${b}`,m++;let v=await a.vault.createBinary(p,h),x={filePath:v.path,message:`\u753B\u50CF\u3092\u751F\u6210\u3057\u307E\u3057\u305F: ${v.path}`};return JSON.stringify(x)}n.executeGenerateImage=t})(zd||(zd={}));var sg={name:"generate_image",description:"Generate image via AI and save to assets",parameters:zd.GENERATE_IMAGE_METADATA.parameters,execute:zd.executeGenerateImage};var yx=require("obsidian"),Vd;(n=>{n.GENERATE_VIDEO_METADATA={name:"generate_video",description:"Generate video via AI and save to assets",parameters:{type:"object",properties:{prompt:{type:"string",description:"Prompt text"},apiKey:{type:"string",description:"API key"},app:{type:"object",description:"Obsidian app instance"},fileName:{type:"string",description:"File name",nullable:!0}},required:["prompt","apiKey","app"]}};async function t(r){var x,w,_,E;let{prompt:i,apiKey:o,app:a,fileName:s}=r,u=await fetch("https://api.fal.ai/v1/videos/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({prompt:i,n:1,response_format:"b64_json"})});if(!u.ok)throw new Error(`fal.ai \u52D5\u753B\u751F\u6210API\u30A8\u30E9\u30FC: ${u.status} ${await u.text()}`);let c=await u.json(),f=(w=(x=c==null?void 0:c.data)==null?void 0:x[0])==null?void 0:w.b64_json;if(!f)throw new Error("\u52D5\u753B\u30C7\u30FC\u30BF\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F");let d=Uint8Array.from(atob(f),P=>P.charCodeAt(0)),h=((E=(_=a.workspace.getActiveFile())==null?void 0:_.parent)==null?void 0:E.path)||"",y=(0,yx.normalizePath)(`${h}/assets`),S="mp4",b=s!=null?s:`generated-${Date.now()}.${S}`;b.endsWith(`.${S}`)||(b+=`.${S}`);let g=`${y}/${b}`;try{a.vault.getAbstractFileByPath(y)||await a.vault.createFolder(y)}catch(P){}let p=1;for(;a.vault.getAbstractFileByPath(g);)g=`${y}/${Date.now()}_${p}.${S}`,p++;let m=await a.vault.createBinary(g,d),v={filePath:m.path,message:`\u52D5\u753B\u3092\u751F\u6210\u3057\u307E\u3057\u305F: ${m.path}`};return JSON.stringify(v)}n.executeGenerateVideo=t})(Vd||(Vd={}));var lg={name:"generate_video",description:"Generate video via AI and save to assets",parameters:Vd.GENERATE_VIDEO_METADATA.parameters,execute:Vd.executeGenerateVideo};var Sx=require("obsidian"),Gd;(i=>{function e(o){let a=o.includes(",")?o.split(",")[1]:o;return Uint8Array.from(atob(a),s=>s.charCodeAt(0))}function t(o,a){return new File([e(o)],a,{type:"image/png"})}i.INPAINT_IMAGE_METADATA={name:"inpaint_image",description:"Edit image with attachments and save to assets",parameters:{type:"object",properties:{prompt:{type:"string",description:"Prompt text"},apiKey:{type:"string",description:"API key"},app:{type:"object",description:"Obsidian app instance"},fileName:{type:"string",description:"File name",nullable:!0},image:{type:"string",description:"Base64 image",nullable:!0},mask:{type:"string",description:"Base64 mask",nullable:!0},reference:{type:"string",description:"Reference image",nullable:!0}},required:["prompt","apiKey","app"]}};async function r(o){var M,j,N;let{prompt:a,apiKey:s,app:l,fileName:u,image:c,mask:f,reference:d}=o,h=new FormData;h.append("prompt",a),h.append("n","1"),h.append("size","1024x1024"),h.append("response_format","b64_json"),c&&h.append("image",t(c,"image.png")),f&&h.append("mask",t(f,"mask.png")),d&&h.append("reference_image",t(d,"ref.png"));let S=await fetch("https://api.fal.ai/v1/predictions",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:h});if(!S.ok)throw new Error(`fal.ai API \u30A8\u30E9\u30FC: ${S.status} ${await S.text()}`);let b=await S.json(),g=(M=b==null?void 0:b.output)==null?void 0:M[0];if(!g)throw new Error("\u753B\u50CF\u30C7\u30FC\u30BF\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F");let p=e(g),m=((N=(j=l.workspace.getActiveFile())==null?void 0:j.parent)==null?void 0:N.path)||"",v=(0,Sx.normalizePath)(`${m}/assets`),x="png",w=u!=null?u:`generated-${Date.now()}.${x}`;w.endsWith(`.${x}`)||(w+=`.${x}`);let _=`${v}/${w}`;try{l.vault.getAbstractFileByPath(v)||await l.vault.createFolder(v)}catch(L){}let E=1;for(;l.vault.getAbstractFileByPath(_);)_=`${v}/${Date.now()}_${E}.${x}`,E++;let P=await l.vault.createBinary(_,p),D={filePath:P.path,message:`\u753B\u50CF\u3092\u751F\u6210\u3057\u307E\u3057\u305F: ${P.path}`};return JSON.stringify(D)}i.executeInpaintImage=r})(Gd||(Gd={}));var ug={name:"inpaint_image",description:"Edit image with attachments and save to assets",parameters:Gd.INPAINT_IMAGE_METADATA.parameters,execute:Gd.executeInpaintImage};var wx=require("obsidian");var Hd;(r=>{r.GENERATIVE_FILL_METADATA={name:"generative_fill",description:"Generatively fill selected area using AI",parameters:{type:"object",properties:{prompt:{type:"string",description:"Prompt text"},apiKey:{type:"string",description:"API key"},app:{type:"object",description:"Obsidian app instance"},image:{type:"string",description:"Base64 image"},mask:{type:"string",description:"Base64 mask"},width:{type:"number",description:"Canvas width"},height:{type:"number",description:"Canvas height"}},required:["prompt","apiKey","app","image","mask","width","height"]}};function t(i){return new Promise((o,a)=>{let s=new Image;s.onload=()=>o(s),s.onerror=a,s.src=i})}async function n(i){let{prompt:o,apiKey:a,app:s,image:l,mask:u,width:c,height:f}=i,d=await le.executeTool("inpaint_image",{prompt:o,apiKey:a,app:s,image:l,mask:u}),h=JSON.parse(d),y=s.vault.getAbstractFileByPath(h.filePath);if(!y||!(y instanceof wx.TFile))throw new Error("\u751F\u6210\u753B\u50CF\u30D5\u30A1\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");let S=await s.vault.readBinary(y),b=new Blob([S]),g=URL.createObjectURL(b),p=await t(g);URL.revokeObjectURL(g);let m=document.createElement("canvas");m.width=c,m.height=f;let v=m.getContext("2d");if(!v)throw new Error("2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F");v.drawImage(p,0,0,c,f);let x=await t(u);v.globalCompositeOperation="destination-in",v.drawImage(x,0,0,c,f),v.globalCompositeOperation="source-over";let w={name:"Generative Fill",visible:!0,opacity:1,blendMode:"normal",canvas:m},_=ye.getState(),E=Ye.getState();return dt.getState().saveHistory(_.layers,E.currentLayerIndex),_.addLayer(w),JSON.stringify(h)}r.executeGenerativeFill=n})(Hd||(Hd={}));var cg={name:"generative_fill",description:"Generatively fill selected area using AI",parameters:Hd.GENERATIVE_FILL_METADATA.parameters,execute:Hd.executeGenerativeFill};var bx=[D0,k0,Wl,O0,N0,z0,H0,W0,X0,K0,q0,px,y0,S0,b0,_0,E0,I0,P0,Q0,eg,tg,ng,rg,ig,og,ag,sg,lg,ug,cg];var hn;(a=>{a.tools=new Map,a.aiEnabledTools=new Set,a.config=MS;function r(s){return typeof s=="object"&&s!==null&&typeof s.name=="string"&&typeof s.description=="string"&&s.parameters!==void 0&&typeof s.execute=="function"}a.isValidTool=r;async function i(s){let l=bx.find(u=>u.name===s.name);if(!l)throw new Error(`Tool not found: ${s.name}`);if(!r(l))throw new Error(`Invalid tool for ${s.name}`);o(l),s.ai_enabled&&a.aiEnabledTools.add(l.name)}a.loadToolFromConfig=i;function o(s){a.tools.has(s.name)||a.tools.set(s.name,s)}a.registerToolInternal=o})(hn||(hn={}));var dg=class{constructor(){hn.config.config.autoRegister?this.ready=this.autoRegisterTools():this.ready=Promise.resolve()}async autoRegisterTools(){let t=0,n=0;for(let r of hn.config.tools)try{await hn.loadToolFromConfig(r),t++}catch(i){if(n++,hn.config.config.failOnError)throw new Error(`Tool registration failed for ${r.name}: ${i}`)}Wi.initialize(hn.tools,hn.aiEnabledTools,hn.config)}getTool(t){return Wi.getTool(t)}getAllTools(){return Array.from(hn.tools.values())}getAiEnabledTools(){return this.getAllTools().filter(t=>hn.aiEnabledTools.has(t.name))}getRegisteredToolNames(){return Array.from(hn.tools.keys())}getAiEnabledToolNames(){return Array.from(hn.aiEnabledTools)}hasToolRegistered(t){return Wi.hasToolRegistered(t)}isAiEnabled(t){return Wi.isAiEnabled(t)}async executeTool(t,n){return Wi.executeTool(t,n)}printToolInfo(){hn.tools.forEach((t,n)=>{let r=hn.aiEnabledTools.has(n)})}},le=new dg;function _x(e,t){let n=e.containerEl.querySelector(".view-header-title");n&&(n.textContent=t)}var jo=class extends ls.FileView{constructor(n,r){super(n);this.reactRoot=null;this.actionsAdded=!1;this.renderReact=r}getViewType(){return"psd-view"}getDisplayText(){var n;return((n=this.file)==null?void 0:n.basename)||"Untitled"}updateTitle(n,r,i){if(!this.file)return;let o=this.file.basename;n&&r&&(o+=` (${n}x${r})`),i&&(o+=` ${i}%`),_x(this,o)}getState(){var n,r;return{file:(r=(n=this.file)==null?void 0:n.path)!=null?r:null}}async onOpen(){this.actionsAdded||(this.addActionButtons(),this.actionsAdded=!0)}addActionButtons(){var i,o;let n=this.addAction("",V("EDIT_MENU"),async a=>{let s=new ls.Menu;s.addItem(l=>l.setTitle(V("UNDO")).onClick(async()=>{try{await le.executeTool("undo_painter",{})}catch(u){console.error(u)}})),s.addItem(l=>l.setTitle(V("REDO")).onClick(async()=>{try{await le.executeTool("redo_painter",{})}catch(u){console.error(u)}})),s.showAtMouseEvent(a)});(i=n.querySelector("svg"))==null||i.remove(),n.textContent=V("EDIT_MENU");let r=this.addAction("",V("EXPORT_MERGED_IMAGE"),async()=>{var a;if(this._painterData)try{await le.executeTool("export_merged_image",{app:this.app,layers:this._painterData.layers,fileName:`${((a=this.file)==null?void 0:a.basename)||"merged"}.png`})}catch(s){console.error(s)}});(o=r.querySelector("svg"))==null||o.remove(),r.textContent=V("EXPORT_MERGED_IMAGE")}async setState(n){if(!n.file)return;let r=this.app.vault.getAbstractFileByPath(n.file);r instanceof ls.TFile&&(this.file=r,this.updateTitle(),this.renderReact())}async onClose(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null)}};var Tn=H(Fe(),1);var Ur=H(Fe(),1);function fg(){let[e,t]=(0,Ur.useState)("brush"),[n,r]=(0,Ur.useState)(5),[i,o]=(0,Ur.useState)("#000000"),[a,s]=(0,Ur.useState)("normal"),[l,u]=(0,Ur.useState)("rect"),[c,f]=(0,Ur.useState)(!0),[d,h]=(0,Ur.useState)(100),[y,S]=(0,Ur.useState)(50),[b,g]=(0,Ur.useState)(100);return{tool:e,drawingMode:a,lineWidth:n,color:i,selectionMode:l,brushHasColor:c,brushOpacity:d,blendStrength:y,mixRatio:b,setTool:m=>{switch(t(m),m){case"pen":h(100),s("normal"),g(100),S(0),f(!0);break;case"brush":h(10),s("normal"),g(100),S(0),f(!0);break;case"paint-brush":h(10),s("spectral"),g(50),S(50),f(!0);break;case"color-mixer":h(0),s("spectral"),g(0),S(100),f(!1);break;case"eraser":h(100),s("erase-soft"),g(100),S(0),f(!0);break;default:break}},setDrawingMode:s,setLineWidth:r,setColor:o,setSelectionMode:u,setBrushHasColor:f,setBrushOpacity:h,setBlendStrength:S,setMixRatio:g}}var Br=H(Fe(),1);var xx=H(Fe(),1);function pg(){let e=(0,xx.useRef)(null);if(!e.current){let t={mode:"rect",selectionRect:void 0,lassoPoints:[],magicClipPath:void 0,magicOutline:void 0,magicBounding:void 0,reset(){t.selectionRect=void 0,t.lassoPoints=[],t.magicClipPath=void 0,t.magicOutline=void 0,t.magicBounding=void 0},hasSelection(){return t.mode==="rect"&&!!t.selectionRect||t.mode==="lasso"&&t.lassoPoints.length>0||t.mode==="magic"&&!!t.magicClipPath},getBoundingRect(){if(t.mode==="rect")return t.selectionRect;if(t.mode==="magic")return t.magicBounding;if(t.lassoPoints.length===0)return;let n=t.lassoPoints.map(l=>l.x),r=t.lassoPoints.map(l=>l.y),i=Math.min(...n),o=Math.max(...n),a=Math.min(...r),s=Math.max(...r);return{x:i,y:a,width:o-i,height:s-a}}};e.current=t}return e.current}var ao=En()(cx(e=>({layoutDirection:"horizontal",setLayoutDirection:t=>e({layoutDirection:t})}),{name:"painter-layout-store",storage:{getItem:async e=>{try{return typeof window!="undefined"&&window.boardPlugin&&(await window.boardPlugin.loadData()||{}).painterLayoutStore||null}catch(t){return null}},setItem:async(e,t)=>{try{if(typeof window!="undefined"&&window.boardPlugin){let n=window.boardPlugin,r=await n.loadData()||{};r.painterLayoutStore=t,await n.saveData(r)}}catch(n){console.error(n)}},removeItem:async e=>{try{if(typeof window!="undefined"&&window.boardPlugin){let t=window.boardPlugin,n=await t.loadData()||{};delete n.painterLayoutStore,await t.saveData(n)}}catch(t){console.error(t)}}}}));var jd=En((e,t)=>({attachments:[],addAttachment:n=>{e(r=>({attachments:[...r.attachments,n]}))},removeAttachment:n=>{e(r=>{let i=[...r.attachments],[o]=i.splice(n,1);return o&&URL.revokeObjectURL(o.url),{attachments:i}})},clearAttachments:()=>{e(n=>(n.attachments.forEach(r=>URL.revokeObjectURL(r.url)),{attachments:[]}))}}));var so=H(fe(),1),nL=({handlers:e,mode:t="global",position:n={x:8,y:8},isFloating:r=!1,layoutDirection:i="horizontal"})=>{if(t==="hidden")return null;let o="flex gap-1 bg-secondary border border-modifier-border p-2 rounded",a;r?a=`absolute ${o} shadow-lg z-50`:a=i==="horizontal"?`${o} border-r border-l-0 border-t-0 border-b-0 w-[250px] flex-col`:`${o} border-b border-l-0 border-t-0 border-r-0 flex-row items-center`;let s="px-2 py-1 text-xs bg-primary hover:bg-modifier-hover text-text-normal rounded border-none cursor-pointer";return(0,so.jsxs)("div",{className:a,style:r?{left:`${n.x}px`,top:`${n.y}px`}:void 0,children:[(0,so.jsx)("button",{className:s,onClick:e.fill,title:"\u5857\u308A\u3064\u3076\u3057",children:"\u5857\u308A\u3064\u3076\u3057"}),(0,so.jsx)("button",{className:s,onClick:e.clear,title:"\u30AF\u30EA\u30A2",children:"\u30AF\u30EA\u30A2"}),e.generativeFill&&(0,so.jsx)("button",{className:s,onClick:e.generativeFill,title:"\u30B8\u30A7\u30CD\u30EC\u30FC\u30C6\u30A3\u30D6\u5857\u308A\u3064\u3076\u3057",children:"\u751F\u6210\u5857\u308A"}),e.edit&&(0,so.jsx)("button",{className:s,onClick:e.edit,title:"\u7DE8\u96C6",children:"\u7DE8\u96C6"}),t==="selection"&&e.cancel&&(0,so.jsx)("button",{className:s,onClick:e.cancel,title:"\u30AD\u30E3\u30F3\u30BB\u30EB",children:"\u30AD\u30E3\u30F3\u30BB\u30EB"})]})},hg=nL;var Yl=H(Fe(),1);var Xl=H(Fe(),1);function rL(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function iL(e,t,n){return"#"+[e,t,n].map(r=>r.toString(16).padStart(2,"0")).join("")}function oL(e,t,n){e/=255,t/=255,n/=255;let r=Math.max(e,t,n),i=Math.min(e,t,n),o=0,a=0,s=(r+i)/2;if(r!==i){let l=r-i;switch(a=s>.5?l/(2-r-i):l/(r+i),r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4;break}o*=60}return{h:o,s:a*100,l:s*100}}function $d(e,t,n){t/=100,n/=100;let r=(1-Math.abs(2*n-1))*t,i=r*(1-Math.abs(e/60%2-1)),o=n-r/2,a=0,s=0,l=0;return 0<=e&&e<60?(a=r,s=i,l=0):60<=e&&e<120?(a=i,s=r,l=0):120<=e&&e<180?(a=0,s=r,l=i):180<=e&&e<240?(a=0,s=i,l=r):240<=e&&e<300?(a=i,s=0,l=r):(a=r,s=0,l=i),{r:Math.round((a+o)*255),g:Math.round((s+o)*255),b:Math.round((l+o)*255)}}function mg(e){let t=rL(e);return t?oL(t.r,t.g,t.b):{h:0,s:0,l:0}}function Ix(e,t,n){let{r,g:i,b:o}=$d(e,t,n);return iL(r,i,o)}var Ax=H(fe(),1);function Px(e,t){return t*(100-50*e)}function aL(e,t){let n=100-50*e;return n<=0?0:t/n}function gg({hue:e,saturation:t,lightness:n,onChange:r,size:i=100}){let o=(0,Xl.useRef)(null),a=(0,Xl.useRef)(null);(0,Xl.useEffect)(()=>{let d=o.current;if(!d)return;let h=d.getContext("2d");if(!h)return;let y=i/2,S=i*.15,b=y-S,g=b*Math.SQRT2,p=g/2,m=h.createImageData(i,i),v=m.data;for(let j=0;j<i;j++)for(let N=0;N<i;N++){let L=N-y,O=j-y,F=Math.sqrt(L*L+O*O),X=(j*i+N)*4;if(F>y){v[X+3]=0;continue}if(F>=b){let te=Math.atan2(O,L);te<0&&(te+=Math.PI*2);let ge=te*180/Math.PI,{r:ne,g:Ie,b:je}=$d(ge,100,50);v[X]=ne,v[X+1]=Ie,v[X+2]=je,v[X+3]=255}else if(Math.abs(L)<=p&&Math.abs(O)<=p){let te=(L+p)/g,ge=1-(O+p)/g,ne=Px(te,ge),{r:Ie,g:je,b:Q}=$d(e,te*100,ne);v[X]=Ie,v[X+1]=je,v[X+2]=Q,v[X+3]=255}else v[X+3]=0}h.putImageData(m,0,0);let x=e*Math.PI/180,w=y-S/2,_=y+w*Math.cos(x),E=y+w*Math.sin(x);h.strokeStyle="#ffffff",h.lineWidth=2,h.beginPath(),h.arc(_,E,4,0,Math.PI*2),h.stroke();let P=y-p+t*g,D=aL(t,n),M=y-p+(1-D)*g;h.strokeRect(P-3,M-3,6,6)},[e,t,n,i]);function s(d,h){let y=i/2,S=i*.15,b=y-S,g=Math.sqrt(d*d+h*h);return g>=b&&g<=y?"hue":g<b?"sl":null}function l(d,h){let y=d.currentTarget.getBoundingClientRect(),S=d.clientX-y.left-i/2,b=d.clientY-y.top-i/2,g=i/2,p=i*.15,m=g-p;if(h==="hue"){let v=Math.atan2(b,S);v<0&&(v+=Math.PI*2),r(v*180/Math.PI,t,n)}else{let v=m*Math.SQRT2,x=v/2,w=Math.max(-x,Math.min(x,S)),_=Math.max(-x,Math.min(x,b)),E=(w+x)/v,P=1-(_+x)/v,D=Px(E,P);r(e,E,D)}}function u(d){let h=d.currentTarget.getBoundingClientRect(),y=d.clientX-h.left-i/2,S=d.clientY-h.top-i/2,b=s(y,S);b&&(a.current=b,l(d,b))}function c(d){a.current&&l(d,a.current)}function f(){a.current=null}return(0,Ax.jsx)("canvas",{ref:o,width:i,height:i,onMouseDown:u,onMouseMove:c,onMouseUp:f,onMouseLeave:f,className:"cursor-crosshair rounded-full select-none"})}var Kl=H(fe(),1);function vg({color:e,setColor:t,layoutDirection:n}){let[r,i]=(0,Yl.useState)(()=>mg(e));(0,Yl.useEffect)(()=>{i(mg(e))},[e]),(0,Yl.useEffect)(()=>{t(Ix(r.h,r.s,r.l))},[r,t]);let o=n==="horizontal"?"p-2 bg-secondary border-r border-modifier-border w-[250px] flex flex-col items-center gap-2":"p-2 bg-secondary border-b border-modifier-border flex flex-row items-center gap-2",a=(s,l,u)=>{i({h:s,s:l*100,l:u})};return(0,Kl.jsxs)("div",{className:o,children:[(0,Kl.jsx)("div",{className:"text-text-muted text-xs",children:"\u30AB\u30E9\u30FC"}),(0,Kl.jsx)(gg,{hue:r.h,saturation:r.s/100,lightness:r.l,onChange:a,size:120})]})}var ue=H(fe(),1);function yg({tool:e,drawingMode:t,lineWidth:n,selectionMode:r,brushHasColor:i,brushOpacity:o,blendStrength:a,mixRatio:s,zoom:l,rotation:u,canvasWidth:c,canvasHeight:f,actualZoom:d,maintainAspectRatio:h,resizeMode:y,setDrawingMode:S,setLineWidth:b,setSelectionMode:g,setBrushHasColor:p,setBrushOpacity:m,setBlendStrength:v,setMixRatio:x,setZoom:w,setRotation:_,setCanvasSize:E,setMaintainAspectRatio:P,setResizeMode:D,layoutDirection:M}){let{setLayoutDirection:j}=ao();return(0,ue.jsxs)("div",{className:M==="horizontal"?"p-2 bg-secondary border-r border-modifier-border w-[250px] flex flex-col gap-2":"p-2 bg-secondary border-b border-modifier-border flex flex-row gap-4 items-center flex-wrap",children:[e==="settings"&&(0,ue.jsxs)("div",{className:M==="horizontal"?"flex flex-col gap-2":"flex flex-row gap-2 items-center",children:[(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("LAYOUT_SETTINGS"),":"]}),(0,ue.jsxs)("select",{className:M==="horizontal"?"w-full text-xs p-1 border border-modifier-border rounded bg-primary":"text-xs p-1 border border-modifier-border rounded bg-primary",value:M,onChange:L=>j(L.target.value),children:[(0,ue.jsx)("option",{value:"horizontal",children:V("LAYOUT_HORIZONTAL")}),(0,ue.jsx)("option",{value:"vertical",children:V("LAYOUT_VERTICAL")})]})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsx)("div",{className:"text-text-muted text-xs",children:"\u30AD\u30E3\u30F3\u30D0\u30B9\u30B5\u30A4\u30BA:"}),(0,ue.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:[(0,ue.jsx)("input",{type:"checkbox",checked:h,onChange:L=>P(L.target.checked),className:"w-3 h-3"}),"\u7E26\u6A2A\u6BD4\u3092\u7DAD\u6301"]}),(0,ue.jsxs)("div",{className:M==="horizontal"?"flex flex-col gap-1":"flex flex-row gap-2",children:[(0,ue.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ue.jsx)("span",{className:"text-xs",children:"\u5E45:"}),(0,ue.jsx)("input",{type:"number",min:100,max:4e3,step:10,value:c,onChange:L=>{let O=parseInt(L.target.value)||c;if(h){let F=c/f,X=Math.round(O/F);E(O,X)}else E(O,f)},className:"w-20 text-xs p-1 border border-modifier-border rounded bg-primary"}),(0,ue.jsx)("span",{className:"text-xs",children:"px"})]}),(0,ue.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ue.jsx)("span",{className:"text-xs",children:"\u9AD8:"}),(0,ue.jsx)("input",{type:"number",min:100,max:4e3,step:10,value:f,onChange:L=>{let O=parseInt(L.target.value)||f;if(h){let F=c/f,X=Math.round(O*F);E(X,O)}else E(c,O)},className:"w-20 text-xs p-1 border border-modifier-border rounded bg-primary"}),(0,ue.jsx)("span",{className:"text-xs",children:"px"})]})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1 mt-2",children:[(0,ue.jsx)("div",{className:"text-text-muted text-xs",children:"\u753B\u50CF\u306E\u51E6\u7406:"}),(0,ue.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:[(0,ue.jsx)("input",{type:"radio",name:"resizeMode",value:"canvas-only",checked:y==="canvas-only",onChange:L=>D(L.target.value),className:"w-3 h-3"}),"\u30AD\u30E3\u30F3\u30D0\u30B9\u30B5\u30A4\u30BA\u306E\u307F\u5909\u66F4"]}),(0,ue.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:[(0,ue.jsx)("input",{type:"radio",name:"resizeMode",value:"resize-content",checked:y==="resize-content",onChange:L=>D(L.target.value),className:"w-3 h-3"}),"\u753B\u50CF\u3082\u7E26\u6A2A\u6BD4\u3092\u7DAD\u6301\u3057\u3066\u30EA\u30B5\u30A4\u30BA"]})]})]})]}),["pen","brush","paint-brush","color-mixer","eraser"].includes(e)&&(0,ue.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("BRUSH_SIZE"),": ",n,"px"]}),(0,ue.jsx)("input",{type:"range",min:0,max:100,value:Math.log10(n)*33.33,onChange:L=>{let O=parseInt(L.currentTarget.value,10)/33.33,F=Math.round(Math.pow(10,O));b(Math.max(1,Math.min(1e3,F)))}})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("BRUSH_OPACITY"),": ",o,"%"]}),(0,ue.jsx)("input",{type:"range",min:0,max:100,value:Math.sqrt(o)*10,onChange:L=>{let O=parseInt(L.currentTarget.value,10),F=Math.round((O/10)**2);m(Math.max(0,Math.min(100,F))),p(F>0)}})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsx)("div",{className:"text-text-muted text-xs",children:V("COLOR_MIX_RATIO").replace("{canvas}",(100-s).toString()).replace("{pen}",s.toString())}),(0,ue.jsx)("input",{type:"range",min:0,max:100,value:s,onChange:L=>x(parseInt(L.currentTarget.value,10))})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("BLEND_STRENGTH"),": ",a,"%"]}),(0,ue.jsx)("input",{type:"range",min:0,max:100,value:Math.sqrt(a)*10,onChange:L=>{let O=parseInt(L.currentTarget.value,10),F=Math.round((O/10)**2);v(Math.max(0,Math.min(100,F)))}})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("DRAWING_MODE"),":"]}),(0,ue.jsxs)("select",{className:"w-full text-xs p-1 border border-modifier-border rounded bg-primary",value:t,onChange:L=>S(L.target.value),children:[(0,ue.jsx)("option",{value:"normal",children:V("DRAWING_MODE_NORMAL")}),(0,ue.jsx)("option",{value:"spectral",children:V("DRAWING_MODE_SPECTRAL")}),(0,ue.jsx)("option",{value:"erase-soft",children:V("DRAWING_MODE_ERASE_SOFT")})]})]})]}),e==="selection"&&(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("SELECTION_TYPE"),":"]}),(0,ue.jsxs)("select",{className:"w-full text-xs",value:r,onChange:L=>g(L.currentTarget.value),children:[(0,ue.jsx)("option",{value:"rect",children:V("SELECT_RECT")}),(0,ue.jsx)("option",{value:"lasso",children:V("SELECT_LASSO")}),(0,ue.jsx)("option",{value:"magic",children:V("SELECT_MAGIC")})]})]}),e==="hand"&&(0,ue.jsxs)("div",{className:M==="horizontal"?"flex flex-col gap-2":"flex flex-row gap-4",children:[(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("ZOOM_LEVEL"),": ",d!==void 0?d:l,"%"]}),(0,ue.jsx)("input",{type:"range",min:10,max:400,value:l,onChange:L=>w(parseInt(L.currentTarget.value,10))})]}),(0,ue.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ue.jsxs)("div",{className:"text-text-muted text-xs",children:[V("ROTATION_ANGLE"),": ",u,"\xB0"]}),(0,ue.jsx)("input",{type:"range",min:-180,max:180,value:u,onChange:L=>_(parseInt(L.currentTarget.value,10))})]})]})]})}var Ot=H(Fe(),1);var lo=H(fe(),1);function Sg({rect:e,layers:t,currentLayerIndex:n,onFinish:r}){let i=(0,Ot.useRef)(null),o=(0,Ot.useRef)(null),[a,s]=(0,Ot.useState)({x:0,y:0}),[l,u]=(0,Ot.useState)(1),[c,f]=(0,Ot.useState)(0),d=(0,Ot.useRef)(!1),h=(0,Ot.useRef)({x:0,y:0}),y=(0,Ot.useRef)(!1),S=(0,Ot.useRef)({x:0,y:0}),b=(0,Ot.useRef)(1),g=(0,Ot.useRef)(0),p=(0,Ot.useRef)(1),m=(0,Ot.useRef)(0);(0,Ot.useEffect)(()=>{let E=t[n];if(!E)return;let P=E.canvas.getContext("2d"),D=i.current;if(!P||!D)return;let M=document.createElement("canvas");M.width=e.width,M.height=e.height;let j=M.getContext("2d");if(!j)return;j.drawImage(E.canvas,e.x,e.y,e.width,e.height,0,0,e.width,e.height),o.current=M,D.width=e.width,D.height=e.height;let N=D.getContext("2d");N&&(N.drawImage(E.canvas,e.x,e.y,e.width,e.height,0,0,e.width,e.height),P.clearRect(e.x,e.y,e.width,e.height))},[e,n]),(0,Ot.useEffect)(()=>{let E=i.current;E&&(E.style.transform=`translate(${a.x}px, ${a.y}px) scale(${l}) rotate(${c}rad)`)},[a,l,c]),(0,Ot.useEffect)(()=>{let E=D=>{d.current&&s(M=>{let j=M.x+D.clientX-h.current.x,N=M.y+D.clientY-h.current.y;return h.current={x:D.clientX,y:D.clientY},{x:j,y:N}})},P=()=>{d.current=!1};return window.addEventListener("pointermove",E),window.addEventListener("pointerup",P),()=>{window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",P)}},[]);let v=()=>{let P=t[n].canvas.getContext("2d"),D=i.current;if(!P||!D)return;P.save(),P.translate(e.x+e.width/2+a.x,e.y+e.height/2+a.y),P.rotate(c),P.scale(l,l),P.drawImage(D,-e.width/2,-e.height/2),P.restore();let M=ye.getState();dt.getState().saveHistory(M.layers,n),M.updateLayers([...M.layers]),r()},x=()=>{let P=t[n].canvas.getContext("2d"),D=o.current;if(!P||!D)return;P.clearRect(e.x,e.y,e.width,e.height),P.drawImage(D,e.x,e.y);let M=ye.getState();M.updateLayers([...M.layers]),r()},w=E=>{d.current=!0,h.current={x:E.clientX,y:E.clientY}},_=E=>{if(E.stopPropagation(),!i.current)return;y.current=!0;let P=i.current.getBoundingClientRect(),D=P.left+P.width/2,M=P.top+P.height/2,j=E.clientX-D,N=E.clientY-M;S.current={x:j,y:N},b.current=Math.hypot(j,N),g.current=Math.atan2(N,j),p.current=l,m.current=c;let L=F=>{if(!y.current||!i.current)return;let X=i.current.getBoundingClientRect(),te=X.left+X.width/2,ge=X.top+X.height/2,ne=F.clientX-te,Ie=F.clientY-ge,je=Math.hypot(ne,Ie),Q=Math.atan2(Ie,ne);u(p.current*(je/b.current)),f(m.current+(Q-g.current))},O=()=>{y.current=!1,window.removeEventListener("pointermove",L),window.removeEventListener("pointerup",O)};window.addEventListener("pointermove",L),window.addEventListener("pointerup",O)};return(0,lo.jsxs)("div",{className:"absolute z-50",style:{left:e.x,top:e.y},onPointerDown:w,children:[(0,lo.jsx)("canvas",{ref:i,style:{pointerEvents:"none",border:"1px dashed var(--color-accent)"}}),(0,lo.jsxs)("div",{className:"absolute left-0 -top-7 flex gap-1 bg-secondary border border-modifier-border p-1 rounded",children:[(0,lo.jsx)("button",{className:"px-2 py-1 text-xs",onClick:v,children:"\u78BA\u5B9A"}),(0,lo.jsx)("button",{className:"px-2 py-1 text-xs",onClick:x,children:"\u30AD\u30E3\u30F3\u30BB\u30EB"})]}),(0,lo.jsx)("div",{className:"absolute w-4 h-4 bg-background border-2 border-accent rounded-full cursor-grab",style:{right:"-8px",bottom:"-8px"},onPointerDown:_})]})}var xt=H(Fe(),1);var Zl=H(Lx(),1);function Yd(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function sL(e,t,n){return"#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}function Wo(e,t,n){let r=Yd(e),i=Yd(t);if(!r||!i)return e;let o=Math.round(r.r*(1-n)+i.r*n),a=Math.round(r.g*(1-n)+i.g*n),s=Math.round(r.b*(1-n)+i.b*n);return sL(o,a,s)}function us(e,t,n){try{let r=Yd(e),i=Yd(t);if(!r||!i)return e;let o=new Zl.Color([r.r,r.g,r.b]),a=new Zl.Color([i.r,i.g,i.b]),l=Zl.mix([o,1-n],[a,n]).toString();return l.startsWith("#")?l:"#"+l}catch(r){return console.error("\u30B9\u30DA\u30AF\u30C8\u30E9\u30EB\u6DF7\u8272\u30A8\u30E9\u30FC:",r),Wo(e,t,n)}}var Kd=H(fe(),1);function wg({view:e,pointer:t,zoom:n,rotation:r,containerRef:i,selectionState:o,canvasSize:a,onActualZoomChange:s,onSelectionStart:l,onSelectionUpdate:u,onSelectionEnd:c}){let f=(0,xt.useRef)(null),[d,h]=(0,xt.useState)({width:800,height:600}),[y,S]=(0,xt.useState)({x:0,y:0}),b=ye(R=>R.layers),g=Ye(R=>R.currentLayerIndex),{updateLayers:p}=ye(),m=(0,xt.useRef)(0),v=(0,xt.useRef)(),[x,w]=(0,xt.useState)(0),_=32,E=()=>{v.current&&cancelAnimationFrame(v.current);let R=()=>{o.hasSelection()&&(m.current=(m.current+.5)%12,w(U=>U+1),v.current=requestAnimationFrame(R))};v.current=requestAnimationFrame(R)},P=()=>{v.current&&(cancelAnimationFrame(v.current),v.current=void 0)},D=(0,xt.useRef)(!1),M=(0,xt.useRef)(0),j=(0,xt.useRef)(0),N=(0,xt.useRef)(!1),L=(0,xt.useRef)(null),O=(0,xt.useRef)(!1),F=(0,xt.useRef)({x:0,y:0});(0,xt.useEffect)(()=>{let R=f.current;R&&(["pen","brush","paint-brush","color-mixer","eraser","selection"].includes(t.tool)?R.style.cursor="crosshair":t.tool==="hand"?R.style.cursor="grab":R.style.cursor="default")},[t.tool]),(0,xt.useEffect)(()=>{var R,U;a?h(a):(R=e==null?void 0:e._painterData)!=null&&R.canvasWidth&&((U=e==null?void 0:e._painterData)!=null&&U.canvasHeight)?h({width:e._painterData.canvasWidth,height:e._painterData.canvasHeight}):b.length>0&&b[0].canvas&&h({width:b[0].canvas.width||800,height:b[0].canvas.height||600})},[a,e,b]),(0,xt.useEffect)(()=>{let R=f.current;R&&(R.width=d.width,R.height=d.height)},[d]),(0,xt.useEffect)(()=>{let R=f.current;if(R){let U=R.getBoundingClientRect(),Y=Math.round(U.width/d.width*n);e&&e.updateTitle&&e.updateTitle(d.width,d.height,Y),s&&s(Y)}else e&&e.updateTitle&&e.updateTitle(d.width,d.height,n),s&&s(n)},[n,d,e,s]),(0,xt.useEffect)(()=>{let R=f.current;if(!R)return;let U=R.getContext("2d");if(!U)return;U.clearRect(0,0,R.width,R.height);let Y=10;U.fillStyle="#ffffff",U.fillRect(0,0,R.width,R.height),U.fillStyle="#e0e0e0";for(let G=0;G<R.height;G+=Y*2)for(let oe=0;oe<R.width;oe+=Y*2)U.fillRect(oe+Y,G,Y,Y),U.fillRect(oe,G+Y,Y,Y);if(b&&b.length>0&&b.forEach((G,oe)=>{if(G.visible&&G.canvas){let Pe=U.globalAlpha;U.globalAlpha=G.opacity!==void 0?G.opacity:1;let ht=U.globalCompositeOperation;if(G.blendMode&&G.blendMode!=="normal")try{U.globalCompositeOperation=G.blendMode}catch(Ae){console.error(Ae)}try{if(G.clippingMask&&oe>0){let Ae=document.createElement("canvas");Ae.width=G.canvas.width,Ae.height=G.canvas.height;let $e=Ae.getContext("2d");$e&&($e.drawImage(G.canvas,0,0),$e.globalCompositeOperation="destination-in",$e.drawImage(b[oe-1].canvas,0,0),U.drawImage(Ae,0,0))}else U.drawImage(G.canvas,0,0)}catch(Ae){console.error(Ae)}U.globalAlpha=Pe,U.globalCompositeOperation=ht}}),o.hasSelection()){if(U.save(),U.setLineDash([6]),U.lineDashOffset=-m.current,U.strokeStyle="#000",U.lineWidth=1,o.mode==="rect"&&o.selectionRect){let G=o.selectionRect;U.strokeRect(G.x+.5,G.y+.5,G.width,G.height)}else if(o.mode==="lasso"&&o.lassoPoints.length>1){U.beginPath(),U.moveTo(o.lassoPoints[0].x+.5,o.lassoPoints[0].y+.5);for(let G=1;G<o.lassoPoints.length;G++){let oe=o.lassoPoints[G];U.lineTo(oe.x+.5,oe.y+.5)}U.closePath(),U.stroke()}else o.mode==="magic"&&o.magicOutline&&U.stroke(o.magicOutline);U.restore()}},[b,g,o,x,d]);let X=R=>{let U=f.current;if(!U)return{x:0,y:0};let Y=U.getBoundingClientRect(),G=U.width/Y.width,oe=U.height/Y.height,Pe=(R.clientX-Y.left)*G,ht=(R.clientY-Y.top)*oe;return{x:Pe,y:ht}},te=(R,U)=>{if(!b[g]||!b[g].canvas)return;let G=b[g].canvas.getContext("2d");if(!G)return;t.tool==="eraser"&&t.drawingMode!=="erase-soft"?(G.globalCompositeOperation="destination-out",G.strokeStyle="rgba(0,0,0,1)",G.lineWidth=t.lineWidth,G.lineCap="round",G.lineJoin="round",G.beginPath(),G.moveTo(R.x,R.y),G.lineTo(U.x,U.y),G.stroke()):["pen","brush","paint-brush","color-mixer","eraser"].includes(t.tool)&&(t.drawingMode==="erase-soft"?ge(G,R,U):t.brushOpacity===0?je(G,R,U):ne(G,R,U));let oe=[...b];oe[g]={...b[g]},p(oe)},ge=(R,U,Y)=>{let G=t.brushOpacity/100;R.globalCompositeOperation="destination-out",R.globalAlpha=G,R.strokeStyle="rgba(0,0,0,1)",R.lineWidth=t.lineWidth,R.lineCap="round",R.lineJoin="round",R.beginPath(),R.moveTo(U.x,U.y),R.lineTo(Y.x,Y.y),R.stroke(),R.globalAlpha=1,R.globalCompositeOperation="source-over"},ne=(R,U,Y)=>{let G=t.lineWidth/2,oe=t.brushOpacity/100,Pe=Math.sqrt((Y.x-U.x)**2+(Y.y-U.y)**2),ht=Math.max(1,Math.floor(Pe));for(let Ae=0;Ae<=ht;Ae++){let $e=ht===0?0:Ae/ht,tt=U.x+(Y.x-U.x)*$e,Vt=U.y+(Y.y-U.y)*$e,an=R.getImageData(Math.max(0,tt-G),Math.max(0,Vt-G),Math.min(t.lineWidth,R.canvas.width-(tt-G)),Math.min(t.lineWidth,R.canvas.height-(Vt-G))),It=an.data,In=an.width,Vn=an.height,vn=t.color;if(t.mixRatio<100){let Re=[];for(let Xe=0;Xe<Vn;Xe++)for(let nt=0;nt<In;nt++){let Pt=(Xe*In+nt)*4;if(It[Pt+3]>0){let Kt=It[Pt],Pn=It[Pt+1],po=It[Pt+2],_s=`#${Kt.toString(16).padStart(2,"0")}${Pn.toString(16).padStart(2,"0")}${po.toString(16).padStart(2,"0")}`;Re.push(_s)}}if(Re.length>0){let Xe=t.drawingMode==="spectral"?"spectral":"normal",nt=K(Re,Xe),Pt=t.mixRatio/100;vn=Xe==="spectral"?us(nt,t.color,Pt):Wo(nt,t.color,Pt)}}let Gt=t.blendStrength/100;if(Gt>0){let Re=G*Math.max(.3,Gt),Xe=R.createRadialGradient(tt,Vt,0,tt,Vt,Re);Xe.addColorStop(0,vn+Math.floor(255*oe).toString(16).padStart(2,"0")),Xe.addColorStop(.7,vn+Math.floor(255*oe*Gt*.8).toString(16).padStart(2,"0")),Xe.addColorStop(1,vn+"00"),R.globalCompositeOperation="source-over",R.fillStyle=Xe,R.beginPath(),R.arc(tt,Vt,Re,0,Math.PI*2),R.fill()}else{R.globalCompositeOperation="source-over",R.globalAlpha=oe,R.strokeStyle=vn,R.lineWidth=t.lineWidth,R.lineCap="round",R.lineJoin="round",R.beginPath(),R.moveTo(U.x,U.y),R.lineTo(Y.x,Y.y),R.stroke(),R.globalAlpha=1;return}}},Ie=(R,U,Y)=>{let G=t.lineWidth/2,oe=Math.sqrt((Y.x-U.x)**2+(Y.y-U.y)**2),Pe=Math.max(1,Math.floor(oe));for(let ht=0;ht<=Pe;ht++){let Ae=Pe===0?0:ht/Pe,$e=U.x+(Y.x-U.x)*Ae,tt=U.y+(Y.y-U.y)*Ae,Vt=R.getImageData(Math.max(0,$e-G),Math.max(0,tt-G),Math.min(t.lineWidth,R.canvas.width-($e-G)),Math.min(t.lineWidth,R.canvas.height-(tt-G))),an=Vt.data,It=Vt.width,In=Vt.height,Vn=t.color;if(t.mixRatio<100){let Gt=[];for(let Re=0;Re<In;Re++)for(let Xe=0;Xe<It;Xe++){let nt=(Re*It+Xe)*4;if(an[nt+3]>0){let At=an[nt],Kt=an[nt+1],Pn=an[nt+2],po=`#${At.toString(16).padStart(2,"0")}${Kt.toString(16).padStart(2,"0")}${Pn.toString(16).padStart(2,"0")}`;Gt.push(po)}}if(Gt.length>0){let Re=t.drawingMode==="spectral"?"spectral":"normal",Xe=K(Gt,Re),nt=t.mixRatio/100;Vn=Re==="spectral"?us(Xe,t.color,nt):Wo(Xe,t.color,nt)}}let vn=t.blendStrength/100;if(vn>0){let Gt=G*Math.max(.3,vn),Re=R.createRadialGradient($e,tt,0,$e,tt,Gt);Re.addColorStop(0,Vn),Re.addColorStop(.7,Vn+Math.floor(255*vn*.8).toString(16).padStart(2,"0")),Re.addColorStop(1,Vn+"00"),R.globalCompositeOperation="source-over",R.fillStyle=Re,R.beginPath(),R.arc($e,tt,Gt,0,Math.PI*2),R.fill()}else{R.globalCompositeOperation="source-over",R.strokeStyle=Vn,R.lineWidth=t.lineWidth,R.lineCap="round",R.lineJoin="round",R.beginPath(),R.moveTo(U.x,U.y),R.lineTo(Y.x,Y.y),R.stroke();return}}},je=(R,U,Y)=>{let G=t.lineWidth/2,oe=t.blendStrength/100;if(oe===0)return;let Pe=Math.sqrt((Y.x-U.x)**2+(Y.y-U.y)**2),ht=Math.max(1,Math.floor(Pe));for(let Ae=0;Ae<=ht;Ae++){let $e=ht===0?0:Ae/ht,tt=U.x+(Y.x-U.x)*$e,Vt=U.y+(Y.y-U.y)*$e,an=R.getImageData(Math.max(0,tt-G),Math.max(0,Vt-G),Math.min(t.lineWidth,R.canvas.width-(tt-G)),Math.min(t.lineWidth,R.canvas.height-(Vt-G))),It=an.data,In=an.width,Vn=an.height,vn=new Map,Gt=new Set;for(let At=0;At<Vn;At++)for(let Kt=0;Kt<In;Kt++){let Pn=(At*In+Kt)*4;if(It[Pn+3]>0){let _s=It[Pn],Te=It[Pn+1],Me=It[Pn+2],lt=`#${_s.toString(16).padStart(2,"0")}${Te.toString(16).padStart(2,"0")}${Me.toString(16).padStart(2,"0")}`;vn.set(lt,(vn.get(lt)||0)+1);let ho=[[Kt-1,At],[Kt+1,At],[Kt,At-1],[Kt,At+1]];for(let[ta,xs]of ho)if(ta>=0&&ta<In&&xs>=0&&xs<Vn){let na=(xs*In+ta)*4;if(It[na+3]>0){let O2=It[na],F2=It[na+1],N2=It[na+2],wf=`#${O2.toString(16).padStart(2,"0")}${F2.toString(16).padStart(2,"0")}${N2.toString(16).padStart(2,"0")}`;lt!==wf&&Q(lt,wf)&&(Gt.add(lt),Gt.add(wf))}}}}if(Gt.size===0)return;let Re=Array.from(Gt),Xe;if(Re.length===1)Xe=Re[0];else if(Re.length===2)Xe=(t.drawingMode==="spectral"?"spectral":"normal")==="spectral"?us(Re[0],Re[1],.5):Wo(Re[0],Re[1],.5);else{let At=t.drawingMode==="spectral"?"spectral":"normal";Xe=re(Re,At)}let nt=G*oe,Pt=R.createRadialGradient(tt,Vt,0,tt,Vt,nt);Pt.addColorStop(0,Xe),Pt.addColorStop(.6,Xe+Math.floor(255*oe*.7).toString(16).padStart(2,"0")),Pt.addColorStop(1,Xe+"00"),R.globalCompositeOperation="source-over",R.fillStyle=Pt,R.beginPath(),R.arc(tt,Vt,nt,0,Math.PI*2),R.fill()}},Q=(R,U)=>{let Y=W(R),G=W(U);if(!Y||!G)return!1;let oe=30;return Math.abs(Y.r-G.r)>oe||Math.abs(Y.g-G.g)>oe||Math.abs(Y.b-G.b)>oe},W=R=>{let U=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(R);return U?{r:parseInt(U[1],16),g:parseInt(U[2],16),b:parseInt(U[3],16)}:null},re=(R,U)=>{if(R.length===0)return"#000000";if(R.length===1)return R[0];let Y=R[0];for(let G=1;G<R.length;G++){let oe=1/(G+1);Y=U==="spectral"?us(Y,R[G],oe):Wo(Y,R[G],oe)}return Y},K=(R,U)=>{if(R.length===0)return"#000000";if(R.length===1)return R[0];let Y=R[0];for(let G=1;G<R.length;G++)Y=U==="spectral"?us(Y,R[G],.5):Wo(Y,R[G],.5);return Y},q=(R,U)=>{let Y=f.current;if(!Y)return;let G=Y.getContext("2d");if(!G)return;let oe=Y.width,Pe=Y.height;if(R<0||U<0||R>=oe||U>=Pe)return;let Ae=G.getImageData(0,0,oe,Pe).data,$e=new Uint8Array(oe*Pe),tt=(Te,Me)=>Me*oe+Te,Vt=(Te,Me)=>(Me*oe+Te)*4,an=Math.round(R),It=Math.round(U),In=Vt(an,It),Vn=Ae[In],vn=Ae[In+1],Gt=Ae[In+2],Re=[an,It];for(;Re.length;){let Te=Re.pop(),Me=Re.pop();if(Me===void 0||Te===void 0)break;let lt=tt(Me,Te);if($e[lt])continue;let ho=lt*4,ta=Ae[ho],xs=Ae[ho+1],na=Ae[ho+2];Math.abs(ta-Vn)>_||Math.abs(xs-vn)>_||Math.abs(na-Gt)>_||($e[lt]=1,Me>0&&Re.push(Me-1,Te),Me<oe-1&&Re.push(Me+1,Te),Te>0&&Re.push(Me,Te-1),Te<Pe-1&&Re.push(Me,Te+1))}let Xe=new Path2D,nt=new Path2D,Pt=oe,At=Pe,Kt=0,Pn=0,po=!1,_s=(Te,Me)=>{if(Te<0||Me<0||Te>=oe||Me>=Pe)return!1;let lt=tt(Te,Me);return $e[lt]?Te===0||!$e[tt(Te-1,Me)]||Te===oe-1||!$e[tt(Te+1,Me)]||Me===0||!$e[tt(Te,Me-1)]||Me===Pe-1||!$e[tt(Te,Me+1)]:!1};for(let Te=0;Te<Pe;Te++){let Me=-1;for(let lt=0;lt<oe;lt++){let ho=tt(lt,Te);$e[ho]?(po=!0,lt<Pt&&(Pt=lt),lt>Kt&&(Kt=lt),Te<At&&(At=Te),Te>Pn&&(Pn=Te),Xe.rect(lt,Te,1,1),_s(lt,Te)?Me===-1&&(Me=lt):Me!==-1&&(nt.moveTo(Me+.5,Te+.5),nt.lineTo(lt+.5,Te+.5),Me=-1)):Me!==-1&&(nt.moveTo(Me+.5,Te+.5),nt.lineTo(lt+.5,Te+.5),Me=-1)}Me!==-1&&(nt.moveTo(Me+.5,Te+.5),nt.lineTo(oe+.5,Te+.5))}if(!po||Pt>Kt||At>Pn){o.magicClipPath=void 0,o.magicOutline=void 0,o.magicBounding=void 0;return}o.magicClipPath=Xe,o.magicOutline=nt,o.magicBounding={x:Pt,y:At,width:Kt-Pt+1,height:Pn-At+1}},Se=R=>{let{x:U,y:Y}=X(R),G=ye.getState(),oe=Ye.getState(),Pe=dt.getState();if(t.tool==="selection"){if(o.mode=t.selectionMode,t.selectionMode==="magic"){o.reset(),q(U,Y),u==null||u(),c==null||c(),E();return}D.current=!0,M.current=U,j.current=Y,t.selectionMode==="rect"?(o.selectionRect={x:U,y:Y,width:0,height:0},o.lassoPoints=[],o.magicClipPath=void 0,o.magicOutline=void 0,o.magicBounding=void 0):(o.lassoPoints=[{x:U,y:Y}],o.selectionRect=void 0,o.magicClipPath=void 0,o.magicOutline=void 0,o.magicBounding=void 0),u==null||u(),l==null||l(),E()}else["pen","brush","paint-brush","color-mixer","eraser"].includes(t.tool)?(Pe.saveHistory(G.layers,oe.currentLayerIndex),N.current=!0,L.current={x:U,y:Y},te({x:U,y:Y},{x:U,y:Y})):t.tool==="hand"&&(O.current=!0,F.current={x:R.clientX,y:R.clientY},f.current&&(f.current.style.cursor="grabbing"))},we=R=>{let{x:U,y:Y}=X(R);if(t.tool==="selection"&&D.current){if(o.mode==="rect"){let G=Math.min(M.current,U),oe=Math.min(j.current,Y),Pe=Math.abs(U-M.current),ht=Math.abs(Y-j.current);o.selectionRect={x:G,y:oe,width:Pe,height:ht}}else o.lassoPoints.push({x:U,y:Y});u==null||u()}else if(["pen","brush","paint-brush","color-mixer","eraser"].includes(t.tool)&&N.current&&L.current)te(L.current,{x:U,y:Y}),L.current={x:U,y:Y};else if(t.tool==="hand"&&O.current){let G=R.clientX-F.current.x,oe=R.clientY-F.current.y;S(Pe=>({x:Pe.x+G,y:Pe.y+oe})),F.current={x:R.clientX,y:R.clientY}}},ce=R=>{if(t.tool==="selection"){if(t.selectionMode==="magic"){c==null||c();return}if(!D.current)return;D.current=!1;let U=!1;o.mode==="rect"?U=!!(o.selectionRect&&o.selectionRect.width>2&&o.selectionRect.height>2):(o.lassoPoints.length>2&&o.lassoPoints.push(o.lassoPoints[0]),U=o.lassoPoints.length>2),U||(o.reset(),P(),u==null||u()),c==null||c()}else["pen","brush","paint-brush","color-mixer","eraser"].includes(t.tool)?(N.current=!1,L.current=null):t.tool==="hand"&&(O.current=!1,f.current&&(f.current.style.cursor="grab"))};return(0,Kd.jsx)("div",{className:"flex flex-1 w-full h-full bg-background overflow-hidden relative",children:(0,Kd.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,Kd.jsx)("canvas",{ref:f,width:d.width,height:d.height,className:"border border-modifier-border max-w-full max-h-full",style:{display:"block",transform:`translate(${y.x}px, ${y.y}px) scale(${n/100}) rotate(${r}deg)`},onPointerDown:Se,onPointerMove:we,onPointerUp:ce})})})}var mr=H(fe(),1);function bg({pointer:e,view:t,zoom:n,rotation:r,setZoom:i,setRotation:o}){let a=(0,Br.useRef)(null),{layoutDirection:s}=ao(),l=pg(),[u,c]=(0,Br.useState)("global"),[f,d]=(0,Br.useState)({x:8,y:8}),[h,y]=(0,Br.useState)(null),[S,b]=(0,Br.useState)({width:800,height:600}),[g,p]=(0,Br.useState)(!1),[m,v]=(0,Br.useState)("canvas-only"),[x,w]=(0,Br.useState)(n),_=async W=>(await fetch(W)).blob(),{layers:E}=ye(),{currentLayerIndex:P}=Ye(),{saveHistory:D}=dt(),{addAttachment:M,clearAttachments:j}=jd(),N=(W,re,K,q,Se,we)=>{if(!W.canvas)return W;let ce=document.createElement("canvas");ce.width=q,ce.height=Se;let R=ce.getContext("2d");if(!R)return W;if(we==="canvas-only")R.drawImage(W.canvas,0,0);else{let U=q/re,Y=Se/K,G=Math.min(U,Y),oe=re*G,Pe=K*G,ht=(q-oe)/2,Ae=(Se-Pe)/2;R.drawImage(W.canvas,ht,Ae,oe,Pe)}return{...W,canvas:ce}},L=(W,re)=>{var Se;let K=S.width,q=S.height;if(b({width:W,height:re}),t&&t._painterData&&(t._painterData.canvasWidth=W,t._painterData.canvasHeight=re,(Se=t.updateTitle)==null||Se.call(t,W,re,n)),m==="resize-content"){let we=ye.getState();dt.getState().saveHistory(we.layers,P);let R=we.layers.map(U=>N(U,K,q,W,re,m));we.updateLayers(R)}},O=()=>{c("hidden")},F=()=>{},X=()=>{let W=l.getBoundingRect();W?(d({x:W.x,y:W.y-28}),c("selection")):c("global")},te=()=>{l.reset(),c("global")},ge=()=>{let re=l.getBoundingRect();re||t!=null&&t._canvas&&(re={x:0,y:0,width:t._canvas.width,height:t._canvas.height}),re&&(y(re),l.reset(),c("hidden"))},ne=()=>{y(null),c("global")},Ie={fill:()=>{let W=ye.getState(),re=Ye.getState(),K=dt.getState(),q=W.layers,Se=re.currentLayerIndex,we=q[Se];if(!we||!we.canvas)return;K.saveHistory(q,Se);let ce=we.canvas.getContext("2d");if(ce){if(ce.save(),l.mode==="rect"&&l.selectionRect){let R=l.selectionRect;ce.fillStyle=e.color,ce.fillRect(R.x,R.y,R.width,R.height)}else if(l.mode==="lasso"&&l.lassoPoints.length>2){ce.beginPath(),ce.moveTo(l.lassoPoints[0].x,l.lassoPoints[0].y);for(let U=1;U<l.lassoPoints.length;U++){let Y=l.lassoPoints[U];ce.lineTo(Y.x,Y.y)}ce.closePath(),ce.clip();let R=l.getBoundingRect();R&&(ce.fillStyle=e.color,ce.fillRect(R.x,R.y,R.width,R.height))}else if(l.mode==="magic"&&l.magicClipPath){ce.clip(l.magicClipPath);let R=l.magicBounding;R&&(ce.fillStyle=e.color,ce.fillRect(R.x,R.y,R.width,R.height))}else ce.fillStyle=e.color,ce.fillRect(0,0,we.canvas.width,we.canvas.height);ce.restore(),W.updateLayers([...q])}},clear:()=>{let W=ye.getState(),re=Ye.getState(),K=dt.getState(),q=W.layers,Se=re.currentLayerIndex,we=q[Se];if(!we||!we.canvas)return;K.saveHistory(q,Se);let ce=we.canvas.getContext("2d");if(ce){if(ce.save(),l.mode==="rect"&&l.selectionRect){let R=l.selectionRect;ce.clearRect(R.x,R.y,R.width,R.height)}else if(l.mode==="lasso"&&l.lassoPoints.length>2){ce.beginPath(),ce.moveTo(l.lassoPoints[0].x,l.lassoPoints[0].y);for(let U=1;U<l.lassoPoints.length;U++){let Y=l.lassoPoints[U];ce.lineTo(Y.x,Y.y)}ce.closePath(),ce.clip();let R=l.getBoundingRect();R&&ce.clearRect(R.x,R.y,R.width,R.height)}else if(l.mode==="magic"&&l.magicClipPath){ce.clip(l.magicClipPath);let R=l.magicBounding;R&&ce.clearRect(R.x,R.y,R.width,R.height)}else ce.clearRect(0,0,we.canvas.width,we.canvas.height);ce.restore(),W.updateLayers([...q])}},generativeFill:async()=>{try{let W=await le.executeTool("export_merged_image",{app:window.app,layers:E,fileName:`ai-fill-source-${Date.now()}.png`}),re=JSON.parse(W),K=window.app.vault.getAbstractFileByPath(re.filePath);if(!K){alert("\u753B\u50CF\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F");return}let q=await window.app.vault.readBinary(K),Se=new Blob([q],{type:"image/png"}),we=URL.createObjectURL(Se),ce=new FileReader;ce.onload=async()=>{let R=ce.result;if(j(),M({type:"image",url:we,data:R}),l.mode!=="none"){let U=S.width,Y=S.height,G=document.createElement("canvas");G.width=U,G.height=Y;let oe=G.getContext("2d");if(oe){if(oe.fillStyle="black",oe.fillRect(0,0,U,Y),oe.fillStyle="white",l.mode==="rect"&&l.selectionRect){let Ae=l.selectionRect;oe.fillRect(Ae.x,Ae.y,Ae.width,Ae.height)}else if(l.mode==="lasso"&&l.lassoPoints.length>2){oe.beginPath(),oe.moveTo(l.lassoPoints[0].x,l.lassoPoints[0].y);for(let Ae=1;Ae<l.lassoPoints.length;Ae++){let $e=l.lassoPoints[Ae];oe.lineTo($e.x,$e.y)}oe.closePath(),oe.fill()}else l.mode==="magic"&&l.magicClipPath&&oe.fill(l.magicClipPath);let Pe=G.toDataURL("image/png"),ht=URL.createObjectURL(await _(Pe));M({type:"mask",url:ht,data:Pe})}}l.reset(),c("global"),alert("\u753B\u50CF\u3068\u30DE\u30B9\u30AF\u3092\u30C1\u30E3\u30C3\u30C8\u30DC\u30C3\u30AF\u30B9\u306B\u9001\u4FE1\u3057\u307E\u3057\u305F\u3002\u30D7\u30ED\u30F3\u30D7\u30C8\u3092\u5165\u529B\u3057\u3066AI\u751F\u6210\u3092\u5B9F\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002")},ce.readAsDataURL(Se)}catch(W){console.error("AI\u5857\u308A\u3064\u3076\u3057\u51E6\u7406\u3067\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F:",W),alert("\u753B\u50CF\u306E\u51E6\u7406\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F")}},edit:ge,cancel:te};return(0,mr.jsxs)("div",{className:s==="horizontal"?"flex flex-1 w-full h-full overflow-hidden":"flex flex-col flex-1 w-full h-full overflow-hidden",children:[(0,mr.jsxs)("div",{className:s==="horizontal"?"flex flex-col":"flex flex-row border-b border-modifier-border",children:[(0,mr.jsx)(yg,{tool:e.tool,drawingMode:e.drawingMode,lineWidth:e.lineWidth,selectionMode:e.selectionMode,brushHasColor:e.brushHasColor,brushOpacity:e.brushOpacity,blendStrength:e.blendStrength,mixRatio:e.mixRatio,zoom:n,rotation:r,canvasWidth:S.width,canvasHeight:S.height,actualZoom:x,maintainAspectRatio:g,resizeMode:m,setDrawingMode:e.setDrawingMode,setLineWidth:e.setLineWidth,setSelectionMode:e.setSelectionMode,setBrushHasColor:e.setBrushHasColor,setBrushOpacity:e.setBrushOpacity,setBlendStrength:e.setBlendStrength,setMixRatio:e.setMixRatio,setZoom:i,setRotation:o,setCanvasSize:L,setMaintainAspectRatio:p,setResizeMode:v,layoutDirection:s}),(0,mr.jsx)(vg,{color:e.color,setColor:e.setColor,layoutDirection:s}),(0,mr.jsx)(hg,{handlers:Ie,mode:u==="selection"?"hidden":"global",isFloating:!1,layoutDirection:s})]}),(0,mr.jsxs)("div",{className:"flex flex-1 w-full h-full items-center justify-center overflow-auto bg-secondary relative",ref:a,children:[(0,mr.jsx)(wg,{pointer:e,view:t,zoom:n,rotation:r,containerRef:a,selectionState:l,canvasSize:S,onActualZoomChange:w,onSelectionStart:O,onSelectionUpdate:F,onSelectionEnd:X}),u==="selection"&&(0,mr.jsx)(hg,{handlers:Ie,mode:u,position:f,isFloating:!0}),h&&(0,mr.jsx)(Sg,{rect:h,layers:E,currentLayerIndex:P,onFinish:ne})]})]})}var kx='xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"',Rx='stroke-width="1" stroke-linecap="round" stroke-linejoin="round"',Mx="0 0 24 24",$o=`${kx} viewBox="${Mx}" ${Rx}`,Ke=`${kx} width="20" height="20" viewBox="${Mx}" ${Rx}`,Ox=`
  <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
  <line x1="4" y1="10" x2="20" y2="10"/>
  <line x1="10" y1="20" x2="10" y2="10"/>
`,Fx=`
  <path d="M12 2l3 6L21 9l-4.5 4.5L18 21l-6-3.5L6 21l1.5-7.5L3 9l6-.5L12 2z"/>
  <circle cx="12" cy="12" r="2"/>
`,Nx=`
  <line x1="4" y1="12" x2="20" y2="12"/>
  <circle cx="6" cy="12" r="1"/>
  <circle cx="12" cy="12" r="1"/>
  <circle cx="18" cy="12" r="1"/>
  <line x1="6" y1="8" x2="6" y2="10"/>
  <line x1="12" y1="8" x2="12" y2="10"/>
  <line x1="18" y1="8" x2="18" y2="10"/>
`,Ux=`
  <path d="M4 19v-14A2 2 0 0 1 6 3h14v18H6a2 2 0 0 1 0-4h14"/>
  <path d="M7 7h10"/><path d="M7 11h10"/><path d="M7 15h7"/>
`,Bx=`
  <polyline points="15 4 20 4 20 9"/><line x1="4" y1="20" x2="20" y2="4"/><polyline points="9 20 4 20 4 15"/>
`,xg=`
  <line x1="12" y1="7" x2="12" y2="17"/>
  <line x1="7" y1="12" x2="17" y2="12"/>
`,zx=`
  <polyline points="9 6 15 12 9 18"/>
`,lL=`
  <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
  <rect x="8" y="8" width="8" height="8"/>
`,Xo={moveUp:'<polyline points="6 14 12 8 18 14"/>',moveDown:'<polyline points="6 10 12 16 18 10"/>',add:'<line x1="12" y1="7" x2="12" y2="17"/><line x1="7" y1="12" x2="17" y2="12"/>',addBelow:'<polyline points="12 5 12 15"/><polyline points="8 11 12 15 16 11"/>',delete:'<line x1="8" y1="8" x2="16" y2="16"/><line x1="16" y1="8" x2="8" y2="16"/>',menu:'<circle cx="12" cy="5" r="2" fill="currentColor"/><circle cx="12" cy="12" r="2" fill="currentColor"/><circle cx="12" cy="19" r="2" fill="currentColor"/>'},uo={pen:`
    <path d="M14.7 3.3l6 6-9.4 9.4-4.6 1.3 1.3-4.6 9.4-9.4z" fill="none"/>
    <circle cx="17.8" cy="6.2" r="1.2"/>
  `,brush:`
    <rect x="2" y="10" width="14" height="4" rx="1" ry="1" fill="none"/>
    <path d="M9 14v6" fill="none"/>
    <circle cx="18" cy="12" r="1"/>
    <circle cx="20" cy="12" r="1"/>
    <circle cx="22" cy="12" r="1"/>
  `,"paint-brush":`
    <path d="M4 22c.5-2.5 2-4.5 4-6l9-9-3-3-9 9c-1.5 1.5-3.5 3.5-6 4l5 5z" fill="none"/>
    <path d="M14 5l3 3" fill="none"/>
  `,"color-mixer":`
    <circle cx="9"  cy="9"  r="6" fill="currentColor" fill-opacity="0.25"/>
    <circle cx="15" cy="9"  r="6" fill="currentColor" fill-opacity="0.25"/>
    <circle cx="12" cy="15" r="6" fill="currentColor" fill-opacity="0.25"/>
  `,eraser:`
    <path d="M3 14l7.5-7.5a2 2 0 0 1 2.83 0l5.17 5.17a2 2 0 0 1 0 2.83L13 22a2 2 0 0 1-2.83 0L3 14z" fill="none"/>
    <path d="M14 7l3 3" fill="none"/>
    <path d="M2 22h6" fill="none"/>
  `,selection:`
    <rect x="4" y="4" width="16" height="16" rx="2" ry="2" fill="none"/>
    <path d="M4 9h16" fill="none"/>
    <path d="M9 20V9" fill="none"/>
  `,hand:`
    <path d="M7 12V6a1.5 1.5 0 0 1 3 0v6" fill="none"/>
    <path d="M11 13V3a1.5 1.5 0 0 1 3 0v10" fill="none"/>
    <path d="M16 13V7a1.5 1.5 0 0 1 3 0v10" fill="none"/>
    <path d="M5 16s2 4 7 4 7-4 7-4" fill="none"/>
  `,settings:`
    <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
  `},_g={fileSelect:'<path d="M8 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/><path d="M17 17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h6.5L17 6.5zM4 2a1 1 0 0 0-1 1v12l2.7-2.7a.5.5 0 0 1 .7-.1L10 14l2.6-3.6a.5.5 0 0 1 .9-.1L16 12V6.5h-2A2 2 0 0 1 12 4.5V2z"/>',aiGenerate:'<path d="M7 .3a.9.9 0 0 1 .1 1 8.6 8.6 0 0 0-1 4.1c0 4.8 3.9 8.7 8.8 8.7q.9 0 1.8-.2a.9.9 0 0 1 1 .4.9.9 0 0 1 0 1.1A10 10 0 0 1 10 19C4.5 19 0 14.7 0 9.3 0 5.1 2.5 1.6 6.1.1A.9.9 0 0 1 7 .3M5.8 1.6A8.7 8.7 0 0 0 1.2 9.3c0 4.8 3.9 8.7 8.8 8.7a8.8 8.8 0 0 0 6.2-2.6q-.6.1-1.2.1c-5.5 0-10-4.5-10-10 0-1.4.3-2.7.8-3.9"/><path d="M13 3.8a.3.3 0 0 1 .5 0l.5 1.4c.2.6.7 1.1 1.3 1.3l1.4.5a.3.3 0 0 1 0 .5l-1.4.5a2.1 2.1 0 0 0-1.3 1.3l-.5 1.4a.3.3 0 0 1-.5 0l-.5-1.4a2.1 2.1 0 0 0-1.3-1.3l-1.4-.5a.3.3 0 0 1 0-.5l1.4-.5c.4-.1.7-.5 1.3-1.3zM16.6.1a.2.2 0 0 1 .3 0l.3.9c.1.4.5.7.9.9l.9.3a.2.2 0 0 1 0 .3l-.9.3a1.4 1.4 0 0 0-.9.9l-.3.9a.2.2 0 0 1-.3 0l-.3-.9a1.4 1.4 0 0 0-.9-.9l-.9-.3a.2.2 0 0 1 0-.3l.9-.3c.4-.1.7-.5.9-.9z"/>',clearPath:'<path d="M2 6h20"/><path d="M19 6v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/>'},pi={PSD_ICON_SVG:`<svg ${$o}>${Ox}</svg>`,PAINTER_ICON_SVG:`<svg ${$o}>${Fx}</svg>`,TIMELINE_ICON_SVG:`<svg ${$o}>${Nx}</svg>`,STORYBOARD_ICON_SVG:`<svg ${$o}>${Ux}</svg>`,STORYBOARD_TOGGLE_ICON_SVG:`<svg ${$o}>${Bx}</svg>`,ADD_ICON_SVG:`<svg ${$o}>${xg}</svg>`,FOLD_ICON_SVG:`<svg ${$o}>${zx}</svg>`},jO=`<svg ${Ke}>${Ox}</svg>`,WO=`<svg ${Ke}>${Fx}</svg>`,$O=`<svg ${Ke}>${Nx}</svg>`,XO=`<svg ${Ke}>${Ux}</svg>`,YO=`<svg ${Ke}>${Bx}</svg>`,Vx=`<svg ${Ke}>${zx}</svg>`,cs=`<svg ${Ke}>${xg}</svg>`,zr={moveUp:`<svg ${Ke}>${Xo.moveUp}</svg>`,moveDown:`<svg ${Ke}>${Xo.moveDown}</svg>`,add:`<svg ${Ke}>${Xo.add}</svg>`,addBelow:`<svg ${Ke}>${Xo.addBelow}</svg>`,delete:`<svg ${Ke}>${Xo.delete}</svg>`,menu:`<svg ${Ke}>${Xo.menu}</svg>`},Zd={add:`<svg ${Ke}>${xg}</svg>`,delete:`<svg ${Ke}>${Xo.delete}</svg>`,clip:`<svg ${Ke}>${lL}</svg>`},hi={settings:`<svg ${Ke}>${uo.settings}</svg>`,pen:`<svg ${Ke}>${uo.pen}</svg>`,brush:`<svg ${Ke}>${uo.brush}</svg>`,"paint-brush":`<svg ${Ke}>${uo["paint-brush"]}</svg>`,"color-mixer":`<svg ${Ke}>${uo["color-mixer"]}</svg>`,eraser:`<svg ${Ke}>${uo.eraser}</svg>`,selection:`<svg ${Ke}>${uo.selection}</svg>`,hand:`<svg ${Ke}>${uo.hand}</svg>`},ds={fileSelect:`<svg ${Ke}>${_g.fileSelect}</svg>`,aiGenerate:`<svg ${Ke}>${_g.aiGenerate}</svg>`,clearPath:`<svg ${Ke}>${_g.clearPath}</svg>`};var Yo=H(Fe(),1),mi=H(fe(),1),uL=({icon:e,title:t,options:n,className:r="",disabled:i=!1,variant:o="secondary"})=>{let[a,s]=(0,Yo.useState)(!1),l=(0,Yo.useRef)(null),u=(0,Yo.useRef)(null),c=(y="secondary")=>{switch(y){case"accent":return"bg-accent text-on-accent hover:bg-accent-hover";case"secondary":return"bg-secondary border border-modifier-border text-text-normal hover:bg-modifier-hover";case"danger":return"bg-error text-on-error hover:bg-error-hover";case"primary":default:return"bg-primary border border-modifier-border text-text-normal hover:bg-modifier-hover"}},f=(y="default")=>"text-gray-700 hover:bg-gray-100",d=y=>{y.stopPropagation(),i||s(!a)},h=(y,S)=>{S.stopPropagation(),y.disabled||(y.onClick(),s(!1))};return(0,Yo.useEffect)(()=>{let y=S=>{l.current&&!l.current.contains(S.target)&&u.current&&!u.current.contains(S.target)&&s(!1)};if(a)return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[a]),(0,mi.jsxs)("div",{className:"relative",children:[(0,mi.jsx)("button",{ref:u,className:`p-1 rounded cursor-pointer disabled:opacity-50 flex items-center justify-center ${c(o)} ${r}`,onClick:d,disabled:i,title:t,children:(0,mi.jsx)("span",{dangerouslySetInnerHTML:{__html:e}})}),a&&(0,mi.jsx)("div",{ref:l,className:"absolute top-full right-0 mt-1 bg-white border rounded-lg shadow-xl py-2 z-[9999] whitespace-nowrap",children:n.map((y,S)=>(0,mi.jsxs)("button",{className:`w-full text-left px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 transition-colors ${f(y.variant)}`,onClick:b=>h(y,b),disabled:y.disabled,children:[y.icon&&(0,mi.jsx)("span",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",dangerouslySetInnerHTML:{__html:y.icon}}),(0,mi.jsx)("span",{className:"font-medium",children:y.label})]},S))})]})},Gx=uL;var qd=H(fe(),1),cL=({buttons:e,className:t="",gap:n="gap-2",direction:r="horizontal"})=>{let i=(a="primary")=>{switch(a){case"accent":return"bg-accent text-on-accent hover:bg-accent-hover";case"secondary":return"bg-secondary border border-modifier-border text-text-normal hover:bg-modifier-hover";case"danger":return"bg-error text-on-error hover:bg-error-hover";case"primary":default:return"bg-primary border border-modifier-border text-text-normal hover:bg-modifier-hover"}};return(0,qd.jsx)("div",{className:`flex ${r==="vertical"?"flex-col":""} ${n} ${t}`,children:e.map((a,s)=>a.menuOptions&&a.menuOptions.length>0?(0,qd.jsx)(Gx,{icon:a.icon,title:a.title,options:a.menuOptions,className:a.className,disabled:a.disabled,variant:a.variant},s):(0,qd.jsx)("button",{className:`p-1 rounded cursor-pointer disabled:opacity-50 flex items-center justify-center ${i(a.variant)} ${a.className||""}`,onClick:a.onClick,disabled:a.disabled,title:a.title,dangerouslySetInnerHTML:{__html:a.icon}},s))})},gi=cL;var Ko=H(fe(),1);function Eg({tool:e,onChange:t}){let{layoutDirection:n}=ao(),r=[{id:"settings",title:V("TOOL_SETTINGS"),icon:hi.settings},{id:"selection",title:V("TOOL_SELECTION"),icon:hi.selection},{id:"hand",title:V("TOOL_HAND"),icon:hi.hand}],i=[{id:"pen",title:V("TOOL_PEN"),icon:hi.pen},{id:"brush",title:V("TOOL_BRUSH"),icon:hi.brush},{id:"paint-brush",title:V("TOOL_PAINT_BRUSH"),icon:hi["paint-brush"]},{id:"color-mixer",title:V("TOOL_COLOR_MIXER"),icon:hi["color-mixer"]},{id:"eraser",title:V("TOOL_ERASER"),icon:hi.eraser}],o=n==="horizontal"?"w-[60px] bg-secondary border-r border-modifier-border flex flex-col gap-1 p-1":"h-[60px] bg-secondary border-b border-modifier-border flex flex-row gap-1 p-1",a=n==="horizontal"?"flex flex-col gap-1 items-center":"flex flex-row gap-1 items-center",s=u=>e===u?{backgroundColor:"#3b82f6",color:"#ffffff",borderWidth:"2px",borderColor:"#2563eb"}:{},l=u=>`w-10 h-10 border-none rounded cursor-pointer flex items-center justify-center transition-all duration-200 ${e===u?"shadow-lg scale-110 ring-2 ring-opacity-50":"bg-primary text-text-normal hover:bg-modifier-hover hover:scale-105"}`;return(0,Ko.jsx)("div",{className:o,children:(0,Ko.jsxs)("div",{className:a,children:[(0,Ko.jsx)(gi,{buttons:r.map(u=>({icon:u.icon,title:u.title,className:l(u.id),style:s(u.id),onClick:()=>t(u.id)})),direction:n==="horizontal"?"vertical":"horizontal",gap:"gap-1"}),(0,Ko.jsx)("div",{className:n==="horizontal"?"w-8 h-px bg-modifier-border my-1":"h-full w-px bg-modifier-border mx-1"}),(0,Ko.jsx)(gi,{buttons:i.map(u=>({icon:u.icon,title:u.title,className:l(u.id),style:s(u.id),onClick:()=>t(u.id)})),direction:n==="horizontal"?"vertical":"horizontal",gap:"gap-1"})]})})}var fs=H(fe(),1);function Tg({view:e,app:t}){var g;if(!e)return(0,fs.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-primary text-text-normal",children:"Painter \u30D3\u30E5\u30FC\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093"});let n=fg(),[r,i]=(0,Tn.useState)(100),[o,a]=(0,Tn.useState)(0),{layoutDirection:s}=ao();(0,Tn.useEffect)(()=>{e&&e._painterData&&e.updateTitle&&e.updateTitle(e._painterData.canvasWidth,e._painterData.canvasHeight,r)},[r,e]);let[l,u]=(0,Tn.useState)([]),[c,f]=(0,Tn.useState)(0),d=(0,Tn.useRef)(new Set),h=(0,Tn.useRef)(!1),y=ye(p=>p.layers),S=Ye(p=>p.currentLayerIndex);return(0,Tn.useEffect)(()=>{y.length>0&&(u(y),e&&(e.layers=y))},[y,e]),(0,Tn.useEffect)(()=>{f(S),e&&(e.currentLayerIndex=S)},[S,e]),(0,Tn.useEffect)(()=>{if(y.length>0){let p=dt.getState();p.history.length===0&&p.saveHistory(y,S)}},[y,S]),(0,Tn.useEffect)(()=>{var v;if(!((v=e==null?void 0:e.file)!=null&&v.path)||!t)return;let p=`${e.file.path}-${t.vault.getName()}`;if(d.current.has(p)||h.current)return;d.current.add(p),h.current=!0,(async()=>{var x,w;try{if(((x=e.file)==null?void 0:x.extension)==="psd"){ye.getState().setCurrentPsdFile(e.file);let _=await le.executeTool("load_painter_file",{app:t,file:e.file}),E=JSON.parse(_),P=await Promise.all(E.layers.map(async D=>{let M=document.createElement("canvas");if(M.width=D.width||E.width,M.height=D.height||E.height,D.canvasDataUrl)try{let j=new Image;await new Promise((L,O)=>{j.onload=L,j.onerror=O,j.src=D.canvasDataUrl});let N=M.getContext("2d");N&&N.drawImage(j,0,0)}catch(j){console.warn("Canvas\u5909\u63DB\u30A8\u30E9\u30FC:",D.name,j)}return{name:D.name,visible:D.visible,opacity:D.opacity,blendMode:D.blendMode,canvas:M}}));e.layers=P,e.currentLayerIndex=0,e._painterData={layers:P,currentLayerIndex:0,canvasWidth:E.width,canvasHeight:E.height},dt.getState().clearHistory(),ye.getState().initializeLayers(P),Ye.getState().setCurrentLayerIndex(0),(w=e.updateTitle)==null||w.call(e,E.width,E.height,r)}else ye.getState().clearCurrentPsdFile()}catch(_){console.error("\u274C \u30D5\u30A1\u30A4\u30EB\u51E6\u7406\u30A8\u30E9\u30FC:",_),d.current.delete(p)}finally{h.current=!1}})()},[(g=e==null?void 0:e.file)==null?void 0:g.path,t]),(0,fs.jsxs)("div",{className:s==="horizontal"?"flex w-full h-full overflow-hidden":"flex flex-col w-full h-full overflow-hidden",children:[(0,fs.jsx)(Eg,{tool:n.tool,onChange:p=>n.setTool(p)}),(0,fs.jsx)(bg,{pointer:n,view:e,zoom:r,rotation:o,setZoom:i,setRotation:a})]})}var Jd=class{createPainterView(t){let n=new jo(t,()=>this.renderReactComponent(n));return n}renderReactComponent(t){t.contentEl.empty(),t.contentEl.style.width="100%",t.contentEl.style.height="100%",t.contentEl.style.display="flex",t.reactRoot=(0,Hx.createRoot)(t.contentEl),t.reactRoot.render(jx.default.createElement(Tg,{view:t,app:t.app}))}};var Qd=class{constructor(t){this.plugin=t,this.factory=new Jd}initialize(){(0,ef.addIcon)("palette",pi.PAINTER_ICON_SVG),this.plugin.registerView("psd-view",t=>this.factory.createPainterView(t)),this.plugin.registerExtensions(["psd","painter"],"psd-view"),this.plugin.app.workspace.on("file-menu",(t,n)=>{n instanceof ef.TFile&&n.extension.toLowerCase().match(/^(png|jpe?g|gif|webp)$/)&&t.addItem(r=>{r.setTitle("PSD\u3067\u958B\u304F").setIcon("image").onClick(async()=>{await le.executeTool("create_painter_file",{app:this.plugin.app,imageFile:n})})})}),this.plugin.registerDomEvent(document,"keydown",t=>{t.ctrlKey&&t.key==="z"&&!t.shiftKey&&(t.preventDefault(),this.plugin.app.workspace.getActiveViewOfType(jo)&&le.executeTool("undo_painter",{})),(t.ctrlKey&&t.shiftKey&&t.key==="z"||t.ctrlKey&&t.key==="y")&&(t.preventDefault(),this.plugin.app.workspace.getActiveViewOfType(jo)&&le.executeTool("redo_painter",{}))}),this.plugin.register(()=>{this.plugin.app.workspace.detachLeavesOfType("psd-view")})}};var f2=require("obsidian");var c2=H(vl(),1),d2=H(Fe(),1);var er=H(Fe(),1),Bg=require("obsidian");var mn=H(Fe(),1),hs=H(o2(),1),ft=H(fe(),1),jL=({project:e,storyboardData:t,currentTime:n,onTimeUpdate:r})=>{let i=(0,mn.useRef)(null),o=(0,mn.useRef)(null),[a,s]=(0,mn.useState)(!1),[l,u]=(0,mn.useState)(0),[c,f]=(0,mn.useState)(!1),[d,h]=(0,mn.useState)(0);(0,mn.useEffect)(()=>{if(!i.current)return;let m=i.current;m.width=320,m.height=180;let v=new hs.default.Movie({canvas:m});return v.width=320,v.height=180,o.current=v,()=>{o.current&&(o.current.stop(),o.current=null)}},[]),(0,mn.useEffect)(()=>{if(!o.current||!e||!t)return;let m=o.current;f(!0),m.layers.length=0;try{t.chapters.forEach(x=>{x.frames.forEach(w=>{if(w.imageUrl&&w.startTime!==void 0&&w.duration!==void 0){let _=new hs.default.layer.Image({startTime:w.startTime,duration:w.duration,source:w.imageUrl,x:0,y:0,width:320,height:180});if(m.addLayer(_),w.dialogues){let E=new hs.default.layer.Text({startTime:w.startTime,duration:w.duration,text:`${w.speaker}: ${w.dialogues}`,x:20,y:300,width:600,height:40,font:"16px Arial"});m.addLayer(E)}}})}),e.stage.tracks.forEach(x=>{x.clips.forEach(w=>{if(w.assetPath&&w.assetPath.trim())try{if(w.assetPath.match(/\.(mp4|webm|ogg)$/i)){let _=document.createElement("video");_.src=w.assetPath,_.crossOrigin="anonymous";let E=new hs.default.layer.Video({startTime:w.startTime,duration:w.duration,source:_,x:0,y:0,width:640,height:360});m.addLayer(E)}else if(w.assetPath.match(/\.(jpg|jpeg|png|gif|webp)$/i)){let _=new hs.default.layer.Image({startTime:w.startTime,duration:w.duration,source:w.assetPath,x:0,y:0,width:640,height:360});m.addLayer(_)}}catch(_){console.warn("\u30EC\u30A4\u30E4\u30FC\u8FFD\u52A0\u30A8\u30E9\u30FC:",_)}})});let v=Math.max(...m.layers.map(x=>x.startTime+x.duration),0);u(v)}catch(v){console.error("\u30D7\u30EC\u30D3\u30E5\u30FC\u4F5C\u6210\u30A8\u30E9\u30FC:",v)}finally{f(!1)}},[e,t]),(0,mn.useEffect)(()=>{o.current&&!a&&(o.current.currentTime=n,o.current.refresh())},[n,a]);let y=(0,mn.useMemo)(()=>t?t.chapters.map(v=>v.frames.filter(x=>x.startTime!==void 0&&x.duration!==void 0).map(x=>({startTime:x.startTime,duration:x.duration,speaker:x.speaker,dialogues:x.dialogues,imageUrl:x.imageUrl}))).reduce((v,x)=>v.concat(x),[]).sort((v,x)=>v.startTime-x.startTime):[],[t]);(0,mn.useEffect)(()=>{let m=y.findIndex(v=>n>=v.startTime&&n<v.startTime+v.duration);m!==-1&&h(m)},[n,y]);let S=()=>{if(d>0){let m=y[d-1];r==null||r(m.startTime)}},b=()=>{if(d<y.length-1){let m=y[d+1];r==null||r(m.startTime)}},g=async()=>{if(o.current)try{if(a)o.current.pause(),s(!1);else{o.current.currentTime=n,await o.current.play(),s(!0);let m=()=>{if(o.current&&a){let v=o.current.currentTime;r==null||r(v),v<l?requestAnimationFrame(m):s(!1)}};requestAnimationFrame(m)}}catch(m){console.error("\u518D\u751F\u30A8\u30E9\u30FC:",m),s(!1)}},p=m=>{if(!o.current)return;let v=m.currentTarget.getBoundingClientRect(),_=(m.clientX-v.left)/v.width*l;o.current.currentTime=_,o.current.refresh(),r==null||r(_)};return(0,ft.jsxs)("div",{className:"video-preview bg-secondary border border-modifier-border rounded p-4",children:[(0,ft.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"\u30D7\u30EC\u30D3\u30E5\u30FC"}),(0,ft.jsxs)("div",{className:"relative bg-black rounded overflow-hidden",children:[(0,ft.jsx)("button",{onClick:S,disabled:d<=0,className:"absolute left-2 top-1/2 transform -translate-y-1/2 z-30 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 disabled:opacity-30 disabled:cursor-not-allowed",title:"\u524D\u306E\u30B7\u30FC\u30F3",children:(0,ft.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,ft.jsx)("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),(0,ft.jsx)("button",{onClick:b,disabled:d>=y.length-1,className:"absolute right-2 top-1/2 transform -translate-y-1/2 z-30 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 disabled:opacity-30 disabled:cursor-not-allowed",title:"\u6B21\u306E\u30B7\u30FC\u30F3",children:(0,ft.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,ft.jsx)("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})})}),(0,ft.jsx)("canvas",{ref:i,className:"block",style:{width:"800px",height:"450px"}}),c&&(0,ft.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,ft.jsx)("div",{className:"text-white",children:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."})}),y.length>0&&y[d]&&(0,ft.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 bg-black bg-opacity-70 text-white p-2 rounded text-sm",children:[(0,ft.jsx)("div",{className:"font-semibold",children:y[d].speaker}),(0,ft.jsx)("div",{className:"text-xs opacity-90",children:y[d].dialogues}),(0,ft.jsxs)("div",{className:"text-xs opacity-70 mt-1",children:["\u30B7\u30FC\u30F3 ",d+1," / ",y.length]})]})]}),(0,ft.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,ft.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ft.jsx)("button",{onClick:g,disabled:c||!o.current,className:"px-4 py-2 bg-accent text-on-accent rounded hover:bg-accent-hover disabled:opacity-50",children:a?"\u4E00\u6642\u505C\u6B62":"\u518D\u751F"}),(0,ft.jsxs)("span",{className:"text-sm text-text-muted",children:[n.toFixed(1),"s / ",l.toFixed(1),"s"]})]}),(0,ft.jsx)("div",{className:"w-full h-2 bg-primary border border-modifier-border rounded cursor-pointer",onClick:p,children:(0,ft.jsx)("div",{className:"h-full bg-accent rounded",style:{width:`${l>0?n/l*100:0}%`}})})]})]})},a2=jL;var gs=H(Fe(),1);var gr=H(Fe(),1),ms=H(fe(),1);function Ug({clip:e,clipIndex:t,trackIndex:n,pixelsPerSecond:r,isSelected:i,onClipChange:o,onClipMove:a,onClipResize:s}){let[l,u]=(0,gr.useState)(null),[c,f]=(0,gr.useState)(e.startTime||0),[d,h]=(0,gr.useState)(e.duration||5),y=(0,gr.useRef)(null),S=(0,gr.useRef)({startTime:0,duration:0}),b=(0,gr.useRef)(!1);(0,gr.useEffect)(()=>{l!=null&&l.isDragging||b.current||(f(e.startTime||0),h(e.duration||5),S.current={startTime:e.startTime||0,duration:e.duration||5})},[e.startTime||0,e.duration||5,l==null?void 0:l.isDragging]),(0,gr.useEffect)(()=>{if(!(l!=null&&l.isDragging))return;let v=w=>{if(!l)return;let E=(w.clientX-l.startX)/r;if(l.isResizing){if(l.resizeEdge==="left"){let P=Math.max(0,S.current.startTime+E),D=Math.max(.1,S.current.duration-E);f(P),h(D)}else if(l.resizeEdge==="right"){let P=Math.max(.1,S.current.duration+E);h(P)}}else{let P=Math.max(0,S.current.startTime+E);f(P)}},x=()=>{if(l){if(b.current=!0,l.isResizing){let w=c,_=d;l.resizeEdge==="left"?s?(s(n,t,w,_),setTimeout(()=>{b.current=!1,S.current={startTime:w,duration:_}},50)):Promise.resolve().then(()=>{o(n,t,"start",w.toString()),o(n,t,"duration",_.toString()),setTimeout(()=>{b.current=!1,S.current={startTime:w,duration:_}},50)}):(o(n,t,"duration",_.toString()),setTimeout(()=>{b.current=!1,S.current={startTime:e.startTime||0,duration:_}},50))}else a(n,t,c),setTimeout(()=>{b.current=!1,S.current={startTime:c,duration:e.duration||5}},50);u(null)}};return document.addEventListener("mousemove",v),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",x)}},[l,r,n,t,c,d,o,a,e.startTime||0,e.duration||5]);let g=v=>{v.preventDefault(),v.stopPropagation();let x=v.currentTarget.getBoundingClientRect(),w=v.clientX-x.left,_=x.width;w<10?(S.current={startTime:e.startTime||0,duration:e.duration||5},u({isDragging:!0,startX:v.clientX,isResizing:!0,resizeEdge:"left"})):w>_-10?(S.current={startTime:e.startTime||0,duration:e.duration||5},u({isDragging:!0,startX:v.clientX,isResizing:!0,resizeEdge:"right"})):(S.current={startTime:e.startTime||0,duration:e.duration||5},u({isDragging:!0,startX:v.clientX}))},p=v=>{v.preventDefault(),v.stopPropagation(),S.current={startTime:e.startTime||0,duration:e.duration||5},u({isDragging:!0,startX:v.clientX,isResizing:!0,resizeEdge:"left"})},m=v=>{v.preventDefault(),v.stopPropagation(),S.current={startTime:e.startTime||0,duration:e.duration||5},u({isDragging:!0,startX:v.clientX,isResizing:!0,resizeEdge:"right"})};return(0,ms.jsxs)("div",{ref:y,className:`absolute top-0.5 h-7 bg-secondary text-text-normal text-xs flex items-center justify-center border rounded-sm select-none ${i||l!=null&&l.isDragging?"border-accent bg-accent bg-opacity-20 z-20":"border-modifier-border"}`,style:{left:`${c*r}px`,width:`${d*r}px`,cursor:l!=null&&l.isResizing?l.resizeEdge==="left"?"w-resize":"e-resize":"move"},onMouseDown:g,title:`${e.assetPath} (${c.toFixed(2)}s - ${(c+d).toFixed(2)}s)`,children:[(0,ms.jsx)("span",{className:"px-1 truncate pointer-events-none",children:e.assetPath.split("/").pop()||"Untitled"}),(0,ms.jsx)("div",{className:"absolute left-0 top-0 h-full cursor-w-resize opacity-0 hover:opacity-100 bg-accent z-30",style:{width:"10px"},onMouseDown:p}),(0,ms.jsx)("div",{className:"absolute right-0 top-0 h-full cursor-e-resize opacity-0 hover:opacity-100 bg-accent z-30",style:{width:"10px"},onMouseDown:m})]})}var vr=H(fe(),1);function Ql({track:e,trackIndex:t,currentTime:n,pixelsPerSecond:r,timelineWidth:i=600,onClipChange:o,onClipMove:a,onClipResize:s,onAddClip:l,onTimeSeek:u,onFileDrop:c}){let[f,d]=(0,gs.useState)(!1),[h,y]=(0,gs.useState)(null),S=(0,gs.useRef)(null),b=(0,gs.useRef)(null),g=w=>{let _=w.currentTarget.getBoundingClientRect(),P=(w.clientX-_.left)/r;u(P),y(null)},p=w=>{w.preventDefault(),d(!0)},m=w=>{w.preventDefault(),d(!1)},v=w=>{if(w.preventDefault(),d(!1),!c)return;let _=w.currentTarget.getBoundingClientRect(),P=(w.clientX-_.left)/r;w.dataTransfer.files.length>0&&c(t,w.dataTransfer.files,P)},x=w=>{let _=w.target.files;_&&_.length>0&&l(t,_),w.target.value=""};return(0,vr.jsxs)("div",{className:"flex items-center",children:[(0,vr.jsx)("span",{className:"text-text-normal flex-shrink-0",style:{width:"200px"},children:e.name}),(0,vr.jsx)("button",{onClick:()=>{var w;return(w=b.current)==null?void 0:w.click()},className:"mr-2 px-2 py-1 text-xs bg-accent text-on-accent rounded hover:bg-accent-hover",children:"+"}),(0,vr.jsx)("input",{ref:b,type:"file",multiple:!0,className:"hidden",onChange:x}),(0,vr.jsxs)("div",{ref:S,className:`relative h-8 bg-primary border cursor-pointer w-full ${f?"border-accent border-dashed border-2":"border-modifier-border"}`,onClick:g,onDragOver:p,onDragLeave:m,onDrop:v,children:[(0,vr.jsx)("div",{className:"absolute top-0 w-0.5 h-full bg-red-500 z-10 pointer-events-none",style:{left:`${n*r}px`}}),e.clips.map((w,_)=>(0,vr.jsx)(Ug,{clip:w,clipIndex:_,trackIndex:t,pixelsPerSecond:r,isSelected:h===_,onClipChange:o,onClipMove:a,onClipResize:s},_)),f&&(0,vr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-accent bg-opacity-10 border-2 border-dashed border-accent",children:(0,vr.jsx)("span",{className:"text-accent font-semibold",children:"\u30D5\u30A1\u30A4\u30EB\u3092\u30C9\u30ED\u30C3\u30D7"})})]})]})}var gn=H(fe(),1);function WL(e){let t=e.match(/customLayerData\s*=\s*\{([\s\S]*?)\}/);if(!t)return;let r=t[1].match(/string\s+originalContent\s*=\s*"((?:[^"\\]|\\.)*)"/);if(r)return r[1].replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}function $L(e){let t=e.split(`
`),n={title:"",chapters:[],characters:[]},r=null,i=null,o=!1,a=!1,s=!1;function l(){return{dialogues:"",speaker:"",imageUrl:void 0,imagePrompt:void 0,prompt:void 0,endTime:0,startTime:0,duration:5}}function u(){r&&i&&i.frames.push(r),r=null}for(let c=0;c<t.length;c++){let f=t[c].trimEnd();if(f.startsWith("```")){s=!s;continue}if(!s){if(f.startsWith("### \u30AD\u30E3\u30E9\u30AF\u30BF\u30FC")){o=!0,a=!1;continue}if(f.startsWith("### ")){let d=f.replace(/^###\s*/,"");i&&(u(),n.chapters.push(i)),i={bgmPrompt:d,frames:[]},o=!1,a=!0;continue}if(a){if(f.startsWith("####"))u(),r=l(),r.speaker=f.replace(/^####\s*/,"");else if(r){let d=f.match(/^>\s*\[!INFO\]\s*(.*)$/),h=f.match(/^\[(.*)\]\((.*)\)$/);if(d){let S=d[1].trim().match(/start:\s*(\d+(?:\.\d+)?),\s*duration:\s*(\d+(?:\.\d+)?)/);S&&(r.startTime=parseFloat(S[1]),r.duration=parseFloat(S[2]));let b=[];for(;c+1<t.length&&t[c+1].trimStart().startsWith(">");){let g=t[c+1].replace(/^>\s*/,"").trim();g&&b.push(g),c++}b.length>0&&(r.prompt=b.join(`
`))}else h?(r.imagePrompt=h[1],r.imageUrl=h[2]):f.trim()&&!f.startsWith(">")&&(r.dialogues+=(r.dialogues?`
`:"")+f)}}}}return u(),i&&n.chapters.push(i),n}function s2(e,t=0,n=5){return{path:`/Clips/clip_${Date.now()}`,name:e.split("/").pop()||"Untitled",assetPath:e,startTime:t,duration:n,clipType:"video"}}function l2(e){return{path:`/Tracks/${e.replace(/\s+/g,"_")}`,name:e,trackType:"video",clips:[]}}var XL=({app:e,file:t})=>{let[n,r]=(0,er.useState)(null),[i,o]=(0,er.useState)(null),[a,s]=(0,er.useState)(0),l=(0,er.useRef)(null),u=(0,er.useMemo)(()=>i?i.chapters.map(v=>{var _;let x=Math.min(...v.frames.map(E=>{var P;return(P=E.startTime)!=null?P:0})),w=Math.max(...v.frames.map(E=>{var P,D;return((P=E.startTime)!=null?P:0)+((D=E.duration)!=null?D:0)}));return{bgmPrompt:(_=v.bgmPrompt)!=null?_:"",startTime:x,duration:w-x}}):[],[i]);(0,er.useEffect)(()=>{if(!t)return;(async()=>{try{let x=await le.executeTool("load_usd_file",{app:e,file:t}),w={schemaIdentifier:"usd",schemaVersion:"1.0",name:t.basename,stage:{tracks:[],timeCodesPerSecond:30,startTimeCode:0,endTimeCode:1e3},applicationMetadata:{version:"1.0",creator:"Obsidian Storyboard",sourceMarkdown:WL(x)}};if(w.stage.tracks.length===0)for(let E=1;E<5;E++)w.stage.tracks.push(l2(`Track ${E}`));r(w);let _=w.applicationMetadata.sourceMarkdown;if(_)try{let E=$L(_);o(E)}catch(E){console.error("Failed to parse storyboard data:",E)}}catch(x){console.error(x)}})()},[e,t]);let c=async v=>{if(t)try{let x=ss.generateUsdaContent(v);await le.executeTool("save_usd_file",{app:e,file:t,content:x}),r(v)}catch(x){console.error(x)}},f=(v,x,w,_)=>{n&&r(E=>{if(!E)return E;let P=JSON.parse(JSON.stringify(E)),D=P.stage.tracks[v].clips[x];return w==="path"?(D.assetPath=_,D.name=_.split("/").pop()||"Untitled"):w==="start"?D.startTime=parseFloat(_)||0:D.duration=parseFloat(_)||0,c(P),P})},d=async v=>{var j,N;let w=e.vault.getFiles().find(L=>L.name===v.name);if(w)return w.path;let _=await v.arrayBuffer(),E=((N=(j=e.workspace.getActiveFile())==null?void 0:j.parent)==null?void 0:N.path)||"",P=E?(0,Bg.normalizePath)(`${E}/assets`):"assets";try{e.vault.getAbstractFileByPath(P)||await e.vault.createFolder(P)}catch(L){}let D=(0,Bg.normalizePath)(`${P}/${v.name}`);return(await e.vault.createBinary(D,_)).path},h=async(v,x)=>{if(!n)return;let w=JSON.parse(JSON.stringify(n)),_=Math.max(...w.stage.tracks[v].clips.map(E=>E.startTime+E.duration),0);for(let E of Array.from(x)){let P=await d(E),D=s2(P,_,5);w.stage.tracks[v].clips.push(D),_+=D.duration}r(w),c(w)},y=()=>{if(!n)return;let v=JSON.parse(JSON.stringify(n)),x=v.stage.tracks.length+1,w=l2(`Track ${x}`);v.stage.tracks.push(w),r(v),c(v)},S=(v,x,w)=>{if(!n)return;let _=JSON.parse(JSON.stringify(n)),E=_.stage.tracks[v].clips[x];E.startTime=w,r(_),c(_)},b=(v,x,w,_)=>{n&&r(E=>{if(!E)return E;let P=JSON.parse(JSON.stringify(E)),D=P.stage.tracks[v].clips[x];return D.startTime=w,D.duration=_,c(P),P})},g=async(v,x,w)=>{if(!n)return;let _=JSON.parse(JSON.stringify(n)),E=w;for(let P of Array.from(x)){let D=await d(P),M=5,j=s2(D,E,M);_.stage.tracks[v].clips.push(j),E+=M}r(_),c(_)},p=(0,er.useMemo)(()=>{if(!n||!i)return 60;let v=Math.max(...n.stage.tracks.flatMap(w=>w.clips.map(_=>_.startTime+_.duration)),0),x=Math.max(...i.chapters.flatMap(w=>w.frames.map(_=>(_.startTime||0)+(_.duration||0))),0);return Math.max(v,x,60)},[n,i]),m=(0,er.useMemo)(()=>20,[]);return n?(0,gn.jsxs)("div",{className:"flex flex-col",style:{height:"calc(100vh - 100px)"},children:[(0,gn.jsx)("div",{className:"flex-shrink-0",children:(0,gn.jsx)(a2,{project:n,storyboardData:i,currentTime:a,onTimeUpdate:s})}),(0,gn.jsxs)("div",{className:"flex-1 overflow-x-auto overflow-y-auto min-h-0",children:[n.stage.tracks.map((v,x)=>(0,gn.jsx)(Ql,{track:v,trackIndex:x,currentTime:a,pixelsPerSecond:m,onClipChange:f,onClipMove:S,onClipResize:b,onAddClip:h,onTimeSeek:s,onFileDrop:g},x)),(0,gn.jsx)("div",{className:"flex-shrink-0 p-2",children:(0,gn.jsx)("button",{onClick:y,className:"px-3 py-1 text-sm bg-accent text-on-accent rounded hover:bg-accent-hover",children:"\u30C8\u30E9\u30C3\u30AF\u3092\u8FFD\u52A0"})})]}),(0,gn.jsxs)("div",{className:"flex-shrink-0 overflow-x-auto",children:[(0,gn.jsx)(Ql,{track:{path:"/BGM",name:"BGM",trackType:"audio",clips:u.map(v=>({path:`/BGM/clip_${v.startTime}`,name:v.bgmPrompt,assetPath:v.bgmPrompt,startTime:v.startTime,duration:v.duration,clipType:"audio"}))},trackIndex:-1,currentTime:a,pixelsPerSecond:m,onClipChange:()=>{},onClipMove:()=>{},onClipResize:()=>{},onAddClip:(v,x)=>{},onTimeSeek:s}),(0,gn.jsx)(Ql,{track:{path:"/Story",name:"\u30B9\u30C8\u30FC\u30EA\u30FC",trackType:"video",clips:(i==null?void 0:i.chapters.flatMap(v=>v.frames).map(v=>({path:`/Story/clip_${v.startTime||0}`,name:v.speaker,assetPath:v.speaker,startTime:v.startTime||0,duration:v.duration||0,clipType:"video"})))||[]},trackIndex:-2,currentTime:a,pixelsPerSecond:m,onClipChange:()=>{},onClipMove:()=>{},onClipResize:()=>{},onAddClip:(v,x)=>{},onTimeSeek:s})]})]}):(0,gn.jsxs)("div",{className:"timeline-view p-4",children:[(0,gn.jsx)("h2",{children:"Timeline View (USD)"}),(0,gn.jsx)("p",{children:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."})]})},u2=XL;var af=require("obsidian"),YL="timeline-view",of=class extends af.FileView{constructor(n,r){super(n);this.reactRoot=null;this.renderReact=r}getViewType(){return YL}getDisplayText(){var n;return((n=this.file)==null?void 0:n.basename)||"Timeline"}getState(){var n,r;return{file:(r=(n=this.file)==null?void 0:n.path)!=null?r:null}}async setState(n){if(!n.file)return;let r=this.app.vault.getAbstractFileByPath(n.file);r instanceof af.TFile&&(this.file=r,this.renderReact())}async onClose(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null)}};var sf=class{createTimelineView(t){let n=new of(t,()=>this.renderReactComponent(n));return n}renderReactComponent(t){t.containerEl.empty(),t.reactRoot=(0,c2.createRoot)(t.containerEl),t.reactRoot.render(d2.default.createElement(u2,{app:t.app,file:t.file}))}};var lf=class{constructor(t){this.plugin=t,this.factory=new sf}initialize(){(0,f2.addIcon)("timeline",pi.TIMELINE_ICON_SVG),this.plugin.registerView("timeline-view",t=>this.factory.createTimelineView(t)),this.plugin.registerExtensions(["usda","timeline"],"timeline-view"),this.plugin.register(()=>{this.plugin.app.workspace.detachLeavesOfType("timeline-view")})}};var su=require("obsidian");var au=require("obsidian"),C2=H(vl(),1);var I2=H(Fe(),1);var iu=require("obsidian"),Ct=H(Fe(),1);var qo=H(Fe(),1);var on=H(Fe(),1);function zg(){return{imageUrl:"",speaker:"",dialogues:"",imagePrompt:"",prompt:"",endTime:""}}function Vg(e,t){let[n,r]=(0,on.useState)(e);(0,on.useEffect)(()=>{r(e)},[e]);let i=(0,on.useCallback)(p=>{r(m=>{let v=p(m);return t(v),v})},[t]),o=(0,on.useCallback)((p,m,v,x)=>{i(w=>{let _=w.chapters.map((E,P)=>{if(P!==p)return E;let D=E.frames.map((M,j)=>j===m?{...M,[v]:x}:M);return{...E,frames:D}});return{...w,chapters:_}})},[i]),a=(0,on.useCallback)(p=>{let m=zg();i(v=>{let x=v.chapters.map((w,_)=>_===p?{...w,frames:[...w.frames,m]}:w);return{...v,chapters:x}})},[i]),s=(0,on.useCallback)((p,m)=>{i(v=>{let x=v.chapters.map((w,_)=>_!==p?w:{...w,frames:w.frames.filter((E,P)=>P!==m)});return{...v,chapters:x}})},[i]),l=(0,on.useCallback)((p,m)=>{m<=0||i(v=>{let x=v.chapters.map((w,_)=>{if(_!==p)return w;let E=[...w.frames],P=E[m];return E[m]=E[m-1],E[m-1]=P,{...w,frames:E}});return{...v,chapters:x}})},[i]),u=(0,on.useCallback)((p,m)=>{i(v=>{let x=v.chapters.map((w,_)=>{if(_!==p||m>=w.frames.length-1)return w;let E=[...w.frames],P=E[m];return E[m]=E[m+1],E[m+1]=P,{...w,frames:E}});return{...v,chapters:x}})},[i]),c=(0,on.useCallback)((p,m)=>{let v=zg();i(x=>{let w=x.chapters.map((_,E)=>{if(E!==p)return _;let P=[..._.frames];return P.splice(m+1,0,v),{..._,frames:P}});return{...x,chapters:w}})},[i]),f=(0,on.useCallback)(p=>{let m=zg(),v={bgmPrompt:p!=null?p:"",frames:[m]};i(x=>({...x,chapters:[...x.chapters,v]}))},[i]),d=(0,on.useCallback)(p=>{i(m=>{let v=m.chapters.filter((x,w)=>w!==p);return{...m,chapters:v}})},[i]),h=(0,on.useCallback)(p=>{i(m=>{var E;let v=((E=m.characters)!=null?E:[]).map(P=>P.name),x=p.map(P=>P.name),w={};v.forEach((P,D)=>{P&&P!==x[D]&&(w[P]=x[D])});let _=m.chapters.map(P=>({...P,frames:P.frames.map(D=>{let M=w[D.speaker];return M?{...D,speaker:M}:D})}));return{...m,characters:p,chapters:_}})},[i]),S=(0,on.useCallback)(p=>{var x;if(!p)return[];let m=((x=p.characters)!=null?x:[]).map(w=>w.name),v=p.chapters.flatMap(w=>w.frames.map(_=>_.speaker));return Array.from(new Set([...m,...v])).filter(w=>typeof w=="string"&&w.trim()!=="")},[])(n),g=S.map(p=>{var v;let m=((v=n.characters)!=null?v:[]).find(x=>x.name===p);return m||{name:p,attributes:{\u8AAC\u660E:""}}});return{storyboard:n,setStoryboard:r,handleCellChange:o,addRow:a,deleteRow:s,moveRowUp:l,moveRowDown:u,insertRowBelow:c,addChapter:f,deleteChapter:d,saveCharacters:h,uniqueSpeakers:S,allCharacters:g}}function Gg(e,t){let[n,r]=(0,qo.useState)({title:"",chapters:[{bgmPrompt:"calm acoustic guitar, soft piano, peaceful ambient instrumental",frames:[]}],characters:[]}),[i,o]=(0,qo.useState)(!0),a=(0,qo.useCallback)(async l=>{if(t)try{await le.executeTool("save_storyboard_data",{app:e,file:t,data:JSON.stringify(l)})}catch(u){console.error(u)}},[e,t]),s=Vg(n,a);return(0,qo.useEffect)(()=>{(async()=>{if(t)try{o(!0);let u=await le.executeTool("load_storyboard_data",{app:e,file:t});r(JSON.parse(u))}catch(u){console.error(u)}finally{o(!1)}})()},[e,t]),{isLoading:i,handleDataChange:a,...s}}var jr=En(e=>({selectedFrame:null,setSelectedFrame:t=>e({selectedFrame:t}),clearSelectedFrame:()=>e({selectedFrame:null})}));var eu=En(e=>({selectedRowIndex:null,setSelectedRowIndex:t=>e({selectedRowIndex:t}),clearSelectedRowIndex:()=>e({selectedRowIndex:null})}));var Jo=H(Fe(),1);var pt=H(fe(),1),KL=({data:e,columns:t,onCellChange:n,onAddRow:r,onDeleteRow:i,onMoveRowUp:o,onMoveRowDown:a,onInsertRowBelow:s,onMoveRowTo:l,showAddRow:u=!0,onRowClick:c,headerTop:f,selectedRowIndexes:d,onSelectRow:h,onClearSelection:y})=>{let[S,b]=(0,Jo.useState)(Array.from({length:t.length},(P,D)=>D===0||D===1?Math.round(404.5):D===2?250:Math.round(404.5))),g=(0,Jo.useRef)(null),p=(0,Jo.useRef)(0),m=(0,Jo.useRef)(0),v=(0,Jo.useRef)(0),x=(P,D)=>{g.current=P,p.current=D.clientX,m.current=S[P]||300,v.current=S[P+1]||300,document.body.style.cursor="col-resize",window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)},w=P=>{if(g.current===null)return;let D=P.clientX-p.current;b(M=>{let j=[...M],N=g.current;if(N!==null&&N<t.length-1){let L=N+1,O=Math.max(80,m.current+D),F=Math.max(80,v.current-D);j[N]=O,j[L]=F}return j})},_=()=>{g.current=null,document.body.style.cursor="",window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)},E=S.reduce((P,D)=>(P||0)+(D||0),0)||1;return(0,pt.jsx)("div",{children:(0,pt.jsxs)("table",{className:"border-collapse border border-modifier-border mb-0 w-full table-fixed",children:[(0,pt.jsxs)("colgroup",{children:[t.map((P,D)=>(0,pt.jsx)("col",{style:{width:(S[D]||0)/E*100+"%"}},String(P.key))),(0,pt.jsx)("col",{style:{width:"40px"}})]}),(0,pt.jsxs)("thead",{children:[f,(0,pt.jsxs)("tr",{className:"bg-secondary",children:[t.map((P,D)=>(0,pt.jsx)("th",{className:"border border-modifier-border px-4 py-2 text-left relative group select-none",style:{width:(S[D]||0)/E*100+"%"},children:(0,pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,pt.jsx)("span",{children:P.header}),D<t.length-1&&(0,pt.jsx)("div",{className:"absolute right-0 top-0 h-full w-2 cursor-col-resize z-10 bg-transparent hover:bg-accent-hover transition",onMouseDown:M=>x(D,M)})]})},String(P.key))),(0,pt.jsx)("th",{className:"border border-modifier-border px-2 py-2"})]})]}),(0,pt.jsxs)("tbody",{children:[e.map((P,D)=>{var j;let M=(j=d==null?void 0:d.includes(D))!=null?j:!1;return(0,pt.jsxs)("tr",{className:`${M?"bg-accent text-on-accent":"hover:bg-modifier-hover"}`,onClick:()=>c==null?void 0:c(P,D),children:[t.map(N=>{var L;return(0,pt.jsx)("td",{className:"border border-modifier-border px-4 py-2 align-top",children:N.renderCell?N.renderCell(P[N.key],P,(O,F)=>n(D,O,F),D,void 0):String((L=P[N.key])!=null?L:"")},`${D}-${String(N.key)}`)}),(0,pt.jsx)("td",{className:"border border-modifier-border px-1 py-2 text-center align-middle whitespace-nowrap",children:(0,pt.jsx)(gi,{direction:"vertical",gap:"gap-y-1",className:"items-center",buttons:[...s?[{icon:zr.add,onClick:N=>{N.stopPropagation(),s(D)},title:"\u4E0B\u306B\u884C\u3092\u633F\u5165",variant:"secondary",className:"text-text-faint hover:text-accent text-base px-1 py-0.5 leading-none"}]:[],{icon:zr.menu,title:"\u884C\u64CD\u4F5C",variant:"secondary",className:"text-text-faint hover:text-accent text-base px-1 py-0.5 leading-none",menuOptions:[...h?[{label:M?"\u9078\u629E\u3092\u89E3\u9664":"\u9078\u629E\u72B6\u614B\u306B\u3059\u308B",icon:"\u2713",onClick:()=>h(D,!M),variant:"default"}]:[],...l&&d&&d.length>0&&!d.includes(D)?[{label:`\u9078\u629E\u3057\u305F${d.length}\u884C\u3092\u3053\u3053\u306B\u79FB\u52D5`,icon:"\u2192",onClick:()=>{d&&d.length>0&&(l(d[0],D),y==null||y())},variant:"default"}]:[],...o&&D>0?[{label:"\u884C\u3092\u4E0A\u306B\u79FB\u52D5",icon:zr.moveUp,onClick:()=>o(D),variant:"default"}]:[],...a&&D<e.length-1?[{label:"\u884C\u3092\u4E0B\u306B\u79FB\u52D5",icon:zr.moveDown,onClick:()=>a(D),variant:"default"}]:[],...e.length>1?[{label:"\u524A\u9664",icon:zr.delete,onClick:()=>i(D),variant:"default"}]:[]]}]})})]},D)}),u&&(0,pt.jsx)("tr",{className:"bg-secondary hover:bg-modifier-hover",children:(0,pt.jsx)("td",{colSpan:t.length+1,className:"border border-modifier-border px-4 py-2 text-center cursor-pointer text-text-muted hover:text-text-normal",onClick:()=>r(),title:"\u65B0\u3057\u3044\u884C\u3092\u8FFD\u52A0",children:(0,pt.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,pt.jsx)("span",{dangerouslySetInnerHTML:{__html:cs}}),(0,pt.jsx)("span",{className:"text-sm",children:"\u65B0\u3057\u3044\u884C\u3092\u8FFD\u52A0"})]})})})]})]})})},p2=KL;var Ft=H(fe(),1),ZL=({value:e,onChange:t,onDelete:n,onSubmit:r,inputRef:i,className:o="",placeholder:a,columnsCount:s,isNewChapter:l=!1})=>{let u=d=>{let h=d.target.value;t(h),l&&r&&h.length>0&&r(h)},c=l?V("NEW_CHAPTER_BGM_PLACEHOLDER"):V("BGM_PROMPT_PLACEHOLDER"),f=l?V("NEW_CHAPTER_BGM_LABEL"):V("BGM_LABEL");return l&&s!==void 0?(0,Ft.jsx)("table",{className:"w-full border-collapse border border-modifier-border mb-4 table-fixed",children:(0,Ft.jsx)("tbody",{children:(0,Ft.jsx)("tr",{className:"bg-secondary hover:bg-modifier-hover",children:(0,Ft.jsx)("td",{className:"border border-modifier-border px-4 py-2",colSpan:s+1,children:(0,Ft.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ft.jsxs)("span",{className:"text-sm text-text-muted",children:["\u{1F3B5} ",f,":"]}),(0,Ft.jsx)("input",{ref:i,type:"text",className:"flex-1 border-none bg-transparent focus:outline-none text-sm text-text-normal placeholder:text-text-muted",placeholder:a||c,value:e,onChange:u}),r&&(0,Ft.jsxs)(Ft.Fragment,{children:[(0,Ft.jsx)("span",{className:"text-sm text-text-muted",children:"\u307E\u305F\u306F"}),(0,Ft.jsx)("button",{className:"p-1 bg-accent text-on-accent rounded text-xs hover:bg-accent-hover",onClick:()=>r(""),children:V("ADD_SILENT_SECTION")})]})]})})})})}):(0,Ft.jsxs)("div",{className:`flex items-center gap-2 p-2 border border-modifier-border rounded bg-secondary ${o}`,children:[(0,Ft.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,Ft.jsxs)("span",{className:"text-sm text-text-muted min-w-fit",children:["\u{1F3B5} ",f,":"]}),(0,Ft.jsx)("input",{ref:i,type:"text",className:"flex-1 border-none bg-transparent focus:outline-none text-sm text-text-normal placeholder:text-text-muted",placeholder:a||c,value:e,onChange:l?u:d=>t(d.target.value),onClick:d=>d.stopPropagation()})]}),n&&(0,Ft.jsx)("button",{className:"text-text-faint hover:text-error text-sm px-1 py-0.5 leading-none min-w-fit",onClick:d=>{d.preventDefault(),d.stopPropagation(),n()},title:V("DELETE"),children:"\u2715"})]})},Hg=ZL;var Wr=require("obsidian"),$r=H(Fe(),1);var h2=H(Fe(),1),g2=H(fe(),1),m2=(0,h2.forwardRef)(({value:e,onChange:t,placeholder:n="",className:r="",onKeyDown:i},o)=>(0,g2.jsx)("textarea",{ref:o,value:e||"",onChange:a=>t(a.target.value),onKeyDown:i,placeholder:n,className:`w-full border-none focus:border-none focus:outline-none focus:shadow-none shadow-none rounded-none bg-transparent p-0 text-text-normal placeholder-text-faint leading-tight resize-none field-sizing-content overflow-y-hidden [@supports_not(field-sizing:content)]:overflow-y-auto ${r}`}));m2.displayName="TextAreaField";var vs=m2;var tu=H(fe(),1),qL=({src:e,alt:t="",title:n="",onDoubleClick:r,onClear:i,className:o="",clearButtonIcon:a="\xD7",clearButtonTitle:s="\u30AF\u30EA\u30A2"})=>e?(0,tu.jsxs)("div",{className:`relative inline-block ${o}`,children:[(0,tu.jsx)("img",{src:e,alt:t,title:n,className:"w-auto object-contain bg-secondary rounded cursor-pointer",onDoubleClick:r,tabIndex:0}),i&&(0,tu.jsx)("button",{className:"absolute top-1 right-1 p-1 bg-primary border border-modifier-border text-text-normal rounded cursor-pointer hover:bg-modifier-hover flex items-center justify-center",onClick:l=>{l.stopPropagation(),i()},title:s,dangerouslySetInnerHTML:{__html:a}})]}):null,v2=qL;var y2=H(Fe(),1);function nu(e,t={}){let{onArrowUp:n,onArrowDown:r}=t;return(0,y2.useCallback)(i=>{let o=e.current;if(!o)return;let{selectionStart:a,selectionEnd:s,value:l}=o;i.key==="ArrowUp"&&a===0?(i.preventDefault(),n==null||n()):i.key==="ArrowDown"&&s===l.length&&(i.preventDefault(),r==null||r())},[e,n,r])}var bi=H(fe(),1),JL=({imageUrl:e,imagePrompt:t,onImageUrlChange:n,onImagePromptChange:r,app:i,generateThumbnail:o,createPsd:a,focusPrevCellPrompt:s,focusNextCellPrompt:l,refCallback:u})=>{let[c,f]=(0,$r.useState)(null),d=(0,$r.useRef)(null),h=(0,$r.useRef)(null),y=(0,$r.useRef)(null),[S,b]=(0,$r.useState)(!1);(0,$r.useEffect)(()=>(u&&u(h.current),()=>{u&&u(null)}),[u]),(0,$r.useEffect)(()=>{let w=!1;return(async()=>{if(!(e!=null&&e.endsWith(".psd"))){f(null),d.current=null;return}try{let E=i.vault.getAbstractFileByPath(e);if(E instanceof Wr.TFile){let P=E.stat.mtime;if(d.current===null||P>d.current)try{let D=await le.executeTool("generate_thumbnail",{app:i,file:E}),j=JSON.parse(D).thumbnailData;w||(f(j),d.current=P)}catch(D){w||(f(null),d.current=null)}}}catch(E){w||(f(null),d.current=null)}})(),()=>{w=!0}},[e,i]);let g=nu(h,{onArrowUp:s,onArrowDown:l}),p=async()=>{if(!(e!=null&&e.endsWith(".psd")))return;let w=i.vault.getAbstractFileByPath(e);w instanceof Wr.TFile&&await i.workspace.getLeaf(!0).openFile(w,{active:!0})},m=async w=>{var j,N,L,O,F;let _=(j=w.target.files)==null?void 0:j[0];if(!_)return;let P=i.vault.getFiles().find(X=>X.name===_.name),D;if(P)D=P.path;else{let X=await _.arrayBuffer(),te=((L=(N=i.workspace.getActiveFile())==null?void 0:N.parent)==null?void 0:L.path)||"",ge=te?(0,Wr.normalizePath)(`${te}/assets`):"assets";try{i.vault.getAbstractFileByPath(ge)||await i.vault.createFolder(ge)}catch(Ie){console.error(Ie)}D=(0,Wr.normalizePath)(`${ge}/${_.name}`),D=(await i.vault.createBinary(D,X)).path}let M=D.toLowerCase().split(".").pop();if(M&&["png","jpg","jpeg","gif","webp"].includes(M)){let X=i.vault.getAbstractFileByPath(D);if(X instanceof Wr.TFile)try{let te=((F=(O=i.workspace.getActiveFile())==null?void 0:O.parent)==null?void 0:F.path)||"",ge=te?`${te}/psd`:void 0,ne=await le.executeTool("create_painter_file",{app:i,imageFile:X,targetDir:ge,baseFileName:X.basename});D=JSON.parse(ne).filePath}catch(te){console.error(te)}}n(D)},v=()=>{f(null),d.current=null,n(null)},x=async()=>{if(!S){if(!t||t.trim()===""){new Wr.Notice(V("PROMPT_REQUIRED"));return}new Wr.Notice("AI\u751F\u6210\u6A5F\u80FD\u306F\u5B9F\u88C5\u4E88\u5B9A\u3067\u3059")}};return(0,bi.jsxs)(bi.Fragment,{children:[(0,bi.jsx)(gi,{buttons:[{icon:ds.aiGenerate,onClick:w=>{w.stopPropagation(),x()},title:S?V("GENERATING"):V("AI_GENERATE"),disabled:S,variant:"accent"},{icon:ds.fileSelect,onClick:w=>{var _;w.stopPropagation(),(_=y.current)==null||_.click()},title:V("FILE_SELECT"),variant:"primary"}],className:"mb-2"}),(0,bi.jsx)("input",{ref:y,type:"file",accept:".psd,.png,.jpg,.jpeg,.gif,.webp",className:"hidden",onChange:m}),c?(0,bi.jsx)(v2,{src:c,alt:V("PSD_THUMBNAIL"),title:e||"",onDoubleClick:p,onClear:v,clearButtonIcon:ds.clearPath,clearButtonTitle:V("CLEAR_PATH")}):(0,bi.jsx)(vs,{ref:h,value:t,onChange:r,onKeyDown:g,placeholder:V("IMAGE_PROMPT_PLACEHOLDER")})]})},S2=JL;var b2=H(fe(),1),QL=({prompt:e,onPromptChange:t})=>(0,b2.jsx)(vs,{value:e,onChange:t,placeholder:V("PROMPT_PLACEHOLDER")}),w2=QL;var uf=H(Fe(),1);var _i=H(fe(),1),ek=({speaker:e,dialogue:t,speakersList:n,onSpeakerChange:r,onDialogueChange:i,className:o="",focusPrevCellDialogue:a,focusNextCellDialogue:s,refCallback:l,onEditCharacters:u})=>{let c=(0,uf.useRef)(null);(0,uf.useEffect)(()=>(l&&l(c.current),()=>{l&&l(null)}),[l]);let f=y=>{i(y)},d=nu(c,{onArrowUp:a,onArrowDown:s}),h=Array.from(new Set([...n||[],e])).filter(y=>y&&y.trim()!=="");return(0,_i.jsxs)("div",{className:`flex flex-col gap-1 w-full justify-start ${o}`,children:[(0,_i.jsx)("div",{className:"flex items-center",children:(0,_i.jsxs)("select",{value:e,onChange:y=>{if(y.target.value==="__edit__"){u&&u(),y.target.blur();return}r(y.target.value)},className:"appearance-none bg-transparent border-none font-bold text-lg focus:outline-none cursor-pointer",style:{boxShadow:"none",outline:"none",border:"none",background:"transparent",color:e?void 0:"var(--text-faint)",width:"auto",minWidth:0,maxWidth:"100%",WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},children:[(0,_i.jsx)("option",{value:"",className:"text-text-faint",children:V("NO_SPEAKER")}),h.map((y,S)=>(0,_i.jsx)("option",{value:y,style:{color:"var(--text-normal)"},children:y},S)),(0,_i.jsx)("option",{value:"__edit__",className:"text-text-faint",children:V("EDIT_CHARACTERS")})]})}),(0,_i.jsx)(vs,{ref:c,value:t,onChange:f,onKeyDown:d,placeholder:V("DIALOGUE_PLACEHOLDER"),className:"mt-2"})]})},_2=ek;var ru=H(Fe(),1);var Qo=H(fe(),1),tk=({open:e,onClose:t,title:n,children:r,footer:i,width:o="w-[400px]",maxHeight:a="max-h-[80vh]",className:s=""})=>e?(0,Qo.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,Qo.jsxs)("div",{className:`bg-primary rounded shadow-lg p-6 ${o} ${a} overflow-auto ${s}`,children:[n&&(0,Qo.jsx)("h2",{className:"text-lg font-bold mb-2",children:n}),(0,Qo.jsx)("div",{className:"mb-4",children:r}),i&&(0,Qo.jsx)("div",{className:"flex gap-2 justify-end",children:i})]})}):null,x2=tk;var zt=H(fe(),1),nk=({open:e,characters:t,frames:n,onClose:r,onSave:i,selectedFrame:o,onSetSpeaker:a})=>{let[s,l]=(0,ru.useState)(t),[u,c]=(0,ru.useState)(0),f=Array.from(new Set(n.map(m=>m.speaker).filter(Boolean)));(0,ru.useEffect)(()=>{let m=t.length===0?[{name:"",attributes:{\u8AAC\u660E:""}}]:t;l(m),c(0)},[t,e]);let d=m=>{c(Number(m.target.value))},h=m=>{l(v=>v.map((x,w)=>w===u?{...x,attributes:{\u8AAC\u660E:m}}:x))},y=m=>{l(v=>v.map((x,w)=>w===u?{...x,name:m}:x))},S=()=>{l(m=>[...m,{name:"",attributes:{\u8AAC\u660E:""}}]),c(s.length)},b=()=>{if(s.length===0)return;let m=s[u];if(f.includes(m.name))return;let v=s.filter((x,w)=>w!==u);l(v),c(Math.max(0,u-1))},g=s[u]||{name:"",attributes:{\u8AAC\u660E:""}},p=(0,zt.jsxs)(zt.Fragment,{children:[(0,zt.jsx)("button",{className:"text-muted px-2 py-1 border border-modifier-border rounded",onClick:r,children:V("CANCEL")}),(0,zt.jsx)("button",{className:"text-on-accent bg-accent px-2 py-1 rounded",onClick:()=>{i(s),o&&a&&g.name.trim()&&a(g.name.trim()),r()},children:V("SAVE")})]});return(0,zt.jsxs)(x2,{open:e,onClose:r,title:V("CHARACTER_EDIT"),footer:p,children:[(0,zt.jsxs)("div",{className:"flex gap-2 items-center mb-4",children:[(0,zt.jsx)("select",{value:u,onChange:d,className:"border border-modifier-border rounded px-2 py-1 flex-1",children:s.map((m,v)=>(0,zt.jsx)("option",{value:v,children:m.name||`(${V("NO_SPEAKER")})`},v))}),(0,zt.jsx)(gi,{buttons:[{icon:cs,onClick:S,title:"\u8FFD\u52A0",variant:"secondary"},{icon:zr.delete,onClick:b,title:V("DELETE"),variant:"danger",disabled:s.length===0||f.includes(g.name)}]})]}),(0,zt.jsxs)("div",{className:"mb-2",children:[(0,zt.jsx)("label",{className:"block text-sm mb-1",children:V("CHARACTER_NAME")}),(0,zt.jsx)("input",{className:"border border-modifier-border rounded px-2 py-1 w-full",value:g.name,onChange:m=>y(m.target.value),placeholder:V("CHARACTER_NAME")})]}),(0,zt.jsxs)("div",{className:"mb-4",children:[(0,zt.jsx)("label",{className:"block text-sm mb-1",children:V("DESCRIPTION")}),(0,zt.jsx)("input",{className:"border border-modifier-border rounded px-2 py-1 w-full",value:g.attributes.\u8AAC\u660E||"",onChange:m=>h(m.target.value),placeholder:V("DESCRIPTION")})]})]})},E2=nk;var Yt=H(fe(),1),rk=({app:e,file:t})=>{let{isLoading:n,storyboard:r,handleDataChange:i,handleCellChange:o,addRow:a,deleteRow:s,moveRowUp:l,moveRowDown:u,insertRowBelow:c,addChapter:f,deleteChapter:d,saveCharacters:h,uniqueSpeakers:y,allCharacters:S,setStoryboard:b}=Gg(e,t),[g,p]=(0,Ct.useState)(!1),[m,v]=(0,Ct.useState)(r.chapters.map(()=>!0)),[x,w]=(0,Ct.useState)(""),[_,E]=(0,Ct.useState)([]),P=(0,Ct.useRef)([]),D=(0,Ct.useRef)(r.chapters.length),M=(0,Ct.useRef)([]),j=(0,Ct.useRef)([]);(0,Ct.useEffect)(()=>{v(r.chapters.map(()=>!0))},[r.chapters.length]);let N=async(Q,W)=>{try{let re=await le.executeTool("generate_thumbnail",{app:Q,file:W});return JSON.parse(re).thumbnailData}catch(re){return null}},L=async(Q,W,re,K,q)=>{var Se,we;try{let ce=q||((we=(Se=Q.workspace.getActiveFile())==null?void 0:Se.parent)==null?void 0:we.path)||"",R=ce?`${ce}/psd`:void 0,U=await le.executeTool("create_painter_file",{app:Q,imageFile:W,targetDir:R,baseFileName:W?W.basename:"untitled-illustration"}),Y=JSON.parse(U),G=Q.vault.getAbstractFileByPath(Y.filePath);if(!(G instanceof iu.TFile))throw new Error("\u4F5C\u6210\u3055\u308C\u305FPSD\u30D5\u30A1\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");if(K){await Q.workspace.getLeaf(!0).openFile(G,{active:!0});try{let Pe=await le.executeTool("load_painter_file",{app:Q,file:G}),ht=JSON.parse(Pe)}catch(Pe){console.error(Pe)}}return G}catch(ce){throw new iu.Notice("PSD\u4F5C\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F: "+ce.message),ce}},O=[{key:"imageUrl",header:V("HEADER_IMAGE"),renderCell:(Q,W,re,K)=>(0,Yt.jsx)(S2,{imageUrl:W.imageUrl,imagePrompt:W.imagePrompt,onImageUrlChange:q=>re("imageUrl",q||""),onImagePromptChange:q=>re("imagePrompt",q),app:e,generateThumbnail:N,createPsd:L,focusPrevCellPrompt:()=>{var q;j.current[K-1]&&((q=j.current[K-1])==null||q.focus())},focusNextCellPrompt:()=>{var q;j.current[K+1]&&((q=j.current[K+1])==null||q.focus())},refCallback:q=>{j.current[K]=q}})},{key:"dialogues",header:V("HEADER_DIALOGUE"),renderCell:(Q,W,re,K)=>(0,Yt.jsx)(_2,{dialogue:Q||"",speaker:W.speaker||"",speakersList:y,onDialogueChange:q=>re("dialogues",q),onSpeakerChange:q=>re("speaker",q),focusPrevCellDialogue:()=>{var q;M.current[K-1]&&((q=M.current[K-1])==null||q.focus())},focusNextCellDialogue:()=>{var q;M.current[K+1]&&((q=M.current[K+1])==null||q.focus())},refCallback:q=>{M.current[K]=q},isFirstRow:K===0,onEditCharacters:()=>p(!0)})},{key:"preview",header:V("HEADER_PREVIEW"),renderCell:(Q,W,re,K)=>(0,Yt.jsx)(w2,{prompt:W.prompt||"",onPromptChange:q=>re("prompt",q)})}],F=(0,Ct.useCallback)((Q,W,re)=>{var q;let K=0;for(let Se=0;Se<re;Se++)K+=r.chapters[Se].frames.length;if(K+=W,eu.getState().setSelectedRowIndex(K),jr.getState().setSelectedFrame(Q),(q=Q.imageUrl)!=null&&q.endsWith(".psd")){let Se=e.vault.getAbstractFileByPath(Q.imageUrl);Se instanceof iu.TFile&&ye.getState().setCurrentPsdFile(Se)}else ye.getState().clearCurrentPsdFile()},[e,r]),X=jr(Q=>Q.selectedFrame),te=eu(Q=>Q.selectedRowIndex),ge=(0,Ct.useCallback)(Q=>{if(!X)return;let W=0,re=-1,K=-1;for(let q=0;q<r.chapters.length;q++){let Se=r.chapters[q];for(let we=0;we<Se.frames.length;we++){if(W===te){re=q,K=we;break}W++}if(re!==-1)break}re!==-1&&K!==-1&&o(re,K,"speaker",Q)},[X,te,r.chapters,o]);(0,Ct.useEffect)(()=>{(async()=>{if(!(!t||!(X!=null&&X.imageUrl)))try{let W=await le.executeTool("load_storyboard_data",{app:e,file:t}),re=JSON.parse(W);b(re)}catch(W){console.error("Failed to reload storyboard data:",W)}})()},[X==null?void 0:X.imageUrl,e,t,b]),(0,Ct.useEffect)(()=>{var Q;if(r.chapters.length>D.current){let W=r.chapters.length-1;(Q=P.current[W])==null||Q.focus(),D.current=r.chapters.length}else D.current=r.chapters.length},[r.chapters.length]);let ne=(0,Ct.useCallback)((Q,W,re)=>{let K={...r},q=K.chapters[Q];if(q&&q.frames){let Se=_.filter(we=>we.chapterIndex===Q).map(we=>we.rowIndex).sort((we,ce)=>we-ce);if(Se.length>0){let we=Se.map(R=>q.frames[R]);Se.reverse().forEach(R=>{q.frames.splice(R,1)});let ce=re;Se.forEach(R=>{R<re&&ce--}),q.frames.splice(ce,0,...we)}else{let[we]=q.frames.splice(W,1);q.frames.splice(re,0,we)}b(K),i(K)}},[r,b,i,_]),Ie=(0,Ct.useCallback)((Q,W,re)=>{E(re?K=>[...K,{chapterIndex:Q,rowIndex:W}]:K=>K.filter(q=>!(q.chapterIndex===Q&&q.rowIndex===W)))},[]),je=(0,Ct.useCallback)(Q=>{E(W=>W.filter(re=>re.chapterIndex!==Q))},[]);return n?(0,Yt.jsx)("div",{className:"storyboard-react-view p-4",children:V("LOADING")}):(0,Yt.jsxs)(Yt.Fragment,{children:[(0,Yt.jsx)(E2,{open:g,characters:S,frames:r.chapters.flatMap(Q=>Q.frames),onClose:()=>p(!1),onSave:h,selectedFrame:X,onSetSpeaker:ge}),r.chapters.map((Q,W)=>{var re;return(0,Yt.jsxs)("details",{className:"mb-4 last:mb-0",open:m[W],onToggle:K=>{let q=K.currentTarget.open;v(Se=>{let we=[...Se];return we[W]=q,we})},children:[(0,Yt.jsxs)("summary",{className:"font-bold mb-2 flex items-center gap-2",children:[(0,Yt.jsx)("span",{className:`inline-block transition-transform ${m[W]?"rotate-90":""}`,dangerouslySetInnerHTML:{__html:Vx}}),(0,Yt.jsx)("div",{className:"flex-1",children:(0,Yt.jsx)(Hg,{value:(re=Q.bgmPrompt)!=null?re:"",onChange:K=>{b(q=>{let Se=q.chapters.map((ce,R)=>R===W?{...ce,bgmPrompt:K}:ce),we={...q,chapters:Se};return i(we),we})},onDelete:()=>{d(W),v(K=>K.filter((q,Se)=>Se!==W))},inputRef:K=>{P.current[W]=K}})})]}),(0,Yt.jsx)(p2,{data:Q.frames,columns:O.map(K=>K.key==="dialogues"||String(K.key)==="preview"?{...K,renderCell:(q,Se,we,ce)=>{var R;return(R=K.renderCell)==null?void 0:R.call(K,q,Se,(U,Y)=>we(U,Y),ce,{frames:Q.frames})}}:K),onCellChange:(K,q,Se)=>o(W,K,q,Se),onAddRow:()=>a(W),onDeleteRow:K=>s(W,K),onMoveRowUp:K=>l(W,K),onMoveRowDown:K=>u(W,K),onInsertRowBelow:K=>c(W,K),onMoveRowTo:(K,q)=>ne(W,K,q),onRowClick:(K,q)=>F(K,q,W),selectedRowIndexes:_.filter(K=>K.chapterIndex===W).map(K=>K.rowIndex),onSelectRow:(K,q)=>Ie(W,K,q),onClearSelection:()=>je(W),showAddRow:!1})]},W)}),(0,Yt.jsx)(Hg,{value:x,onChange:w,onSubmit:Q=>{f(Q),v(W=>[...W,!0]),w("")},columnsCount:O.length,isNewChapter:!0})]})},T2=rk;var cf=new WeakMap,ou=new WeakMap,ys=class{injectStoryboardCapability(t){var r;if(!(t.view instanceof au.MarkdownView))return;((r=t.view.file)==null?void 0:r.extension)==="board"&&ou.set(t,"markdown")}async toggleStoryboardForLeaf(t,n){var i;let r=t.view instanceof au.MarkdownView?(i=t.view.file)==null?void 0:i.name:"unknown";try{let o=await le.executeTool(de.TOGGLE_STORYBOARD_VIEW,{app:n,leaf:t,factory:this})}catch(o){console.error(o)}}async createSampleStoryboardFile(t){try{return await le.executeTool(de.CREATE_STORYBOARD_FILE,{app:t})}catch(n){return null}}async switchToStoryboardViewMode(t,n){if(!(t.view instanceof au.MarkdownView))return;let r=t.view;if(!r.file)return;ou.set(t,"board");let o=r.contentEl;Array.from(o.children).forEach(a=>a.style.display="none"),await this.renderReactComponent(r,t,n)}switchToMarkdownViewMode(t){if(!(t.view instanceof au.MarkdownView))return;let n=t.view;ou.set(t,"markdown"),this.cleanupViewRoot(t);let r=n.contentEl,i=r.querySelector(".storyboard-view-container");i&&i.remove(),Array.from(r.children).forEach(o=>o.style.display=""),n.previewMode.rerender(!0)}async renderReactComponent(t,n,r){this.cleanupViewRoot(n);let o=t.contentEl.createDiv({cls:"storyboard-view-container h-full overflow-auto"}),a=(0,C2.createRoot)(o);cf.set(n,a),a.render(I2.default.createElement(T2,{app:r,file:t.file}))}cleanupViewRoot(t){var n;cf.has(t)&&((n=cf.get(t))==null||n.unmount(),cf.delete(t))}getCurrentViewMode(t){return ou.get(t)||"markdown"}cleanupStoryboardViewRoots(t){t.workspace.getLeavesOfType("markdown").forEach(n=>{this.cleanupViewRoot(n),ou.delete(n)})}};var df=class{constructor(t){this.plugin=t,this.factory=new ys}initialize(){(0,su.addIcon)("board",pi.STORYBOARD_ICON_SVG),(0,su.addIcon)("board-toggle",pi.STORYBOARD_TOGGLE_ICON_SVG),this.plugin.registerExtensions(["board"],"markdown");let t=async n=>{let r=this.plugin.app.workspace.activeLeaf;!r||!(r.view instanceof su.MarkdownView)||(n.extension==="board"?await this.factory.switchToStoryboardViewMode(r,this.plugin.app):this.factory.getCurrentViewMode(r)==="board"&&this.factory.switchToMarkdownViewMode(r))};this.plugin.registerEvent(this.plugin.app.workspace.on("file-open",t)),this.plugin.register(()=>{this.factory.cleanupStoryboardViewRoots(this.plugin.app)})}getFactory(){return this.factory}};var pf=require("obsidian");var ik={falApiKey:""};async function P2(e){return Object.assign({},ik,await e.loadData())}async function A2(e,t){await e.saveData(t)}var ff=class extends pf.PluginSettingTab{constructor(t,n,r){super(t,n),this.plugin=n,this.settings=r}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"AI Settings"}),new pf.Setting(t).setName("fal.ai API Key").setDesc("API key for fal.ai").addText(n=>n.setPlaceholder("fal-...").setValue(this.settings.falApiKey||"").onChange(async r=>{this.settings.falApiKey=r,await A2(this.plugin,this.settings)}))}};var hf=class{constructor(t){this.settings=null;this.plugin=t}async initialize(){this.settings=await P2(this.plugin),this.plugin.addSettingTab(new ff(this.plugin.app,this.plugin,this.settings))}};var ea=require("obsidian");var mf=class{constructor(t){this.plugin=t}initialize(){(0,ea.addIcon)("create-menu",pi.ADD_ICON_SVG),this.plugin.addRibbonIcon("create-menu","\u65B0\u898F\u4F5C\u6210",async t=>{let n=new ea.Menu;n.addItem(r=>r.setTitle("Storyboard").setIcon("board").onClick(async()=>{try{let i=await le.executeTool(de.CREATE_STORYBOARD_FILE,{app:this.plugin.app});try{let s=JSON.parse(i);if(s.filePath){let l=this.plugin.app.vault.getAbstractFileByPath(s.filePath);if(l instanceof ea.TFile){await this.plugin.app.workspace.getLeaf(!0).openFile(l);return}}}catch(s){}let o=this.plugin.app.workspace.getLeaf(!0),a=this.plugin.app.vault.getFiles().filter(s=>s.extension==="board");if(a.length>0){let s=a[a.length-1];await o.openFile(s)}}catch(i){console.error(i)}})),n.addItem(r=>r.setTitle("Painter").setIcon("palette").onClick(async()=>{await le.executeTool(de.CREATE_PAINTER_FILE,{app:this.plugin.app})})),n.addItem(r=>r.setTitle("Timeline").setIcon("timeline").onClick(async()=>{try{let i=await le.executeTool(de.CREATE_USD_FILE,{app:this.plugin.app}),o=JSON.parse(i);if(o.filePath){let a=this.plugin.app.vault.getAbstractFileByPath(o.filePath);a instanceof ea.TFile&&await this.plugin.app.workspace.getLeaf(!0).openFile(a)}}catch(i){console.error("\u30BF\u30A4\u30E0\u30E9\u30A4\u30F3\u30D5\u30A1\u30A4\u30EB\u4F5C\u6210\u30A8\u30E9\u30FC:",i)}})),n.showAtMouseEvent(t)})}};var D2=require("obsidian"),Ss="right-sidebar-view",gf=class extends D2.ItemView{constructor(t,n){super(t),this.renderReact=n}getViewType(){return Ss}getDisplayText(){return"Right Sidebar"}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("right-sidebar"),this.renderReact()}async onClose(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=void 0)}};var k2=H(vl(),1),R2=H(Fe(),1);var uu=H(Fe(),1),$g=require("obsidian");var ws=require("obsidian");var yr=H(fe(),1);function L2({isPsdPainterOpen:e,currentImageUrl:t,onBackToStoryboard:n,onOpenPsdPainter:r,app:i,onImageUrlChange:o}){let a=async()=>{let d=i.workspace.getActiveFile();d&&(d.extension==="md"?await u("rename_file_extension","board","BOARD"):d.extension==="usda"&&await c())},s=async()=>{let d=i.workspace.getActiveFile();d&&(d.extension==="board"?await u("rename_file_extension","md","Markdown"):d.extension==="usda"&&await u("convert_usd_to_md","md","Markdown"))},l=async()=>{let d=i.workspace.getActiveFile();d&&(d.extension==="md"||d.extension==="board")&&await u("convert_md_to_usd","usda","USD")},u=async(d,h,y)=>{var S;try{let b=i.workspace.getActiveFile();if(!b)return;let g;if(d==="rename_file_extension"){g=await le.executeTool(d,{app:i,file:b,newExt:h});let m=JSON.parse(g).newPath;if(m){let v=i.vault.getAbstractFileByPath(m);if(v&&v instanceof ws.TFile){let x=i.workspace.getLeavesOfType("markdown"),w=null;for(let _ of x)if(_.view instanceof ws.MarkdownView&&((S=_.view.file)==null?void 0:S.path)===v.path){w=_;break}if((v.extension==="board"||v.extension==="md")&&w)try{let _=new ys,E=await Wl.execute({app:i,leaf:w,factory:_})}catch(_){console.error("Failed to toggle view:",_),i.workspace.trigger("file-open",v)}else w||i.workspace.trigger("file-open",v)}}}else{g=await le.executeTool(d,{app:i,file:b});let m=JSON.parse(g).filePath;if(m){let v=i.vault.getAbstractFileByPath(m);if(v&&v instanceof ws.TFile){let x=i.workspace.getLeaf();v.extension==="usda"?await x.setViewState({type:"timeline-view",state:{file:v.path}}):(await x.openFile(v),v.extension==="board"&&i.workspace.trigger("file-open",v))}}}}catch(b){console.error(`Conversion to ${y} failed:`,b)}},c=async()=>{try{let d=i.workspace.getActiveFile();if(!d)return;let h=await le.executeTool("convert_usd_to_md",{app:i,file:d}),y=JSON.parse(h),S=i.vault.getAbstractFileByPath(y.filePath);if(S){let b=await le.executeTool("rename_file_extension",{app:i,file:S,newExt:"board"}),g=JSON.parse(b),p=i.vault.getAbstractFileByPath(g.newPath);p&&p instanceof ws.TFile&&(await i.workspace.getLeaf().openFile(p),i.workspace.trigger("file-open",p))}}catch(d){console.error("USD to STORYBOARD conversion failed:",d)}};return(0,yr.jsxs)("div",{className:"flex flex-col gap-2 mb-4",children:[(0,yr.jsxs)("div",{className:"flex gap-2",children:[(0,yr.jsx)("button",{onClick:async()=>{var d,h;try{let y=((h=(d=i.workspace.getActiveFile())==null?void 0:d.parent)==null?void 0:h.path)||"",S=await le.executeTool("create_painter_file",{app:i}),b=JSON.parse(S),g=eu.getState().selectedRowIndex,p=i.workspace.getActiveFile();if(g!==null&&p&&p.extension==="board")try{let m=await le.executeTool("load_storyboard_data",{app:i,file:p}),v=JSON.parse(m),x=0,w=!1;for(let _=0;_<v.chapters.length;_++){let E=v.chapters[_];for(let P=0;P<E.frames.length;P++){if(x===g){E.frames[P].imageUrl=b.filePath,w=!0;break}x++}if(w)break}if(w){await le.executeTool("save_storyboard_data",{app:i,file:p,data:JSON.stringify(v)});let _=jr.getState().selectedFrame;if(_){let E={..._,imageUrl:b.filePath};jr.getState().setSelectedFrame(E)}}}catch(m){console.error("Failed to update board data:",m)}o(b.filePath),r()}catch(y){console.error("PSD creation failed:",y)}},className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${!(t!=null&&t.endsWith(".psd"))&&!e?"":"hidden"}`,title:V("CREATE_PSD"),children:".psd (new)"}),(0,yr.jsx)("button",{onClick:r,className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${t!=null&&t.endsWith(".psd")&&!e?"":"hidden"}`,title:V("OPEN_PSD"),children:".psd (open)"}),(0,yr.jsx)("button",{onClick:s,className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${e?"hidden":""}`,title:"MD\u306B\u5909\u63DB",children:".md"}),(0,yr.jsx)("button",{onClick:a,className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${e?"hidden":""}`,title:"BOARD\u306B\u5909\u63DB",children:".board"}),(0,yr.jsx)("button",{onClick:l,className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${e?"hidden":""}`,title:"USD\u306B\u5909\u63DB",children:".usda"})]}),(0,yr.jsx)("div",{className:"flex gap-2",children:(0,yr.jsx)("button",{onClick:n,className:`px-3 py-2 bg-accent text-on-accent hover:bg-accent-hover rounded cursor-pointer ${e?"":"hidden"}`,title:V("BACK_TO_STORYBOARD"),children:".board"})})]})}var lu=H(Fe(),1);var Ze=H(fe(),1);function jg(){var m,v,x;let e=ye(w=>w.layers),t=Ye(w=>w.currentLayerIndex),n=(0,lu.useRef)(null),[r,i]=(0,lu.useState)(null),[o,a]=(0,lu.useState)(""),s=async w=>{var E;let _=(E=w.target.files)==null?void 0:E[0];if(_)try{let P=await _.arrayBuffer();await le.executeTool("add_layer",{name:_.name,fileData:P})}catch(P){console.error(P)}finally{w.target.value=""}},l=()=>{var w;(w=n.current)==null||w.click()},u=async()=>{try{await le.executeTool("add_layer",{name:`\u30EC\u30A4\u30E4\u30FC ${e.length+1}`})}catch(w){console.error(w)}},c=async()=>{if(!(e.length<=1))try{await le.executeTool("remove_layer",{index:t})}catch(w){console.error(w)}},f=async w=>{try{Ye.getState().setCurrentLayerIndex(w)}catch(_){console.error(_)}},d=async w=>{try{await le.executeTool("toggle_layer_visibility",{index:w})}catch(_){console.error(_)}},h=async w=>{var _,E;try{let P=(E=(_=e[w])==null?void 0:_.clippingMask)!=null?E:!1;await le.executeTool("set_layer_clipping",{index:w,clippingMask:!P})}catch(P){console.error(P)}},y=w=>{i(w),a(e[w].name)},S=async()=>{if(r!==null&&o.trim()&&o!==e[r].name)try{await le.executeTool("rename_layer",{index:r,name:o.trim()})}catch(w){console.error(w)}i(null),a("")},b=()=>{i(null),a("")},g=async w=>{try{await le.executeTool("set_layer_opacity",{index:t,opacity:w/100})}catch(_){console.error(_)}},p=async w=>{try{await le.executeTool("set_layer_blend_mode",{index:t,blendMode:w})}catch(_){console.error(_)}};return e.length===0?(0,Ze.jsxs)("div",{className:"p-2 border-b border-modifier-border",children:[(0,Ze.jsx)("div",{className:"text-text-muted text-sm",children:V("NO_LAYERS")}),(0,Ze.jsxs)("div",{className:"text-text-muted text-xs mt-1",children:["\u30C7\u30D0\u30C3\u30B0\u60C5\u5831:",(0,Ze.jsx)("br",{}),"\u2022 Layers\u914D\u5217: ",JSON.stringify(e)]})]}):(0,Ze.jsxs)("div",{className:"p-2 border-b border-modifier-border",children:[(0,Ze.jsx)("div",{className:"text-text-normal text-sm mb-2 pb-1 border-b border-modifier-border",children:V("LAYERS")}),e[t]&&(0,Ze.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Ze.jsx)("button",{className:"p-2 w-8 h-8 bg-primary border border-modifier-border text-text-normal rounded cursor-pointer hover:bg-modifier-hover flex items-center justify-center",onClick:u,title:V("NEW_LAYER"),dangerouslySetInnerHTML:{__html:Zd.add}}),(0,Ze.jsx)("button",{className:"p-2 w-8 h-8 bg-primary border border-modifier-border text-text-normal rounded cursor-pointer hover:bg-modifier-hover flex items-center justify-center",onClick:l,title:V("FILE_SELECT"),dangerouslySetInnerHTML:{__html:ds.fileSelect}}),(0,Ze.jsx)("input",{ref:n,type:"file",accept:"image/*",className:"hidden",onChange:s}),(0,Ze.jsx)("button",{className:"p-2 w-8 h-8 bg-primary border border-modifier-border text-text-normal rounded cursor-pointer hover:bg-modifier-hover flex items-center justify-center",onClick:c,title:V("DELETE_LAYER"),dangerouslySetInnerHTML:{__html:Zd.delete}}),(0,Ze.jsx)("input",{type:"range",min:"0",max:"100",value:Math.sqrt((((m=e[t])==null?void 0:m.opacity)!==void 0?(v=e[t])==null?void 0:v.opacity:1)*100)*10,onChange:w=>{let _=parseInt(w.target.value,10),E=Math.round((_/10)**2);g(E)},className:"flex-1 h-1 bg-modifier-border rounded outline-none"}),(0,Ze.jsx)("select",{value:((x=e[t])==null?void 0:x.blendMode)||"normal",onChange:w=>p(w.target.value),className:"p-1 border border-modifier-border rounded bg-primary text-xs",children:[{key:"normal",label:V("BLEND_MODE_NORMAL")},{key:"multiply",label:V("BLEND_MODE_MULTIPLY")},{key:"screen",label:V("BLEND_MODE_SCREEN")},{key:"overlay",label:V("BLEND_MODE_OVERLAY")},{key:"darken",label:V("BLEND_MODE_DARKEN")},{key:"lighten",label:V("BLEND_MODE_LIGHTEN")},{key:"color-dodge",label:V("BLEND_MODE_COLOR_DODGE")},{key:"color-burn",label:V("BLEND_MODE_COLOR_BURN")},{key:"hard-light",label:V("BLEND_MODE_HARD_LIGHT")},{key:"soft-light",label:V("BLEND_MODE_SOFT_LIGHT")},{key:"difference",label:V("BLEND_MODE_DIFFERENCE")},{key:"exclusion",label:V("BLEND_MODE_EXCLUSION")}].map(w=>(0,Ze.jsx)("option",{value:w.key,children:w.label},w.key))})]}),(0,Ze.jsx)("div",{className:"space-y-1",children:e.slice().reverse().map((w,_)=>{let E=e.length-1-_;return(0,Ze.jsxs)("div",{className:`p-2 bg-primary rounded cursor-pointer flex items-center gap-2 relative select-none hover:bg-modifier-hover ${E===t?"ring-2 ring-accent":""}`,onClick:()=>f(E),children:[(0,Ze.jsx)("div",{className:`w-4 h-4 border border-modifier-border rounded relative cursor-pointer ${w.visible?"bg-accent":"bg-transparent"}`,onClick:P=>{P.stopPropagation(),d(E)}}),(0,Ze.jsx)("div",{className:`w-4 h-4 border border-modifier-border rounded relative cursor-pointer ${w.clippingMask?"bg-accent":"bg-transparent"}`,onClick:P=>{P.stopPropagation(),h(E)},title:V("CLIPPING_MASK"),children:(0,Ze.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",dangerouslySetInnerHTML:{__html:Zd.clip}})}),(0,Ze.jsxs)("div",{className:"flex-1",children:[r===E?(0,Ze.jsx)("input",{type:"text",value:o,onChange:P=>a(P.target.value),onBlur:S,onKeyDown:P=>{P.key==="Enter"?S():P.key==="Escape"&&b()},className:"text-text-normal text-sm w-full bg-primary border border-modifier-border rounded px-1",autoFocus:!0}):(0,Ze.jsx)("div",{className:"text-text-normal text-sm cursor-pointer",onDoubleClick:()=>y(E),children:w.name}),(0,Ze.jsxs)("div",{className:"text-text-muted text-xs mt-1 flex gap-2",children:[(0,Ze.jsxs)("span",{children:["\u4E0D\u900F\u660E\u5EA6: ",Math.round((w.opacity||1)*100),"%"]}),(0,Ze.jsx)("span",{children:w.blendMode==="normal"?"\u901A\u5E38":w.blendMode==="multiply"?"\u4E57\u7B97":w.blendMode==="screen"?"\u30B9\u30AF\u30EA\u30FC\u30F3":w.blendMode==="overlay"?"\u30AA\u30FC\u30D0\u30FC\u30EC\u30A4":w.blendMode==="darken"?"\u6BD4\u8F03(\u6697)":w.blendMode==="lighten"?"\u6BD4\u8F03(\u660E)":w.blendMode==="color-dodge"?"\u8986\u3044\u713C\u304D":w.blendMode==="color-burn"?"\u713C\u304D\u8FBC\u307F":w.blendMode==="hard-light"?"\u30CF\u30FC\u30C9\u30E9\u30A4\u30C8":w.blendMode==="soft-light"?"\u30BD\u30D5\u30C8\u30E9\u30A4\u30C8":w.blendMode==="difference"?"\u5DEE\u306E\u7D76\u5BFE\u5024":w.blendMode==="exclusion"?"\u9664\u5916":w.blendMode||"\u901A\u5E38"})]})]})]},E)})})]})}var tr=H(Fe(),1);var st=H(fe(),1);function Wg(){let[e,t]=(0,tr.useState)([]),[n,r]=(0,tr.useState)(""),[i,o]=(0,tr.useState)(!1),[a,s]=(0,tr.useState)(null),[l,u]=(0,tr.useState)(!1),c=(0,tr.useRef)(null),f=(0,tr.useRef)(null),d=(0,tr.useRef)(null),{attachments:h,addAttachment:y,removeAttachment:S,clearAttachments:b}=jd(),g=v=>{var P,D;let x=(P=v.target.files)==null?void 0:P[0];if(!x)return;let w=URL.createObjectURL(x),_=(D=f.current)!=null?D:"image",E=new FileReader;E.onload=()=>{let M=E.result;y({url:w,data:M,type:_})},E.readAsDataURL(x),f.current=null,v.target.value=""},p=v=>{var x;f.current=v,(x=c.current)==null||x.click(),u(!1)};(0,tr.useEffect)(()=>{var v;(v=d.current)==null||v.scrollIntoView({behavior:"smooth"})},[e]);let m=async v=>{if(v.preventDefault(),s(null),!n.trim())return;let x=n;t(w=>[...w,{role:"user",content:x,attachments:h}]),t(w=>[...w,{role:"assistant",content:""}]),r(""),b(),o(!0);try{await new Promise(_=>setTimeout(_,1e3));let w=`AI\u5FDC\u7B54\uFF08\u958B\u767A\u4E2D\uFF09: ${x}`;t(_=>{let E=[..._],P=E[E.length-1];return P&&P.role==="assistant"&&(P.content=w),E})}catch(w){s(w instanceof Error?w.message:V("AI_RESPONSE_ERROR"))}finally{o(!1)}};return(0,st.jsxs)("div",{className:"flex flex-col h-full w-full border-t border-modifier-border bg-primary mb-4",children:[(0,st.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:[e.map((v,x)=>(0,st.jsxs)("div",{className:`text-sm rounded px-2 py-1 max-w-full break-words ${v.role==="user"?"bg-accent text-on-accent text-right ml-auto":"bg-secondary mr-auto"}`,children:[v.attachments&&v.attachments.length>0&&(0,st.jsx)("div",{className:`flex gap-2 mb-1 ${v.role==="user"?"justify-end":""}`,children:v.attachments.map((w,_)=>{let E=w.type==="image"?"border-blue-500":w.type==="mask"?"border-red-500":"border-green-500";return(0,st.jsx)("img",{src:w.url,alt:`${w.type} attachment`,className:`w-12 h-12 object-cover rounded border-2 ${E}`},_)})}),v.content]},x)),i&&(0,st.jsx)("div",{className:"text-xs text-text-faint text-center",children:V("LOADING")}),a&&(0,st.jsx)("div",{className:"text-xs text-error text-center",children:a}),(0,st.jsx)("div",{ref:d})]}),(0,st.jsxs)("form",{onSubmit:m,className:"flex flex-col p-2 border-t border-modifier-border w-full gap-2 relative",children:[(0,st.jsx)("input",{ref:c,type:"file",accept:"image/*",className:"hidden",onChange:g}),h.length>0&&(0,st.jsx)("div",{className:"flex gap-2",children:h.map((v,x)=>{let w=v.type==="image"?"border-blue-500":v.type==="mask"?"border-red-500":"border-green-500";return(0,st.jsxs)("div",{className:"relative",children:[(0,st.jsx)("img",{src:v.url,alt:`${v.type} attachment`,className:`w-12 h-12 object-cover rounded border-2 ${w}`}),(0,st.jsx)("button",{type:"button",className:"absolute -top-1 -right-1 bg-secondary rounded-full p-1",onClick:()=>S(x),dangerouslySetInnerHTML:{__html:zr.delete}})]},x)})}),(0,st.jsxs)("div",{className:"flex gap-2",children:[(0,st.jsxs)("div",{className:"relative",children:[(0,st.jsx)("button",{type:"button",className:"p-1 bg-primary border border-modifier-border text-text-normal rounded cursor-pointer hover:bg-modifier-hover flex items-center justify-center",onClick:()=>u(v=>!v),dangerouslySetInnerHTML:{__html:cs}}),l&&(0,st.jsxs)("div",{className:"absolute bottom-full left-0 mb-1 flex flex-col bg-secondary border border-modifier-border rounded z-10",children:[(0,st.jsxs)("button",{type:"button",className:"px-2 py-1 text-sm hover:bg-modifier-hover text-left flex items-center",onClick:()=>p("image"),children:["\u{1F5BC}\uFE0F ",V("ATTACH_IMAGE")]}),(0,st.jsxs)("button",{type:"button",className:"px-2 py-1 text-sm hover:bg-modifier-hover text-left flex items-center",onClick:()=>p("mask"),children:["\u{1F3AD} ",V("ATTACH_MASK")]}),(0,st.jsxs)("button",{type:"button",className:"px-2 py-1 text-sm hover:bg-modifier-hover text-left flex items-center",onClick:()=>p("reference"),children:["\u{1F4CE} ",V("ATTACH_REFERENCE")]})]})]}),(0,st.jsx)("input",{type:"text",value:n,onChange:v=>r(v.target.value),placeholder:V("CHAT_INPUT_PLACEHOLDER"),className:"flex-1 p-1 border border-modifier-border rounded bg-primary text-text-normal",disabled:i}),(0,st.jsx)("button",{type:"submit",className:"p-1 bg-accent text-on-accent rounded cursor-pointer hover:bg-accent-hover disabled:opacity-50",disabled:i||!n.trim(),children:V("SEND")})]})]})]})}var bs=H(fe(),1);function Xg({view:e,app:t}){let[n,r]=(0,uu.useState)(!1),i=jr(f=>f.selectedFrame),o=ye(f=>f.currentPsdFile),a=ye(f=>f.layers);(0,uu.useEffect)(()=>{if(!(e!=null&&e.app))return;let f=()=>{r(e.app.workspace.getLeavesOfType("psd-view").length>0)};return e.app.workspace.on("active-leaf-change",f),f(),()=>{e.app.workspace.off("active-leaf-change",f)}},[e==null?void 0:e.app]),(0,uu.useEffect)(()=>{if(!t)return;if(!o){ye.getState().clearLayers(),Ye.getState().setCurrentLayerIndex(0);return}(async()=>{try{let d=await le.executeTool("load_painter_file",{app:t,file:o}),h=JSON.parse(d),y=await Promise.all(h.layers.map(async S=>{let b;if(S.canvasDataUrl){b=document.createElement("canvas"),b.width=S.width,b.height=S.height;let g=b.getContext("2d");g&&await new Promise(p=>{let m=new Image;m.onload=()=>{g.drawImage(m,0,0),p()},m.onerror=()=>{console.error("\u753B\u50CF\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),p()},m.src=S.canvasDataUrl})}else S.canvas?b=S.canvas:(b=document.createElement("canvas"),b.width=S.width,b.height=S.height);return{name:S.name,visible:S.visible,opacity:S.opacity,blendMode:S.blendMode,clippingMask:S.clippingMask,canvas:b}}));ye.getState().initializeLayers(y),Ye.getState().setCurrentLayerIndex(0)}catch(d){console.error("\u274C PSD\u30D5\u30A1\u30A4\u30EB\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F:",d)}})()},[o,t]);let s=f=>{let d=jr.getState().selectedFrame;if(d&&f){let h={...d,imageUrl:f};if(jr.getState().setSelectedFrame(h),f.endsWith(".psd")&&t){let y=t.vault.getAbstractFileByPath(f);y instanceof $g.TFile&&ye.getState().setCurrentPsdFile(y)}}},l=async()=>{if(!(!c||!t))try{let f=t.vault.getAbstractFileByPath(c);f instanceof $g.TFile&&await t.workspace.getLeaf(!0).openFile(f,{active:!0})}catch(f){console.error(f)}},u=()=>{if(t)try{t.workspace.getLeavesOfType("psd-view").forEach(d=>d.detach());let f=t.workspace.getLeavesOfType("markdown").find(d=>{let h=d.view;return h&&h.contentEl&&h.contentEl.querySelector(".storyboard-view-container")});f&&t.workspace.setActiveLeaf(f)}catch(f){console.error(f)}},c=(i==null?void 0:i.imageUrl)||null;return(0,bs.jsxs)("div",{className:"w-full h-full flex flex-col bg-primary border-l border-modifier-border",children:[(0,bs.jsx)(L2,{isPsdPainterOpen:n,currentImageUrl:c,onBackToStoryboard:u,onOpenPsdPainter:l,app:t||{},onImageUrlChange:s}),a&&a.length>0&&(0,bs.jsx)(jg,{}),(0,bs.jsx)(Wg,{})]})}var vf=class{createRightSidebarView(t){let n=new gf(t,()=>this.renderReactComponent(n));return n}renderReactComponent(t){t.containerEl.empty(),t.reactRoot=(0,k2.createRoot)(t.containerEl),t.reactRoot.render(R2.default.createElement(Xg,{view:t,app:t.app}))}};var yf=class{constructor(t){this.plugin=t,this.factory=new vf}initialize(){this.plugin.registerView(Ss,t=>this.factory.createRightSidebarView(t)),this.plugin.app.workspace.onLayoutReady(()=>{this.activateRightSidebar()}),this.plugin.register(()=>{this.plugin.app.workspace.detachLeavesOfType(Ss)})}async activateRightSidebar(){let{workspace:t}=this.plugin.app,n=t.getLeavesOfType(Ss)[0];if(!n){let r=t.getRightLeaf(!1);r&&(n=r,await n.setViewState({type:Ss,active:!0}))}n&&t.revealLeaf(n)}};var Sf=class extends M2.Plugin{async onload(){RS(this.app),await le.ready,le.getRegisteredToolNames().length===0&&console.warn("\u767B\u9332\u6E08\u307F\u30C4\u30FC\u30EB\u304C\u3042\u308A\u307E\u305B\u3093"),this.painterPlugin=new Qd(this),this.rightSidebarPlugin=new yf(this),this.timelinePlugin=new lf(this),this.boardPlugin=new df(this),this.settingsPlugin=new hf(this),this.createMenuPlugin=new mf(this),this.painterPlugin.initialize(),this.rightSidebarPlugin.initialize(),this.timelinePlugin.initialize(),this.boardPlugin.initialize(),await this.settingsPlugin.initialize(),this.createMenuPlugin.initialize()}onunload(){}};
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

etro/dist/etro-cjs.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
